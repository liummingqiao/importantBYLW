!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.FM=e():t.FM=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=37)}({0:function(t,e,n){
/* @preserve
 * Leaflet 1.6.0, a JS library for interactive maps. http://leafletjs.com
 * (c) 2010-2019 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */
!function(t){"use strict";var e=Object.freeze;function n(t){var e,n,r,i;for(n=1,r=arguments.length;n<r;n++)for(e in i=arguments[n])t[e]=i[e];return t}Object.freeze=function(t){return t};var r=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function i(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var r=n.call(arguments,2);return function(){return t.apply(e,r.length?r.concat(n.call(arguments)):arguments)}}var o=0;function a(t){return t._leaflet_id=t._leaflet_id||++o,t._leaflet_id}function s(t,e,n){var r,i,o,a;return a=function(){r=!1,i&&(o.apply(n,i),i=!1)},o=function(){r?i=arguments:(t.apply(n,arguments),setTimeout(a,e),r=!0)}}function l(t,e,n){var r=e[1],i=e[0],o=r-i;return t===r&&n?t:((t-i)%o+o)%o+i}function u(){return!1}function c(t,e){var n=Math.pow(10,void 0===e?6:e);return Math.round(t*n)/n}function h(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function f(t){return h(t).split(/\s+/)}function p(t,e){for(var n in t.hasOwnProperty("options")||(t.options=t.options?r(t.options):{}),e)t.options[n]=e[n];return t.options}function d(t,e,n){var r=[];for(var i in t)r.push(encodeURIComponent(n?i.toUpperCase():i)+"="+encodeURIComponent(t[i]));return(e&&-1!==e.indexOf("?")?"&":"?")+r.join("&")}var g=/\{ *([\w_-]+) *\}/g;function y(t,e){return t.replace(g,(function(t,n){var r=e[n];if(void 0===r)throw new Error("No value provided for variable "+t);return"function"==typeof r&&(r=r(e)),r}))}var m=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function v(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var _="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function b(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var w=0;function x(t){var e=+new Date,n=Math.max(0,16-(e-w));return w=e+n,window.setTimeout(t,n)}var E=window.requestAnimationFrame||b("RequestAnimationFrame")||x,C=window.cancelAnimationFrame||b("CancelAnimationFrame")||b("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function k(t,e,n){if(!n||E!==x)return E.call(window,i(t,e));t.call(e)}function S(t){t&&C.call(window,t)}var P=(Object.freeze||Object)({freeze:e,extend:n,create:r,bind:i,lastId:o,stamp:a,throttle:s,wrapNum:l,falseFn:u,formatNum:c,trim:h,splitWords:f,setOptions:p,getParamString:d,template:y,isArray:m,indexOf:v,emptyImageUrl:_,requestFn:E,cancelFn:C,requestAnimFrame:k,cancelAnimFrame:S});function M(){}M.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=e.__super__=this.prototype,o=r(i);for(var a in o.constructor=e,e.prototype=o,this)this.hasOwnProperty(a)&&"prototype"!==a&&"__super__"!==a&&(e[a]=this[a]);return t.statics&&(n(e,t.statics),delete t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=m(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),n.apply(null,[o].concat(t.includes)),delete t.includes),o.options&&(t.options=n(r(o.options),t.options)),n(o,t),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=o._initHooks.length;t<e;t++)o._initHooks[t].call(this)}},e},M.include=function(t){return n(this.prototype,t),this},M.mergeOptions=function(t){return n(this.prototype.options,t),this},M.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var T={on:function(t,e,n){if("object"==typeof t)for(var r in t)this._on(r,t[r],e);else for(var i=0,o=(t=f(t)).length;i<o;i++)this._on(t[i],e,n);return this},off:function(t,e,n){if(t)if("object"==typeof t)for(var r in t)this._off(r,t[r],e);else for(var i=0,o=(t=f(t)).length;i<o;i++)this._off(t[i],e,n);else delete this._events;return this},_on:function(t,e,n){this._events=this._events||{};var r=this._events[t];r||(r=[],this._events[t]=r),n===this&&(n=void 0);for(var i={fn:e,ctx:n},o=r,a=0,s=o.length;a<s;a++)if(o[a].fn===e&&o[a].ctx===n)return;o.push(i)},_off:function(t,e,n){var r,i,o;if(this._events&&(r=this._events[t]))if(e){if(n===this&&(n=void 0),r)for(i=0,o=r.length;i<o;i++){var a=r[i];if(a.ctx===n&&a.fn===e)return a.fn=u,this._firingCount&&(this._events[t]=r=r.slice()),void r.splice(i,1)}}else{for(i=0,o=r.length;i<o;i++)r[i].fn=u;delete this._events[t]}},fire:function(t,e,r){if(!this.listens(t,r))return this;var i=n({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var a=0,s=o.length;a<s;a++){var l=o[a];l.fn.call(l.ctx||this,i)}this._firingCount--}}return r&&this._propagateEvent(i),this},listens:function(t,e){var n=this._events&&this._events[t];if(n&&n.length)return!0;if(e)for(var r in this._eventParents)if(this._eventParents[r].listens(t,e))return!0;return!1},once:function(t,e,n){if("object"==typeof t){for(var r in t)this.once(r,t[r],e);return this}var o=i((function(){this.off(t,e,n).off(t,o,n)}),this);return this.on(t,e,n).on(t,o,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[a(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[a(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,n({layer:t.target,propagatedFrom:t.target},t),!0)}};T.addEventListener=T.on,T.removeEventListener=T.clearAllEventListeners=T.off,T.addOneTimeEventListener=T.once,T.fireEvent=T.fire,T.hasEventListeners=T.listens;var O=M.extend(T);function I(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}var N=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function D(t,e,n){return t instanceof I?t:m(t)?new I(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new I(t.x,t.y):new I(t,e,n)}function R(t,e){if(t)for(var n=e?[t,e]:t,r=0,i=n.length;r<i;r++)this.extend(n[r])}function A(t,e){return!t||t instanceof R?t:new R(t,e)}function j(t,e){if(t)for(var n=e?[t,e]:t,r=0,i=n.length;r<i;r++)this.extend(n[r])}function B(t,e){return t instanceof j?t:new j(t,e)}function z(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==n&&(this.alt=+n)}function F(t,e,n){return t instanceof z?t:m(t)&&"object"!=typeof t[0]?3===t.length?new z(t[0],t[1],t[2]):2===t.length?new z(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new z(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new z(t,e,n)}I.prototype={clone:function(){return new I(this.x,this.y)},add:function(t){return this.clone()._add(D(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(D(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new I(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new I(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=N(this.x),this.y=N(this.y),this},distanceTo:function(t){var e=(t=D(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=D(t)).x===this.x&&t.y===this.y},contains:function(t){return t=D(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+c(this.x)+", "+c(this.y)+")"}},R.prototype={extend:function(t){return t=D(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new I((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new I(this.min.x,this.max.y)},getTopRight:function(){return new I(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof I?D(t):A(t))instanceof R?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=A(t);var e=this.min,n=this.max,r=t.min,i=t.max,o=i.x>=e.x&&r.x<=n.x,a=i.y>=e.y&&r.y<=n.y;return o&&a},overlaps:function(t){t=A(t);var e=this.min,n=this.max,r=t.min,i=t.max,o=i.x>e.x&&r.x<n.x,a=i.y>e.y&&r.y<n.y;return o&&a},isValid:function(){return!(!this.min||!this.max)}},j.prototype={extend:function(t){var e,n,r=this._southWest,i=this._northEast;if(t instanceof z)e=t,n=t;else{if(!(t instanceof j))return t?this.extend(F(t)||B(t)):this;if(e=t._southWest,n=t._northEast,!e||!n)return this}return r||i?(r.lat=Math.min(e.lat,r.lat),r.lng=Math.min(e.lng,r.lng),i.lat=Math.max(n.lat,i.lat),i.lng=Math.max(n.lng,i.lng)):(this._southWest=new z(e.lat,e.lng),this._northEast=new z(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,r=Math.abs(e.lat-n.lat)*t,i=Math.abs(e.lng-n.lng)*t;return new j(new z(e.lat-r,e.lng-i),new z(n.lat+r,n.lng+i))},getCenter:function(){return new z((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new z(this.getNorth(),this.getWest())},getSouthEast:function(){return new z(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof z||"lat"in t?F(t):B(t);var e,n,r=this._southWest,i=this._northEast;return t instanceof j?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=r.lat&&n.lat<=i.lat&&e.lng>=r.lng&&n.lng<=i.lng},intersects:function(t){t=B(t);var e=this._southWest,n=this._northEast,r=t.getSouthWest(),i=t.getNorthEast(),o=i.lat>=e.lat&&r.lat<=n.lat,a=i.lng>=e.lng&&r.lng<=n.lng;return o&&a},overlaps:function(t){t=B(t);var e=this._southWest,n=this._northEast,r=t.getSouthWest(),i=t.getNorthEast(),o=i.lat>e.lat&&r.lat<n.lat,a=i.lng>e.lng&&r.lng<n.lng;return o&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=B(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},z.prototype={equals:function(t,e){return!!t&&(t=F(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+c(this.lat,t)+", "+c(this.lng,t)+")"},distanceTo:function(t){return q.distance(this,F(t))},wrap:function(){return q.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return B([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new z(this.lat,this.lng,this.alt)}};var G,U={latLngToPoint:function(t,e){var n=this.projection.project(t),r=this.scale(e);return this.transformation._transform(n,r)},pointToLatLng:function(t,e){var n=this.scale(e),r=this.transformation.untransform(t,n);return this.projection.unproject(r)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);return new R(this.transformation.transform(e.min,n),this.transformation.transform(e.max,n))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?l(t.lng,this.wrapLng,!0):t.lng;return new z(this.wrapLat?l(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),r=e.lat-n.lat,i=e.lng-n.lng;if(0===r&&0===i)return t;var o=t.getSouthWest(),a=t.getNorthEast();return new j(new z(o.lat-r,o.lng-i),new z(a.lat-r,a.lng-i))}},q=n({},U,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,r=t.lat*n,i=e.lat*n,o=Math.sin((e.lat-t.lat)*n/2),a=Math.sin((e.lng-t.lng)*n/2),s=o*o+Math.cos(r)*Math.cos(i)*a*a,l=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s));return this.R*l}}),H={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,r=Math.max(Math.min(n,t.lat),-n),i=Math.sin(r*e);return new I(this.R*t.lng*e,this.R*Math.log((1+i)/(1-i))/2)},unproject:function(t){var e=180/Math.PI;return new z((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(G=6378137*Math.PI,new R([-G,-G],[G,G]))};function V(t,e,n,r){if(m(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=r}function Y(t,e,n,r){return new V(t,e,n,r)}V.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new I((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var W=n({},q,{code:"EPSG:3857",projection:H,transformation:function(){var t=.5/(Math.PI*H.R);return Y(t,.5,-t,.5)}()}),X=n({},W,{code:"EPSG:900913"});function Z(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function K(t,e){var n,r,i,o,a,s,l="";for(n=0,i=t.length;n<i;n++){for(r=0,o=(a=t[n]).length;r<o;r++)l+=(r?"L":"M")+(s=a[r]).x+" "+s.y;l+=e?Pt?"z":"x":""}return l||"M0 0"}var J=document.documentElement.style,Q="ActiveXObject"in window,$=Q&&!document.addEventListener,tt="msLaunchUri"in navigator&&!("documentMode"in document),et=Tt("webkit"),nt=Tt("android"),rt=Tt("android 2")||Tt("android 3"),it=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ot=nt&&Tt("Google")&&it<537&&!("AudioNode"in window),at=!!window.opera,st=Tt("chrome"),lt=Tt("gecko")&&!et&&!at&&!Q,ut=!st&&Tt("safari"),ct=Tt("phantom"),ht="OTransition"in J,ft=0===navigator.platform.indexOf("Win"),pt=Q&&"transition"in J,dt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!rt,gt="MozPerspective"in J,yt=!window.L_DISABLE_3D&&(pt||dt||gt)&&!ht&&!ct,mt="undefined"!=typeof orientation||Tt("mobile"),vt=mt&&et,_t=mt&&dt,bt=!window.PointerEvent&&window.MSPointerEvent,wt=!(et||!window.PointerEvent&&!bt),xt=!window.L_NO_TOUCH&&(wt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Lt=mt&&at,Et=mt&&lt,Ct=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,kt=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",u,e),window.removeEventListener("testPassiveEventSupport",u,e)}catch(t){}return t},St=!!document.createElement("canvas").getContext,Pt=!(!document.createElementNS||!Z("svg").createSVGRect),Mt=!Pt&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}();function Tt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Ot=(Object.freeze||Object)({ie:Q,ielt9:$,edge:tt,webkit:et,android:nt,android23:rt,androidStock:ot,opera:at,chrome:st,gecko:lt,safari:ut,phantom:ct,opera12:ht,win:ft,ie3d:pt,webkit3d:dt,gecko3d:gt,any3d:yt,mobile:mt,mobileWebkit:vt,mobileWebkit3d:_t,msPointer:bt,pointer:wt,touch:xt,mobileOpera:Lt,mobileGecko:Et,retina:Ct,passiveEvents:kt,canvas:St,svg:Pt,vml:Mt}),It=bt?"MSPointerDown":"pointerdown",Nt=bt?"MSPointerMove":"pointermove",Dt=bt?"MSPointerUp":"pointerup",Rt=bt?"MSPointerCancel":"pointercancel",At=["INPUT","SELECT","OPTION"],jt={},Bt=!1,zt=0;function Ft(t,e,n,r){return"touchstart"===e?function(t,e,n){var r=i((function(t){if("mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(At.indexOf(t.target.tagName)<0))return;je(t)}Ht(t,e)}));t["_leaflet_touchstart"+n]=r,t.addEventListener(It,r,!1),Bt||(document.documentElement.addEventListener(It,Gt,!0),document.documentElement.addEventListener(Nt,Ut,!0),document.documentElement.addEventListener(Dt,qt,!0),document.documentElement.addEventListener(Rt,qt,!0),Bt=!0)}(t,n,r):"touchmove"===e?function(t,e,n){var r=function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&Ht(t,e)};t["_leaflet_touchmove"+n]=r,t.addEventListener(Nt,r,!1)}(t,n,r):"touchend"===e&&function(t,e,n){var r=function(t){Ht(t,e)};t["_leaflet_touchend"+n]=r,t.addEventListener(Dt,r,!1),t.addEventListener(Rt,r,!1)}(t,n,r),this}function Gt(t){jt[t.pointerId]=t,zt++}function Ut(t){jt[t.pointerId]&&(jt[t.pointerId]=t)}function qt(t){delete jt[t.pointerId],zt--}function Ht(t,e){for(var n in t.touches=[],jt)t.touches.push(jt[n]);t.changedTouches=[t],e(t)}var Vt=bt?"MSPointerDown":wt?"pointerdown":"touchstart",Yt=bt?"MSPointerUp":wt?"pointerup":"touchend",Wt="_leaflet_";function Xt(t,e,n){var r,i,o=!1;function a(t){var e;if(wt){if(!tt||"mouse"===t.pointerType)return;e=zt}else e=t.touches.length;if(!(e>1)){var n=Date.now(),a=n-(r||n);i=t.touches?t.touches[0]:t,o=a>0&&a<=250,r=n}}function s(t){if(o&&!i.cancelBubble){if(wt){if(!tt||"mouse"===t.pointerType)return;var n,a,s={};for(a in i)n=i[a],s[a]=n&&n.bind?n.bind(i):n;i=s}i.type="dblclick",i.button=0,e(i),r=null}}return t[Wt+Vt+n]=a,t[Wt+Yt+n]=s,t[Wt+"dblclick"+n]=e,t.addEventListener(Vt,a,!!kt&&{passive:!1}),t.addEventListener(Yt,s,!!kt&&{passive:!1}),t.addEventListener("dblclick",e,!1),this}function Zt(t,e){var n=t[Wt+Vt+e],r=t[Wt+Yt+e],i=t[Wt+"dblclick"+e];return t.removeEventListener(Vt,n,!!kt&&{passive:!1}),t.removeEventListener(Yt,r,!!kt&&{passive:!1}),tt||t.removeEventListener("dblclick",i,!1),this}var Kt,Jt,Qt,$t,te,ee=me(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ne=me(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),re="webkitTransition"===ne||"OTransition"===ne?ne+"End":"transitionend";function ie(t){return"string"==typeof t?document.getElementById(t):t}function oe(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var r=document.defaultView.getComputedStyle(t,null);n=r?r[e]:null}return"auto"===n?null:n}function ae(t,e,n){var r=document.createElement(t);return r.className=e||"",n&&n.appendChild(r),r}function se(t){var e=t.parentNode;e&&e.removeChild(t)}function le(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ue(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function ce(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function he(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=ge(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function fe(t,e){if(void 0!==t.classList)for(var n=f(e),r=0,i=n.length;r<i;r++)t.classList.add(n[r]);else if(!he(t,e)){var o=ge(t);de(t,(o?o+" ":"")+e)}}function pe(t,e){void 0!==t.classList?t.classList.remove(e):de(t,h((" "+ge(t)+" ").replace(" "+e+" "," ")))}function de(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function ge(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function ye(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var n=!1,r="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(r)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+r+"(opacity="+e+")"}(t,e)}function me(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function ve(t,e,n){var r=e||new I(0,0);t.style[ee]=(pt?"translate("+r.x+"px,"+r.y+"px)":"translate3d("+r.x+"px,"+r.y+"px,0)")+(n?" scale("+n+")":"")}function _e(t,e){t._leaflet_pos=e,yt?ve(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function be(t){return t._leaflet_pos||new I(0,0)}if("onselectstart"in document)Kt=function(){Me(window,"selectstart",je)},Jt=function(){Oe(window,"selectstart",je)};else{var we=me(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Kt=function(){if(we){var t=document.documentElement.style;Qt=t[we],t[we]="none"}},Jt=function(){we&&(document.documentElement.style[we]=Qt,Qt=void 0)}}function xe(){Me(window,"dragstart",je)}function Le(){Oe(window,"dragstart",je)}function Ee(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Ce(),$t=t,te=t.style.outline,t.style.outline="none",Me(window,"keydown",Ce))}function Ce(){$t&&($t.style.outline=te,$t=void 0,te=void 0,Oe(window,"keydown",Ce))}function ke(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Se(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Pe=(Object.freeze||Object)({TRANSFORM:ee,TRANSITION:ne,TRANSITION_END:re,get:ie,getStyle:oe,create:ae,remove:se,empty:le,toFront:ue,toBack:ce,hasClass:he,addClass:fe,removeClass:pe,setClass:de,getClass:ge,setOpacity:ye,testProp:me,setTransform:ve,setPosition:_e,getPosition:be,disableTextSelection:Kt,enableTextSelection:Jt,disableImageDrag:xe,enableImageDrag:Le,preventOutline:Ee,restoreOutline:Ce,getSizedParentNode:ke,getScale:Se});function Me(t,e,n,r){if("object"==typeof e)for(var i in e)Ie(t,i,e[i],n);else for(var o=0,a=(e=f(e)).length;o<a;o++)Ie(t,e[o],n,r);return this}var Te="_leaflet_events";function Oe(t,e,n,r){if("object"==typeof e)for(var i in e)Ne(t,i,e[i],n);else if(e)for(var o=0,a=(e=f(e)).length;o<a;o++)Ne(t,e[o],n,r);else{for(var s in t[Te])Ne(t,s,t[Te][s]);delete t[Te]}return this}function Ie(t,e,n,r){var i=e+a(n)+(r?"_"+a(r):"");if(t[Te]&&t[Te][i])return this;var o=function(e){return n.call(r||t,e||window.event)},s=o;wt&&0===e.indexOf("touch")?Ft(t,e,o,i):!xt||"dblclick"!==e||!Xt||wt&&st?"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",o,!!kt&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?(o=function(e){e=e||window.event,Ye(t,e)&&s(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",o,!1)):("click"===e&&nt&&(o=function(t){!function(t,e){var n=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,r=Ue&&n-Ue;r&&r>100&&r<500||t.target._simulatedClick&&!t._simulated?Be(t):(Ue=n,e(t))}(t,s)}),t.addEventListener(e,o,!1)):"attachEvent"in t&&t.attachEvent("on"+e,o):Xt(t,o,i),t[Te]=t[Te]||{},t[Te][i]=o}function Ne(t,e,n,r){var i=e+a(n)+(r?"_"+a(r):""),o=t[Te]&&t[Te][i];if(!o)return this;wt&&0===e.indexOf("touch")?function(t,e,n){var r=t["_leaflet_"+e+n];"touchstart"===e?t.removeEventListener(It,r,!1):"touchmove"===e?t.removeEventListener(Nt,r,!1):"touchend"===e&&(t.removeEventListener(Dt,r,!1),t.removeEventListener(Rt,r,!1))}(t,e,i):!xt||"dblclick"!==e||!Zt||wt&&st?"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",o,!!kt&&{passive:!1}):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,o,!1):"detachEvent"in t&&t.detachEvent("on"+e,o):Zt(t,i),t[Te][i]=null}function De(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,Ve(t),this}function Re(t){return Ie(t,"mousewheel",De),this}function Ae(t){return Me(t,"mousedown touchstart dblclick",De),Ie(t,"click",He),this}function je(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Be(t){return je(t),De(t),this}function ze(t,e){if(!e)return new I(t.clientX,t.clientY);var n=Se(e),r=n.boundingClientRect;return new I((t.clientX-r.left)/n.x-e.clientLeft,(t.clientY-r.top)/n.y-e.clientTop)}var Fe=ft&&st?2*window.devicePixelRatio:lt?window.devicePixelRatio:1;function Ge(t){return tt?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Fe:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var Ue,qe={};function He(t){qe[t.type]=!0}function Ve(t){var e=qe[t.type];return qe[t.type]=!1,e}function Ye(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t}var We=(Object.freeze||Object)({on:Me,off:Oe,stopPropagation:De,disableScrollPropagation:Re,disableClickPropagation:Ae,preventDefault:je,stop:Be,getMousePosition:ze,getWheelDelta:Ge,fakeStop:He,skipped:Ve,isExternalTarget:Ye,addListener:Me,removeListener:Oe}),Xe=O.extend({run:function(t,e,n,r){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(r||.5,.2),this._startPos=be(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=k(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),_e(this._el,n),this.fire("step")},_complete:function(){S(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),Ze=O.extend({options:{crs:W,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=p(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=i(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(F(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ne&&yt&&!Lt&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Me(this._proxy,re,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,r){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(F(t),e,this.options.maxBounds),r=r||{},this._stop(),this._loaded&&!r.reset&&!0!==r&&(void 0!==r.animate&&(r.zoom=n({animate:r.animate},r.zoom),r.pan=n({animate:r.animate,duration:r.duration},r.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,r.zoom):this._tryAnimatedPan(t,r.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(yt?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(yt?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var r=this.getZoomScale(e),i=this.getSize().divideBy(2),o=(t instanceof I?t:this.latLngToContainerPoint(t)).subtract(i).multiplyBy(1-1/r),a=this.containerPointToLatLng(i.add(o));return this.setView(a,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():B(t);var n=D(e.paddingTopLeft||e.padding||[0,0]),r=D(e.paddingBottomRight||e.padding||[0,0]),i=this.getBoundsZoom(t,!1,n.add(r));if((i="number"==typeof e.maxZoom?Math.min(e.maxZoom,i):i)===1/0)return{center:t.getCenter(),zoom:i};var o=r.subtract(n).divideBy(2),a=this.project(t.getSouthWest(),i),s=this.project(t.getNorthEast(),i);return{center:this.unproject(a.add(s).divideBy(2).add(o),i),zoom:i}},fitBounds:function(t,e){if(!(t=B(t)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=D(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Xe,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){fe(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){if(!1===(n=n||{}).animate||!yt)return this.setView(t,e,n);this._stop();var r=this.project(this.getCenter()),i=this.project(t),o=this.getSize(),a=this._zoom;t=F(t),e=void 0===e?a:e;var s=Math.max(o.x,o.y),l=s*this.getZoomScale(a,e),u=i.distanceTo(r)||1;function c(t){var e=(l*l-s*s+2.0164*(t?-1:1)*2.0164*u*u)/(2*(t?l:s)*2.0164*u),n=Math.sqrt(e*e+1)-e;return n<1e-9?-18:Math.log(n)}function h(t){return(Math.exp(t)-Math.exp(-t))/2}function f(t){return(Math.exp(t)+Math.exp(-t))/2}var p=c(0);function d(t){return s*(f(p)*(h(e=p+1.42*t)/f(e))-h(p))/2.0164;var e}var g=Date.now(),y=(c(1)-p)/1.42,m=n.duration?1e3*n.duration:1e3*y*.8;return this._moveStart(!0,n.noMoveStart),function n(){var o=(Date.now()-g)/m,l=function(t){return 1-Math.pow(1-t,1.5)}(o)*y;o<=1?(this._flyToFrame=k(n,this),this._move(this.unproject(r.add(i.subtract(r).multiplyBy(d(l)/u)),a),this.getScaleZoom(s/function(t){return s*(f(p)/f(p+1.42*t))}(l),a),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return(t=B(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),r=this._limitCenter(n,this._zoom,B(t));return n.equals(r)||this.panTo(r,e),this._enforcingBounds=!1,this},panInside:function(t,e){var n=D((e=e||{}).paddingTopLeft||e.padding||[0,0]),r=D(e.paddingBottomRight||e.padding||[0,0]),i=this.getCenter(),o=this.project(i),a=this.project(t),s=this.getPixelBounds(),l=s.getSize().divideBy(2),u=A([s.min.add(n),s.max.subtract(r)]);if(!u.contains(a)){this._enforcingBounds=!0;var c=o.subtract(a),h=D(a.x+c.x,a.y+c.y);(a.x<u.min.x||a.x>u.max.x)&&(h.x=o.x-c.x,c.x>0?h.x+=l.x-n.x:h.x-=l.x-r.x),(a.y<u.min.y||a.y>u.max.y)&&(h.y=o.y-c.y,c.y>0?h.y+=l.y-n.y:h.y-=l.y-r.y),this.panTo(this.unproject(h),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=n({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var r=this.getSize(),o=e.divideBy(2).round(),a=r.divideBy(2).round(),s=o.subtract(a);return s.x||s.y?(t.animate&&t.pan?this.panBy(s):(t.pan&&this._rawPanBy(s),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:r})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=n({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=i(this._handleGeolocationResponse,this),r=i(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,r,t):navigator.geolocation.getCurrentPosition(e,r,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=new z(t.coords.latitude,t.coords.longitude),n=e.toBounds(2*t.coords.accuracy),r=this._locateOptions;if(r.setView){var i=this.getBoundsZoom(n);this.setView(e,r.maxZoom?Math.min(i,r.maxZoom):i)}var o={latlng:e,bounds:n,timestamp:t.timestamp};for(var a in t.coords)"number"==typeof t.coords[a]&&(o[a]=t.coords[a]);this.fire("locationfound",o)},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),se(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(S(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)se(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n=ae("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new j(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=B(t),n=D(n||[0,0]);var r=this.getZoom()||0,i=this.getMinZoom(),o=this.getMaxZoom(),a=t.getNorthWest(),s=t.getSouthEast(),l=this.getSize().subtract(n),u=A(this.project(s,r),this.project(a,r)).getSize(),c=yt?this.options.zoomSnap:1,h=l.x/u.x,f=l.y/u.y,p=e?Math.max(h,f):Math.min(h,f);return r=this.getScaleZoom(p,r),c&&(r=Math.round(r/(c/100))*(c/100),r=e?Math.ceil(r/c)*c:Math.floor(r/c)*c),Math.max(i,Math.min(o,r))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new I(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new R(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=void 0===e?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=void 0===e?this._zoom:e;var r=n.zoom(t*n.scale(e));return isNaN(r)?1/0:r},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(F(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(D(t),e)},layerPointToLatLng:function(t){var e=D(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(F(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(F(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(B(t))},distance:function(t,e){return this.options.crs.distance(F(t),F(e))},containerPointToLayerPoint:function(t){return D(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return D(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(D(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(F(t)))},mouseEventToContainerPoint:function(t){return ze(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=ie(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Me(e,"scroll",this._onScroll,this),this._containerId=a(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&yt,fe(t,"leaflet-container"+(xt?" leaflet-touch":"")+(Ct?" leaflet-retina":"")+($?" leaflet-oldie":"")+(ut?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=oe(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),_e(this._mapPane,new I(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(fe(t.markerPane,"leaflet-zoom-hide"),fe(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){_e(this._mapPane,new I(0,0));var n=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var r=this._zoom!==e;this._moveStart(r,!1)._move(t,e)._moveEnd(r),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,n){void 0===e&&(e=this._zoom);var r=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(r||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return S(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){_e(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[a(this._container)]=this;var e=t?Oe:Me;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),yt&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){S(this._resizeRequest),this._resizeRequest=k((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,r=[],i="mouseout"===e||"mouseover"===e,o=t.target||t.srcElement,s=!1;o;){if((n=this._targets[a(o)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(n)){s=!0;break}if(n&&n.listens(e,!0)){if(i&&!Ye(o,t))break;if(r.push(n),i)break}if(o===this._container)break;o=o.parentNode}return r.length||s||i||!Ye(o,t)||(r=[this]),r},_handleDOMEvent:function(t){if(this._loaded&&!Ve(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e&&"keyup"!==e&&"keydown"!==e||Ee(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,r){if("click"===t.type){var i=n({},t);i.type="preclick",this._fireDOMEvent(i,i.type,r)}if(!t._stopped&&(r=(r||[]).concat(this._findEventTargets(t,e))).length){var o=r[0];"contextmenu"===e&&o.listens(e,!0)&&je(t);var a={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var s=o.getLatLng&&(!o._radius||o._radius<=10);a.containerPoint=s?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),a.layerPoint=this.containerPointToLayerPoint(a.containerPoint),a.latlng=s?o.getLatLng():this.layerPointToLatLng(a.layerPoint)}for(var l=0;l<r.length;l++)if(r[l].fire(e,a,!0),a.originalEvent._stopped||!1===r[l].options.bubblingMouseEvents&&-1!==v(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return be(this._mapPane)||new I(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var r=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(r)},_latLngBoundsToNewLayerBounds:function(t,e,n){var r=this._getNewPixelOrigin(n,e);return A([this.project(t.getSouthWest(),e)._subtract(r),this.project(t.getNorthWest(),e)._subtract(r),this.project(t.getSouthEast(),e)._subtract(r),this.project(t.getNorthEast(),e)._subtract(r)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var r=this.project(t,e),i=this.getSize().divideBy(2),o=new R(r.subtract(i),r.add(i)),a=this._getBoundsOffset(o,n,e);return a.round().equals([0,0])?t:this.unproject(r.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),r=new R(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(r,e))},_getBoundsOffset:function(t,e,n){var r=A(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),i=r.min.subtract(t.min),o=r.max.subtract(t.max);return new I(this._rebound(i.x,-o.x),this._rebound(i.y,-o.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),r=yt?this.options.zoomSnap:1;return r&&(t=Math.round(t/r)*r),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){pe(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n)||(this.panBy(n,e),0))},_createAnimProxy:function(){var t=this._proxy=ae("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=ee,n=this._proxy.style[e];ve(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){se(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();ve(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var r=this.getZoomScale(e),i=this._getCenterOffset(t)._divideBy(1-1/r);return!(!0!==n.animate&&!this.getSize().contains(i)||(k((function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)}),this),0))},_animateZoom:function(t,e,n,r){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,fe(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:r}),setTimeout(i(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&pe(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),k((function(){this._moveEnd(!0)}),this))}}),Ke=M.extend({options:{position:"topright"},initialize:function(t){p(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),r=t._controlCorners[n];return fe(e,"leaflet-control"),-1!==n.indexOf("bottom")?r.insertBefore(e,r.firstChild):r.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(se(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Je=function(t){return new Ke(t)};Ze.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",n=this._controlContainer=ae("div",e+"control-container",this._container);function r(r,i){var o=e+r+" "+e+i;t[r+i]=ae("div",o,n)}r("top","left"),r("top","right"),r("bottom","left"),r("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)se(this._controlCorners[t]);se(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Qe=Ke.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,r){return n<r?-1:r<n?1:0}},initialize:function(t,e,n){for(var r in p(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[r],r);for(r in e)this._addLayer(e[r],r,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Ke.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(a(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){fe(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(fe(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):pe(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return pe(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=ae("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),Ae(e),Re(e);var r=this._section=ae("section",t+"-list");n&&(this._map.on("click",this.collapse,this),nt||Me(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var i=this._layersLink=ae("a",t+"-toggle",e);i.href="#",i.title="Layers",xt?(Me(i,"click",Be),Me(i,"click",this.expand,this)):Me(i,"focus",this.expand,this),n||this.expand(),this._baseLayersList=ae("div",t+"-base",r),this._separator=ae("div",t+"-separator",r),this._overlaysList=ae("div",t+"-overlays",r),e.appendChild(r)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&a(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(i((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;le(this._baseLayersList),le(this._overlaysList),this._layerControlInputs=[];var t,e,n,r,i=0;for(n=0;n<this._layers.length;n++)r=this._layers[n],this._addItem(r),e=e||r.overlay,t=t||!r.overlay,i+=r.overlay?0:1;return this.options.hideSingleBase&&(t=t&&i>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(a(t.target)),n=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",r=document.createElement("div");return r.innerHTML=n,r.firstChild},_addItem:function(t){var e,n=document.createElement("label"),r=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=r):e=this._createRadioElement("leaflet-base-layers_"+a(this),r),this._layerControlInputs.push(e),e.layerId=a(t.layer),Me(e,"click",this._onInputClick,this);var i=document.createElement("span");i.innerHTML=" "+t.name;var o=document.createElement("div");return n.appendChild(o),o.appendChild(e),o.appendChild(i),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,n=this._layerControlInputs,r=[],i=[];this._handlingClick=!0;for(var o=n.length-1;o>=0;o--)t=n[o],e=this._getLayer(t.layerId).layer,t.checked?r.push(e):t.checked||i.push(e);for(o=0;o<i.length;o++)this._map.hasLayer(i[o])&&this._map.removeLayer(i[o]);for(o=0;o<r.length;o++)this._map.hasLayer(r[o])||this._map.addLayer(r[o]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,r=this._map.getZoom(),i=n.length-1;i>=0;i--)t=n[i],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&r<e.options.minZoom||void 0!==e.options.maxZoom&&r>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),$e=Ke.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=ae("div",e+" leaflet-bar"),r=this.options;return this._zoomInButton=this._createButton(r.zoomInText,r.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(r.zoomOutText,r.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,r,i){var o=ae("a",n,r);return o.innerHTML=t,o.href="#",o.title=e,o.setAttribute("role","button"),o.setAttribute("aria-label",e),Ae(o),Me(o,"click",Be),Me(o,"click",i,this),Me(o,"click",this._refocusOnMap,this),o},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";pe(this._zoomInButton,e),pe(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&fe(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&fe(this._zoomInButton,e)}});Ze.mergeOptions({zoomControl:!0}),Ze.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new $e,this.addControl(this.zoomControl))}));var tn=Ke.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e=ae("div","leaflet-control-scale"),n=this.options;return this._addScales(n,"leaflet-control-scale-line",e),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),e},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=ae("div",e,n)),t.imperial&&(this._iScale=ae("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,n=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(n)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},_updateImperial:function(t){var e,n,r,i=3.2808399*t;i>5280?(e=i/5280,n=this._getRoundNum(e),this._updateScale(this._iScale,n+" mi",n/e)):(r=this._getRoundNum(i),this._updateScale(this._iScale,r+" ft",r/i))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),en=Ke.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){p(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=ae("div","leaflet-control-attribution"),Ae(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}}});Ze.mergeOptions({attributionControl:!0}),Ze.addInitHook((function(){this.options.attributionControl&&(new en).addTo(this)})),Ke.Layers=Qe,Ke.Zoom=$e,Ke.Scale=tn,Ke.Attribution=en,Je.layers=function(t,e,n){return new Qe(t,e,n)},Je.zoom=function(t){return new $e(t)},Je.scale=function(t){return new tn(t)},Je.attribution=function(t){return new en(t)};var nn=M.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});nn.addTo=function(t,e){return t.addHandler(e,this),this};var rn,on={Events:T},an=xt?"touchstart mousedown":"mousedown",sn={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},ln={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},un=O.extend({options:{clickTolerance:3},initialize:function(t,e,n,r){p(this,r),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(Me(this._dragStartTarget,an,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(un._dragging===this&&this.finishDrag(),Oe(this._dragStartTarget,an,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!he(this._element,"leaflet-zoom-anim")&&!(un._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(un._dragging=this,this._preventOutline&&Ee(this._element),xe(),Kt(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t,n=ke(this._element);this._startPoint=new I(e.clientX,e.clientY),this._parentScale=Se(n),Me(document,ln[t.type],this._onMove,this),Me(document,sn[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new I(e.clientX,e.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,je(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=be(this._element).subtract(n),fe(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),fe(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,S(this._animRequest),this._lastEvent=t,this._animRequest=k(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),_e(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in pe(document.body,"leaflet-dragging"),this._lastTarget&&(pe(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ln)Oe(document,ln[t],this._onMove,this),Oe(document,sn[t],this._onUp,this);Le(),Jt(),this._moved&&this._moving&&(S(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,un._dragging=!1}});function cn(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=function(t,e){var n=t.length,r=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);r[0]=r[n-1]=1,function t(e,n,r,i,o){var a,s,l,u=0;for(s=i+1;s<=o-1;s++)(l=gn(e[s],e[i],e[o],!0))>u&&(a=s,u=l);u>r&&(n[a]=1,t(e,n,r,i,a),t(e,n,r,a,o))}(t,r,e,0,n-1);var i,o=[];for(i=0;i<n;i++)r[i]&&o.push(t[i]);return o}(t=function(t,e){for(var n=[t[0]],r=1,i=0,o=t.length;r<o;r++)a=t[r],s=t[i],l=void 0,u=void 0,l=s.x-a.x,u=s.y-a.y,l*l+u*u>e&&(n.push(t[r]),i=r);var a,s,l,u;return i<o-1&&n.push(t[o-1]),n}(t,n),n)}function hn(t,e,n){return Math.sqrt(gn(t,e,n,!0))}function fn(t,e,n,r,i){var o,a,s,l=r?rn:dn(t,n),u=dn(e,n);for(rn=u;;){if(!(l|u))return[t,e];if(l&u)return!1;s=dn(a=pn(t,e,o=l||u,n,i),n),o===l?(t=a,l=s):(e=a,u=s)}}function pn(t,e,n,r,i){var o,a,s=e.x-t.x,l=e.y-t.y,u=r.min,c=r.max;return 8&n?(o=t.x+s*(c.y-t.y)/l,a=c.y):4&n?(o=t.x+s*(u.y-t.y)/l,a=u.y):2&n?(o=c.x,a=t.y+l*(c.x-t.x)/s):1&n&&(o=u.x,a=t.y+l*(u.x-t.x)/s),new I(o,a,i)}function dn(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function gn(t,e,n,r){var i,o=e.x,a=e.y,s=n.x-o,l=n.y-a,u=s*s+l*l;return u>0&&((i=((t.x-o)*s+(t.y-a)*l)/u)>1?(o=n.x,a=n.y):i>0&&(o+=s*i,a+=l*i)),s=t.x-o,l=t.y-a,r?s*s+l*l:new I(o,a)}function yn(t){return!m(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function mn(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),yn(t)}var vn=(Object.freeze||Object)({simplify:cn,pointToSegmentDistance:hn,closestPointOnSegment:function(t,e,n){return gn(t,e,n)},clipSegment:fn,_getEdgeIntersection:pn,_getBitCode:dn,_sqClosestPointOnSegment:gn,isFlat:yn,_flat:mn});function _n(t,e,n){var r,i,o,a,s,l,u,c,h,f=[1,4,2,8];for(i=0,u=t.length;i<u;i++)t[i]._code=dn(t[i],e);for(a=0;a<4;a++){for(c=f[a],r=[],i=0,o=(u=t.length)-1;i<u;o=i++)s=t[i],l=t[o],s._code&c?l._code&c||((h=pn(l,s,c,e,n))._code=dn(h,e),r.push(h)):(l._code&c&&((h=pn(l,s,c,e,n))._code=dn(h,e),r.push(h)),r.push(s));t=r}return t}var bn=(Object.freeze||Object)({clipPolygon:_n}),wn={project:function(t){return new I(t.lng,t.lat)},unproject:function(t){return new z(t.y,t.x)},bounds:new R([-180,-90],[180,90])},xn={R:6378137,R_MINOR:6356752.314245179,bounds:new R([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,n=this.R,r=t.lat*e,i=this.R_MINOR/n,o=Math.sqrt(1-i*i),a=o*Math.sin(r),s=Math.tan(Math.PI/4-r/2)/Math.pow((1-a)/(1+a),o/2);return r=-n*Math.log(Math.max(s,1e-10)),new I(t.lng*e*n,r)},unproject:function(t){for(var e,n=180/Math.PI,r=this.R,i=this.R_MINOR/r,o=Math.sqrt(1-i*i),a=Math.exp(-t.y/r),s=Math.PI/2-2*Math.atan(a),l=0,u=.1;l<15&&Math.abs(u)>1e-7;l++)e=o*Math.sin(s),e=Math.pow((1-e)/(1+e),o/2),s+=u=Math.PI/2-2*Math.atan(a*e)-s;return new z(s*n,t.x*n/r)}},Ln=(Object.freeze||Object)({LonLat:wn,Mercator:xn,SphericalMercator:H}),En=n({},q,{code:"EPSG:3395",projection:xn,transformation:function(){var t=.5/(Math.PI*xn.R);return Y(t,.5,-t,.5)}()}),Cn=n({},q,{code:"EPSG:4326",projection:wn,transformation:Y(1/180,1,-1/180,.5)}),kn=n({},U,{projection:wn,transformation:Y(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,r=e.lat-t.lat;return Math.sqrt(n*n+r*r)},infinite:!0});U.Earth=q,U.EPSG3395=En,U.EPSG3857=W,U.EPSG900913=X,U.EPSG4326=Cn,U.Simple=kn;var Sn=O.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[a(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[a(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",(function(){e.off(n,this)}),this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});Ze.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=a(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=a(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&a(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?m(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[a(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=a(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,n=this._getZoomSpan();for(var r in this._zoomBoundLayers){var i=this._zoomBoundLayers[r].options;t=void 0===i.minZoom?t:Math.min(t,i.minZoom),e=void 0===i.maxZoom?e:Math.max(e,i.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Pn=Sn.extend({initialize:function(t,e){var n,r;if(p(this,e),this._layers={},t)for(n=0,r=t.length;n<r;n++)this.addLayer(t[n])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,n,r=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,r);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return a(t)}}),Mn=Pn.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Pn.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Pn.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new j;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),Tn=M.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){p(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var r=this._createImg(n,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(r,t),r},_setIconStyles:function(t,e){var n=this.options,r=n[e+"Size"];"number"==typeof r&&(r=[r,r]);var i=D(r),o=D("shadow"===e&&n.shadowAnchor||n.iconAnchor||i&&i.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),i&&(t.style.width=i.x+"px",t.style.height=i.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Ct&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),On=Tn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return On.imagePath||(On.imagePath=this._detectIconPath()),(this.options.imagePath||On.imagePath)+Tn.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=ae("div","leaflet-default-icon-path",document.body),e=oe(t,"background-image")||oe(t,"backgroundImage");return document.body.removeChild(t),e=null===e||0!==e.indexOf("url")?"":e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),In=nn.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new un(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),fe(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&pe(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,n=e._map,r=this._marker.options.autoPanSpeed,i=this._marker.options.autoPanPadding,o=be(e._icon),a=n.getPixelBounds(),s=n.getPixelOrigin(),l=A(a.min._subtract(s).add(i),a.max._subtract(s).subtract(i));if(!l.contains(o)){var u=D((Math.max(l.max.x,o.x)-l.max.x)/(a.max.x-l.max.x)-(Math.min(l.min.x,o.x)-l.min.x)/(a.min.x-l.min.x),(Math.max(l.max.y,o.y)-l.max.y)/(a.max.y-l.max.y)-(Math.min(l.min.y,o.y)-l.min.y)/(a.min.y-l.min.y)).multiplyBy(r);n.panBy(u,{animate:!1}),this._draggable._newPos._add(u),this._draggable._startPos._add(u),_e(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=k(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(S(this._panRequest),this._panRequest=k(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,n=e._shadow,r=be(e._icon),i=e._map.layerPointToLatLng(r);n&&_e(n,r),e._latlng=i,t.latlng=i,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){S(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Nn=Sn.extend({options:{icon:new On,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){p(this,e),this._latlng=F(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=F(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),r=!1;n!==this._icon&&(this._icon&&this._removeIcon(),r=!0,t.title&&(n.title=t.title),"IMG"===n.tagName&&(n.alt=t.alt||"")),fe(n,e),t.keyboard&&(n.tabIndex="0"),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var i=t.icon.createShadow(this._shadow),o=!1;i!==this._shadow&&(this._removeShadow(),o=!0),i&&(fe(i,e),i.alt=""),this._shadow=i,t.opacity<1&&this._updateOpacity(),r&&this.getPane().appendChild(this._icon),this._initInteraction(),i&&o&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),se(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&se(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&_e(this._icon,t),this._shadow&&_e(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(fe(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),In)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new In(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&ye(this._icon,t),this._shadow&&ye(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),Dn=Sn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return p(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&t.hasOwnProperty("weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),Rn=Dn.extend({options:{fill:!0,radius:10},initialize:function(t,e){p(this,e),this._latlng=F(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=F(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Dn.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),r=[t+n,e+n];this._pxBounds=new R(this._point.subtract(r),this._point.add(r))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),An=Rn.extend({initialize:function(t,e,r){if("number"==typeof e&&(e=n({},r,{radius:e})),p(this,e),this._latlng=F(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new j(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Dn.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,r=n.options.crs;if(r.distance===q.distance){var i=Math.PI/180,o=this._mRadius/q.R/i,a=n.project([e+o,t]),s=n.project([e-o,t]),l=a.add(s).divideBy(2),u=n.unproject(l).lat,c=Math.acos((Math.cos(o*i)-Math.sin(e*i)*Math.sin(u*i))/(Math.cos(e*i)*Math.cos(u*i)))/i;(isNaN(c)||0===c)&&(c=o/Math.cos(Math.PI/180*e)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(c)?0:l.x-n.project([u,t-c]).x,this._radiusY=l.y-a.y}else{var h=r.unproject(r.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(h).x}this._updateBounds()}}),jn=Dn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){p(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,n,r=1/0,i=null,o=gn,a=0,s=this._parts.length;a<s;a++)for(var l=this._parts[a],u=1,c=l.length;u<c;u++){var h=o(t,e=l[u-1],n=l[u],!0);h<r&&(r=h,i=o(t,e,n))}return i&&(i.distance=Math.sqrt(r)),i},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,r,i,o,a,s=this._rings[0],l=s.length;if(!l)return null;for(t=0,e=0;t<l-1;t++)e+=s[t].distanceTo(s[t+1])/2;if(0===e)return this._map.layerPointToLatLng(s[0]);for(t=0,r=0;t<l-1;t++)if(i=s[t],o=s[t+1],(r+=n=i.distanceTo(o))>e)return a=(r-e)/n,this._map.layerPointToLatLng([o.x-a*(o.x-i.x),o.y-a*(o.y-i.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=F(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new j,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return yn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=yn(t),r=0,i=t.length;r<i;r++)n?(e[r]=F(t[r]),this._bounds.extend(e[r])):e[r]=this._convertLatLngs(t[r]);return e},_project:function(){var t=new R;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new I(t,t);this._pxBounds=new R([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)])},_projectLatlngs:function(t,e,n){var r,i,o=t[0]instanceof z,a=t.length;if(o){for(i=[],r=0;r<a;r++)i[r]=this._map.latLngToLayerPoint(t[r]),n.extend(i[r]);e.push(i)}else for(r=0;r<a;r++)this._projectLatlngs(t[r],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,n,r,i,o,a,s,l=this._parts;for(e=0,r=0,i=this._rings.length;e<i;e++)for(n=0,o=(s=this._rings[e]).length;n<o-1;n++)(a=fn(s[n],s[n+1],t,n,!0))&&(l[r]=l[r]||[],l[r].push(a[0]),a[1]===s[n+1]&&n!==o-2||(l[r].push(a[1]),r++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,r=t.length;n<r;n++)t[n]=cn(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,r,i,o,a,s,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,o=this._parts.length;n<o;n++)for(r=0,i=(a=(s=this._parts[n]).length)-1;r<a;i=r++)if((e||0!==r)&&hn(t,s[i],s[r])<=l)return!0;return!1}});jn._flat=mn;var Bn=jn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,r,i,o,a,s,l,u=this._rings[0],c=u.length;if(!c)return null;for(o=a=s=0,t=0,e=c-1;t<c;e=t++)n=u[t],r=u[e],i=n.y*r.x-r.y*n.x,a+=(n.x+r.x)*i,s+=(n.y+r.y)*i,o+=3*i;return l=0===o?u[0]:[a/o,s/o],this._map.layerPointToLatLng(l)},_convertLatLngs:function(t){var e=jn.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof z&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){jn.prototype._setLatLngs.call(this,t),yn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return yn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new I(e,e);if(t=new R(t.min.subtract(n),t.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var r,i=0,o=this._rings.length;i<o;i++)(r=_n(this._rings[i],t,!0)).length&&this._parts.push(r)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,r,i,o,a,s,l,u=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,s=this._parts.length;i<s;i++)for(o=0,a=(l=(e=this._parts[i]).length)-1;o<l;a=o++)n=e[o],r=e[a],n.y>t.y!=r.y>t.y&&t.x<(r.x-n.x)*(t.y-n.y)/(r.y-n.y)+n.x&&(u=!u);return u||jn.prototype._containsPoint.call(this,t,!0)}}),zn=Mn.extend({initialize:function(t,e){p(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,r,i=m(t)?t:t.features;if(i){for(e=0,n=i.length;e<n;e++)((r=i[e]).geometries||r.geometry||r.features||r.coordinates)&&this.addData(r);return this}var o=this.options;if(o.filter&&!o.filter(t))return this;var a=Fn(t,o);return a?(a.feature=Wn(t),a.defaultOptions=a.options,this.resetStyle(a),o.onEachFeature&&o.onEachFeature(t,a),this.addLayer(a)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=n({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function Fn(t,e){var n,r,i,o,a="Feature"===t.type?t.geometry:t,s=a?a.coordinates:null,l=[],u=e&&e.pointToLayer,c=e&&e.coordsToLatLng||Un;if(!s&&!a)return null;switch(a.type){case"Point":return Gn(u,t,n=c(s),e);case"MultiPoint":for(i=0,o=s.length;i<o;i++)n=c(s[i]),l.push(Gn(u,t,n,e));return new Mn(l);case"LineString":case"MultiLineString":return r=qn(s,"LineString"===a.type?0:1,c),new jn(r,e);case"Polygon":case"MultiPolygon":return r=qn(s,"Polygon"===a.type?1:2,c),new Bn(r,e);case"GeometryCollection":for(i=0,o=a.geometries.length;i<o;i++){var h=Fn({geometry:a.geometries[i],type:"Feature",properties:t.properties},e);h&&l.push(h)}return new Mn(l);default:throw new Error("Invalid GeoJSON object.")}}function Gn(t,e,n,r){return t?t(e,n):new Nn(n,r&&r.markersInheritOptions&&r)}function Un(t){return new z(t[1],t[0],t[2])}function qn(t,e,n){for(var r,i=[],o=0,a=t.length;o<a;o++)r=e?qn(t[o],e-1,n):(n||Un)(t[o]),i.push(r);return i}function Hn(t,e){return e="number"==typeof e?e:6,void 0!==t.alt?[c(t.lng,e),c(t.lat,e),c(t.alt,e)]:[c(t.lng,e),c(t.lat,e)]}function Vn(t,e,n,r){for(var i=[],o=0,a=t.length;o<a;o++)i.push(e?Vn(t[o],e-1,n,r):Hn(t[o],r));return!e&&n&&i.push(i[0]),i}function Yn(t,e){return t.feature?n({},t.feature,{geometry:e}):Wn(e)}function Wn(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Xn={toGeoJSON:function(t){return Yn(this,{type:"Point",coordinates:Hn(this.getLatLng(),t)})}};function Zn(t,e){return new zn(t,e)}Nn.include(Xn),An.include(Xn),Rn.include(Xn),jn.include({toGeoJSON:function(t){var e=!yn(this._latlngs);return Yn(this,{type:(e?"Multi":"")+"LineString",coordinates:Vn(this._latlngs,e?1:0,!1,t)})}}),Bn.include({toGeoJSON:function(t){var e=!yn(this._latlngs),n=e&&!yn(this._latlngs[0]),r=Vn(this._latlngs,n?2:e?1:0,!0,t);return e||(r=[r]),Yn(this,{type:(n?"Multi":"")+"Polygon",coordinates:r})}}),Pn.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(n){e.push(n.toGeoJSON(t).geometry.coordinates)})),Yn(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var n="GeometryCollection"===e,r=[];return this.eachLayer((function(e){if(e.toGeoJSON){var i=e.toGeoJSON(t);if(n)r.push(i.geometry);else{var o=Wn(i);"FeatureCollection"===o.type?r.push.apply(r,o.features):r.push(o)}}})),n?Yn(this,{geometries:r,type:"GeometryCollection"}):{type:"FeatureCollection",features:r}}});var Kn=Zn,Jn=Sn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=B(e),p(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(fe(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){se(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ue(this._image),this},bringToBack:function(){return this._map&&ce(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=B(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:ae("img");fe(e,"leaflet-image-layer"),this._zoomAnimated&&fe(e,"leaflet-zoom-animated"),this.options.className&&fe(e,this.options.className),e.onselectstart=u,e.onmousemove=u,e.onload=i(this.fire,this,"load"),e.onerror=i(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;ve(this._image,n,e)},_reset:function(){var t=this._image,e=new R(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();_e(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){ye(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),Qn=Jn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:ae("video");if(fe(e,"leaflet-image-layer"),this._zoomAnimated&&fe(e,"leaflet-zoom-animated"),this.options.className&&fe(e,this.options.className),e.onselectstart=u,e.onmousemove=u,e.onloadeddata=i(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),r=[],o=0;o<n.length;o++)r.push(n[o].src);this._url=n.length>0?r:[e.src]}else{m(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&e.style.hasOwnProperty("objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop;for(var a=0;a<this._url.length;a++){var s=ae("source");s.src=this._url[a],e.appendChild(s)}}}}),$n=Jn.extend({_initImage:function(){var t=this._image=this._url;fe(t,"leaflet-image-layer"),this._zoomAnimated&&fe(t,"leaflet-zoom-animated"),this.options.className&&fe(t,this.options.className),t.onselectstart=u,t.onmousemove=u}}),tr=Sn.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){p(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&ye(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&ye(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(ye(this._container,0),this._removeTimeout=setTimeout(i(se,void 0,this._container),200)):se(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=F(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ue(this._container),this},bringToBack:function(){return this._map&&ce(this._container),this},_prepareOpen:function(t,e,n){if(e instanceof Sn||(n=e,e=t),e instanceof Mn)for(var r in t._layers){e=t._layers[r];break}if(!n)if(e.getCenter)n=e.getCenter();else{if(!e.getLatLng)throw new Error("Unable to get source layer LatLng.");n=e.getLatLng()}return this._source=e,this.update(),n},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=D(this.options.offset),n=this._getAnchor();this._zoomAnimated?_e(this._container,t.add(n)):e=e.add(t).add(n);var r=this._containerBottom=-e.y,i=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=r+"px",this._container.style.left=i+"px"}},_getAnchor:function(){return[0,0]}}),er=tr.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){tr.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Dn||this._source.on("preclick",De))},onRemove:function(t){tr.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Dn||this._source.off("preclick",De))},getEvents:function(){var t=tr.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=ae("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=ae("div",t+"-content-wrapper",e);if(this._contentNode=ae("div",t+"-content",n),Ae(n),Re(this._contentNode),Me(n,"contextmenu",De),this._tipContainer=ae("div",t+"-tip-container",e),this._tip=ae("div",t+"-tip",this._tipContainer),this.options.closeButton){var r=this._closeButton=ae("a",t+"-close-button",e);r.href="#close",r.innerHTML="&#215;",Me(r,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var r=t.offsetHeight,i=this.options.maxHeight;i&&r>i?(e.height=i+"px",fe(t,"leaflet-popup-scrolled")):pe(t,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();_e(this._container,e.add(n))},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var t=this._map,e=parseInt(oe(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+e,r=this._containerWidth,i=new I(this._containerLeft,-n-this._containerBottom);i._add(be(this._container));var o=t.layerPointToContainerPoint(i),a=D(this.options.autoPanPadding),s=D(this.options.autoPanPaddingTopLeft||a),l=D(this.options.autoPanPaddingBottomRight||a),u=t.getSize(),c=0,h=0;o.x+r+l.x>u.x&&(c=o.x+r-u.x+l.x),o.x-c-s.x<0&&(c=o.x-s.x),o.y+n+l.y>u.y&&(h=o.y+n-u.y+l.y),o.y-h-s.y<0&&(h=o.y-s.y),(c||h)&&t.fire("autopanstart").panBy([c,h])}},_onCloseButtonClick:function(t){this._close(),Be(t)},_getAnchor:function(){return D(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});Ze.mergeOptions({closePopupOnClick:!0}),Ze.include({openPopup:function(t,e,n){return t instanceof er||(t=new er(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),Sn.include({bindPopup:function(t,e){return t instanceof er?(p(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new er(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){return this._popup&&this._map&&(e=this._popup._prepareOpen(this,t,e),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(Be(t),e instanceof Dn?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var nr=tr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){tr.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){tr.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=tr.prototype.getEvents.call(this);return xt&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ae("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,n=this._container,r=e.latLngToContainerPoint(e.getCenter()),i=e.layerPointToContainerPoint(t),o=this.options.direction,a=n.offsetWidth,s=n.offsetHeight,l=D(this.options.offset),u=this._getAnchor();"top"===o?t=t.add(D(-a/2+l.x,-s+l.y+u.y,!0)):"bottom"===o?t=t.subtract(D(a/2-l.x,-l.y,!0)):"center"===o?t=t.subtract(D(a/2+l.x,s/2-u.y+l.y,!0)):"right"===o||"auto"===o&&i.x<r.x?(o="right",t=t.add(D(l.x+u.x,u.y-s/2+l.y,!0))):(o="left",t=t.subtract(D(a+u.x-l.x,s/2-u.y-l.y,!0))),pe(n,"leaflet-tooltip-right"),pe(n,"leaflet-tooltip-left"),pe(n,"leaflet-tooltip-top"),pe(n,"leaflet-tooltip-bottom"),fe(n,"leaflet-tooltip-"+o),_e(n,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&ye(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return D(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});Ze.include({openTooltip:function(t,e,n){return t instanceof nr||(t=new nr(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),Sn.include({bindTooltip:function(t,e){return t instanceof nr?(p(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=new nr(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),xt&&(n.click=this._openTooltip)),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){return this._tooltip&&this._map&&(e=this._tooltip._prepareOpen(this,t,e),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(fe(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(pe(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,n,r=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),n=this._map.containerPointToLayerPoint(e),r=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(r)}});var rr=Tn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),n=this.options;if(n.html instanceof Element?(le(e),e.appendChild(n.html)):e.innerHTML=!1!==n.html?n.html:"",n.bgPos){var r=D(n.bgPos);e.style.backgroundPosition=-r.x+"px "+-r.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});Tn.Default=On;var ir=Sn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:mt,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){p(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),se(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ue(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ce(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=s(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof I?t:new I(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,n=this.getPane().children,r=-t(-1/0,1/0),i=0,o=n.length;i<o;i++)e=n[i].style.zIndex,n[i]!==this._container&&e&&(r=t(r,+e));isFinite(r)&&(this.options.zIndex=r+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!$){ye(this._container,this.options.opacity);var t=+new Date,e=!1,n=!1;for(var r in this._tiles){var i=this._tiles[r];if(i.current&&i.loaded){var o=Math.min(1,(t-i.loaded)/200);ye(i.el,o),o<1?e=!0:(i.active?n=!0:this._onOpaqueTile(i),i.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),e&&(S(this._fadeFrame),this._fadeFrame=k(this._updateOpacity,this))}},_onOpaqueTile:u,_initContainer:function(){this._container||(this._container=ae("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var n in this._levels)this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(se(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var r=this._levels[t],i=this._map;return r||((r=this._levels[t]={}).el=ae("div","leaflet-tile-container leaflet-zoom-animated",this._container),r.el.style.zIndex=e,r.origin=i.project(i.unproject(i.getPixelOrigin()),t).round(),r.zoom=t,this._setZoomTransform(r,i.getCenter(),i.getZoom()),r.el.offsetWidth,this._onCreateLevel(r)),this._level=r,r}},_onUpdateLevel:u,_onRemoveLevel:u,_onCreateLevel:u,_pruneTiles:function(){if(this._map){var t,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var r=e.coords;this._retainParent(r.x,r.y,r.z,r.z-5)||this._retainChildren(r.x,r.y,r.z,r.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)se(this._levels[t].el),this._onRemoveLevel(t),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,n,r){var i=Math.floor(t/2),o=Math.floor(e/2),a=n-1,s=new I(+i,+o);s.z=+a;var l=this._tileCoordsToKey(s),u=this._tiles[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),a>r&&this._retainParent(i,o,a,r))},_retainChildren:function(t,e,n,r){for(var i=2*t;i<2*t+2;i++)for(var o=2*e;o<2*e+2;o++){var a=new I(i,o);a.z=n+1;var s=this._tileCoordsToKey(a),l=this._tiles[s];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<r&&this._retainChildren(i,o,n+1,r))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,r){var i=this._clampZoom(Math.round(e));(void 0!==this.options.maxZoom&&i>this.options.maxZoom||void 0!==this.options.minZoom&&i<this.options.minZoom)&&(i=void 0);var o=this.options.updateWhenZooming&&i!==this._tileZoom;r&&!o||(this._tileZoom=i,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==i&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var r=this._map.getZoomScale(n,t.zoom),i=t.origin.multiplyBy(r).subtract(this._map._getNewPixelOrigin(e,n)).round();yt?ve(t.el,i,r):_e(t.el,i)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),r=this._tileZoom,i=this._map.getPixelWorldBounds(this._tileZoom);i&&(this._globalTileRange=this._pxBoundsToTileRange(i)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],r).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],r).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],r).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],r).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),r=e.getZoomScale(n,this._tileZoom),i=e.project(t,this._tileZoom).floor(),o=e.getSize().divideBy(2*r);return new R(i.subtract(o),i.add(o))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var r=this._getTiledPixelBounds(t),i=this._pxBoundsToTileRange(r),o=i.getCenter(),a=[],s=this.options.keepBuffer,l=new R(i.getBottomLeft().subtract([s,-s]),i.getTopRight().add([s,-s]));if(!(isFinite(i.min.x)&&isFinite(i.min.y)&&isFinite(i.max.x)&&isFinite(i.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var u in this._tiles){var c=this._tiles[u].coords;c.z===this._tileZoom&&l.contains(new I(c.x,c.y))||(this._tiles[u].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(t,n);else{for(var h=i.min.y;h<=i.max.y;h++)for(var f=i.min.x;f<=i.max.x;f++){var p=new I(f,h);if(p.z=this._tileZoom,this._isValidTile(p)){var d=this._tiles[this._tileCoordsToKey(p)];d?d.current=!0:a.push(p)}}if(a.sort((function(t,e){return t.distanceTo(o)-e.distanceTo(o)})),0!==a.length){this._loading||(this._loading=!0,this.fire("loading"));var g=document.createDocumentFragment();for(f=0;f<a.length;f++)this._addTile(a[f],g);this._level.el.appendChild(g)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var r=this._tileCoordsToBounds(t);return B(this.options.bounds).overlaps(r)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,n=this.getTileSize(),r=t.scaleBy(n),i=r.add(n);return[e.unproject(r,t.z),e.unproject(i,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),n=new j(e[0],e[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),n=new I(+e[0],+e[1]);return n.z=+e[2],n},_removeTile:function(t){var e=this._tiles[t];e&&(se(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){fe(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=u,t.onmousemove=u,$&&this.options.opacity<1&&ye(t,this.options.opacity),nt&&!rt&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var n=this._getTilePos(t),r=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),i(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&k(i(this._tileReady,this,t,null,o)),_e(o,n),this._tiles[r]={el:o,coords:t,current:!0},e.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,e,n){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var r=this._tileCoordsToKey(t);(n=this._tiles[r])&&(n.loaded=+new Date,this._map._fadeAnimated?(ye(n.el,0),S(this._fadeFrame),this._fadeFrame=k(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(fe(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),$||!this._map._fadeAnimated?k(this._pruneTiles,this):setTimeout(i(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new I(this._wrapX?l(t.x,this._wrapX):t.x,this._wrapY?l(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new R(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),or=ir.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=p(this,e)).detectRetina&&Ct&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),nt||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return Me(n,"load",i(this._tileOnLoad,this,e,n)),Me(n,"error",i(this._tileOnError,this,e,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),n.alt="",n.setAttribute("role","presentation"),n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:Ct?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var r=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=r),e["-y"]=r}return y(this._url,n(e,this.options))},_tileOnLoad:function(t,e){$?setTimeout(i(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var r=this.options.errorTileUrl;r&&e.getAttribute("src")!==r&&(e.src=r),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=u,e.onerror=u,e.complete||(e.src=_,se(e),delete this._tiles[t]))},_removeTile:function(t){var e=this._tiles[t];if(e)return ot||e.el.setAttribute("src",_),ir.prototype._removeTile.call(this,t)},_tileReady:function(t,e,n){if(this._map&&(!n||n.getAttribute("src")!==_))return ir.prototype._tileReady.call(this,t,e,n)}});function ar(t,e){return new or(t,e)}var sr=or.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var r=n({},this.defaultWmsParams);for(var i in e)i in this.options||(r[i]=e[i]);var o=(e=p(this,e)).detectRetina&&Ct?2:1,a=this.getTileSize();r.width=a.x*o,r.height=a.y*o,this.wmsParams=r},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,or.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),n=this._crs,r=A(n.project(e[0]),n.project(e[1])),i=r.min,o=r.max,a=(this._wmsVersion>=1.3&&this._crs===Cn?[i.y,i.x,o.y,o.x]:[i.x,i.y,o.x,o.y]).join(","),s=or.prototype.getTileUrl.call(this,t);return s+d(this.wmsParams,s,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+a},setParams:function(t,e){return n(this.wmsParams,t),e||this.redraw(),this}});or.WMS=sr,ar.wms=function(t,e){return new sr(t,e)};var lr=Sn.extend({options:{padding:.1,tolerance:0},initialize:function(t){p(this,t),a(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&fe(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),r=be(this._container),i=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,e),a=this._map.project(t,e).subtract(o),s=i.multiplyBy(-n).add(r).add(i).subtract(a);yt?ve(this._container,s,n):_e(this._container,s)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new R(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ur=lr.extend({getEvents:function(){var t=lr.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){lr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Me(t,"mousemove",this._onMouseMove,this),Me(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Me(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){S(this._redrawRequest),delete this._ctx,se(this._container),Oe(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){lr.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),r=Ct?2:1;_e(e,t.min),e.width=r*n.x,e.height=r*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",Ct&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){lr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[a(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,r=e.prev;n?n.prev=r:this._drawLast=r,r?r.next=n:this._drawFirst=n,delete t._order,delete this._layers[a(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,n,r=t.options.dashArray.split(/[, ]+/),i=[];for(n=0;n<r.length;n++){if(e=Number(r[n]),isNaN(e))return;i.push(e)}t.options._dashArray=i}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||k(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new R,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var r=this._drawFirst;r;r=r.next)t=r.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,r,i,o,a=t._parts,s=a.length,l=this._ctx;if(s){for(l.beginPath(),n=0;n<s;n++){for(r=0,i=a[n].length;r<i;r++)o=a[n][r],l[r?"lineTo":"moveTo"](o.x,o.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=this._ctx,r=Math.max(Math.round(t._radius),1),i=(Math.max(Math.round(t._radiusY),1)||r)/r;1!==i&&(n.save(),n.scale(1,i)),n.beginPath(),n.arc(e.x,e.y/i,r,0,2*Math.PI,!1),1!==i&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,r=this._map.mouseEventToLayerPoint(t),i=this._drawFirst;i;i=i.next)(e=i.layer).options.interactive&&e._containsPoint(r)&&!this._map._draggableMoved(e)&&(n=e);n&&(He(t),this._fireEvent([n],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(pe(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var n,r,i=this._drawFirst;i;i=i.next)(n=i.layer).options.interactive&&n._containsPoint(e)&&(r=n);r!==this._hoveredLayer&&(this._handleMouseOut(t),r&&(fe(this._container,"leaflet-interactive"),this._fireEvent([r],t,"mouseover"),this._hoveredLayer=r)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(L.bind((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var n=e.next,r=e.prev;n&&(n.prev=r,r?r.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var n=e.next,r=e.prev;r&&(r.next=n,n?n.prev=r:r&&(this._drawLast=r),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function cr(t){return St?new ur(t):null}var hr=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),fr={_initContainer:function(){this._container=ae("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(lr.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=hr("shape");fe(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=hr("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[a(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;se(e),t.removeInteractiveTarget(e),delete this._layers[a(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,r=t.options,i=t._container;i.stroked=!!r.stroke,i.filled=!!r.fill,r.stroke?(e||(e=t._stroke=hr("stroke")),i.appendChild(e),e.weight=r.weight+"px",e.color=r.color,e.opacity=r.opacity,r.dashArray?e.dashStyle=m(r.dashArray)?r.dashArray.join(" "):r.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=r.lineCap.replace("butt","flat"),e.joinstyle=r.lineJoin):e&&(i.removeChild(e),t._stroke=null),r.fill?(n||(n=t._fill=hr("fill")),i.appendChild(n),n.color=r.fillColor||r.color,n.opacity=r.fillOpacity):n&&(i.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),r=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+r+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){ue(t._container)},_bringToBack:function(t){ce(t._container)}},pr=Mt?hr:Z,dr=lr.extend({getEvents:function(){var t=lr.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=pr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=pr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){se(this._container),Oe(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){lr.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),_e(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=pr("path");t.options.className&&fe(e,t.options.className),t.options.interactive&&fe(e,"leaflet-interactive"),this._updateStyle(t),this._layers[a(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){se(t._path),t.removeInteractiveTarget(t._path),delete this._layers[a(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,K(t._parts,e))},_updateCircle:function(t){var e=t._point,n=Math.max(Math.round(t._radius),1),r="a"+n+","+(Math.max(Math.round(t._radiusY),1)||n)+" 0 1,0 ",i=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+r+2*n+",0 "+r+2*-n+",0 ";this._setPath(t,i)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){ue(t._path)},_bringToBack:function(t){ce(t._path)}});function gr(t){return Pt||Mt?new dr(t):null}Mt&&dr.include(fr),Ze.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&cr(t)||gr(t)}});var yr=Bn.extend({initialize:function(t,e){Bn.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=B(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});dr.create=pr,dr.pointsToPath=K,zn.geometryToLayer=Fn,zn.coordsToLatLng=Un,zn.coordsToLatLngs=qn,zn.latLngToCoords=Hn,zn.latLngsToCoords=Vn,zn.getFeature=Yn,zn.asFeature=Wn,Ze.mergeOptions({boxZoom:!0});var mr=nn.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Me(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Oe(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){se(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),Kt(),xe(),this._startPoint=this._map.mouseEventToContainerPoint(t),Me(document,{contextmenu:Be,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=ae("div","leaflet-zoom-box",this._container),fe(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new R(this._point,this._startPoint),n=e.getSize();_e(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(se(this._box),pe(this._container,"leaflet-crosshair")),Jt(),Le(),Oe(document,{contextmenu:Be,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(i(this._resetState,this),0);var e=new j(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});Ze.addInitHook("addHandler","boxZoom",mr),Ze.mergeOptions({doubleClickZoom:!0});var vr=nn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),r=e.options.zoomDelta,i=t.originalEvent.shiftKey?n-r:n+r;"center"===e.options.doubleClickZoom?e.setZoom(i):e.setZoomAround(t.containerPoint,i)}});Ze.addInitHook("addHandler","doubleClickZoom",vr),Ze.mergeOptions({dragging:!0,inertia:!rt,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var _r=nn.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new un(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}fe(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){pe(this._map._container,"leaflet-grab"),pe(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=B(this._map.options.maxBounds);this._offsetLimit=A(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,r=this._draggable._newPos.x,i=(r-e+n)%t+e-n,o=(r+e+n)%t-e-n,a=Math.abs(i+n)<Math.abs(o+n)?i:o;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=a},_onDragEnd:function(t){var e=this._map,n=e.options,r=!n.inertia||this._times.length<2;if(e.fire("dragend",t),r)e.fire("moveend");else{this._prunePositions(+new Date);var i=this._lastPos.subtract(this._positions[0]),o=(this._lastTime-this._times[0])/1e3,a=n.easeLinearity,s=i.multiplyBy(a/o),l=s.distanceTo([0,0]),u=Math.min(n.inertiaMaxSpeed,l),c=s.multiplyBy(u/l),h=u/(n.inertiaDeceleration*a),f=c.multiplyBy(-h/2).round();f.x||f.y?(f=e._limitOffset(f,e.options.maxBounds),k((function(){e.panBy(f,{duration:h,easeLinearity:a,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});Ze.addInitHook("addHandler","dragging",_r),Ze.mergeOptions({keyboard:!0,keyboardPanDelta:80});var br=nn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Me(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Oe(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,r=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(r,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,n,r=this._panKeys={},i=this.keyCodes;for(e=0,n=i.left.length;e<n;e++)r[i.left[e]]=[-1*t,0];for(e=0,n=i.right.length;e<n;e++)r[i.right[e]]=[t,0];for(e=0,n=i.down.length;e<n;e++)r[i.down[e]]=[0,t];for(e=0,n=i.up.length;e<n;e++)r[i.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,n,r=this._zoomKeys={},i=this.keyCodes;for(e=0,n=i.zoomIn.length;e<n;e++)r[i.zoomIn[e]]=t;for(e=0,n=i.zoomOut.length;e<n;e++)r[i.zoomOut[e]]=-t},_addHooks:function(){Me(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Oe(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n=t.keyCode,r=this._map;if(n in this._panKeys)r._panAnim&&r._panAnim._inProgress||(e=this._panKeys[n],t.shiftKey&&(e=D(e).multiplyBy(3)),r.panBy(e),r.options.maxBounds&&r.panInsideBounds(r.options.maxBounds));else if(n in this._zoomKeys)r.setZoom(r.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!r._popup||!r._popup.options.closeOnEscapeKey)return;r.closePopup()}Be(t)}}});Ze.addInitHook("addHandler","keyboard",br),Ze.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var wr=nn.extend({addHooks:function(){Me(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Oe(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=Ge(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var r=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(i(this._performZoom,this),r),Be(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var r=this._delta/(4*this._map.options.wheelPxPerZoomLevel),i=4*Math.log(2/(1+Math.exp(-Math.abs(r))))/Math.LN2,o=n?Math.ceil(i/n)*n:i,a=t._limitZoom(e+(this._delta>0?o:-o))-e;this._delta=0,this._startTime=null,a&&("center"===t.options.scrollWheelZoom?t.setZoom(e+a):t.setZoomAround(this._lastMousePos,e+a))}});Ze.addInitHook("addHandler","scrollWheelZoom",wr),Ze.mergeOptions({tap:!0,tapTolerance:15});var xr=nn.extend({addHooks:function(){Me(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Oe(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(je(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new I(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&fe(n,"leaflet-active"),this._holdTimeout=setTimeout(i((function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))}),this),1e3),this._simulateEvent("mousedown",e),Me(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),Oe(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],n=e.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&pe(n,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new I(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var n=document.createEvent("MouseEvents");n._simulated=!0,e.target._simulatedClick=!0,n.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}});xt&&!wt&&Ze.addInitHook("addHandler","tap",xr),Ze.mergeOptions({touchZoom:xt&&!rt,bounceAtZoomLimits:!0});var Lr=nn.extend({addHooks:function(){fe(this._map._container,"leaflet-touch-zoom"),Me(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){pe(this._map._container,"leaflet-touch-zoom"),Oe(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToContainerPoint(t.touches[0]),r=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(r)._divideBy(2))),this._startDist=n.distanceTo(r),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Me(document,"touchmove",this._onTouchMove,this),Me(document,"touchend",this._onTouchEnd,this),je(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),r=e.mouseEventToContainerPoint(t.touches[1]),o=n.distanceTo(r)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&o<1||this._zoom>e.getMaxZoom()&&o>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===o)return}else{var a=n._add(r)._divideBy(2)._subtract(this._centerPoint);if(1===o&&0===a.x&&0===a.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(a),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),S(this._animRequest);var s=i(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=k(s,this,!0),je(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,S(this._animRequest),Oe(document,"touchmove",this._onTouchMove),Oe(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Ze.addInitHook("addHandler","touchZoom",Lr),Ze.BoxZoom=mr,Ze.DoubleClickZoom=vr,Ze.Drag=_r,Ze.Keyboard=br,Ze.ScrollWheelZoom=wr,Ze.Tap=xr,Ze.TouchZoom=Lr,Object.freeze=e,t.version="1.6.0",t.Control=Ke,t.control=Je,t.Browser=Ot,t.Evented=O,t.Mixin=on,t.Util=P,t.Class=M,t.Handler=nn,t.extend=n,t.bind=i,t.stamp=a,t.setOptions=p,t.DomEvent=We,t.DomUtil=Pe,t.PosAnimation=Xe,t.Draggable=un,t.LineUtil=vn,t.PolyUtil=bn,t.Point=I,t.point=D,t.Bounds=R,t.bounds=A,t.Transformation=V,t.transformation=Y,t.Projection=Ln,t.LatLng=z,t.latLng=F,t.LatLngBounds=j,t.latLngBounds=B,t.CRS=U,t.GeoJSON=zn,t.geoJSON=Zn,t.geoJson=Kn,t.Layer=Sn,t.LayerGroup=Pn,t.layerGroup=function(t,e){return new Pn(t,e)},t.FeatureGroup=Mn,t.featureGroup=function(t){return new Mn(t)},t.ImageOverlay=Jn,t.imageOverlay=function(t,e,n){return new Jn(t,e,n)},t.VideoOverlay=Qn,t.videoOverlay=function(t,e,n){return new Qn(t,e,n)},t.SVGOverlay=$n,t.svgOverlay=function(t,e,n){return new $n(t,e,n)},t.DivOverlay=tr,t.Popup=er,t.popup=function(t,e){return new er(t,e)},t.Tooltip=nr,t.tooltip=function(t,e){return new nr(t,e)},t.Icon=Tn,t.icon=function(t){return new Tn(t)},t.DivIcon=rr,t.divIcon=function(t){return new rr(t)},t.Marker=Nn,t.marker=function(t,e){return new Nn(t,e)},t.TileLayer=or,t.tileLayer=ar,t.GridLayer=ir,t.gridLayer=function(t){return new ir(t)},t.SVG=dr,t.svg=gr,t.Renderer=lr,t.Canvas=ur,t.canvas=cr,t.Path=Dn,t.CircleMarker=Rn,t.circleMarker=function(t,e){return new Rn(t,e)},t.Circle=An,t.circle=function(t,e,n){return new An(t,e,n)},t.Polyline=jn,t.polyline=function(t,e){return new jn(t,e)},t.Polygon=Bn,t.polygon=function(t,e){return new Bn(t,e)},t.Rectangle=yr,t.rectangle=function(t,e){return new yr(t,e)},t.Map=Ze,t.map=function(t,e){return new Ze(t,e)};var Er=window.L;t.noConflict=function(){return window.L=Er,this},window.L=t}(e)},1:function(t,e,n){!function(t){"use strict";function e(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.bbox,i=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");r&&C(r),i&&k(i);var o={type:"Feature"};return i&&(o.id=i),r&&(o.bbox=r),o.properties=e||{},o.geometry=t,o}function n(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i,a=n.bbox;if(!t)throw new Error("type is required");if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");switch(a&&C(a),t){case"Point":i=r(e).geometry;break;case"LineString":i=s(e).geometry;break;case"Polygon":i=o(e).geometry;break;case"MultiPoint":i=h(e).geometry;break;case"MultiLineString":i=c(e).geometry;break;case"MultiPolygon":i=f(e).geometry;break;default:throw new Error(t+" is invalid")}return a&&(i.bbox=a),i}function r(t,n,r){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!L(t[0])||!L(t[1]))throw new Error("coordinates must contain numbers");return e({type:"Point",coordinates:t},n,r)}function i(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return u(t.map((function(t){return r(t,e)})),n)}function o(t,n,r){if(!t)throw new Error("coordinates is required");for(var i=0;i<t.length;i++){var o=t[i];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++){if(0===i&&0===a&&!L(o[0][0])||!L(o[0][1]))throw new Error("coordinates must contain numbers");if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}}return e({type:"Polygon",coordinates:t},n,r)}function a(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return u(t.map((function(t){return o(t,e)})),n)}function s(t,n,r){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!L(t[0][1])||!L(t[0][1]))throw new Error("coordinates must contain numbers");return e({type:"LineString",coordinates:t},n,r)}function l(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return u(t.map((function(t){return s(t,e)})),n)}function u(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.bbox,r=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&C(n),r&&k(r);var i={type:"FeatureCollection"};return r&&(i.id=r),n&&(i.bbox=n),i.features=t,i}function c(t,n,r){if(!t)throw new Error("coordinates is required");return e({type:"MultiLineString",coordinates:t},n,r)}function h(t,n,r){if(!t)throw new Error("coordinates is required");return e({type:"MultiPoint",coordinates:t},n,r)}function f(t,n,r){if(!t)throw new Error("coordinates is required");return e({type:"MultiPolygon",coordinates:t},n,r)}function p(t,n,r){if(!t)throw new Error("geometries is required");if(!Array.isArray(t))throw new Error("geometries must be an Array");return e({type:"GeometryCollection",geometries:t},n,r)}function d(t,e){if(null==t||isNaN(t))throw new Error("num is required");if(e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function g(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=Lo[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t*n}function y(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=Lo[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t/n}function m(t,e){return _(y(t,e))}function v(t){if(null==t)throw new Error("bearing is required");var e=t%360;return e<0&&(e+=360),e}function _(t){if(null==t)throw new Error("radians is required");return t%(2*Math.PI)*180/Math.PI}function b(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function w(t,e,n){if(null==t)throw new Error("length is required");if(!(t>=0))throw new Error("length must be a positive number");return g(y(t,e),n||"kilometers")}function x(t,e,n){if(null==t)throw new Error("area is required");if(!(t>=0))throw new Error("area must be a positive number");var r=Co[e||"meters"];if(!r)throw new Error("invalid original units");var i=Co[n||"kilometers"];if(!i)throw new Error("invalid final units");return t/r*i}function L(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function E(t){return!!t&&t.constructor===Object}function C(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!L(t))throw new Error("bbox must only contain numbers")}))}function k(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function S(t,e,n){if(null!==t)for(var r,i,o,a,s,l,u,c,h=0,f=0,p=t.type,d="FeatureCollection"===p,g="Feature"===p,y=d?t.features.length:1,m=0;m<y;m++){s=(c=!!(u=d?t.features[m].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var v=0;v<s;v++){var _=0,b=0;if(null!==(a=c?u.geometries[v]:u)){l=a.coordinates;var w=a.type;switch(h=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":e(l,f,m,_,b),f++,_++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++)e(l[r],f,m,_,b),f++,"MultiPoint"===w&&_++;"LineString"===w&&_++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(i=0;i<l[r].length-h;i++)e(l[r][i],f,m,_,b),f++;"MultiLineString"===w&&_++,"Polygon"===w&&b++}"Polygon"===w&&_++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for("MultiPolygon"===w&&(b=0),i=0;i<l[r].length;i++){for(o=0;o<l[r][i].length-h;o++)e(l[r][i][o],f,m,_,b),f++;b++}_++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)S(a.geometries[r],e,n);break;default:throw new Error("Unknown Geometry Type")}}}}}function P(t,e,n,r){var i=n;return S(t,(function(t,r,o,a,s){i=0===r&&void 0===n?t:e(i,t,r,o,a,s)}),r),i}function M(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties,n);break;case"Feature":e(t.properties,0)}}function T(t,e,n){var r=n;return M(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r}function O(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n],n)}function I(t,e,n){var r=n;return O(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r}function N(t){var e=[];return S(t,(function(t){e.push(t)})),e}function D(t,e){var n,r,i,o,a,s,l,u,c,h,f=0,p="FeatureCollection"===t.type,d="Feature"===t.type,g=p?t.features.length:1;for(n=0;n<g;n++){for(s=p?t.features[n].geometry:d?t.geometry:t,u=p?t.features[n].properties:d?t.properties:{},c=p?t.features[n].bbox:d?t.bbox:void 0,h=p?t.features[n].id:d?t.id:void 0,a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=l?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":e(o,f,u,c,h);break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)e(o.geometries[r],f,u,c,h);break;default:throw new Error("Unknown Geometry Type")}else e(null,f,u,c,h);f++}}function R(t,e,n){var r=n;return D(t,(function(t,i,o,a,s){r=0===i&&void 0===n?t:e(r,t,i,o,a,s)})),r}function A(t,n){D(t,(function(t,r,i,o,a){var s,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return void n(e(t,i,{bbox:o,id:a}),r,0)}switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}t.coordinates.forEach((function(t,o){n(e({type:s,coordinates:t},i),r,o)}))}))}function j(t,e,n){var r=n;return A(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r}function B(t,e){A(t,(function(t,n,r){var i=0;if(t.geometry){var o=t.geometry.type;"Point"!==o&&"MultiPoint"!==o&&P(t,(function(o,a,l,u,c,h){var f=s([o,a],t.properties);return e(f,n,r,h,i),i++,a}))}}))}function z(t,e,n){var r=n,i=!1;return B(t,(function(t,o,a,s,l){r=!1===i&&void 0===n?t:e(r,t,o,a,s,l),i=!0})),r}function F(t,e){if(!t)throw new Error("geojson is required");A(t,(function(t,n,r){if(null!==t.geometry){var i=t.geometry.type,o=t.geometry.coordinates;switch(i){case"LineString":e(t,n,r,0,0);break;case"Polygon":for(var a=0;a<o.length;a++)e(s(o[a],t.properties),n,r,a)}}}))}function G(t,e,n){var r=n;return F(t,(function(t,i,o,a){r=0===i&&void 0===n?t:e(r,t,i,o,a)})),r}function U(t){var e=[1/0,1/0,-1/0,-1/0];return S(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}function q(t){if(!t)throw new Error("obj is required");var e=H(t);if(e.length>1&&L(e[0])&&L(e[1]))return e;throw new Error("Coordinate is not a valid Point")}function H(t){if(!t)throw new Error("obj is required");var e;if(t.length?e=t:t.coordinates?e=t.coordinates:t.geometry&&t.geometry.coordinates&&(e=t.geometry.coordinates),e)return V(e),e;throw new Error("No valid coordinates")}function V(t){if(t.length>1&&L(t[0])&&L(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return V(t[0]);throw new Error("coordinates must only contain numbers")}function Y(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}function W(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}function X(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0;r<t.features.length;r++){var i=t.features[r];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!i.geometry||i.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+i.geometry.type)}}function Z(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")}function K(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")}function J(t,e){if(!t)throw new Error((e||"geojson")+" is required");if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error((e||"geojson")+" is invalid")}function Q(t,e,n){n=n||{};for(var r=Object.keys(Mo),i=0;i<r.length;i++){var o=r[i],a=n[o];a=null!=a?a:Mo[o],To[o]=a}To.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+e);var s=function(t){var e=[],n=0;return t.rows,t.cols,t.cells.forEach((function(r,i){r.forEach((function(r,o){if(void 0!==r&&!function(t){return 5===t.cval||10===t.cval}(r)&&!tt(r)){var a=function(t,e,n){var r,i,o,a=t.length,s=[],l=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],u=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],c=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],h=(t[e][n],t[e][n]),f=h.cval,p=nt(h,o=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"][f]);s.push([n+p[0],e+p[1]]),p=nt(h,o=c[f]),s.push([n+p[0],e+p[1]]),et(h);for(var d=n+l[f],g=e+u[f],y=f;d>=0&&g>=0&&g<a&&(d!=n||g!=e)&&void 0!==(h=t[g][d]);){if(0===(f=h.cval)||15===f)return{path:s,info:"mergeable"};o=c[f],r=l[f],i=u[f],5!==f&&10!==f||(5===f?h.flipped?-1===u[y]?(o="left",r=-1,i=0):(o="right",r=1,i=0):-1===l[y]&&(o="bottom",r=0,i=-1):10===f&&(h.flipped?-1===l[y]?(o="top",r=0,i=1):(o="bottom",r=0,i=-1):1===u[y]&&(o="left",r=-1,i=0))),p=nt(h,o),s.push([d+p[0],g+p[1]]),et(h),d+=r,g+=i,y=f}return{path:s,info:"closed"}}(t.cells,i,o),s=!1;if("mergeable"===a.info)for(var l=a.path[a.path.length-1][0],u=a.path[a.path.length-1][1],c=n-1;c>=0;c--)if(Math.abs(e[c][0][0]-l)<=1e-7&&Math.abs(e[c][0][1]-u)<=1e-7){for(var h=a.path.length-2;h>=0;--h)e[c].unshift(a.path[h]);s=!0;break}s||(e[n++]=a.path)}}))})),e}(function(t,e){for(var n=t.length-1,r=t[0].length-1,i={rows:n,cols:r,cells:[]},o=0;o<n;++o){i.cells[o]=[];for(var a=0;a<r;++a){var s=0,l=t[o+1][a],u=t[o+1][a+1],c=t[o][a+1],h=t[o][a];if(!(isNaN(l)||isNaN(u)||isNaN(c)||isNaN(h))){s|=l>=e?8:0,s|=u>=e?4:0,s|=c>=e?2:0;var f,p,d,g,y=!1;if(5==(s|=h>=e?1:0)||10===s){var m=(l+u+c+h)/4;5===s&&m<e?(s=10,y=!0):10===s&&m<e&&(s=5,y=!0)}0!==s&&15!==s&&(f=p=d=g=.5,1===s?(d=1-$(e,l,h),p=1-$(e,c,h)):2===s?(p=$(e,h,c),g=1-$(e,u,c)):3===s?(d=1-$(e,l,h),g=1-$(e,u,c)):4===s?(f=$(e,l,u),g=$(e,c,u)):5===s?(f=$(e,l,u),g=$(e,c,u),p=1-$(e,c,h),d=1-$(e,l,h)):6===s?(p=$(e,h,c),f=$(e,l,u)):7===s?(d=1-$(e,l,h),f=$(e,l,u)):8===s?(d=$(e,h,l),f=1-$(e,u,l)):9===s?(p=1-$(e,c,h),f=1-$(e,u,l)):10===s?(f=1-$(e,u,l),g=1-$(e,u,c),p=$(e,h,c),d=$(e,h,l)):11===s?(f=1-$(e,u,l),g=1-$(e,u,c)):12===s?(d=$(e,h,l),g=$(e,c,u)):13===s?(p=1-$(e,c,h),g=$(e,c,u)):14===s?(d=$(e,h,l),p=$(e,h,c)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+s),i.cells[o][a]={cval:s,flipped:y,top:f,right:g,bottom:p,left:d})}}}return i}(t,e));return"function"==typeof To.successCallback&&To.successCallback(s),s}function $(t,e,n){return(t-e)/(n-e)}function tt(t){return 0===t.cval||15===t.cval}function et(t){tt(t)||5===t.cval||10===t.cval||(t.cval=15)}function nt(t,e){return"top"===e?[t.top,1]:"bottom"===e?[t.bottom,0]:"right"===e?[1,t.right]:"left"===e?[0,t.left]:void 0}function rt(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function it(t,e){if(!(this instanceof it))return new it(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function ot(t,e){at(t,0,t.children.length,e,t)}function at(t,e,n,r,i){i||(i=dt(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,a=e;a<n;a++)o=t.children[a],st(i,t.leaf?r(o):o);return i}function st(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function lt(t,e){return t.minX-e.minX}function ut(t,e){return t.minY-e.minY}function ct(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function ht(t){return t.maxX-t.minX+(t.maxY-t.minY)}function ft(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function pt(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function dt(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function gt(t,e,n,r,i){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(o=e+Math.ceil((n-e)/r/2)*r,Oo(t,o,e,n,i),a.push(e,o,o,n))}function yt(t,e){return t(e={exports:{}},e.exports),e.exports}function mt(t,e){if(!(this instanceof mt))return new mt(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||function(t,e){return t<e?-1:t>e?1:0},this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function vt(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;for(var r,i=function(t){for(var e=t[0],n=t[0],r=t[0],i=t[0],o=0;o<t.length;o++){var a=t[o];a[0]<e[0]&&(e=a),a[0]>r[0]&&(r=a),a[1]<n[1]&&(n=a),a[1]>i[1]&&(i=a)}var s=[e,n,r,i],l=s.slice();for(o=0;o<t.length;o++)Ho(t[o],s)||l.push(t[o]);var u=Fo(l),c=[];for(o=0;o<u.length;o++)c.push(l[u[o]]);return c}(t),o=Io(16,["[0]","[1]","[0]","[1]"]).load(t),a=[],s=0;s<i.length;s++){var l=i[s];o.remove(l),r=Lt(l,r),a.push(r)}var u=Io(16);for(s=0;s<a.length;s++)u.insert(xt(a[s]));for(var c=e*e,h=n*n;a.length;){var f=a.shift(),p=f.p,d=f.next.p,g=Et(p,d);if(!(g<h)){var y=g/c;(l=function(t,e,n,r,i,o,a){for(var s=new Uo(null,_t),l=t.data;l;){for(var u=0;u<l.children.length;u++){var c=l.children[u],h=l.leaf?Ct(c,n,r):function(t,e,n){if(bt(t,n)||bt(e,n))return 0;var r=kt(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===r)return 0;var i=kt(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===i)return 0;var o=kt(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===o)return 0;var a=kt(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===a?0:Math.min(r,i,o,a)}(n,r,c);h>o||s.push({node:c,dist:h})}for(;s.length&&!s.peek().node.children;){var f=s.pop(),p=f.node,d=Ct(p,e,n),g=Ct(p,r,i);if(f.dist<d&&f.dist<g&&wt(n,p,a)&&wt(r,p,a))return p}(l=s.pop())&&(l=l.node)}return null}(o,f.prev.p,p,d,f.next.next.p,y,u))&&Math.min(Et(l,p),Et(l,d))<=y&&(a.push(f),a.push(Lt(l,f)),o.remove(l),u.remove(f),u.insert(xt(f)),u.insert(xt(f.next)))}}f=r;var m=[];do{m.push(f.p),f=f.next}while(f!==r);return m.push(f.p),m}function _t(t,e){return t.dist-e.dist}function bt(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function wt(t,e,n){for(var r=Math.min(t[0],e[0]),i=Math.min(t[1],e[1]),o=Math.max(t[0],e[0]),a=Math.max(t[1],e[1]),s=n.search({minX:r,minY:i,maxX:o,maxY:a}),l=0;l<s.length;l++)if(function(t,e,n,r){return t!==r&&e!==n&&Vo(t,e,n)>0!=Vo(t,e,r)>0&&Vo(n,r,t)>0!=Vo(n,r,e)>0}(s[l].p,s[l].next.p,t,e))return!1;return!0}function xt(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function Lt(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function Et(t,e){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function Ct(t,e,n){var r=e[0],i=e[1],o=n[0]-r,a=n[1]-i;if(0!==o||0!==a){var s=((t[0]-r)*o+(t[1]-i)*a)/(o*o+a*a);s>1?(r=n[0],i=n[1]):s>0&&(r+=o*s,i+=a*s)}return(o=t[0]-r)*o+(a=t[1]-i)*a}function kt(t,e,n,r,i,o,a,s){var l,u,c,h,f=n-t,p=r-e,d=a-i,g=s-o,y=t-i,m=e-o,v=f*f+p*p,_=f*d+p*g,b=d*d+g*g,w=f*y+p*m,x=d*y+g*m,L=v*b-_*_,E=L,C=L;0===L?(u=0,E=1,h=x,C=b):(h=v*x-_*w,(u=_*x-b*w)<0?(u=0,h=x,C=b):u>E&&(u=E,h=x+_,C=b)),h<0?(h=0,-w<0?u=0:-w>v?u=E:(u=-w,E=v)):h>C&&(h=C,-w+_<0?u=0:-w+_>v?u=E:(u=-w+_,E=v));var k=(1-(c=0===h?0:h/C))*i+c*a-((1-(l=0===u?0:u/E))*t+l*n),S=(1-c)*o+c*s-((1-l)*e+l*r);return k*k+S*S}function St(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.concavity||1/0,r=[];if(S(t,(function(t){r.push([t[0],t[1]])})),!r.length)return null;var i=Yo(r,n);return i.length>3?o([i]):null}function Pt(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var r=n.ignoreBoundary;if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=q(t),o=H(e),a=e.geometry?e.geometry.type:e.type,s=e.bbox;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(i,s))return!1;"Polygon"===a&&(o=[o]);for(var l=0,u=!1;l<o.length&&!u;l++)if(Mt(i,o[l][0],r)){for(var c=!1,h=1;h<o[l].length&&!c;)Mt(i,o[l][h],!r)&&(c=!0),h++;c||(u=!0)}return u}function Mt(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var a=e[i][0],s=e[i][1],l=e[o][0],u=e[o][1];if(t[1]*(a-l)+s*(l-t[0])+u*(t[0]-a)==0&&(a-t[0])*(l-t[0])<=0&&(s-t[1])*(u-t[1])<=0)return!n;s>t[1]!=u>t[1]&&t[0]<(l-a)*(t[1]-s)/(u-s)+a&&(r=!r)}return r}function Tt(t,e){var n=[];return D(e,(function(e){O(t,(function(t){Pt(t,e)&&n.push(t)}))})),u(n)}function Ot(t,e){if("FeatureCollection"!==t.type)throw new Error("points must be a FeatureCollection");var n=!1;return u(function(t){if(t.length<3)return[];t.sort(Nt);for(var e,n,r,i,o,a,s=t.length-1,l=t[s].x,u=t[0].x,c=t[s].y,h=c;s--;)t[s].y<c&&(c=t[s].y),t[s].y>h&&(h=t[s].y);var f,p=u-l,d=h-c,g=p>d?p:d,y=.5*(u+l),m=.5*(h+c),v=[new It({x:y-20*g,y:m-g,__sentinel:!0},{x:y,y:m+20*g,__sentinel:!0},{x:y+20*g,y:m-g,__sentinel:!0})],_=[],b=[];for(s=t.length;s--;){for(b.length=0,f=v.length;f--;)(p=t[s].x-v[f].x)>0&&p*p>v[f].r?(_.push(v[f]),v.splice(f,1)):p*p+(d=t[s].y-v[f].y)*d>v[f].r||(b.push(v[f].a,v[f].b,v[f].b,v[f].c,v[f].c,v[f].a),v.splice(f,1));for(Dt(b),f=b.length;f;)n=b[--f],e=b[--f],r=t[s],i=n.x-e.x,o=n.y-e.y,a=2*(i*(r.y-n.y)-o*(r.x-n.x)),Math.abs(a)>1e-12&&v.push(new It(e,n,r))}for(Array.prototype.push.apply(_,v),s=_.length;s--;)(_[s].a.__sentinel||_[s].b.__sentinel||_[s].c.__sentinel)&&_.splice(s,1);return _}(t.features.map((function(t){var r={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return e?r.z=t.properties[e]:3===t.geometry.coordinates.length&&(n=!0,r.z=t.geometry.coordinates[2]),r}))).map((function(t){var e=[t.a.x,t.a.y],r=[t.b.x,t.b.y],i=[t.c.x,t.c.y],a={};return n?(e.push(t.a.z),r.push(t.b.z),i.push(t.c.z)):a={a:t.a.z,b:t.b.z,c:t.c.z},o([[e,r,i,e]],a)})))}function It(t,e,n){this.a=t,this.b=e,this.c=n;var r,i,o=e.x-t.x,a=e.y-t.y,s=n.x-t.x,l=n.y-t.y,u=o*(t.x+e.x)+a*(t.y+e.y),c=s*(t.x+n.x)+l*(t.y+n.y),h=2*(o*(n.y-e.y)-a*(n.x-e.x));this.x=(l*u-a*c)/h,this.y=(o*c-s*u)/h,r=this.x-t.x,i=this.y-t.y,this.r=r*r+i*i}function Nt(t,e){return e.x-t.x}function Dt(t){var e,n,r,i,o,a=t.length;t:for(;a;)for(n=t[--a],e=t[--a],r=a;r;)if(o=t[--r],i=t[--r],e===i&&n===o||e===o&&n===i){t.splice(a,2),t.splice(r,2),a-=2;continue t}}function Rt(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.units,i=q(t),o=q(e),a=b(o[1]-i[1]),s=b(o[0]-i[0]),l=b(i[1]),u=b(o[1]),c=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(l)*Math.cos(u);return g(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),r)}function At(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return jt(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}})),e.features=t.features.map((function(t){return jt(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Bt(t);default:throw new Error("unknown GeoJSON type")}}function jt(t){var e={type:"Feature"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}})),e.properties=function t(e){var n={};return e?(Object.keys(e).forEach((function(r){var i=e[r];"object"==typeof i?null===i?n[r]=null:i.length?n[r]=i.map((function(t){return t})):n[r]=t(i):n[r]=i})),n):n}(t.properties),e.geometry=Bt(t.geometry),e}function Bt(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return Bt(t)})),e):(e.coordinates=function t(e){return"object"!=typeof e[0]?e.slice():e.map((function(e){return t(e)}))}(t.coordinates),e)}function zt(t,e){function n(t,e){e.length&&e.pop();for(var n=l[t<0?~t:t],r=0,i=n.length;r<i;++r)e.push(s(n[r],r));t<0&&Ko(e,i)}function r(t){return s(t)}function i(t){for(var e=[],r=0,i=t.length;r<i;++r)n(t[r],e);return e.length<2&&e.push(e[0]),e}function o(t){for(var e=i(t);e.length<4;)e.push(e[0]);return e}function a(t){return t.map(o)}var s=Zo(t.transform),l=t.arcs;return function t(e){var n,o=e.type;switch(o){case"GeometryCollection":return{type:o,geometries:e.geometries.map(t)};case"Point":n=r(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(r);break;case"LineString":n=i(e.arcs);break;case"MultiLineString":n=e.arcs.map(i);break;case"Polygon":n=a(e.arcs);break;case"MultiPolygon":n=e.arcs.map(a);break;default:return null}return{type:o,coordinates:n}}(e)}function Ft(t,e){function n(t){t.forEach((function(e){e.forEach((function(e){(i[e=e<0?~e:e]||(i[e]=[])).push(t)}))})),o.push(t)}function r(e){return function(t){for(var e,n=-1,r=t.length,i=t[r-1],o=0;++n<r;)e=i,i=t[n],o+=e[0]*i[1]-e[1]*i[0];return Math.abs(o)}(zt(t,{type:"Polygon",arcs:[e]}).coordinates[0])}var i={},o=[],a=[];return e.forEach((function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":n(e.arcs);break;case"MultiPolygon":e.arcs.forEach(n)}})),o.forEach((function(t){if(!t._){var e=[],n=[t];for(t._=1,a.push(e);t=n.pop();)e.push(t),t.forEach((function(t){t.forEach((function(t){i[t<0?~t:t].forEach((function(t){t._||(t._=1,n.push(t))}))}))}))}})),o.forEach((function(t){delete t._})),{type:"MultiPolygon",arcs:a.map((function(e){var n,o=[];if(e.forEach((function(t){t.forEach((function(t){t.forEach((function(t){i[t<0?~t:t].length<2&&o.push(t)}))}))})),(n=(o=Jo(t,o)).length)>1)for(var a,s,l=1,u=r(o[0]);l<n;++l)(a=r(o[l]))>u&&(s=o[0],o[0]=o[l],o[l]=s,u=a);return o}))}}function Gt(t,e,n){for(var r,i=e+(n---e>>1);e<i;++e,--n)r=t[e],t[e]=t[n],t[n]=r}function Ut(t){return null==t?{type:null}:("FeatureCollection"===t.type?function(t){var e={type:"GeometryCollection",geometries:t.features.map(qt)};return null!=t.bbox&&(e.bbox=t.bbox),e}:"Feature"===t.type?qt:Ht)(t)}function qt(t){var e,n=Ht(t.geometry);for(e in null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox),t.properties){n.properties=t.properties;break}return n}function Ht(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(Ht)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}function Vt(t){var e,n=t[0],r=t[1];return r<n&&(e=n,n=r,r=e),n+31*r}function Yt(t,e){var n,r=t[0],i=t[1],o=e[0],a=e[1];return i<r&&(n=r,r=i,i=n),a<o&&(n=o,o=a,a=n),r===o&&i===a}function Wt(t){return t[0].toString()+","+t[1].toString()}function Xt(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==J(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=At(t));var r=function(t){var e={};A(t,(function(t){e[t.geometry.type]=!0}));var n=Object.keys(e);return 1===n.length?n[0]:null}(t);if(!r)throw new Error("geojson must be homogenous");switch(r){case"LineString":return function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==J(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=At(t));var r=[],i=G(t,(function(t,e){return function(t,e){var n,r=t.geometry.coordinates,i=e.geometry.coordinates,o=Wt(r[0]),a=Wt(r[r.length-1]),l=Wt(i[0]),u=Wt(i[i.length-1]);if(o===u)n=i.concat(r.slice(1));else if(l===a)n=r.concat(i.slice(1));else if(o===l)n=r.slice(1).reverse().concat(i);else{if(a!==u)return null;n=r.concat(i.reverse().slice(1))}return s(n)}(t,e)||(r.push(t),e)}));return i&&r.push(i),r.length?1===r.length?r[0]:c(r.map((function(t){return t.coordinates}))):null}(t,e);case"Polygon":return function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==J(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=At(t));var r=[];A(t,(function(t){r.push(t.geometry)}));var i=aa({geoms:p(r).geometry});return Qo(i,i.objects.geoms.geometries)}(t,e);default:throw new Error(r+" is not supported")}}function Zt(t,n){var r="object"==typeof n?n.mutate:n;if(!t)throw new Error("geojson is required");var i=J(t),o=[];switch(i){case"LineString":o=Kt(t);break;case"MultiLineString":case"Polygon":H(t).forEach((function(t){o.push(Kt(t))}));break;case"MultiPolygon":H(t).forEach((function(t){var e=[];t.forEach((function(t){e.push(Kt(t))})),o.push(e)}));break;case"Point":return t;case"MultiPoint":var a={};H(t).forEach((function(t){var e=t.join("-");a.hasOwnProperty(e)||(o.push(t),a[e]=!0)}));break;default:throw new Error(i+" geometry not supported")}return t.coordinates?!0===r?(t.coordinates=o,t):{type:i,coordinates:o}:!0===r?(t.geometry.coordinates=o,t):e({type:i,coordinates:o},t.properties,t.bbox,t.id)}function Kt(t){var e=H(t);if(2===e.length&&!function(t,e){return t[0]===e[0]&&t[1]===e[1]}(e[0],e[1]))return e;var n,r,i,o=[],a=e.length-1;o.push(e[0]);for(var s=1;s<a;s++)n=e[s-1],r=e[s],function(t,e,n){var r=n[0],i=n[1],o=t[0],a=t[1],s=e[0],l=e[1],u=s-o,c=l-a;return(r-o)*c-(i-a)*u==0&&(Math.abs(u)>=Math.abs(c)?u>0?o<=r&&r<=s:s<=r&&r<=o:c>0?a<=i&&i<=l:l<=i&&i<=a)}(n,i=e[s+1],r)||o.push(r);return o.push(i),o}function Jt(t,e){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r}function Qt(t,e,n){var r=e.x,i=e.y,o=n.x-r,a=n.y-i;if(0!==o||0!==a){var s=((t.x-r)*o+(t.y-i)*a)/(o*o+a*a);s>1?(r=n.x,i=n.y):s>0&&(r+=o*s,i+=a*s)}return(o=t.x-r)*o+(a=t.y-i)*a}function $t(t,e,n){if(t.length<=2)return t;var r=void 0!==e?e*e:1;return function(t,e){var n=t.length-1,r=[t[0]];return function t(e,n,r,i,o){for(var a,s=i,l=n+1;l<r;l++){var u=Qt(e[l],e[n],e[r]);u>s&&(a=l,s=u)}s>i&&(a-n>1&&t(e,n,a,i,o),o.push(e[a]),r-a>1&&t(e,a,r,i,o))}(t,0,n,e,r),r.push(t[n]),r}(t=n?t:function(t,e){for(var n,r=t[0],i=[r],o=1,a=t.length;o<a;o++)Jt(n=t[o],r)>e&&(i.push(n),r=n);return r!==n&&i.push(n),i}(t,r),r)}function te(t,e,n){return $t(t.map((function(t){return{x:t[0],y:t[1],z:t[2]}})),e,n).map((function(t){return t.z?[t.x,t.y,t.z]:[t.x,t.y]}))}function ee(t,e,n){return t.map((function(t){var r=t.map((function(t){return{x:t[0],y:t[1]}}));if(r.length<4)throw new Error("invalid polygon");for(var i=$t(r,e,n).map((function(t){return[t.x,t.y]}));!function(t){return!(t.length<3||3===t.length&&t[2][0]===t[0][0]&&t[2][1]===t[0][1])}(i);)i=$t(r,e-=.01*e,n).map((function(t){return[t.x,t.y]}));return i[i.length-1][0]===i[0][0]&&i[i.length-1][1]===i[0][1]||i.push(i[0]),i}))}function ne(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.resolution||1e4,r=e.sharpness||.85;if(!t)throw new Error("line is required");if(!L(n))throw new Error("resolution must be an number");if(!L(r))throw new Error("sharpness must be an number");for(var i=[],o=new sa({points:Z(t).coordinates.map((function(t){return{x:t[0],y:t[1]}})),duration:n,sharpness:r}),a=0;a<o.duration;a+=10){var l=o.pos(a);Math.floor(a/100)%2==0&&i.push([l.x,l.y])}return s(i,t.properties)}function re(t){C(t);var e=Number(t[0]),n=Number(t[1]),r=Number(t[2]),i=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[e,n];return o([[a,[r,n],[r,i],[e,i],a]])}function ie(t){return re(U(t))}function oe(t){var e=t[0],n=t[1],r=t[2],i=t[3];if(Rt(t.slice(0,2),[r,n])>=Rt(t.slice(0,2),[e,i])){var o=(n+i)/2;return[e,o-(r-e)/2,r,o+(r-e)/2]}var a=(e+r)/2;return[a-(i-n)/2,n,a+(i-n)/2,i]}function ae(t,e,n,i){if(!E(i=i||{}))throw new Error("options is invalid");var o=i.units,a=i.properties,s=q(t),l=b(s[0]),u=b(s[1]),c=b(n),h=y(e,o),f=Math.asin(Math.sin(u)*Math.cos(h)+Math.cos(u)*Math.sin(h)*Math.cos(c));return r([_(l+Math.atan2(Math.sin(c)*Math.sin(h)*Math.cos(u),Math.cos(h)-Math.sin(u)*Math.sin(f))),_(f)],a)}function se(t,e,n){var r=(n=n||{}).steps||64,i=n.properties;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be a number");r=r||64,i=i||t.properties||{};for(var a=[],s=0;s<r;s++)a.push(ae(t,e,-360*s/r,n).geometry.coordinates);return a.push(a[0]),o([a],i)}function le(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");if(!0===n.final)return function(t,e){var n=le(e,t);return(n+180)%360}(t,e);var r=q(t),i=q(e),o=b(r[0]),a=b(i[0]),s=b(r[1]),l=b(i[1]),u=Math.sin(a-o)*Math.cos(l),c=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(a-o);return _(Math.atan2(u,c))}function ue(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.properties;if(!t)throw new Error("geojson is required");var i=U(t);return r([(i[0]+i[2])/2,(i[1]+i[3])/2],n)}function ce(t,e){var n=0,i=0,o=0;return S(t,(function(t){n+=t[0],i+=t[1],o++}),!0),r([n/o,i/o],e)}function he(t){var e=[];return"FeatureCollection"===t.type?O(t,(function(t){S(t,(function(n){e.push(r(n,t.properties))}))})):S(t,(function(n){e.push(r(n,t.properties))})),u(e)}function fe(t,e,n){n=n||2;var r,i,o,a,s,l,u,c=e&&e.length,h=c?e[0]*n:t.length,f=pe(t,0,h,n,!0),p=[];if(!f)return p;if(c&&(f=function(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=pe(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(function(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}(a));for(s.sort(ge),i=0;i<s.length;i++)!function(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var l,u=n,c=n.x,h=n.y,f=1/0;for(r=n.next;r!==u;)i>=r.x&&r.x>=c&&i!==r.x&&me(o<h?i:a,o,c,h,o<h?a:i,o,r.x,r.y)&&((l=Math.abs(o-r.y)/(i-r.x))<f||l===f&&r.x>n.x)&&we(r,t)&&(n=r,f=l),r=r.next;return n}(t,e)){var n=xe(e,t);de(n,n.next)}}(s[i],n),n=de(n,n.next);return n}(t,e,f,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<h;d+=n)(s=t[d])<r&&(r=s),(l=t[d+1])<i&&(i=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-r,a-i))?1/u:0}return function t(e,n,r,i,o,a,s){if(e){!s&&a&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=ye(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,l,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1)}(i)}(e,i,o,a);for(var l,u,c=e;e.prev!==e.next;)if(l=e.prev,u=e.next,a?function(t,e,n,r){var i=t.prev,o=t,a=t.next;if(ve(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,l=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=ye(s,l,e,n,r),f=ye(u,c,e,n,r),p=t.nextZ;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&me(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&ve(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&me(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&ve(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}(e,i,o,a):function(t){var e=t.prev,n=t,r=t.next;if(ve(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(me(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&ve(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}(e))n.push(l.i/r),n.push(e.i/r),n.push(u.i/r),Ee(e),e=u.next,c=u.next;else if((e=u)===c){s?1===s?t(e=function(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!_e(i,o)&&be(i,r,r.next,o)&&we(i,o)&&we(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Ee(r),Ee(r.next),r=t=o),r=r.next}while(r!==t);return r}(e,n,r),n,r,i,o,a,2):2===s&&function(e,n,r,i,o,a){var s=e;do{for(var l=s.next.next;l!==s.prev;){if(s.i!==l.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&be(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&we(t,e)&&we(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}(s,l)){var u=xe(s,l);return s=de(s,s.next),u=de(u,u.next),t(s,n,r,i,o,a),void t(u,n,r,i,o,a)}l=l.next}s=s.next}while(s!==e)}(e,n,r,i,o,a):t(de(e),n,r,i,o,a,1);break}}}(f,p,n,r,i,u),p}function pe(t,e,n,r,i){var o,a;if(i===ke(t,e,n,r)>0)for(o=e;o<n;o+=r)a=Le(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=Le(o,t[o],t[o+1],a);return a&&_e(a,a.next)&&(Ee(a),a=a.next),a}function de(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!_e(r,r.next)&&0!==ve(r.prev,r,r.next))r=r.next;else{if(Ee(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function ge(t,e){return t.x-e.x}function ye(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function me(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function ve(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function _e(t,e){return t.x===e.x&&t.y===e.y}function be(t,e,n,r){return!!(_e(t,e)&&_e(n,r)||_e(t,r)&&_e(n,e))||ve(t,e,n)>0!=ve(t,e,r)>0&&ve(n,r,t)>0!=ve(n,r,e)>0}function we(t,e){return ve(t.prev,t,t.next)<0?ve(t,e,t.next)>=0&&ve(t,t.prev,e)>=0:ve(t,e,t.prev)<0||ve(t,t.next,e)<0}function xe(t,e){var n=new Ce(t.i,t.x,t.y),r=new Ce(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Le(t,e,n,r){var i=new Ce(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ee(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ce(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ke(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}function Se(t){var e=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}(t),n=la(e.vertices,e.holes,2),r=[],i=[];n.forEach((function(t,r){var o=n[r];i.push([e.vertices[2*o],e.vertices[2*o+1]])}));for(var a=0;a<i.length;a+=3){var s=i.slice(a,a+3);s.push(i[a]),r.push(o([s]))}return r}function Pe(t,e){if(!t)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");var n,r=1/0;return O(e,(function(e,i){var o=Rt(t,e);o<r&&((n=At(e)).properties.featureIndex=i,n.properties.distanceToPoint=o,r=o)})),n}function Me(t,e,n,r,i){!function t(e,n,r,i,o){for(;i>r;){if(i-r>600){var a=i-r+1,s=n-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-s*u/a+c)),Math.min(i,Math.floor(n+(a-s)*u/a+c)),o)}var h=e[n],f=r,p=i;for(Te(e,r,n),o(e[i],h)>0&&Te(e,r,i);f<p;){for(Te(e,f,p),f++,p--;o(e[f],h)<0;)f++;for(;o(e[p],h)>0;)p--}0===o(e[r],h)?Te(e,r,p):Te(e,++p,i),p<=n&&(r=p+1),n<=p&&(i=p-1)}}(t,e,n||0,r||t.length-1,i||function(t,e){return t<e?-1:t>e?1:0})}function Te(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function Oe(t,e){if(!(this instanceof Oe))return new Oe(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function Ie(t,e){Ne(t,0,t.children.length,e,t)}function Ne(t,e,n,r,i){i||(i=Ge(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,a=e;a<n;a++)o=t.children[a],De(i,t.leaf?r(o):o);return i}function De(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Re(t,e){return t.minX-e.minX}function Ae(t,e){return t.minY-e.minY}function je(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Be(t){return t.maxX-t.minX+(t.maxY-t.minY)}function ze(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Fe(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Ge(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ue(t,e,n,r,i){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(Me(t,o=e+Math.ceil((n-e)/r/2)*r,e,n,i),a.push(e,o,o,n))}function qe(t){var e=Oe(t);return e.insert=function(t){if(Array.isArray(t)){var e=t;(t=He(e)).bbox=e}else t.bbox=t.bbox?t.bbox:Ve(t);return Oe.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){var n=He(t);n.bbox=t,e.push(n)})):O(t,(function(t){t.bbox=t.bbox?t.bbox:Ve(t),e.push(t)})),Oe.prototype.load.call(this,e)},e.remove=function(t){if(Array.isArray(t)){var e=t;(t=He(e)).bbox=e}return Oe.prototype.remove.call(this,t)},e.clear=function(){return Oe.prototype.clear.call(this)},e.search=function(t){return{type:"FeatureCollection",features:Oe.prototype.search.call(this,this.toBBox(t))}},e.collides=function(t){return Oe.prototype.collides.call(this,this.toBBox(t))},e.all=function(){return{type:"FeatureCollection",features:Oe.prototype.all.call(this)}},e.toJSON=function(){return Oe.prototype.toJSON.call(this)},e.fromJSON=function(t){return Oe.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;return{minX:(e=t.bbox?t.bbox:Array.isArray(t)&&4===t.length?t:Ve(t))[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}function He(t){var e=[t[0],t[1]],n=[t[0],t[3]],r=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],r,n,e]]}}}function Ve(t){var e=[1/0,1/0,-1/0,-1/0];return S(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}function Ye(t){if(!t)throw new Error("geojson is required");var e=[];return A(t,(function(t){!function(t,e){var n=[],r=t.geometry;switch(r.type){case"Polygon":n=H(r);break;case"LineString":n=[H(r)]}n.forEach((function(n){(function(t,e){var n=[];return t.reduce((function(t,r){var i=s([t,r],e);return i.bbox=function(t,e){var n=t[0],r=t[1],i=e[0],o=e[1];return[n<i?n:i,r<o?r:o,n>i?n:i,r>o?r:o]}(t,r),n.push(i),r})),n})(n,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}(t,e)})),u(e)}function We(t,n){var r={},i=[];if("LineString"===t.type&&(t=e(t)),"LineString"===n.type&&(n=e(n)),"Feature"===t.type&&"Feature"===n.type&&"LineString"===t.geometry.type&&"LineString"===n.geometry.type&&2===t.geometry.coordinates.length&&2===n.geometry.coordinates.length){var o=Xe(t,n);return o&&i.push(o),u(i)}var a=qe();return a.load(Ye(n)),O(Ye(t),(function(t){O(a.search(t),(function(e){var n=Xe(t,e);if(n){var o=H(n).join(",");r[o]||(r[o]=!0,i.push(n))}}))})),u(i)}function Xe(t,e){var n=H(t),i=H(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==i.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=n[0][0],a=n[0][1],s=n[1][0],l=n[1][1],u=i[0][0],c=i[0][1],h=i[1][0],f=i[1][1],p=(f-c)*(s-o)-(h-u)*(l-a);if(0===p)return null;var d=((h-u)*(a-c)-(f-c)*(o-u))/p,g=((s-o)*(a-c)-(l-a)*(o-u))/p;return d>=0&&d<=1&&g>=0&&g<=1?r([o+d*(s-o),a+d*(l-a)]):null}function Ze(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=t.geometry?t.geometry.type:t.type;if("LineString"!==i&&"MultiLineString"!==i)throw new Error("lines must be LineString or MultiLineString");var o=r([1/0,1/0],{dist:1/0}),a=0;return A(t,(function(t){for(var i=H(t),l=0;l<i.length-1;l++){var u=r(i[l]);u.properties.dist=Rt(e,u,n);var c=r(i[l+1]);c.properties.dist=Rt(e,c,n);var h=Rt(u,c,n),f=Math.max(u.properties.dist,c.properties.dist),p=le(u,c),d=ae(e,f,p+90,n),g=ae(e,f,p-90,n),y=We(s([d.geometry.coordinates,g.geometry.coordinates]),s([u.geometry.coordinates,c.geometry.coordinates])),m=null;y.features.length>0&&((m=y.features[0]).properties.dist=Rt(e,m,n),m.properties.location=a+Rt(u,m,n)),u.properties.dist<o.properties.dist&&((o=u).properties.index=l,o.properties.location=a),c.properties.dist<o.properties.dist&&((o=c).properties.index=l+1,o.properties.location=a+h),m&&m.properties.dist<o.properties.dist&&((o=m).properties.index=l),a+=h}})),o}function Ke(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r,i=n.final;if(!t)throw new Error("start point is required");if(!e)throw new Error("end point is required");return(r=i?Je(q(e),q(t)):Je(q(t),q(e)))>180?-(360-r):r}function Je(t,e){var n=b(t[1]),r=b(e[1]),i=b(e[0]-t[0]);i>Math.PI&&(i-=2*Math.PI),i<-Math.PI&&(i+=2*Math.PI);var o=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4));return(_(Math.atan2(i,o))+360)%360}function Qe(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.units;if(!t)throw new Error("from point is required");if(!e)throw new Error("to point is required");var i=q(t),o=q(e);return o[0]+=o[0]-i[0]>180?-360:i[0]-o[0]>180?360:0,w(function(t,e,n){var r=n=void 0===n?xo:Number(n),i=t[1]*Math.PI/180,o=e[1]*Math.PI/180,a=o-i,s=Math.abs(e[0]-t[0])*Math.PI/180;s>Math.PI&&(s-=2*Math.PI);var l=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),u=Math.abs(l)>1e-11?a/l:Math.cos(i);return Math.sqrt(a*a+u*u*s*s)*r}(i,o),"meters",r)}function $e(t,e){return en(t,"mercator",e)}function tn(t,e){return en(t,"wgs84",e)}function en(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.mutate;if(!t)throw new Error("geojson is required");return Array.isArray(t)&&L(t[0])?t="mercator"===e?nn(t):rn(t):(!0!==r&&(t=At(t)),S(t,(function(t){var n="mercator"===e?nn(t):rn(t);t[0]=n[0],t[1]=n[1]}))),t}function nn(t){var e=Math.PI/180,n=20037508.342789244,r=[6378137*(Math.abs(t[0])<=180?t[0]:t[0]-360*function(t){return t<0?-1:t>0?1:0}(t[0]))*e,6378137*Math.log(Math.tan(.25*Math.PI+.5*t[1]*e))];return r[0]>n&&(r[0]=n),r[0]<-n&&(r[0]=-n),r[1]>n&&(r[1]=n),r[1]<-n&&(r[1]=-n),r}function rn(t){var e=180/Math.PI;return[t[0]*e/6378137,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/6378137)))*e]}function on(t,n,i){if(!E(i=i||{}))throw new Error("options is invalid");if(!t)throw new Error("pt is required");if(Array.isArray(t)?t=r(t):"Point"===t.type?t=e(t):W(t,"Point","point"),!n)throw new Error("line is required");Array.isArray(n)?n=s(n):"LineString"===n.type?n=e(n):W(n,"LineString","line");var o=1/0,a=t.geometry.coordinates;return B(n,(function(t){var e=t.geometry.coordinates[0],n=t.geometry.coordinates[1],s=function(t,e,n,i){var o=i.mercator,a=!0!==o?Rt(e,t,i):an(e,t,i),s=v(!0!==o?le(e,t):Ke(e,t)),l=v(!0!==o?le(e,n):Ke(e,n)),u=Math.abs(s-l);if(u>90)return a;var c=(l+180)%360,h=v(!0!==o?le(n,t):Ke(n,t)),f=Math.abs(h-c);return f>180&&(f=Math.abs(f-360)),f>90?!0!==o?Rt(t,n,i):an(t,n,i):!0!==o?a*Math.sin(b(u)):function(t,e,n,i){var o=0;(Math.abs(t[0])>=180||Math.abs(e[0])>=180||Math.abs(n[0])>=180)&&(o=t[0]>0||e[0]>0||n[0]>0?-180:180);var a=r(n),s=tn(function(t,e,n){var r=t[0],i=t[1],o=e[0]-r,a=e[1]-i,s=((n[0]-r)*o+(n[1]-i)*a)/(o*o+a*a);return[r+s*o,i+s*a]}($e([t[0]+o,t[1]]),$e([e[0]+o,e[1]]),$e([n[0]+o,n[1]])));return 0!==o&&(s[0]-=o),Qe(a,s,i)}(e,n,t,i)}(a,e,n,i);o>s&&(o=s)})),o}function an(t,e,n){var r=n.units,i=0;Math.abs(t[0])>=180&&(i=t[0]>0?-180:180),Math.abs(e[0])>=180&&(i=e[0]>0?-180:180);var o=$e([t[0]+i,t[1]]),a=$e([e[0]+i,e[1]]),s=function(t){return t*t},l=s(o[0]-a[0])+s(o[1]-a[1]);return w(Math.sqrt(l),"meters",r)}function sn(t){for(var n=function(t){return"FeatureCollection"!==t.type?"Feature"!==t.type?u([e(t)]):u([t]):t}(t),i=ue(n),o=!1,a=0;!o&&a<n.features.length;){var s,l=n.features[a].geometry,c=!1;if("Point"===l.type)i.geometry.coordinates[0]===l.coordinates[0]&&i.geometry.coordinates[1]===l.coordinates[1]&&(o=!0);else if("MultiPoint"===l.type){var h=!1;for(s=0;!h&&s<l.coordinates.length;)i.geometry.coordinates[0]===l.coordinates[s][0]&&i.geometry.coordinates[1]===l.coordinates[s][1]&&(o=!0,h=!0),s++}else if("LineString"===l.type)for(s=0;!c&&s<l.coordinates.length-1;)ln(i.geometry.coordinates[0],i.geometry.coordinates[1],l.coordinates[s][0],l.coordinates[s][1],l.coordinates[s+1][0],l.coordinates[s+1][1])&&(c=!0,o=!0),s++;else if("MultiLineString"===l.type)for(var f=0;f<l.coordinates.length;){c=!1,s=0;for(var p=l.coordinates[f];!c&&s<p.length-1;)ln(i.geometry.coordinates[0],i.geometry.coordinates[1],p[s][0],p[s][1],p[s+1][0],p[s+1][1])&&(c=!0,o=!0),s++;f++}else"Polygon"!==l.type&&"MultiPolygon"!==l.type||Pt(i,l)&&(o=!0);a++}if(o)return i;var d=u([]);for(a=0;a<n.features.length;a++)d.features=d.features.concat(he(n.features[a]).features);return r(Pe(i,d).geometry.coordinates)}function ln(t,e,n,r,i,o){return Math.sqrt((i-n)*(i-n)+(o-r)*(o-r))===Math.sqrt((t-n)*(t-n)+(e-r)*(e-r))+Math.sqrt((i-t)*(i-t)+(o-e)*(o-e))}function un(t){return R(t,(function(t,e){return t+function t(e){var n,r=0;switch(e.type){case"Polygon":return cn(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)r+=cn(e.coordinates[n]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)r+=t(e.geometries[n]);return r}}(e)}),0)}function cn(t){var e=0;if(t&&t.length>0){e+=Math.abs(hn(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(hn(t[n]))}return e}function hn(t){var e,n,r,i,o,a,s=0,l=t.length;if(l>2){for(a=0;a<l;a++)a===l-2?(r=l-2,i=l-1,o=0):a===l-1?(r=l-1,i=0,o=1):(r=a,i=a+1,o=a+2),e=t[r],n=t[i],s+=(fn(t[o][0])-fn(e[0]))*Math.sin(fn(n[1]));s=s*ha*ha/2}return s}function fn(t){return t*Math.PI/180}function pn(t,e){if(!E(e=e||{}))throw new Error("options is invalid");if(!t)throw new Error("geojson is required");return z(t,(function(t,n){var r=n.geometry.coordinates;return t+Rt(r[0],r[1],e)}),0)}function dn(t,e,n,r){if(!E(r=r||{}))throw new Error("options is invalid");var i,o=[];if("Feature"===t.type)i=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");i=t.coordinates}for(var a,l,u,c=0,h=0;h<i.length&&!(e>=c&&h===i.length-1);h++){if(c>e&&0===o.length){if(!(a=e-c))return o.push(i[h]),s(o);l=le(i[h],i[h-1])-180,u=ae(i[h],a,l,r),o.push(u.geometry.coordinates)}if(c>=n)return(a=n-c)?(l=le(i[h],i[h-1])-180,u=ae(i[h],a,l,r),o.push(u.geometry.coordinates),s(o)):(o.push(i[h]),s(o));if(c>=e&&o.push(i[h]),h===i.length-1)return s(o);c+=Rt(i[h],i[h+1],r)}return s(i[i.length-1])}function gn(t,e,n){var r=(n=n||{}).ignoreEndVertices;if(!E(n))throw new Error("invalid options");if(!t)throw new Error("pt is required");if(!e)throw new Error("line is required");for(var i=q(t),o=H(e),a=0;a<o.length-1;a++){var s=!1;if(r&&(0===a&&(s="start"),a===o.length-2&&(s="end"),0===a&&a+1===o.length-1&&(s="both")),function(t,e,n,r){var i=n[0],o=n[1],a=t[0],s=t[1],l=e[0],u=e[1],c=l-a,h=u-s;return(n[0]-a)*h-(n[1]-s)*c==0&&(r?"start"===r?Math.abs(c)>=Math.abs(h)?c>0?a<i&&i<=l:l<=i&&i<a:h>0?s<o&&o<=u:u<=o&&o<s:"end"===r?Math.abs(c)>=Math.abs(h)?c>0?a<=i&&i<l:l<i&&i<=a:h>0?s<=o&&o<u:u<o&&o<=s:"both"===r?Math.abs(c)>=Math.abs(h)?c>0?a<i&&i<l:l<i&&i<a:h>0?s<o&&o<u:u<o&&o<s:void 0:Math.abs(c)>=Math.abs(h)?c>0?a<=i&&i<=l:l<=i&&i<=a:h>0?s<=o&&o<=u:u<=o&&o<=s)}(o[a],o[a+1],i,s))return!0}return!1}function yn(t,e){var n=J(t),r=J(e),i=Z(t),o=Z(e);switch(n){case"Point":switch(r){case"MultiPoint":return function(t,e){var n,r=!1;for(n=0;n<e.coordinates.length;n++)if(vn(e.coordinates[n],t.coordinates)){r=!0;break}return r}(i,o);case"LineString":return gn(i,o,{ignoreEndVertices:!0});case"Polygon":return Pt(i,o,{ignoreBoundary:!0});default:throw new Error("feature2 "+r+" geometry not supported")}case"MultiPoint":switch(r){case"MultiPoint":return function(t,e){for(var n=0;n<t.coordinates.length;n++){for(var r=!1,i=0;i<e.coordinates.length;i++)vn(t.coordinates[n],e.coordinates[i])&&(r=!0);if(!r)return!1}return!0}(i,o);case"LineString":return function(t,e){for(var n=!1,r=0;r<t.coordinates.length;r++){if(!gn(t.coordinates[r],e))return!1;n||(n=gn(t.coordinates[r],e,{ignoreEndVertices:!0}))}return n}(i,o);case"Polygon":return function(t,e){for(var n=!0,r=0;r<t.coordinates.length;r++){var i=Pt(t.coordinates[1],e);if(!i){n=!1;break}i=Pt(t.coordinates[1],e,{ignoreBoundary:!0})}return n&&i}(i,o);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"LineString":return function(t,e){for(var n=0;n<t.coordinates.length;n++)if(!gn(t.coordinates[n],e))return!1;return!0}(i,o);case"Polygon":return function(t,e){if(!mn(U(e),U(t)))return!1;for(var n=!1,r=0;r<t.coordinates.length-1;r++){if(!Pt(t.coordinates[r],e))return!1;n||(n=Pt(t.coordinates[r],e,{ignoreBoundary:!0})),n||(n=Pt(function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}(t.coordinates[r],t.coordinates[r+1]),e,{ignoreBoundary:!0}))}return n}(i,o);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"Polygon":return function(t,e){var n=U(t);if(!mn(U(e),n))return!1;for(var r=0;r<t.coordinates[0].length;r++)if(!Pt(t.coordinates[0][r],e))return!1;return!0}(i,o);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function mn(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function vn(t,e){return t[0]===e[0]&&t[1]===e[1]}function _n(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i=n.mask,o=n.properties,a=[];if(null==e)throw new Error("cellSide is required");if(!L(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(i&&-1===["Polygon","MultiPolygon"].indexOf(J(i)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=t[0],l=t[1],c=t[2],h=t[3],f=e/Rt([s,l],[c,l],n)*(c-s),p=e/Rt([s,l],[s,h],n)*(h-l),d=c-s,g=h-l,y=Math.floor(d/f),m=(g-Math.floor(g/p)*p)/2,v=s+(d-y*f)/2;v<=c;){for(var _=l+m;_<=h;){var b=r([v,_],o);i?yn(b,i)&&a.push(b):a.push(b),_+=p}v+=f}return u(a)}function bn(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.precision,r=e.coordinates,i=e.mutate;if(n=null==n||isNaN(n)?6:n,r=null==r||isNaN(r)?3:r,!t)throw new Error("<geojson> is required");if("number"!=typeof n)throw new Error("<precision> must be a number");if("number"!=typeof r)throw new Error("<coordinates> must be a number");!1!==i&&void 0!==i||(t=JSON.parse(JSON.stringify(t)));var o=Math.pow(10,n);return S(t,(function(t){!function(t,e,n){t.length>n&&t.splice(n,t.length);for(var r=0;r<t.length;r++)t[r]=Math.round(t[r]*e)/e}(t,o,r)})),t}function wn(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!wn(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1;return!0}function xn(t,e){if(void 0===e&&(e=!0),3!=t.length)throw new Error("This function requires an array of three points [x,y]");return(t[1][0]-t[0][0])*(t[2][1]-t[0][1])-(t[1][1]-t[0][1])*(t[2][0]-t[0][0])>=0==e}function Ln(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!Ln(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}function En(t,e){var n=[],r=qe();return A(e,(function(e){if(n.forEach((function(t,e){t.id=e})),n.length){var i=r.search(e);if(i.features.length){var o=kn(e,i);n=n.filter((function(t){return t.id!==o.id})),r.remove(o),O(Cn(o,e),(function(t){n.push(t),r.insert(t)}))}}else(n=Cn(t,e).features).forEach((function(t){t.bbox||(t.bbox=oe(U(t)))})),r.load(u(n))})),u(n)}function Cn(t,e){var n=[],r=H(t)[0],i=H(t)[t.geometry.coordinates.length-1];if(Sn(r,q(e))||Sn(i,q(e)))return u([t]);var o=qe(),a=Ye(t);o.load(a);var l=o.search(e);if(!l.features.length)return u([t]);var c=kn(e,l),h=I(a,(function(t,r,i){var o=H(r)[1],a=q(e);return i===c.id?(t.push(a),n.push(s(t)),Sn(a,o)?[a]:[a,o]):(t.push(o),t)}),[r]);return h.length>1&&n.push(s(h)),u(n)}function kn(t,e){if(!e.features.length)throw new Error("lines must contain features");if(1===e.features.length)return e.features[0];var n,r=1/0;return O(e,(function(e){var i=Ze(e,t).properties.dist;i<r&&(n=e,r=i)})),n}function Sn(t,e){return t[0]===e[0]&&t[1]===e[1]}function Pn(t,e,n,r,i){if(!E(i=i||{}))throw new Error("options is invalid");var o=i.steps,a=i.units;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if(null==n)throw new Error("bearing1 is required");if(null==r)throw new Error("bearing2 is required");if("object"!=typeof i)throw new Error("options must be an object");o=o||64;var l=Mn(n),u=Mn(r),c=t.properties;if(l===u)return s(se(t,e,i).geometry.coordinates[0],c);for(var h=l,f=l<u?u:u+360,p=h,d=[],g=0;p<f;)d.push(ae(t,e,p,a).geometry.coordinates),p=h+360*++g/o;return p>f&&d.push(ae(t,e,f,a).geometry.coordinates),s(d,c)}function Mn(t){var e=t%360;return e<0&&(e+=360),e}function Tn(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.properties,r=J(t),i=H(t);if(n=n||t.properties||{},!i.length)throw new Error("polygon must contain coordinates");switch(r){case"Polygon":return On(i,n);case"MultiPolygon":var o=[];return i.forEach((function(t){o.push(On(t,n))})),u(o);default:throw new Error("geom "+r+" not supported")}}function On(t,e){return t.length>1?c(t,e):s(t[0],e)}function In(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.properties,r=e.autoComplete,i=e.orderCoords;if(!t)throw new Error("lines is required");switch(r=void 0===r||r,i=void 0===i||i,J(t)){case"FeatureCollection":case"GeometryCollection":var o=[];return(t.features?t.features:t.geometries).forEach((function(t){o.push(H(Nn(t,{},r,i)))})),f(o,n)}return Nn(t,n,r,i)}function Nn(t,e,n,r){e=e||t.properties||{};var i=H(t),a=J(t);if(!i.length)throw new Error("line must contain coordinates");switch(a){case"LineString":return n&&(i=Dn(i)),o([i],e);case"MultiLineString":var l=[],u=0;return i.forEach((function(t){if(n&&(t=Dn(t)),r){var e=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.abs(e-r)*Math.abs(n-i)}(U(s(t)));e>u?(l.unshift(t),u=e):l.push(t)}else l.push(t)})),o(l,e);default:throw new Error("geometry type "+a+" is not supported")}}function Dn(t){var e=t[0],n=e[0],r=e[1],i=t[t.length-1],o=i[0],a=i[1];return n===o&&r===a||t.push(e),t}function Rn(t,e,n){var r,i,o,a,s,l=t.length,u=jn(t[0],e),c=[];for(n||(n=[]),r=1;r<l;r++){for(i=t[r-1],a=s=jn(o=t[r],e);;){if(!(u|a)){c.push(i),a!==s?(c.push(o),r<l-1&&(n.push(c),c=[])):r===l-1&&c.push(o);break}if(u&a)break;u?u=jn(i=An(i,o,u,e),e):a=jn(o=An(i,o,a,e),e)}u=s}return c.length&&n.push(c),n}function An(t,e,n,r){return 8&n?[t[0]+(e[0]-t[0])*(r[3]-t[1])/(e[1]-t[1]),r[3]]:4&n?[t[0]+(e[0]-t[0])*(r[1]-t[1])/(e[1]-t[1]),r[1]]:2&n?[r[2],t[1]+(e[1]-t[1])*(r[2]-t[0])/(e[0]-t[0])]:1&n?[r[0],t[1]+(e[1]-t[1])*(r[0]-t[0])/(e[0]-t[0])]:null}function jn(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function Bn(t,e){for(var n=[],r=0;r<t.length;r++){var i=wa.polygon(t[r],e);i.length>0&&(i[0][0]===i[i.length-1][0]&&i[0][1]===i[i.length-1][1]||i.push(i[0]),i.length>=4&&n.push(i))}return n}function zn(t){return"[object Arguments]"===Object.prototype.toString.call(t)}function Fn(t,e,n){return n||(n={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?(n.strict,t===e):function(t,e,n){var r,i;if(Gn(t)||Gn(e))return!1;if(t.prototype!==e.prototype)return!1;if(zn(t))return!!zn(e)&&Fn(t=xa.call(t),e=xa.call(e),n);if(Un(t)){if(!Un(e))return!1;if(t.length!==e.length)return!1;for(r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}try{var o=Object.keys(t),a=Object.keys(e)}catch(t){return!1}if(o.length!==a.length)return!1;for(o.sort(),a.sort(),r=o.length-1;r>=0;r--)if(o[r]!==a[r])return!1;for(r=o.length-1;r>=0;r--)if(!Fn(t[i=o[r]],e[i],n))return!1;return typeof t==typeof e}(t,e,n))}function Gn(t){return null==t}function Un(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}function qn(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r,i=n.tolerance||0,o=[],a=qe();return a.load(Ye(t)),B(e,(function(t){var e=!1;O(a.search(t),(function(n){if(!1===e){var o=H(t).sort(),a=H(n).sort();Fn(o,a)||(0===i?gn(o[0],n)&&gn(o[1],n):Ze(n,o[0]).properties.dist<=i&&Ze(n,o[1]).properties.dist<=i)?(e=!0,r=r?Hn(r,t):t):(0===i?gn(a[0],t)&&gn(a[1],t):Ze(t,a[0]).properties.dist<=i&&Ze(t,a[1]).properties.dist<=i)&&(r=r?Hn(r,n):n)}})),!1===e&&r&&(o.push(r),r=void 0)})),r&&o.push(r),u(o)}function Hn(t,e){var n=H(e),r=H(t),i=r[0],o=r[r.length-1],a=t.geometry.coordinates;return Fn(n[0],i)?a.unshift(n[1]):Fn(n[0],o)?a.push(n[1]):Fn(n[1],i)?a.unshift(n[0]):Fn(n[1],o)&&a.push(n[0]),t}function Vn(t){var e=t%360;return e<0&&(e+=360),e}function Yn(t,e,n,i){if(!E(i=i||{}))throw new Error("options is invalid");var o=i.units,a=i.properties;if(!t)throw new Error("origin is required");if(null==e)throw new Error("distance is required");if(null==n)throw new Error("bearing is required");if(!(e>=0))throw new Error("distance must be greater than 0");var s=w(e,o,"meters"),l=q(t),u=function(t,e,n,r){var i=e/(r=void 0===r?xo:Number(r)),o=t[0]*Math.PI/180,a=b(t[1]),s=b(n),l=i*Math.cos(s),u=a+l;Math.abs(u)>Math.PI/2&&(u=u>0?Math.PI-u:-Math.PI-u);var c=Math.log(Math.tan(u/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),h=Math.abs(c)>1e-11?l/c:Math.cos(a);return[(180*(o+i*Math.sin(s)/h)/Math.PI+540)%360-180,180*u/Math.PI]}(l,s,n);return u[0]+=u[0]-l[0]>180?-360:l[0]-u[0]>180?360:0,r(u,a)}function Wn(t,e,n,r,i,o){for(var a=0;a<t.length;a++){var s=t[a],l=t[a+1];a===t.length-1&&(l=t[0]),r=Xn(s,l,e),n<=0&&r>0?function(t,e,n){return Xn(t,e,n)<0}(e,s,i)||(i=s):n>0&&r<=0&&(function(t,e,n){return Xn(t,e,n)>0}(e,s,o)||(o=s)),n=r}return[i,o]}function Xn(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function Zn(t){if(!t)throw new Error("line is required");var e=t.geometry?t.geometry.type:t.type;if(!Array.isArray(t)&&"LineString"!==e)throw new Error("geometry must be a LineString");for(var n,r,i=H(t),o=0,a=1;a<i.length;)n=r||i[0],o+=((r=i[a])[0]-n[0])*(r[1]+n[1]),a++;return o>0}function Kn(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return D(t,(function(t){Kn(t,e)})),t;case"LineString":return Jn(H(t),e),t;case"Polygon":return Qn(H(t),e),t;case"MultiLineString":return H(t).forEach((function(t){Jn(t,e)})),t;case"MultiPolygon":return H(t).forEach((function(t){Qn(t,e)})),t;case"Point":case"MultiPoint":return t}}function Jn(t,e){Zn(t)===e&&t.reverse()}function Qn(t,e){Zn(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)Zn(t[n])===e&&t[n].reverse()}function $n(t,e,n,r){r=r||{};for(var i=Object.keys(La),o=0;o<i.length;o++){var a=i[o],s=r[a];s=null!=s?s:La[a],Ea[a]=s}Ea.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+e+":"+(e+n)+"]");var l,u=function(t,e,n){for(var r=t.length-1,i=t[0].length-1,o={rows:r,cols:i,cells:[]},a=e+Math.abs(n),s=0;s<r;++s){o.cells[s]=[];for(var l=0;l<i;++l){var u=0,c=t[s+1][l],h=t[s+1][l+1],f=t[s][l+1],p=t[s][l];if(!(isNaN(c)||isNaN(h)||isNaN(f)||isNaN(p))){u|=c<e?0:c>a?128:64,u|=h<e?0:h>a?32:16,u|=f<e?0:f>a?8:4;var d=+(u|=p<e?0:p>a?2:1),g=0;if(17===u||18===u||33===u||34===u||38===u||68===u||72===u||98===u||102===u||132===u||136===u||137===u||152===u||153===u){var y=(c+h+f+p)/4;g=y>a?2:y<e?0:1,34===u?1===g?u=35:0===g&&(u=136):136===u?1===g?(u=35,g=4):0===g&&(u=34):17===u?1===g?(u=155,g=4):0===g&&(u=153):68===u?1===g?(u=103,g=4):0===g&&(u=102):153===u?1===g&&(u=155):102===u?1===g&&(u=103):152===u?g<2&&(u=156,g=1):137===u?g<2&&(u=139,g=1):98===u?g<2&&(u=99,g=1):38===u?g<2&&(u=39,g=1):18===u?g>0?(u=156,g=4):u=152:33===u?g>0?(u=139,g=4):u=137:72===u?g>0?(u=99,g=4):u=98:132===u&&(g>0?(u=39,g=4):u=38)}if(0!=u&&170!=u){var m,v,_,b,w,x,L,E;m=v=_=b=w=x=L=E=.5;var C=[];1===u?(_=1-tr(e,f,p),E=1-tr(e,c,p),C.push(cs[u])):169===u?(_=tr(a,p,f),E=tr(a,p,c),C.push(cs[u])):4===u?(x=1-tr(e,h,f),b=tr(e,p,f),C.push(ls[u])):166===u?(x=tr(a,f,h),b=1-tr(a,f,p),C.push(ls[u])):16===u?(w=tr(e,f,h),v=tr(e,c,h),C.push(ss[u])):154===u?(w=1-tr(a,h,f),v=1-tr(a,h,c),C.push(ss[u])):64===u?(L=tr(e,p,c),m=1-tr(e,h,c),C.push(fs[u])):106===u?(L=1-tr(a,c,p),m=tr(a,c,h),C.push(fs[u])):168===u?(b=tr(a,p,f),_=tr(e,p,f),E=tr(e,p,c),L=tr(a,p,c),C.push(us[u]),C.push(cs[u])):2===u?(b=1-tr(e,f,p),_=1-tr(a,f,p),E=1-tr(a,c,p),L=1-tr(e,c,p),C.push(us[u]),C.push(cs[u])):162===u?(w=tr(a,f,h),x=tr(e,f,h),b=1-tr(e,f,p),_=1-tr(a,f,p),C.push(us[u]),C.push(cs[u])):8===u?(w=1-tr(e,h,f),x=1-tr(a,h,f),b=tr(a,p,f),_=tr(e,p,f),C.push(ss[u]),C.push(ls[u])):138===u?(w=1-tr(e,h,f),x=1-tr(a,h,f),m=1-tr(a,h,c),v=1-tr(e,h,c),C.push(ss[u]),C.push(ls[u])):32===u?(w=tr(a,f,h),x=tr(e,f,h),m=tr(e,c,h),v=tr(a,c,h),C.push(ss[u]),C.push(ls[u])):42===u?(E=1-tr(a,c,p),L=1-tr(e,c,p),m=tr(e,c,h),v=tr(a,c,h),C.push(hs[u]),C.push(fs[u])):128===u&&(E=tr(e,p,c),L=tr(a,p,c),m=1-tr(a,h,c),v=1-tr(e,h,c),C.push(hs[u]),C.push(fs[u])),5===u?(x=1-tr(e,h,f),E=1-tr(e,c,p),C.push(ls[u])):165===u?(x=tr(a,f,h),E=tr(a,p,c),C.push(ls[u])):20===u?(b=tr(e,p,f),v=tr(e,c,h),C.push(us[u])):150===u?(b=1-tr(a,f,p),v=1-tr(a,h,c),C.push(us[u])):80===u?(w=tr(e,f,h),L=tr(e,p,c),C.push(ss[u])):90===u?(w=1-tr(a,h,f),L=1-tr(a,c,p),C.push(ss[u])):65===u?(_=1-tr(e,f,p),m=1-tr(e,h,c),C.push(cs[u])):105===u?(_=tr(a,p,f),m=tr(a,c,h),C.push(cs[u])):160===u?(w=tr(a,f,h),x=tr(e,f,h),E=tr(e,p,c),L=tr(a,p,c),C.push(ss[u]),C.push(ls[u])):10===u?(w=1-tr(e,h,f),x=1-tr(a,h,f),E=1-tr(a,c,p),L=1-tr(e,c,p),C.push(ss[u]),C.push(ls[u])):130===u?(b=1-tr(e,f,p),_=1-tr(a,f,p),m=1-tr(a,h,c),v=1-tr(e,h,c),C.push(us[u]),C.push(cs[u])):40===u?(b=tr(a,p,f),_=tr(e,p,f),m=tr(e,c,h),v=tr(a,c,h),C.push(us[u]),C.push(cs[u])):101===u?(x=tr(a,f,h),m=tr(a,c,h),C.push(ls[u])):69===u?(x=1-tr(e,h,f),m=1-tr(e,h,c),C.push(ls[u])):149===u?(E=tr(a,p,c),v=1-tr(a,h,c),C.push(hs[u])):21===u?(E=1-tr(e,c,p),v=tr(e,c,h),C.push(hs[u])):86===u?(b=1-tr(a,f,p),L=1-tr(a,c,p),C.push(us[u])):84===u?(b=tr(e,p,f),L=tr(e,p,c),C.push(us[u])):89===u?(w=1-tr(a,h,f),_=tr(a,p,f),C.push(cs[u])):81===u?(w=tr(e,f,h),_=1-tr(e,f,p),C.push(cs[u])):96===u?(w=tr(a,f,h),x=tr(e,f,h),L=tr(e,p,c),m=tr(a,c,h),C.push(ss[u]),C.push(ls[u])):74===u?(w=1-tr(e,h,f),x=1-tr(a,h,f),L=1-tr(a,c,p),m=1-tr(e,h,c),C.push(ss[u]),C.push(ls[u])):24===u?(w=1-tr(a,h,f),b=tr(a,p,f),_=tr(e,p,f),v=tr(e,c,h),C.push(ss[u]),C.push(cs[u])):146===u?(w=tr(e,f,h),b=1-tr(e,f,p),_=1-tr(a,f,p),v=1-tr(a,h,c),C.push(ss[u]),C.push(cs[u])):6===u?(x=1-tr(e,h,f),b=1-tr(a,f,p),E=1-tr(a,c,p),L=1-tr(e,c,p),C.push(ls[u]),C.push(us[u])):164===u?(x=tr(a,f,h),b=tr(e,p,f),E=tr(e,p,c),L=tr(a,p,c),C.push(ls[u]),C.push(us[u])):129===u?(_=1-tr(e,f,p),E=tr(a,p,c),m=1-tr(a,h,c),v=1-tr(e,h,c),C.push(cs[u]),C.push(hs[u])):41===u?(_=tr(a,p,f),E=1-tr(e,c,p),m=tr(e,c,h),v=tr(a,c,h),C.push(cs[u]),C.push(hs[u])):66===u?(b=1-tr(e,f,p),_=1-tr(a,f,p),L=1-tr(a,c,p),m=1-tr(e,h,c),C.push(us[u]),C.push(cs[u])):104===u?(b=tr(a,p,f),_=tr(e,p,f),L=tr(e,p,c),m=tr(a,c,h),C.push(cs[u]),C.push(ps[u])):144===u?(w=tr(e,f,h),E=tr(e,p,c),L=tr(a,p,c),v=1-tr(a,h,c),C.push(ss[u]),C.push(fs[u])):26===u?(w=1-tr(a,h,f),E=1-tr(a,c,p),L=1-tr(e,c,p),v=tr(e,c,h),C.push(ss[u]),C.push(fs[u])):36===u?(x=tr(a,f,h),b=tr(e,p,f),m=tr(e,c,h),v=tr(a,c,h),C.push(ls[u]),C.push(us[u])):134===u?(x=1-tr(e,h,f),b=1-tr(a,f,p),m=1-tr(a,h,c),v=1-tr(e,h,c),C.push(ls[u]),C.push(us[u])):9===u?(w=1-tr(e,h,f),x=1-tr(a,h,f),_=tr(a,p,f),E=1-tr(e,c,p),C.push(ss[u]),C.push(ls[u])):161===u?(w=tr(a,f,h),x=tr(e,f,h),_=1-tr(e,f,p),E=tr(a,p,c),C.push(ss[u]),C.push(ls[u])):37===u?(x=tr(a,f,h),E=1-tr(e,c,p),m=tr(e,c,h),v=tr(a,c,h),C.push(ls[u]),C.push(hs[u])):133===u?(x=1-tr(e,h,f),E=tr(a,p,c),m=1-tr(a,h,c),v=1-tr(e,h,c),C.push(ls[u]),C.push(hs[u])):148===u?(b=tr(e,p,f),E=tr(e,p,c),L=tr(a,p,c),v=1-tr(a,h,c),C.push(us[u]),C.push(fs[u])):22===u?(b=1-tr(a,f,p),E=1-tr(a,c,p),L=1-tr(e,c,p),v=tr(e,c,h),C.push(us[u]),C.push(fs[u])):82===u?(w=tr(e,f,h),b=1-tr(e,f,p),_=1-tr(a,f,p),L=1-tr(a,c,p),C.push(ss[u]),C.push(cs[u])):88===u?(w=1-tr(a,h,f),b=tr(a,p,f),_=tr(e,p,f),L=tr(e,p,c),C.push(ss[u]),C.push(cs[u])):73===u?(w=1-tr(e,h,f),x=1-tr(a,h,f),_=tr(a,p,f),m=1-tr(e,h,c),C.push(ss[u]),C.push(ls[u])):97===u?(w=tr(a,f,h),x=tr(e,f,h),_=1-tr(e,f,p),m=tr(a,c,h),C.push(ss[u]),C.push(ls[u])):145===u?(w=tr(e,f,h),_=1-tr(e,f,p),E=tr(a,p,c),v=1-tr(a,h,c),C.push(ss[u]),C.push(hs[u])):25===u?(w=1-tr(a,h,f),_=tr(a,p,f),E=1-tr(e,c,p),v=tr(e,c,h),C.push(ss[u]),C.push(hs[u])):70===u?(x=1-tr(e,h,f),b=1-tr(a,f,p),L=1-tr(a,c,p),m=1-tr(e,h,c),C.push(ls[u]),C.push(us[u])):100===u?(x=tr(a,f,h),b=tr(e,p,f),L=tr(e,p,c),m=tr(a,c,h),C.push(ls[u]),C.push(us[u])):34===u?(0===g?(w=1-tr(e,h,f),x=1-tr(a,h,f),b=tr(a,p,f),_=tr(e,p,f),E=tr(e,p,c),L=tr(a,p,c),m=1-tr(a,h,c),v=1-tr(e,h,c)):(w=tr(a,f,h),x=tr(e,f,h),b=1-tr(e,f,p),_=1-tr(a,f,p),E=1-tr(a,c,p),L=1-tr(e,c,p),m=tr(e,c,h),v=tr(a,c,h)),C.push(ss[u]),C.push(ls[u]),C.push(hs[u]),C.push(fs[u])):35===u?(4===g?(w=1-tr(e,h,f),x=1-tr(a,h,f),b=tr(a,p,f),_=tr(e,p,f),E=tr(e,p,c),L=tr(a,p,c),m=1-tr(a,h,c),v=1-tr(e,h,c)):(w=tr(a,f,h),x=tr(e,f,h),b=1-tr(e,f,p),_=1-tr(a,f,p),E=1-tr(a,c,p),L=1-tr(e,c,p),m=tr(e,c,h),v=tr(a,c,h)),C.push(ss[u]),C.push(ls[u]),C.push(cs[u]),C.push(fs[u])):136===u?(0===g?(w=tr(a,f,h),x=tr(e,f,h),b=1-tr(e,f,p),_=1-tr(a,f,p),E=1-tr(a,c,p),L=1-tr(e,c,p),m=tr(e,c,h),v=tr(a,c,h)):(w=1-tr(e,h,f),x=1-tr(a,h,f),b=tr(a,p,f),_=tr(e,p,f),E=tr(e,p,c),L=tr(a,p,c),m=1-tr(a,h,c),v=1-tr(e,h,c)),C.push(ss[u]),C.push(ls[u]),C.push(hs[u]),C.push(fs[u])):153===u?(0===g?(w=tr(e,f,h),_=1-tr(e,f,p),E=1-tr(e,c,p),v=tr(e,c,h)):(w=1-tr(a,h,f),_=tr(a,p,f),E=tr(a,p,c),v=1-tr(a,h,c)),C.push(ss[u]),C.push(cs[u])):102===u?(0===g?(x=1-tr(e,h,f),b=tr(e,p,f),L=tr(e,p,c),m=1-tr(e,h,c)):(x=tr(a,f,h),b=1-tr(a,f,p),L=1-tr(a,c,p),m=tr(a,c,h)),C.push(ls[u]),C.push(fs[u])):155===u?(4===g?(w=tr(e,f,h),_=1-tr(e,f,p),E=1-tr(e,c,p),v=tr(e,c,h)):(w=1-tr(a,h,f),_=tr(a,p,f),E=tr(a,p,c),v=1-tr(a,h,c)),C.push(ss[u]),C.push(hs[u])):103===u?(4===g?(x=1-tr(e,h,f),b=tr(e,p,f),L=tr(e,p,c),m=1-tr(e,h,c)):(x=tr(a,f,h),b=1-tr(a,f,p),L=1-tr(a,c,p),m=tr(a,c,h)),C.push(ls[u]),C.push(us[u])):152===u?(0===g?(w=tr(e,f,h),b=1-tr(e,f,p),_=1-tr(a,f,p),E=1-tr(a,c,p),L=1-tr(e,c,p),v=tr(e,c,h)):(w=1-tr(a,h,f),b=tr(a,p,f),_=tr(e,p,f),E=tr(e,p,c),L=tr(a,p,c),v=1-tr(a,h,c)),C.push(ss[u]),C.push(us[u]),C.push(cs[u])):156===u?(4===g?(w=tr(e,f,h),b=1-tr(e,f,p),_=1-tr(a,f,p),E=1-tr(a,c,p),L=1-tr(e,c,p),v=tr(e,c,h)):(w=1-tr(a,h,f),b=tr(a,p,f),_=tr(e,p,f),E=tr(e,p,c),L=tr(a,p,c),v=1-tr(a,h,c)),C.push(ss[u]),C.push(cs[u]),C.push(fs[u])):137===u?(0===g?(w=tr(a,f,h),x=tr(e,f,h),_=1-tr(e,f,p),E=1-tr(e,c,p),m=tr(e,c,h),v=tr(a,c,h)):(w=1-tr(e,h,f),x=1-tr(a,h,f),_=tr(a,p,f),E=tr(a,p,c),m=1-tr(a,h,c),v=1-tr(e,h,c)),C.push(ss[u]),C.push(ls[u]),C.push(cs[u])):139===u?(4===g?(w=tr(a,f,h),x=tr(e,f,h),_=1-tr(e,f,p),E=1-tr(e,c,p),m=tr(e,c,h),v=tr(a,c,h)):(w=1-tr(e,h,f),x=1-tr(a,h,f),_=tr(a,p,f),E=tr(a,p,c),m=1-tr(a,h,c),v=1-tr(e,h,c)),C.push(ss[u]),C.push(ls[u]),C.push(hs[u])):98===u?(0===g?(w=1-tr(e,h,f),x=1-tr(a,h,f),b=tr(a,p,f),_=tr(e,p,f),L=tr(e,p,c),m=1-tr(e,h,c)):(w=tr(a,f,h),x=tr(e,f,h),b=1-tr(e,f,p),_=1-tr(a,f,p),L=1-tr(a,c,p),m=tr(a,c,h)),C.push(ss[u]),C.push(ls[u]),C.push(fs[u])):99===u?(4===g?(w=1-tr(e,h,f),x=1-tr(a,h,f),b=tr(a,p,f),_=tr(e,p,f),L=tr(e,p,c),m=1-tr(e,h,c)):(w=tr(a,f,h),x=tr(e,f,h),b=1-tr(e,f,p),_=1-tr(a,f,p),L=1-tr(a,c,p),m=tr(a,c,h)),C.push(ss[u]),C.push(ls[u]),C.push(cs[u])):38===u?(0===g?(x=1-tr(e,h,f),b=tr(e,p,f),E=tr(e,p,c),L=tr(a,p,c),m=1-tr(a,h,c),v=1-tr(e,h,c)):(x=tr(a,f,h),b=1-tr(a,f,p),E=1-tr(a,c,p),L=1-tr(e,c,p),m=tr(e,c,h),v=tr(a,c,h)),C.push(ls[u]),C.push(hs[u]),C.push(fs[u])):39===u?(4===g?(x=1-tr(e,h,f),b=tr(e,p,f),E=tr(e,p,c),L=tr(a,p,c),m=1-tr(a,h,c),v=1-tr(e,h,c)):(x=tr(a,f,h),b=1-tr(a,f,p),E=1-tr(a,c,p),L=1-tr(e,c,p),m=tr(e,c,h),v=tr(a,c,h)),C.push(ls[u]),C.push(us[u]),C.push(fs[u])):85===u&&(w=1,x=0,b=1,_=0,E=0,L=1,m=0,v=1),(m<0||m>1||v<0||v>1||w<0||w>1||b<0||b>1||E<0||E>1||L<0||L>1)&&console.log("MarchingSquaresJS-isoBands: "+u+" "+d+" "+c+","+h+","+f+","+p+" "+g+" "+m+" "+v+" "+w+" "+x+" "+b+" "+_+" "+E+" "+L),o.cells[s][l]={cval:u,cval_real:d,flipped:g,topleft:m,topright:v,righttop:w,rightbottom:x,bottomright:b,bottomleft:_,leftbottom:E,lefttop:L,edges:C}}}}}return o}(t,e,n);return Ea.polygons?(Ea.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),l=function(t){var e=[],n=0;return t.cells.forEach((function(t,r){t.forEach((function(t,i){if(void 0!==t){var o=gs[t.cval](t);"object"==typeof o&&er(o)?"object"==typeof o[0]&&er(o[0])?"object"==typeof o[0][0]&&er(o[0][0])?o.forEach((function(t){t.forEach((function(t){t[0]+=i,t[1]+=r})),e[n++]=t})):(o.forEach((function(t){t[0]+=i,t[1]+=r})),e[n++]=o):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}}))})),e}(u)):(Ea.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),l=function(t){for(var e=[],n=t.rows,r=t.cols,i=[],o=0;o<n;o++)for(var a=0;a<r;a++)if(void 0!==t.cells[o][a]&&t.cells[o][a].edges.length>0){var s=function(t){if(t.edges.length>0){var e=t.edges[t.edges.length-1],n=t.cval_real;switch(e){case 0:return n&ka?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 1:return n&Sa?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 2:return n&Sa?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 3:return n&Pa?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 4:return n&ka?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 5:return n&Sa?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 6:return n&Sa?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 7:return n&Pa?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 8:return n&Sa?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.righttop],x:-1,y:0,o:1};case 9:return n&Pa?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 10:return n&Pa?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.righttop],x:-1,y:0,o:1};case 11:return n&Ca?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 12:return n&Sa?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 13:return n&Pa?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 14:return n&Pa?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 15:return n&Ca?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 16:return n&Sa?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 17:return n&Ca?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 18:return n&Pa?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 19:return n&Ca?{p:[t.bottomleft,0],x:0,y:1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 20:return n&Ca?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 21:return n&ka?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.topright,1],x:0,y:-1,o:1};case 22:return n&Ca?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 23:return n&ka?{p:[0,t.lefttop],x:1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t)}}return null}(t.cells[o][a]),l=null,u=a,c=o;null!==s&&i.push([s.p[0]+u,s.p[1]+c]);do{if(null===(l=function(t,e,n,r){var i,o,a,s,l,u=t.cval;switch(e){case-1:switch(r){case 0:i=ls[u],a=Ba[u],s=za[u],l=Fa[u];break;default:i=ss[u],a=Ra[u],s=Aa[u],l=ja[u]}break;case 1:switch(r){case 0:i=hs[u],a=Ka[u],s=Ja[u],l=Qa[u];break;default:i=fs[u],a=Wa[u],s=Xa[u],l=Za[u]}break;default:switch(n){case-1:switch(r){case 0:i=ps[u],a=Ma[u],s=Ta[u],l=Oa[u];break;default:i=ds[u],a=Ia[u],s=Na[u],l=Da[u]}break;case 1:switch(r){case 0:i=cs[u],a=Ga[u],s=Ua[u],l=qa[u];break;default:i=us[u],a=Ha[u],s=Va[u],l=Ya[u]}}}if(o=t.edges.indexOf(i),void 0===t.edges[o])return null;switch(function(t,e){delete t.edges[e];for(var n=e+1;n<t.edges.length;n++)t.edges[n-1]=t.edges[n];t.edges.pop()}(t,o),u=t.cval_real,i){case 0:u&ka?(e=t.topleft,n=1):(e=1,n=t.righttop);break;case 1:u&Sa?(e=1,n=t.rightbottom):(e=t.topleft,n=1);break;case 2:u&Sa?(e=t.topleft,n=1):(e=t.bottomright,n=0);break;case 3:u&Pa?(e=t.bottomleft,n=0):(e=t.topleft,n=1);break;case 4:u&ka?(e=t.topright,n=1):(e=1,n=t.righttop);break;case 5:u&Sa?(e=1,n=t.rightbottom):(e=t.topright,n=1);break;case 6:u&Sa?(e=t.topright,n=1):(e=t.bottomright,n=0);break;case 7:u&Pa?(e=t.bottomleft,n=0):(e=t.topright,n=1);break;case 8:u&Sa?(e=1,n=t.righttop):(e=t.bottomright,n=0);break;case 9:u&Pa?(e=t.bottomleft,n=0):(e=1,n=t.righttop);break;case 10:u&Pa?(e=1,n=t.righttop):(e=0,n=t.leftbottom);break;case 11:u&Ca?(e=0,n=t.lefttop):(e=1,n=t.righttop);break;case 12:u&Sa?(e=1,n=t.rightbottom):(e=t.bottomright,n=0);break;case 13:u&Pa?(e=t.bottomleft,n=0):(e=1,n=t.rightbottom);break;case 14:u&Pa?(e=1,n=t.rightbottom):(e=0,n=t.leftbottom);break;case 15:u&Ca?(e=0,n=t.lefttop):(e=1,n=t.rightbottom);break;case 16:u&Sa?(e=0,n=t.leftbottom):(e=t.bottomright,n=0);break;case 17:u&Ca?(e=0,n=t.lefttop):(e=t.bottomright,n=0);break;case 18:u&Pa?(e=t.bottomleft,n=0):(e=0,n=t.leftbottom);break;case 19:u&Ca?(e=0,n=t.lefttop):(e=t.bottomleft,n=0);break;case 20:u&Ca?(e=0,n=t.leftbottom):(e=t.topleft,n=1);break;case 21:u&ka?(e=t.topright,n=1):(e=0,n=t.leftbottom);break;case 22:u&Ca?(e=0,n=t.lefttop):(e=t.topleft,n=1);break;case 23:u&ka?(e=t.topright,n=1):(e=0,n=t.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t),null}return void 0!==e&&void 0!==n&&void 0!==a&&void 0!==s&&void 0!==l||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(t),console.log(e+" "+n+" "+a+" "+s+" "+l)),{p:[e,n],x:a,y:s,o:l}}(t.cells[c][u],s.x,s.y,s.o)))break;if(i.push([l.p[0]+u,l.p[1]+c]),u+=l.x,s=l,(c+=l.y)<0||c>=n||u<0||u>=r||void 0===t.cells[c][u]){var h=function(t,e,n,r,i,o){for(var a=t.cells[n][e],s=a.cval_real,l=e+r,u=n+i,c=[],h=!1;!h;){if(void 0===t.cells[u]||void 0===t.cells[u][l])if(u-=i,l-=r,s=(a=t.cells[u][l]).cval_real,-1===i)if(0===o)if(s&Pa)c.push([l,u]),r=-1,i=0,o=0;else{if(!(s&Sa)){c.push([l+a.bottomright,u]),r=0,i=1,o=1,h=!0;break}c.push([l+1,u]),r=1,i=0,o=0}else{if(!(s&Pa)){if(s&Sa){c.push([l+a.bottomright,u]),r=0,i=1,o=1,h=!0;break}c.push([l+a.bottomleft,u]),r=0,i=1,o=0,h=!0;break}c.push([l,u]),r=-1,i=0,o=0}else if(1===i)if(0===o){if(!(s&ka)){if(s&Ca){c.push([l+a.topleft,u+1]),r=0,i=-1,o=0,h=!0;break}c.push([l+a.topright,u+1]),r=0,i=-1,o=1,h=!0;break}c.push([l+1,u+1]),r=1,i=0,o=1}else c.push([l+1,u+1]),r=1,i=0,o=1;else if(-1===r)if(0===o){if(!(s&Ca)){if(s&Pa){c.push([l,u+a.leftbottom]),r=1,i=0,o=0,h=!0;break}c.push([l,u+a.lefttop]),r=1,i=0,o=1,h=!0;break}c.push([l,u+1]),r=0,i=1,o=0}else{if(!(s&Ca)){console.log("MarchingSquaresJS-isoBands: wtf");break}c.push([l,u+1]),r=0,i=1,o=0}else{if(1!==r){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===o){if(!(s&Sa)){c.push([l+1,u+a.rightbottom]),r=-1,i=0,o=0,h=!0;break}c.push([l+1,u]),r=0,i=-1,o=1}else{if(!(s&Sa)){if(s&ka){c.push([l+1,u+a.righttop]),r=-1,i=0,o=1;break}c.push([l+1,u+a.rightbottom]),r=-1,i=0,o=0,h=!0;break}c.push([l+1,u]),r=0,i=-1,o=1}}else if(s=(a=t.cells[u][l]).cval_real,-1===r)if(0===o)if(void 0!==t.cells[u-1]&&void 0!==t.cells[u-1][l])r=0,i=-1,o=1;else{if(!(s&Pa)){c.push([l+a.bottomright,u]),r=0,i=1,o=1,h=!0;break}c.push([l,u])}else{if(!(s&Ca)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+l+","+u);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===r){if(0===o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u+1]&&void 0!==t.cells[u+1][l])r=0,i=1,o=0;else{if(!(s&ka)){c.push([l+a.topleft,u+1]),r=0,i=-1,o=0,h=!0;break}c.push([l+1,u+1]),r=1,i=0,o=1}}else if(-1===i){if(1!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u][l+1])r=1,i=0,o=1;else{if(!(s&Sa)){c.push([l+1,u+a.righttop]),r=-1,i=0,o=1,h=!0;break}c.push([l+1,u]),r=0,i=-1,o=1}}else{if(1!==i){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u][l-1])r=-1,i=0,o=0;else{if(!(s&Ca)){c.push([l,u+a.leftbottom]),r=1,i=0,o=0,h=!0;break}c.push([l,u+1]),r=0,i=1,o=0}}if(u+=i,(l+=r)===e&&u===n)break}return{path:c,i:l,j:u,x:r,y:i,o:o}}(t,u-=l.x,c-=l.y,l.x,l.y,l.o);if(null===h)break;h.path.forEach((function(t){i.push(t)})),u=h.i,c=h.j,s=h}}while(void 0!==t.cells[c][u]&&t.cells[c][u].edges.length>0);e.push(i),i=[],t.cells[o][a].edges.length>0&&a--}return e}(u)),"function"==typeof Ea.successCallback&&Ea.successCallback(l),l}function tr(t,e,n){return(t-e)/(n-e)}function er(t){return t.constructor.toString().indexOf("Array")>-1}function nr(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.pivot,i=n.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("angle is required");return 0===e||(r||(r=ce(t)),!1!==i&&void 0!==i||(t=At(t)),S(t,(function(t){var n=Ke(r,t)+e,i=Qe(r,t),o=H(Yn(r,i,n));t[0]=o[0],t[1]=o[1]}))),t}function rr(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.origin,i=n.mutate;if(!t)throw new Error("geojson required");if("number"!=typeof e||0===e)throw new Error("invalid factor");var o=Array.isArray(r)||"object"==typeof r;return!0!==i&&(t=At(t)),"FeatureCollection"!==t.type||o?ir(t,e,r):(O(t,(function(n,i){t.features[i]=ir(n,e,r)})),t)}function ir(t,e,n){var i="Point"===J(t);return n=function(t,e){if(null!=e||(e="centroid"),Array.isArray(e)||"object"==typeof e)return q(e);var n=t.bbox?t.bbox:U(t),i=n[0],o=n[1],a=n[2],s=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return r([i,o]);case"se":case"southeast":case"eastsouth":case"bottomright":return r([a,o]);case"nw":case"northwest":case"westnorth":case"topleft":return r([i,s]);case"ne":case"northeast":case"eastnorth":case"topright":return r([a,s]);case"center":return ue(t);case void 0:case null:case"centroid":return ce(t);default:throw new Error("invalid origin")}}(t,n),1===e||i||S(t,(function(t){var r=Qe(n,t),i=Ke(n,t),o=H(Yn(n,r*e,i));t[0]=o[0],t[1]=o[1],3===t.length&&(t[2]*=e)})),t}function or(t){var e=t[0],n=t[1];return[n[0]-e[0],n[1]-e[1]]}function ar(t,e){return t[0]*e[1]-e[0]*t[1]}function sr(t,e,n){var r=[],i=m(e,n),o=H(t),a=[];return o.forEach((function(t,e){if(e!==o.length-1){var n=function(t,e,n){var r=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),i=t[0]+n*(e[1]-t[1])/r,o=e[0]+n*(e[1]-t[1])/r;return[[i,t[1]+n*(t[0]-e[0])/r],[o,e[1]+n*(t[0]-e[0])/r]]}(t,o[e+1],i);if(r.push(n),e>0){var s=r[e-1],l=function(t,e){return!function(t,e){return 0===ar(or(t),or(e))}(t,e)&&function(t,e){var n=t[0],r=or(t),i=e[0],o=or(e),a=ar(r,o);return function(t,e){return[t[0]+e[0],t[1]+e[1]]}(n,function(t,e){return[t*e[0],t*e[1]]}(ar(function(t,e){return[t[0]-e[0],t[1]-e[1]]}(i,n),o)/a,r))}(t,e)}(n,s);!1!==l&&(s[1]=l,n[0]=l),a.push(s[0]),e===o.length-2&&(a.push(n[0]),a.push(n[1]))}2===o.length&&(a.push(n[0]),a.push(n[1]))}})),s(a,t.properties)}function lr(t,e,n){var r=e[0]-t[0],i=e[1]-t[1],o=n[0]-e[0],a=n[1]-e[1];return Math.sign(r*a-o*i)}function ur(t,e){return e.geometry.coordinates[0].every((function(e){return Pt(r(e),t)}))}function cr(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(function(t,e,n){var r=n[0]-t[0],i=n[1]-t[1],o=e[0]-t[0],a=e[1]-t[1];return r*a-i*o==0&&(Math.abs(o)>=Math.abs(a)?o>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:a>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1])}(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function hr(t,e){return We(e,Tn(t)).features.length>0}function fr(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function pr(t,e){return t[0]===e[0]&&t[1]===e[1]}function dr(t,e){for(var n=!1,r=!1,i=t.coordinates.length,o=0;o<i&&!n&&!r;){for(var a=0;a<e.coordinates.length-1;a++){var s=!0;0!==a&&a!==e.coordinates.length-2||(s=!1),mr(e.coordinates[a],e.coordinates[a+1],t.coordinates[o],s)?n=!0:r=!0}o++}return n&&r}function gr(t,e){return We(t,Tn(e)).features.length>0}function yr(t,e){for(var n=!1,i=!1,o=t.coordinates[0].length,a=0;a<o&&n&&i;)Pt(r(t.coordinates[0][a]),e)?n=!0:i=!0,a++;return i&&i}function mr(t,e,n,r){var i=n[0]-t[0],o=n[1]-t[1],a=e[0]-t[0],s=e[1]-t[1];return 0==i*s-o*a&&(r?Math.abs(a)>=Math.abs(s)?a>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:s>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]:Math.abs(a)>=Math.abs(s)?a>0?t[0]<n[0]&&n[0]<e[0]:e[0]<n[0]&&n[0]<t[0]:s>0?t[1]<n[1]&&n[1]<e[1]:e[1]<n[1]&&n[1]<t[1])}function vr(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function _r(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function br(t,e){return Ls(t,e,{strict:!0})}function wr(t,e){if(!t)throw new Error("feature1 is required");if(!e)throw new Error("feature2 is required");var n=J(t);if(n!==J(e))throw new Error("features must be of the same type");if("Point"===n)throw new Error("Point geometry not supported");if(new Cs({precision:6}).compare(t,e))return!1;var r=0;switch(n){case"MultiPoint":var i=N(t),o=N(e);i.forEach((function(t){o.forEach((function(e){t[0]===e[0]&&t[1]===e[1]&&r++}))}));break;case"LineString":case"MultiLineString":B(t,(function(t){B(e,(function(e){qn(t,e).features.length&&r++}))}));break;case"Polygon":case"MultiPolygon":B(t,(function(t){B(e,(function(e){We(t,e).features.length&&r++}))}))}return r>0}function xr(t,e,n){n=n||[];for(var r=0;r<t;r++)n[r]=e;return n}function Lr(t,e){if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error("Invalid GeoJSON object for "+e)}function Er(t){for(var e=t,n=[];e.parent;)n.unshift(e),e=e.parent;return n}function Cr(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var n=0;n<t.length;n++){this.grid[n]=[];for(var r=0,i=t[n];r<i.length;r++){var o=new kr(n,r,i[r]);this.grid[n][r]=o,this.nodes.push(o)}}this.init()}function kr(t,e,n){this.x=t,this.y=e,this.weight=n}function Sr(t){this.content=[],this.scoreFunction=t}function Pr(t){return t[0]}function Mr(t){return t[1]}function Tr(){this._=null}function Or(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Ir(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Nr(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Dr(t){for(;t.L;)t=t.L;return t}function Rr(t,e,n,r){var i=[null,null],o=Us.push(i)-1;return i.left=t,i.right=e,n&&jr(i,t,e,n),r&&jr(i,e,t,r),Fs[t.index].halfedges.push(o),Fs[e.index].halfedges.push(o),i}function Ar(t,e,n){var r=[e,n];return r.left=t,r}function jr(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Br(t,e,n,r,i){var o,a=t[0],s=t[1],l=a[0],u=a[1],c=0,h=1,f=s[0]-l,p=s[1]-u;if(o=e-l,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>c&&(c=o)}if(o=r-l,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<h&&(h=o)}if(o=n-u,p||!(o>0)){if(o/=p,p<0){if(o<c)return;o<h&&(h=o)}else if(p>0){if(o>h)return;o>c&&(c=o)}if(o=i-u,p||!(o<0)){if(o/=p,p<0){if(o>h)return;o>c&&(c=o)}else if(p>0){if(o<c)return;o<h&&(h=o)}return!(c>0||h<1)||(c>0&&(t[0]=[l+c*f,u+c*p]),h<1&&(t[1]=[l+h*f,u+h*p]),!0)}}}}}function zr(t,e,n,r,i){var o=t[1];if(o)return!0;var a,s,l=t[0],u=t.left,c=t.right,h=u[0],f=u[1],p=c[0],d=c[1],g=(h+p)/2,y=(f+d)/2;if(d===f){if(g<e||g>=r)return;if(h>p){if(l){if(l[1]>=i)return}else l=[g,n];o=[g,i]}else{if(l){if(l[1]<n)return}else l=[g,i];o=[g,n]}}else if(s=y-(a=(h-p)/(d-f))*g,a<-1||a>1)if(h>p){if(l){if(l[1]>=i)return}else l=[(n-s)/a,n];o=[(i-s)/a,i]}else{if(l){if(l[1]<n)return}else l=[(i-s)/a,i];o=[(n-s)/a,n]}else if(f<d){if(l){if(l[0]>=r)return}else l=[e,a*e+s];o=[r,a*r+s]}else{if(l){if(l[0]<e)return}else l=[r,a*r+s];o=[e,a*e+s]}return t[0]=l,t[1]=o,!0}function Fr(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Gr(t,e){return e[+(e.left!==t.site)]}function Ur(t,e){return e[+(e.left===t.site)]}function qr(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var a=i[0],s=i[1],l=r[0]-a,u=r[1]-s,c=o[0]-a,h=o[1]-s,f=2*(l*h-u*c);if(!(f>=-Ys)){var p=l*l+u*u,d=c*c+h*h,g=(h*p-u*d)/f,y=(l*d-c*p)/f,m=qs.pop()||new function(){Or(this),this.x=this.y=this.arc=this.site=this.cy=null};m.arc=t,m.site=i,m.x=g+a,m.y=(m.cy=y+s)+Math.sqrt(g*g+y*y),t.circle=m;for(var v=null,_=Gs._;_;)if(m.y<_.y||m.y===_.y&&m.x<=_.x){if(!_.L){v=_.P;break}_=_.L}else{if(!_.R){v=_;break}_=_.R}Gs.insert(v,m),v||(Bs=m)}}}}function Hr(t){var e=t.circle;e&&(e.P||(Bs=e.N),Gs.remove(e),qs.push(e),Or(e),t.circle=null)}function Vr(t){var e=Hs.pop()||new function(){Or(this),this.edge=this.site=this.circle=null};return e.site=t,e}function Yr(t){Hr(t),zs.remove(t),Hs.push(t),Or(t)}function Wr(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,a=t.N,s=[t];Yr(t);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<Vs&&Math.abs(r-l.circle.cy)<Vs;)o=l.P,s.unshift(l),Yr(l),l=o;s.unshift(l),Hr(l);for(var u=a;u.circle&&Math.abs(n-u.circle.x)<Vs&&Math.abs(r-u.circle.cy)<Vs;)a=u.N,s.push(u),Yr(u),u=a;s.push(u),Hr(u);var c,h=s.length;for(c=1;c<h;++c)u=s[c],l=s[c-1],jr(u.edge,l.site,u.site,i);l=s[0],(u=s[h-1]).edge=Rr(l.site,u.site,null,i),qr(l),qr(u)}function Xr(t){for(var e,n,r,i,o=t[0],a=t[1],s=zs._;s;)if((r=Zr(s,a)-o)>Vs)s=s.L;else{if(!((i=o-function(t,e){var n=t.N;if(n)return Zr(n,e);var r=t.site;return r[1]===e?r[0]:1/0}(s,a))>Vs)){r>-Vs?(e=s.P,n=s):i>-Vs?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){Fs[t.index]={site:t,halfedges:[]}}(t);var l=Vr(t);if(zs.insert(e,l),e||n){if(e===n)return Hr(e),n=Vr(e.site),zs.insert(l,n),l.edge=n.edge=Rr(e.site,l.site),qr(e),void qr(n);if(n){Hr(e),Hr(n);var u=e.site,c=u[0],h=u[1],f=t[0]-c,p=t[1]-h,d=n.site,g=d[0]-c,y=d[1]-h,m=2*(f*y-p*g),v=f*f+p*p,_=g*g+y*y,b=[(y*v-p*_)/m+c,(f*_-g*v)/m+h];jr(n.edge,u,d,b),l.edge=Rr(u,t,null,b),n.edge=Rr(t,d,null,b),qr(e),qr(n)}else l.edge=Rr(e.site,l.site)}}function Zr(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var a=t.P;if(!a)return-1/0;var s=(n=a.site)[0],l=n[1],u=l-e;if(!u)return s;var c=s-r,h=1/o-1/u,f=c/u;return h?(-f+Math.sqrt(f*f-2*h*(c*c/(-2*u)-l+u/2+i-o/2)))/h+r:(r+s)/2}function Kr(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function Jr(t,e){return e[1]-t[1]||e[0]-t[0]}function Qr(t,e){var n,r,i,o=t.sort(Jr).pop();for(Us=[],Fs=new Array(t.length),zs=new Tr,Gs=new Tr;;)if(i=Bs,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(Xr(o),n=o[0],r=o[1]),o=t.pop();else{if(!i)break;Wr(i.arc)}if(function(){for(var t,e,n,r,i=0,o=Fs.length;i<o;++i)if((t=Fs[i])&&(r=(e=t.halfedges).length)){var a=new Array(r),s=new Array(r);for(n=0;n<r;++n)a[n]=n,s[n]=Fr(t,Us[e[n]]);for(a.sort((function(t,e){return s[e]-s[t]})),n=0;n<r;++n)s[n]=e[a[n]];for(n=0;n<r;++n)e[n]=s[n]}}(),e){var a=+e[0][0],s=+e[0][1],l=+e[1][0],u=+e[1][1];!function(t,e,n,r){for(var i,o=Us.length;o--;)zr(i=Us[o],t,e,n,r)&&Br(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>Vs||Math.abs(i[0][1]-i[1][1])>Vs)||delete Us[o]}(a,s,l,u),function(t,e,n,r){var i,o,a,s,l,u,c,h,f,p,d,g,y=Fs.length,m=!0;for(i=0;i<y;++i)if(o=Fs[i]){for(a=o.site,s=(l=o.halfedges).length;s--;)Us[l[s]]||l.splice(s,1);for(s=0,u=l.length;s<u;)d=(p=Ur(o,Us[l[s]]))[0],g=p[1],h=(c=Gr(o,Us[l[++s%u]]))[0],f=c[1],(Math.abs(d-h)>Vs||Math.abs(g-f)>Vs)&&(l.splice(s,0,Us.push(Ar(a,p,Math.abs(d-t)<Vs&&r-g>Vs?[t,Math.abs(h-t)<Vs?f:r]:Math.abs(g-r)<Vs&&n-d>Vs?[Math.abs(f-r)<Vs?h:n,r]:Math.abs(d-n)<Vs&&g-e>Vs?[n,Math.abs(h-n)<Vs?f:e]:Math.abs(g-e)<Vs&&d-t>Vs?[Math.abs(f-e)<Vs?h:t,e]:null))-1),++u);u&&(m=!1)}if(m){var v,_,b,w=1/0;for(i=0,m=null;i<y;++i)(o=Fs[i])&&(b=(v=(a=o.site)[0]-t)*v+(_=a[1]-e)*_)<w&&(w=b,m=o);if(m){var x=[t,e],L=[t,r],E=[n,r],C=[n,e];m.halfedges.push(Us.push(Ar(a=m.site,x,L))-1,Us.push(Ar(a,L,E))-1,Us.push(Ar(a,E,C))-1,Us.push(Ar(a,C,x))-1)}}for(i=0;i<y;++i)(o=Fs[i])&&(o.halfedges.length||delete Fs[i])}(a,s,l,u)}this.edges=Us,this.cells=Fs,zs=Gs=Us=Fs=null}function $r(t){return(t=t.slice()).push(t[0]),o([t])}function ti(t,e,n,r){var i=(r=r||{}).steps||64,a=r.units||"kilometers",s=r.angle||0,l=r.pivot||t,u=r.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!E(r))throw new Error("options must be an object");if(!L(i))throw new Error("steps must be a number");if(!L(s))throw new Error("angle must be a number");var c=q(t);if("degrees"===a)var h=b(s);else e=Yn(t,e,90,{units:a}),n=Yn(t,n,0,{units:a}),e=q(e)[0]-c[0],n=q(n)[1]-c[1];for(var f=[],p=0;p<i;p+=1){var d=-360*p/i,g=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(ei(d),2)),y=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(ei(d),2));if(d<-90&&d>=-270&&(g=-g),d<-180&&d>=-360&&(y=-y),"degrees"===a){var m=g*Math.cos(h)+y*Math.sin(h),v=y*Math.cos(h)-g*Math.sin(h);g=m,y=v}f.push([g+c[0],y+c[1]])}return f.push(f[0]),"degrees"===a?o([f],u):nr(o([f],u),s,{pivot:l})}function ei(t){var e=t*Math.PI/180;return Math.tan(e)}function ni(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.properties,i=e.weight;if(!t)throw new Error("geojson is required");var o=0,a=0,s=0;return D(t,(function(t,e,n){var r=n[i];if(!L(r=null==r?1:r))throw new Error("weight value must be a number for feature index "+e);(r=Number(r))>0&&S(t,(function(t){o+=t[0]*r,a+=t[1]*r,s+=r}))})),r([o/s,a/s],n)}function ri(t,e,n,i){var o=n.properties.tolerance||.001,a=0,s=0,l=0,u=0;if(O(n,(function(e){var n=e.properties.weight,r=null==n?1:n;if(!L(r=Number(r)))throw new Error("weight value must be a number");if(r>0){u+=1;var i=r*Rt(e,t);0===i&&(i=1);var o=r/i;a+=e.geometry.coordinates[0]*o,s+=e.geometry.coordinates[1]*o,l+=o}})),u<1)throw new Error("no features to measure");var c=a/l,h=s/l;return 1===u||0===i||Math.abs(c-e[0])<o&&Math.abs(h-e[1])<o?r([c,h],{medianCandidates:n.properties.medianCandidates}):(n.properties.medianCandidates.push([c,h]),ri([c,h],t,n,i-1))}function ii(t,e){return{x:t[0]-e[0],y:t[1]-e[1]}}function oi(t){if(E(t)&&(t=t.bbox),t&&!Array.isArray(t))throw new Error("bbox is invalid");return t?function(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}(t):[360*ui(),180*ui()]}function ai(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.bbox;null!=t||(t=1);for(var i=[],o=0;o<t;o++)i.push(r(oi(n)));return u(i)}function si(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.bbox,r=e.num_vertices,i=e.max_radial_length;null!=t||(t=1),L(r)||(r=10),L(i)||(i=10);for(var a=[],s=0;s<t;s++){var l=[],c=Array.apply(null,new Array(r+1)).map(Math.random);c.forEach((function(t,e,n){n[e]=e>0?t+n[e-1]:t})),c.forEach((function(t){t=2*t*Math.PI/c[c.length-1];var e=Math.random();l.push([e*i*Math.sin(t),e*i*Math.cos(t)])})),l[l.length-1]=l[0],l=l.map(function(t){return function(e){return[e[0]+t[0],e[1]+t[1]]}}(oi(n))),a.push(o([l]))}return u(a)}function li(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.bbox,r=e.num_vertices,i=e.max_length,o=e.max_rotation;null!=t||(t=1),(!L(r)||r<2)&&(r=10),L(i)||(i=1e-4),L(o)||(o=Math.PI/8);for(var a=[],l=0;l<t;l++){for(var c=[oi(n)],h=0;h<r-1;h++){var f=(0===h?2*Math.random()*Math.PI:Math.tan((c[h][1]-c[h-1][1])/(c[h][0]-c[h-1][0])))+(Math.random()-.5)*o*2,p=Math.random()*i;c.push([c[h][0]+p*Math.cos(f),c[h][1]+p*Math.sin(f)])}a.push(s(c))}return u(a)}function ui(){return Math.random()-.5}function ci(t,e){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("filter is required");var n=[];return O(t,(function(t){di(t.properties,e)&&n.push(t)})),u(n)}function hi(t,e,n){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("property is required");for(var r=pi(t,e),i=Object.keys(r),o=0;o<i.length;o++){for(var a=i[o],s=r[a],l=[],c=0;c<s.length;c++)l.push(t.features[s[c]]);n(u(l),a,o)}}function fi(t,e,n,r){var i=r;return hi(t,e,(function(t,e,o){i=0===o&&void 0===r?t:n(i,t,e,o)})),i}function pi(t,e){var n={};return O(t,(function(t,r){var i=t.properties||{};if(i.hasOwnProperty(e)){var o=i[e];n.hasOwnProperty(o)?n[o].push(r):n[o]=[r]}})),n}function di(t,e){if(void 0===t)return!1;var n=typeof e;if("number"===n||"string"===n)return t.hasOwnProperty(e);if(Array.isArray(e)){for(var r=0;r<e.length;r++)if(!di(t,e[r]))return!1;return!0}return gi(t,e)}function gi(t,e){for(var n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];if(t[i]!==e[i])return!1}return!0}function yi(t,e){if(!e)return{};if(!e.length)return{};for(var n={},r=0;r<e.length;r++){var i=e[r];t.hasOwnProperty(i)&&(n[i]=t[i])}return n}function mi(){}function vi(t){this.message=t||""}function _i(t){this.message=t||""}function bi(){}function wi(t){return null===t?pu:t.color}function xi(t){return null===t?null:t.parent}function Li(t,e){null!==t&&(t.color=e)}function Ei(t){return null===t?null:t.left}function Ci(t){return null===t?null:t.right}function ki(){this.root_=null,this.size_=0}function Si(){}function Pi(){this.array_=[],arguments[0]instanceof Ql&&this.addAll(arguments[0])}function Mi(){}function Ti(t){this.message=t||""}function Oi(){this.array_=[]}function Ii(t){switch(t.type){case"Polygon":return un(t)>1?t:null;case"MultiPolygon":var e=[];if(A(t,(function(t){un(t)>1&&e.push(t.geometry.coordinates)})),e.length)return{type:"MultiPolygon",coordinates:e}}}function Ni(){this.reset()}function Di(t,e,n){var r=t.s=e+n,i=r-e,o=r-i;t.t=e-o+(n-i)}function Ri(t){return t>1?_p:t<-1?-_p:Math.asin(t)}function Ai(){}function ji(t,e){t&&Dp.hasOwnProperty(t.type)&&Dp[t.type](t,e)}function Bi(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function zi(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)Bi(t[n],e,1);e.polygonEnd()}function Fi(t){return[kp(t[1],t[0]),Ri(t[2])]}function Gi(t){var e=t[0],n=t[1],r=Sp(n);return[r*Sp(e),r*Tp(e),Tp(n)]}function Ui(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function qi(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Hi(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Vi(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Yi(t){var e=Op(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Wi(t,e){return[t>vp?t-wp:t<-vp?t+wp:t,e]}function Xi(t,e,n){return(t%=wp)?e||n?Ap(Ki(t),Ji(e,n)):Ki(t):e||n?Ji(e,n):Wi}function Zi(t){return function(e,n){return[(e+=t)>vp?e-wp:e<-vp?e+wp:e,n]}}function Ki(t){var e=Zi(t);return e.invert=Zi(-t),e}function Ji(t,e){function n(t,e){var n=Sp(e),s=Sp(t)*n,l=Tp(t)*n,u=Tp(e),c=u*r+s*i;return[kp(l*o-c*a,s*r-u*i),Ri(c*o+l*a)]}var r=Sp(t),i=Tp(t),o=Sp(e),a=Tp(e);return n.invert=function(t,e){var n=Sp(e),s=Sp(t)*n,l=Tp(t)*n,u=Tp(e),c=u*o-l*a;return[kp(l*o+u*a,s*r+c*i),Ri(c*r-s*i)]},n}function Qi(t,e){(e=Gi(e))[0]-=t,Yi(e);var n=function(t){return t>1?0:t<-1?vp:Math.acos(t)}(-e[1]);return((-e[2]<0?-n:n)+wp-mp)%wp}function $i(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function to(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function eo(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,u){var c=0,h=0;if(null==i||(c=a(i,s))!==(h=a(o,s))||l(i,o)<0^s>0)do{u.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+s+4)%4)!==h);else u.point(o[0],o[1])}function a(r,i){return Ep(r[0]-t)<mp?i>0?0:3:Ep(r[0]-n)<mp?i>0?2:1:Ep(r[1]-e)<mp?i>0?1:0:i>0?3:2}function s(t,e){return l(t.x,e.x)}function l(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){function l(t,e){i(t,e)&&w.point(t,e)}function u(o,a){var s=i(o,a);if(h&&f.push([o,a]),_)p=o,d=a,g=s,_=!1,s&&(w.lineStart(),w.point(o,a));else if(s&&v)w.point(o,a);else{var l=[y=Math.max(Hp,Math.min(qp,y)),m=Math.max(Hp,Math.min(qp,m))],u=[o=Math.max(Hp,Math.min(qp,o)),a=Math.max(Hp,Math.min(qp,a))];Bp(l,u,t,e,n,r)?(v||(w.lineStart(),w.point(l[0],l[1])),w.point(u[0],u[1]),s||w.lineEnd(),b=!1):s&&(w.lineStart(),w.point(o,a),b=!1)}y=o,m=a,v=s}var c,h,f,p,d,g,y,m,v,_,b,w=a,x=jp(),L={point:l,lineStart:function(){L.point=u,h&&h.push(f=[]),_=!0,v=!1,y=m=NaN},lineEnd:function(){c&&(u(p,d),g&&v&&x.rejoin(),c.push(x.result())),L.point=l,v&&w.lineEnd()},polygonStart:function(){w=x,c=[],h=[],b=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=h.length;n<i;++n)for(var o,a,s=h[n],l=1,u=s.length,c=s[0],f=c[0],p=c[1];l<u;++l)o=f,a=p,f=(c=s[l])[0],p=c[1],a<=r?p>r&&(f-o)*(r-a)>(p-a)*(t-o)&&++e:p<=r&&(f-o)*(r-a)<(p-a)*(t-o)&&--e;return e}(),n=b&&e,i=(c=Up(c)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&Fp(c,s,e,o,a),a.polygonEnd()),w=a,c=h=f=null}};return L}}function no(t){return t.length>1}function ro(t,e){return((t=t.x)[0]<0?t[1]-_p-mp:_p-t[1])-((e=e.x)[0]<0?e[1]-_p-mp:_p-e[1])}function io(t){return function(e){var n=new oo;for(var r in t)n[r]=t[r];return n.stream=e,n}}function oo(){}function ao(t,e,n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),Rp(n,t.stream(Jp));var a=Jp.result(),s=Math.min(r/(a[1][0]-a[0][0]),i/(a[1][1]-a[0][1])),l=+e[0][0]+(r-s*(a[1][0]+a[0][0]))/2,u=+e[0][1]+(i-s*(a[1][1]+a[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*s).translate([l,u])}function so(t,e){return[t,Mp(Ip((_p+e)/2))]}function lo(t,e){return[Mp(Ip((_p+e)/2)),-t]}function uo(t,n,r,i){var o=t.properties||{},a="Feature"===t.type?t.geometry:t;if("GeometryCollection"===a.type){var s=[];return D(t,(function(t){var e=uo(t,n,r,i);e&&s.push(e)})),u(s)}var l,c=U(t),h=c[1]>50&&c[3]>50;l=h?{type:a.type,coordinates:co(a.coordinates,fo(a))}:$e(a);var f,p=(new nc).read(l),d=g(y(n,r),"meters"),m=Wh.bufferOp(p,d);if(!function t(e){return Array.isArray(e[0])?t(e[0]):isNaN(e[0])}((m=(new rc).write(m)).coordinates))return(f=h?{type:m.type,coordinates:ho(m.coordinates,fo(a))}:tn(m)).geometry?f:e(f,o)}function co(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return co(t,e)}))}function ho(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return ho(t,e)}))}function fo(t){var e=ue(t).geometry.coordinates.reverse(),n=e.map((function(t){return-t}));return id().center(e).rotate(n).scale(xo)}function po(){for(var t=new nc,e=t.read(JSON.stringify(arguments[0].geometry)),n=1;n<arguments.length;n++)e=dp.union(e,t.read(JSON.stringify(arguments[n].geometry)));return{type:"Feature",geometry:e=(new rc).write(e),properties:arguments[0].properties}}function go(t,n){var r=Z(t),i=Z(n);if(Zt(bn(i,{precision:4})).coordinates[0].length<4)return null;if(Zt(bn(r,{precision:4})).coordinates[0].length<4)return null;var o=new nc,a=o.read(bn(r)),s=o.read(bn(i)),l=op.intersection(a,s);return l.isEmpty()?null:e((new rc).write(l))}function yo(t,e){return function(t,e,n){var r,i;if(!Array.isArray(e))throw new Error("Get closest expects an array as second argument");return e.forEach((function(e,n){var o=function(t,e){return t-e}(e,t);o>=0&&(void 0===i||o<i)&&(i=o,r=n)})),r}(t,e)}function mo(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.properties||{},i=n.triangles,a=n.mask;if(null==e)throw new Error("cellSide is required");if(!L(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(a&&-1===["Polygon","MultiPolygon"].indexOf(J(a)))throw new Error("options.mask must be a (Multi)Polygon");var s=t[0],l=t[1],c=t[2],h=t[3],f=(l+h)/2,p=(s+c)/2,d=2*e/Rt([s,f],[c,f],n)*(c-s),g=2*e/Rt([p,l],[p,h],n)*(h-l),y=d/2,m=2*y,v=Math.sqrt(3)/2*g,_=c-s,b=h-l,w=.75*m,x=v,C=(_-m)/(m-y/2),k=Math.floor(C),S=(k*w-y/2-_)/2-y/2+w/2,P=Math.floor((b-v)/v),M=(b-P*v)/2,T=P*v-b>v/2;T&&(M-=v/4);for(var O=[],I=[],N=0;N<6;N++){var D=2*Math.PI/6*N;O.push(Math.cos(D)),I.push(Math.sin(D))}for(var R=[],A=0;A<=k;A++)for(var j=0;j<=P;j++){var B=A%2==1;if(!(0===j&&B||0===j&&T)){var z=A*w+s-S,F=j*x+l+M;if(B&&(F-=v/2),!0===i)(function(t,e,n,r,i,a){for(var s=[],l=0;l<6;l++){var u=[];u.push(t),u.push([t[0]+e*i[l],t[1]+n*a[l]]),u.push([t[0]+e*i[(l+1)%6],t[1]+n*a[(l+1)%6]]),u.push(t),s.push(o([u],r))}return s})([z,F],d/2,g/2,r,O,I).forEach((function(t){a?go(a,t)&&R.push(t):R.push(t)}));else{var G=function(t,e,n,r,i,a){for(var s=[],l=0;l<6;l++){var u=t[0]+e*i[l],c=t[1]+n*a[l];s.push([u,c])}return s.push(s[0].slice()),o([s],r)}([z,F],d/2,g/2,r,O,I);a?go(a,G)&&R.push(G):R.push(G)}}}return u(R)}function vo(t){if(t.features.length<=1)return t;var e=function(t){var e=Io(),n=[];return A(t,(function(t,e){var r=U(t);n.push({minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],geojson:t,index:e})})),e.load(n),e}(t),n=[],r={};return A(t,(function(t,i){if(r[i])return!0;for(e.remove({index:i},_o),r[i]=!0;;){var o=U(t),a=e.search({minX:o[0],minY:o[1],maxX:o[2],maxY:o[3]});if(a.length>0){var s=a.map((function(t){return r[t.index]=!0,e.remove({index:t.index},_o),t.geojson}));s.push(t),t=po.apply(this,s)}if(0===a.length)break}n.push(t)})),u(n)}function _o(t,e){return t.index===e.index}function bo(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.properties,i=n.mask,a=[];if(null==e)throw new Error("cellSide is required");if(!L(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(i&&-1===["Polygon","MultiPolygon"].indexOf(J(i)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=t[0],l=t[1],c=t[2],h=t[3],f=e/Rt([s,l],[c,l],n)*(c-s),p=e/Rt([s,l],[s,h],n)*(h-l),d=c-s,g=h-l,y=Math.floor(d/f),m=Math.floor(g/p),v=(g-m*p)/2,_=s+(d-y*f)/2,b=0;b<y;b++){for(var w=l+v,x=0;x<m;x++){var C=o([[[_,w],[_,w+p],[_+f,w+p],[_+f,w],[_,w]]],r);i?go(i,C)&&a.push(C):a.push(C),w+=p}_+=f}return u(a)}function wo(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.properties,i=n.mask,a=[];if(null==e)throw new Error("cellSide is required");if(!L(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(i&&-1===["Polygon","MultiPolygon"].indexOf(J(i)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=e/Rt([t[0],t[1]],[t[2],t[1]],n)*(t[2]-t[0]),l=e/Rt([t[0],t[1]],[t[0],t[3]],n)*(t[3]-t[1]),c=0,h=t[0];h<=t[2];){for(var f=0,p=t[1];p<=t[3];){var d=null,g=null;c%2==0&&f%2==0?(d=o([[[h,p],[h,p+l],[h+s,p],[h,p]]],r),g=o([[[h,p+l],[h+s,p+l],[h+s,p],[h,p+l]]],r)):c%2==0&&f%2==1?(d=o([[[h,p],[h+s,p+l],[h+s,p],[h,p]]],r),g=o([[[h,p],[h,p+l],[h+s,p+l],[h,p]]],r)):f%2==0&&c%2==1?(d=o([[[h,p],[h,p+l],[h+s,p+l],[h,p]]],r),g=o([[[h,p],[h+s,p+l],[h+s,p],[h,p]]],r)):f%2==1&&c%2==1&&(d=o([[[h,p],[h,p+l],[h+s,p],[h,p]]],r),g=o([[[h,p+l],[h+s,p+l],[h+s,p],[h,p+l]]],r)),i?(go(i,d)&&a.push(d),go(i,g)&&a.push(g)):(a.push(d),a.push(g)),p+=l,f++}c++,h+=s}return u(a)}var xo=6371008.8,Lo={meters:xo,metres:xo,millimeters:1e3*xo,millimetres:1e3*xo,centimeters:100*xo,centimetres:100*xo,kilometers:xo/1e3,kilometres:xo/1e3,miles:xo/1609.344,nauticalmiles:xo/1852,inches:39.37*xo,yards:xo/1.0936,feet:3.28084*xo,radians:1,degrees:xo/111325},Eo={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:.001,kilometres:.001,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/xo,degrees:1/111325},Co={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006},ko=Object.freeze({earthRadius:xo,factors:Lo,unitsFactors:Eo,areaFactors:Co,feature:e,geometry:n,point:r,points:i,polygon:o,polygons:a,lineString:s,lineStrings:l,featureCollection:u,multiLineString:c,multiPoint:h,multiPolygon:f,geometryCollection:p,round:d,radiansToLength:g,lengthToRadians:y,lengthToDegrees:m,bearingToAzimuth:v,radiansToDegrees:_,degreesToRadians:b,convertLength:w,convertArea:x,isNumber:L,isObject:E,validateBBox:C,validateId:k,radians2degrees:function(){throw new Error("method has been renamed to `radiansToDegrees`")},degrees2radians:function(){throw new Error("method has been renamed to `degreesToRadians`")},distanceToDegrees:function(){throw new Error("method has been renamed to `lengthToDegrees`")},distanceToRadians:function(){throw new Error("method has been renamed to `lengthToRadians`")},radiansToDistance:function(){throw new Error("method has been renamed to `radiansToLength`")},bearingToAngle:function(){throw new Error("method has been renamed to `bearingToAzimuth`")},convertDistance:function(){throw new Error("method has been renamed to `convertLength`")}}),So=Object.freeze({coordEach:S,coordReduce:P,propEach:M,propReduce:T,featureEach:O,featureReduce:I,coordAll:N,geomEach:D,geomReduce:R,flattenEach:A,flattenReduce:j,segmentEach:B,segmentReduce:z,lineEach:F,lineReduce:G}),Po=Object.freeze({getCoord:q,getCoords:H,containsNumber:V,geojsonType:Y,featureOf:W,collectionOf:X,getGeom:Z,getGeomType:K,getType:J}),Mo={successCallback:null,verbose:!1},To={},Oo=function t(e,n,r,i,o){for(r=r||0,i=i||e.length-1,o=o||function(t,e){return t<e?-1:t>e?1:0};i>r;){if(i-r>600){var a=i-r+1,s=n-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-s*u/a+c)),Math.min(i,Math.floor(n+(a-s)*u/a+c)),o)}var h=e[n],f=r,p=i;for(rt(e,r,n),o(e[i],h)>0&&rt(e,r,i);f<p;){for(rt(e,f,p),f++,p--;o(e[f],h)<0;)f++;for(;o(e[p],h)>0;)p--}0===o(e[r],h)?rt(e,r,p):rt(e,++p,i),p<=n&&(r=p+1),n<=p&&(i=p-1)}},Io=it;it.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!pt(t,e))return n;for(var i,o,a,s,l=[];e;){for(i=0,o=e.children.length;i<o;i++)a=e.children[i],pt(t,s=e.leaf?r(a):a)&&(e.leaf?n.push(a):ft(t,s)?this._all(a,n):l.push(a));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!pt(t,e))return!1;for(var r,i,o,a,s=[];e;){for(r=0,i=e.children.length;r<i;r++)if(o=e.children[r],pt(t,a=e.leaf?n(o):o)){if(e.leaf||ft(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=dt([]),this},remove:function(t,e){if(!t)return this;for(var n,r,i,o,a=this.data,s=this.toBBox(t),l=[],u=[];a||l.length;){if(a||(a=l.pop(),r=l[l.length-1],n=u.pop(),o=!0),a.leaf&&-1!==(i=function(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}(t,a.children,e)))return a.children.splice(i,1),l.push(a),this._condense(l),this;o||a.leaf||!ft(a,s)?r?(n++,a=r.children[n],o=!1):a=null:(l.push(a),u.push(n),n=0,r=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:lt,compareMinY:ut,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,o=n-e+1,a=this._maxEntries;if(o<=a)return ot(i=dt(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),(i=dt([])).leaf=!1,i.height=r;var s,l,u,c,h=Math.ceil(o/a),f=h*Math.ceil(Math.sqrt(a));for(gt(t,e,n,f,this.compareMinX),s=e;s<=n;s+=f)for(gt(t,s,u=Math.min(s+f-1,n),h,this.compareMinY),l=s;l<=u;l+=h)c=Math.min(l+h-1,u),i.children.push(this._build(t,l,c,r-1));return ot(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,o,a,s,l,u,c,h;r.push(e),!e.leaf&&r.length-1!==n;){for(c=h=1/0,i=0,o=e.children.length;i<o;i++)l=ct(a=e.children[i]),(u=function(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}(t,a)-l)<h?(h=u,c=l<c?l:c,s=a):u===h&&l<c&&(c=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),o=[],a=this._chooseSubtree(i,this.data,e,o);for(a.children.push(t),st(a,i);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(i,o,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var o=this._chooseSplitIndex(n,i,r),a=dt(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,ot(n,this.toBBox),ot(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=dt([t,e]),this.data.height=t.height+1,this.data.leaf=!1,ot(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,o,a,s,l,u,c;for(l=u=1/0,r=e;r<=n-e;r++)a=function(t,e){var n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}(i=at(t,0,r,this.toBBox),o=at(t,r,n,this.toBBox)),s=ct(i)+ct(o),a<l?(l=a,c=r,u=s<u?s:u):a===l&&s<u&&(u=s,c=r);return c},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:lt,i=t.leaf?this.compareMinY:ut;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,o,a=this.toBBox,s=at(t,0,e,a),l=at(t,n-e,n,a),u=ht(s)+ht(l);for(i=e;i<n-e;i++)o=t.children[i],st(s,t.leaf?a(o):o),u+=ht(s);for(i=n-e-1;i>=e;i--)o=t.children[i],st(l,t.leaf?a(o):o),u+=ht(l);return u},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)st(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():ot(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var No=function(t,e,n){var r=t*e,i=Do*t,o=i-(i-t),a=t-o,s=Do*e,l=s-(s-e),u=e-l,c=a*u-(r-o*l-a*l-o*u);return n?(n[0]=c,n[1]=r,n):[c,r]},Do=+(Math.pow(2,27)+1),Ro=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,i=t-(n-r)+(e-r);return i?[i,n]:[n]}(t[0],e[0]);var i,o,a=new Array(n+r),s=0,l=0,u=0,c=Math.abs,h=t[l],f=c(h),p=e[u],d=c(p);f<d?(o=h,(l+=1)<n&&(f=c(h=t[l]))):(o=p,(u+=1)<r&&(d=c(p=e[u]))),l<n&&f<d||u>=r?(i=h,(l+=1)<n&&(f=c(h=t[l]))):(i=p,(u+=1)<r&&(d=c(p=e[u])));for(var g,y,m=i+o,v=m-i,_=o-v,b=_,w=m;l<n&&u<r;)f<d?(i=h,(l+=1)<n&&(f=c(h=t[l]))):(i=p,(u+=1)<r&&(d=c(p=e[u]))),(_=(o=b)-(v=(m=i+o)-i))&&(a[s++]=_),b=w-((g=w+m)-(y=g-w))+(m-y),w=g;for(;l<n;)(_=(o=b)-(v=(m=(i=h)+o)-i))&&(a[s++]=_),b=w-((g=w+m)-(y=g-w))+(m-y),w=g,(l+=1)<n&&(h=t[l]);for(;u<r;)(_=(o=b)-(v=(m=(i=p)+o)-i))&&(a[s++]=_),b=w-((g=w+m)-(y=g-w))+(m-y),w=g,(u+=1)<r&&(p=e[u]);return b&&(a[s++]=b),w&&(a[s++]=w),s||(a[s++]=0),a.length=s,a},Ao=function(t,e,n){var r=t+e,i=r-t,o=e-i,a=t-(r-i);return n?(n[0]=a+o,n[1]=r,n):[a+o,r]},jo=function(t,e){var n=t.length;if(1===n){var r=No(t[0],e);return r[0]?r:[r[1]]}var i=new Array(2*n),o=[.1,.1],a=[.1,.1],s=0;No(t[0],e,o),o[0]&&(i[s++]=o[0]);for(var l=1;l<n;++l){No(t[l],e,a);var u=o[1];Ao(u,a[0],o),o[0]&&(i[s++]=o[0]);var c=a[1],h=o[1],f=c+h,p=h-(f-c);o[1]=f,p&&(i[s++]=p)}return o[1]&&(i[s++]=o[1]),0===s&&(i[s++]=0),i.length=s,i},Bo=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,i=t-(n-r)+(e-r);return i?[i,n]:[n]}(t[0],-e[0]);var i,o,a=new Array(n+r),s=0,l=0,u=0,c=Math.abs,h=t[l],f=c(h),p=-e[u],d=c(p);f<d?(o=h,(l+=1)<n&&(f=c(h=t[l]))):(o=p,(u+=1)<r&&(d=c(p=-e[u]))),l<n&&f<d||u>=r?(i=h,(l+=1)<n&&(f=c(h=t[l]))):(i=p,(u+=1)<r&&(d=c(p=-e[u])));for(var g,y,m=i+o,v=m-i,_=o-v,b=_,w=m;l<n&&u<r;)f<d?(i=h,(l+=1)<n&&(f=c(h=t[l]))):(i=p,(u+=1)<r&&(d=c(p=-e[u]))),(_=(o=b)-(v=(m=i+o)-i))&&(a[s++]=_),b=w-((g=w+m)-(y=g-w))+(m-y),w=g;for(;l<n;)(_=(o=b)-(v=(m=(i=h)+o)-i))&&(a[s++]=_),b=w-((g=w+m)-(y=g-w))+(m-y),w=g,(l+=1)<n&&(h=t[l]);for(;u<r;)(_=(o=b)-(v=(m=(i=p)+o)-i))&&(a[s++]=_),b=w-((g=w+m)-(y=g-w))+(m-y),w=g,(u+=1)<r&&(p=-e[u]);return b&&(a[s++]=b),w&&(a[s++]=w),s||(a[s++]=0),a.length=s,a},zo=yt((function(t){function e(t,e){for(var n=new Array(t.length-1),r=1;r<t.length;++r)for(var i=n[r-1]=new Array(t.length-1),o=0,a=0;o<t.length;++o)o!==e&&(i[a++]=t[r][o]);return n}function n(t){return 1&t?"-":""}function r(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",r(t.slice(0,e)),",",r(t.slice(e)),")"].join("")}function i(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var o=[],a=0;a<t.length;++a)o.push(["scale(",r(i(e(t,a))),",",n(a),t[0][a],")"].join(""));return o}function o(t){for(var n=[],o=[],a=function(t){for(var e=new Array(t),n=0;n<t;++n){e[n]=new Array(t);for(var r=0;r<t;++r)e[n][r]=["m",r,"[",t-n-1,"]"].join("")}return e}(t),s=[],l=0;l<t;++l)0==(1&l)?n.push.apply(n,i(e(a,l))):o.push.apply(o,i(e(a,l))),s.push("m"+l);var u=r(n),c=r(o),h="orientation"+t+"Exact",f=["function ",h,"(",s.join(),"){var p=",u,",n=",c,",d=sub(p,n);return d[d.length-1];};return ",h].join("");return new Function("sum","prod","scale","sub",f)(Ro,No,jo,Bo)}var a=o(3),s=o(4),l=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var r,i=(t[1]-n[1])*(e[0]-n[0]),o=(t[0]-n[0])*(e[1]-n[1]),s=i-o;if(i>0){if(o<=0)return s;r=i+o}else{if(!(i<0))return s;if(o>=0)return s;r=-(i+o)}var l=33306690738754716e-32*r;return s>=l||s<=-l?s:a(t,e,n)},function(t,e,n,r){var i=t[0]-r[0],o=e[0]-r[0],a=n[0]-r[0],l=t[1]-r[1],u=e[1]-r[1],c=n[1]-r[1],h=t[2]-r[2],f=e[2]-r[2],p=n[2]-r[2],d=o*c,g=a*u,y=a*l,m=i*c,v=i*u,_=o*l,b=h*(d-g)+f*(y-m)+p*(v-_),w=7771561172376103e-31*((Math.abs(d)+Math.abs(g))*Math.abs(h)+(Math.abs(y)+Math.abs(m))*Math.abs(f)+(Math.abs(v)+Math.abs(_))*Math.abs(p));return b>w||-b>w?b:s(t,e,n,r)}];!function(){for(;l.length<=5;)l.push(o(l.length));for(var e=[],n=["slow"],r=0;r<=5;++r)e.push("a"+r),n.push("o"+r);var i=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(r=2;r<=5;++r)i.push("case ",r,":return o",r,"(",e.slice(0,r).join(),");");i.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),n.push(i.join(""));var a=Function.apply(void 0,n);for(t.exports=a.apply(void 0,[function(t){var e=l[t.length];return e||(e=l[t.length]=o(t.length)),e.apply(void 0,t)}].concat(l)),r=0;r<=5;++r)t.exports[r]=l[r]}()})),Fo=function(t){var e=t.length;if(e<3){for(var n=new Array(e),r=0;r<e;++r)n[r]=r;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:n}var i=new Array(e);for(r=0;r<e;++r)i[r]=r;i.sort((function(e,n){return t[e][0]-t[n][0]||t[e][1]-t[n][1]}));var o=[i[0],i[1]],a=[i[0],i[1]];for(r=2;r<e;++r){for(var s=i[r],l=t[s],u=o.length;u>1&&Go(t[o[u-2]],t[o[u-1]],l)<=0;)u-=1,o.pop();for(o.push(s),u=a.length;u>1&&Go(t[a[u-2]],t[a[u-1]],l)>=0;)u-=1,a.pop();a.push(s)}n=new Array(a.length+o.length-2);for(var c=0,h=(r=0,o.length);r<h;++r)n[c++]=o[r];for(var f=a.length-2;f>0;--f)n[c++]=a[f];return n},Go=zo[3],Uo=mt,qo=mt;mt.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,r=e[t];t>0;){var i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r},_down:function(t){for(var e=this.data,n=this.compare,r=this.length>>1,i=e[t];t<r;){var o=1+(t<<1),a=o+1,s=e[o];if(a<this.length&&n(e[a],s)<0&&(o=a,s=e[a]),n(s,i)>=0)break;e[t]=s,t=o}e[t]=i}},Uo.default=qo;var Ho=function(t,e){for(var n=t[0],r=t[1],i=!1,o=0,a=e.length-1;o<e.length;a=o++){var s=e[o][0],l=e[o][1],u=e[a][0],c=e[a][1];l>r!=c>r&&n<(u-s)*(r-l)/(c-l)+s&&(i=!i)}return i},Vo=zo[3],Yo=vt,Wo=vt;Yo.default=Wo;var Xo=function(t){return t},Zo=function(t){if(null==t)return Xo;var e,n,r=t.scale[0],i=t.scale[1],o=t.translate[0],a=t.translate[1];return function(t,s){s||(e=n=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*r+o,c[1]=(n+=t[1])*i+a;l<u;)c[l]=t[l],++l;return c}},Ko=function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n},Jo=function(t,e){function n(t,e){for(var n in t){var i=t[n];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){r[t<0?~t:t]=1})),a.push(i)}}var r={},i={},o={},a=[],s=-1;return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++s],e[s]=n,e[r]=i)})),e.forEach((function(e){var n,r,a=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];return t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1],e<0?[n,i]:[i,n]}(e),s=a[0],l=a[1];if(n=o[s])if(delete o[n.end],n.push(e),n.end=l,r=i[l]){delete i[r.start];var u=r===n?n:n.concat(r);i[u.start=n.start]=o[u.end=r.end]=u}else i[n.start]=o[n.end]=n;else if(n=i[l])if(delete i[n.start],n.unshift(e),n.start=s,r=o[s]){delete o[r.end];var c=r===n?n:r.concat(n);i[c.start=r.start]=o[c.end=n.end]=c}else i[n.start]=o[n.end]=n;else i[(n=[e]).start=s]=o[n.end=l]=n})),n(o,i),n(i,o),e.forEach((function(t){r[t<0?~t:t]||a.push([t])})),a},Qo=function(t){return zt(t,Ft.apply(this,arguments))},$o=function(t,e,n,r,i,o){3===arguments.length&&(r=o=Array,i=null);for(var a=new r(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),s=new o(t),l=t-1,u=0;u<t;++u)a[u]=i;return{set:function(r,o){for(var u=e(r)&l,c=a[u],h=0;c!=i;){if(n(c,r))return s[u]=o;if(++h>=t)throw new Error("full hashmap");c=a[u=u+1&l]}return a[u]=r,s[u]=o,o},maybeSet:function(r,o){for(var u=e(r)&l,c=a[u],h=0;c!=i;){if(n(c,r))return s[u];if(++h>=t)throw new Error("full hashmap");c=a[u=u+1&l]}return a[u]=r,s[u]=o,o},get:function(r,o){for(var u=e(r)&l,c=a[u],h=0;c!=i;){if(n(c,r))return s[u];if(++h>=t)break;c=a[u=u+1&l]}return o},keys:function(){for(var t=[],e=0,n=a.length;e<n;++e){var r=a[e];r!=i&&t.push(r)}return t}}},ta=function(t,e){return t[0]===e[0]&&t[1]===e[1]},ea=new ArrayBuffer(16),na=new Float64Array(ea),ra=new Uint32Array(ea),ia=function(t){na[0]=t[0],na[1]=t[1];var e=ra[0]^ra[1];return 2147483647&(e<<5^e>>7^ra[2]^ra[3])},oa=function(t){var e,n,r,i=function(t){function e(t,e,n,r){if(f[n]!==t){f[n]=t;var i=p[n];if(i>=0){var o=d[n];i===e&&o===r||i===r&&o===e||(++y,g[n]=1)}else p[n]=e,d[n]=r}}function n(t){return ia(l[t])}function r(t,e){return ta(l[t],l[e])}var i,o,a,s,l=t.coordinates,u=t.lines,c=t.rings,h=function(){for(var t=$o(1.4*l.length,n,r,Int32Array,-1,Int32Array),e=new Int32Array(l.length),i=0,o=l.length;i<o;++i)e[i]=t.maybeSet(i,i);return e}(),f=new Int32Array(l.length),p=new Int32Array(l.length),d=new Int32Array(l.length),g=new Int8Array(l.length),y=0;for(i=0,o=l.length;i<o;++i)f[i]=p[i]=d[i]=-1;for(i=0,o=u.length;i<o;++i){var m=u[i],v=m[0],_=m[1];for(a=h[v],s=h[++v],++y,g[a]=1;++v<=_;)e(i,a,a=s,s=h[v]);++y,g[s]=1}for(i=0,o=l.length;i<o;++i)f[i]=-1;for(i=0,o=c.length;i<o;++i){var b=c[i],w=b[0]+1,x=b[1];for(e(i,h[x-1],a=h[w-1],s=h[w]);++w<=x;)e(i,a,a=s,s=h[w])}f=p=d=null;var L,E=function(t,e,n,r,i){3===arguments.length&&(r=Array,i=null);for(var o=new r(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),a=t-1,s=0;s<t;++s)o[s]=i;return{add:function(r){for(var s=e(r)&a,l=o[s],u=0;l!=i;){if(n(l,r))return!0;if(++u>=t)throw new Error("full hashset");l=o[s=s+1&a]}return o[s]=r,!0},has:function(r){for(var s=e(r)&a,l=o[s],u=0;l!=i;){if(n(l,r))return!0;if(++u>=t)break;l=o[s=s+1&a]}return!1},values:function(){for(var t=[],e=0,n=o.length;e<n;++e){var r=o[e];r!=i&&t.push(r)}return t}}}(1.4*y,ia,ta);for(i=0,o=l.length;i<o;++i)g[L=h[i]]&&E.add(l[L]);return E}(t),o=t.coordinates,a=t.lines,s=t.rings;for(n=0,r=a.length;n<r;++n)for(var l=a[n],u=l[0],c=l[1];++u<c;)i.has(o[u])&&(e={0:u,1:l[1]},l[1]=u,l=l.next=e);for(n=0,r=s.length;n<r;++n)for(var h=s[n],f=h[0],p=f,d=h[1],g=i.has(o[f]);++p<d;)i.has(o[p])&&(g?(e={0:p,1:h[1]},h[1]=p,h=h.next=e):(function(t,e,n,r){Gt(t,e,n),Gt(t,e,e+r),Gt(t,e+r,n)}(o,f,d,d-p),o[d]=o[f],g=!0,p=f));return t},aa=function(t,e){function n(t){t&&c.hasOwnProperty(t.type)&&c[t.type](t)}function r(t){var e=[];do{var n=u.get(t);e.push(t[0]<t[1]?n:~n)}while(t=t.next);return e}function i(t){return t.map(r)}var o=function(t){function e(t){null!=t&&u.hasOwnProperty(t.type)&&u[t.type](t)}function n(t){var e=t[0],n=t[1];e<o&&(o=e),e>s&&(s=e),n<a&&(a=n),n>l&&(l=n)}function r(t){t.forEach(n)}function i(t){t.forEach(r)}var o=1/0,a=1/0,s=-1/0,l=-1/0,u={GeometryCollection:function(t){t.geometries.forEach(e)},Point:function(t){n(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(n)},LineString:function(t){r(t.arcs)},MultiLineString:function(t){t.arcs.forEach(r)},Polygon:function(t){t.arcs.forEach(r)},MultiPolygon:function(t){t.arcs.forEach(i)}};for(var c in t)e(t[c]);return s>=o&&l>=a?[o,a,s,l]:void 0}(t=function(t){var e,n={};for(e in t)n[e]=Ut(t[e]);return n}(t)),a=e>0&&o&&function(t,e,n){function r(t){return[Math.round((t[0]-u)*p),Math.round((t[1]-c)*d)]}function i(t,e){for(var n,r,i,o,a,s=-1,l=0,h=t.length,f=new Array(h);++s<h;)n=t[s],o=Math.round((n[0]-u)*p),a=Math.round((n[1]-c)*d),o===r&&a===i||(f[l++]=[r=o,i=a]);for(f.length=l;l<e;)l=f.push([f[0][0],f[0][1]]);return f}function o(t){return i(t,2)}function a(t){return i(t,4)}function s(t){return t.map(a)}function l(t){null!=t&&g.hasOwnProperty(t.type)&&g[t.type](t)}var u=e[0],c=e[1],h=e[2],f=e[3],p=h-u?(n-1)/(h-u):1,d=f-c?(n-1)/(f-c):1,g={GeometryCollection:function(t){t.geometries.forEach(l)},Point:function(t){t.coordinates=r(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(r)},LineString:function(t){t.arcs=o(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(o)},Polygon:function(t){t.arcs=s(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(s)}};for(var y in t)l(t[y]);return{scale:[1/p,1/d],translate:[u,c]}}(t,o,e),s=function(t){function e(t){var e,n,r,i,o,a,s,l;if(r=p.get(e=u[t[0]]))for(s=0,l=r.length;s<l;++s)if(function(t,e){var n=t[0],r=e[0],i=t[1];if(n-i!=r-e[1])return!1;for(;n<=i;++n,++r)if(!ta(u[n],u[r]))return!1;return!0}(i=r[s],t))return t[0]=i[0],void(t[1]=i[1]);if(o=p.get(n=u[t[1]]))for(s=0,l=o.length;s<l;++s)if(function(t,e){var n=t[0],r=e[0],i=t[1],o=e[1];if(n-i!=r-o)return!1;for(;n<=i;++n,--o)if(!ta(u[n],u[o]))return!1;return!0}(a=o[s],t))return t[1]=a[0],void(t[0]=a[1]);r?r.push(t):p.set(e,[t]),o?o.push(t):p.set(n,[t]),d.push(t)}function n(t,e){var n=t[0],r=e[0],o=t[1]-n;if(o!==e[1]-r)return!1;for(var a=i(t),s=i(e),l=0;l<o;++l)if(!ta(u[n+(l+a)%o],u[r+(l+s)%o]))return!1;return!0}function r(t,e){var n=t[0],r=e[0],o=t[1],a=e[1],s=o-n;if(s!==a-r)return!1;for(var l=i(t),c=s-i(e),h=0;h<s;++h)if(!ta(u[n+(h+l)%s],u[a-(h+c)%s]))return!1;return!0}function i(t){for(var e=t[0],n=t[1],r=e,i=r,o=u[r];++r<n;){var a=u[r];(a[0]<o[0]||a[0]===o[0]&&a[1]<o[1])&&(i=r,o=a)}return i-e}var o,a,s,l,u=t.coordinates,c=t.lines,h=t.rings,f=c.length+h.length;for(delete t.lines,delete t.rings,s=0,l=c.length;s<l;++s)for(o=c[s];o=o.next;)++f;for(s=0,l=h.length;s<l;++s)for(a=h[s];a=a.next;)++f;var p=$o(2*f*1.4,ia,ta),d=t.arcs=[];for(s=0,l=c.length;s<l;++s){o=c[s];do{e(o)}while(o=o.next)}for(s=0,l=h.length;s<l;++s)if((a=h[s]).next)do{e(a)}while(a=a.next);else!function(t){var e,o,a,s,l;if(o=p.get(u[t[0]]))for(s=0,l=o.length;s<l;++s){if(n(a=o[s],t))return t[0]=a[0],void(t[1]=a[1]);if(r(a,t))return t[0]=a[1],void(t[1]=a[0])}if(o=p.get(e=u[t[0]+i(t)]))for(s=0,l=o.length;s<l;++s){if(n(a=o[s],t))return t[0]=a[0],void(t[1]=a[1]);if(r(a,t))return t[0]=a[1],void(t[1]=a[0])}o?o.push(t):p.set(e,[t]),d.push(t)}(a);return t}(oa(function(t){function e(t){t&&u.hasOwnProperty(t.type)&&u[t.type](t)}function n(t){for(var e=0,n=t.length;e<n;++e)l[++o]=t[e];var r={0:o-n+1,1:o};return a.push(r),r}function r(t){for(var e=0,n=t.length;e<n;++e)l[++o]=t[e];var r={0:o-n+1,1:o};return s.push(r),r}function i(t){return t.map(r)}var o=-1,a=[],s=[],l=[],u={GeometryCollection:function(t){t.geometries.forEach(e)},LineString:function(t){t.arcs=n(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(n)},Polygon:function(t){t.arcs=t.arcs.map(r)},MultiPolygon:function(t){t.arcs=t.arcs.map(i)}};for(var c in t)e(t[c]);return{type:"Topology",coordinates:l,lines:a,rings:s,objects:t}}(t))),l=s.coordinates,u=$o(1.4*s.arcs.length,Vt,Yt);t=s.objects,s.bbox=o,s.arcs=s.arcs.map((function(t,e){return u.set(t,e),l.slice(t[0],t[1]+1)})),delete s.coordinates,l=null;var c={GeometryCollection:function(t){t.geometries.forEach(n)},LineString:function(t){t.arcs=r(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(r)},Polygon:function(t){t.arcs=t.arcs.map(r)},MultiPolygon:function(t){t.arcs=t.arcs.map(i)}};for(var h in t)n(t[h]);return a&&(s.transform=a,s.arcs=function(t){for(var e=-1,n=t.length;++e<n;){for(var r,i,o=t[e],a=0,s=1,l=o.length,u=o[0],c=u[0],h=u[1];++a<l;)r=(u=o[a])[0],i=u[1],r===c&&i===h||(o[s++]=[r-c,i-h],c=r,h=i);1===s&&(o[s++]=[0,0]),o.length=s}return t}(s.arcs)),s},sa=function(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],r=this.points[e+1];this.centers.push({x:(n.x+r.x)/2,y:(n.y+r.y)/2,z:(n.z+r.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),e=0;e<this.centers.length-1;e++){n=this.centers[e],r=this.centers[e+1];var i=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,a=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+i),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+a)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+i),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+a)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};sa.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var r=0;r<this.duration;r+=10){var i=this.pos(r);Math.sqrt((i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y)+(i.z-n.z)*(i.z-n.z))>t&&(e.push(r),n=i)}return e},sa.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},sa.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var r=Math.floor((this.points.length-1)*n);return function(t,e,n,r,i){var o=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:i.x*o[0]+r.x*o[1]+n.x*o[2]+e.x*o[3],y:i.y*o[0]+r.y*o[1]+n.y*o[2]+e.y*o[3],z:i.z*o[0]+r.z*o[1]+n.z*o[2]+e.z*o[3]}}((this.length-1)*n-r,this.points[r],this.controls[r][1],this.controls[r+1][0],this.points[r+1])};var la=fe,ua=fe;fe.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(ke(t,0,o,n));if(i)for(var s=0,l=e.length;s<l;s++){var u=e[s]*n,c=s<l-1?e[s+1]*n:t.length;a-=Math.abs(ke(t,u,c,n))}var h=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,p=r[s+1]*n,d=r[s+2]*n;h+=Math.abs((t[f]-t[d])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[d+1]-t[f+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},fe.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n},la.default=ua,Oe.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!Fe(t,e))return n;for(var i,o,a,s,l=[];e;){for(i=0,o=e.children.length;i<o;i++)a=e.children[i],Fe(t,s=e.leaf?r(a):a)&&(e.leaf?n.push(a):ze(t,s)?this._all(a,n):l.push(a));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!Fe(t,e))return!1;for(var r,i,o,a,s=[];e;){for(r=0,i=e.children.length;r<i;r++)if(o=e.children[r],Fe(t,a=e.leaf?n(o):o)){if(e.leaf||ze(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Ge([]),this},remove:function(t,e){if(!t)return this;for(var n,r,i,o,a=this.data,s=this.toBBox(t),l=[],u=[];a||l.length;){if(a||(a=l.pop(),r=l[l.length-1],n=u.pop(),o=!0),a.leaf&&-1!==(i=function(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}(t,a.children,e)))return a.children.splice(i,1),l.push(a),this._condense(l),this;o||a.leaf||!ze(a,s)?r?(n++,a=r.children[n],o=!1):a=null:(l.push(a),u.push(n),n=0,r=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:Re,compareMinY:Ae,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,o=n-e+1,a=this._maxEntries;if(o<=a)return Ie(i=Ge(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),(i=Ge([])).leaf=!1,i.height=r;var s,l,u,c,h=Math.ceil(o/a),f=h*Math.ceil(Math.sqrt(a));for(Ue(t,e,n,f,this.compareMinX),s=e;s<=n;s+=f)for(Ue(t,s,u=Math.min(s+f-1,n),h,this.compareMinY),l=s;l<=u;l+=h)c=Math.min(l+h-1,u),i.children.push(this._build(t,l,c,r-1));return Ie(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,o,a,s,l,u,c,h;r.push(e),!e.leaf&&r.length-1!==n;){for(c=h=1/0,i=0,o=e.children.length;i<o;i++)l=je(a=e.children[i]),(u=function(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}(t,a)-l)<h?(h=u,c=l<c?l:c,s=a):u===h&&l<c&&(c=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),o=[],a=this._chooseSubtree(i,this.data,e,o);for(a.children.push(t),De(a,i);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(i,o,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var o=this._chooseSplitIndex(n,i,r),a=Ge(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,Ie(n,this.toBBox),Ie(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=Ge([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Ie(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,o,a,s,l,u,c;for(l=u=1/0,r=e;r<=n-e;r++)a=function(t,e){var n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}(i=Ne(t,0,r,this.toBBox),o=Ne(t,r,n,this.toBBox)),s=je(i)+je(o),a<l?(l=a,c=r,u=s<u?s:u):a===l&&s<u&&(u=s,c=r);return c},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:Re,i=t.leaf?this.compareMinY:Ae;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,o,a=this.toBBox,s=Ne(t,0,e,a),l=Ne(t,n-e,n,a),u=Be(s)+Be(l);for(i=e;i<n-e;i++)o=t.children[i],De(s,t.leaf?a(o):o),u+=Be(s);for(i=n-e-1;i>=e;i--)o=t.children[i],De(l,t.leaf?a(o):o),u+=Be(l);return u},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)De(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():Ie(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var ca=Object.freeze({toMercator:$e,toWgs84:tn}),ha=6378137,fa=function(t){function e(){for(var t=[],e=0;e<d.features.length;e++)-1==d.features[e].properties.parent&&t.push(e);if(t.length>1)for(e=0;e<t.length;e++){for(var n=-1,r=0;r<d.features.length;r++)t[e]!=r&&Pt(d.features[t[e]].geometry.coordinates[0][0],d.features[r],{ignoreBoundary:!0})&&un(d.features[r])<1/0&&(n=r);d.features[t[e]].properties.parent=n}}function n(){for(var t=0;t<d.features.length;t++)if(-1==d.features[t].properties.parent){var e=d.features[t].properties.winding;d.features[t].properties.netWinding=e,r(t,e)}}function r(t,e){for(var n=0;n<d.features.length;n++)if(d.features[n].properties.parent==t){var i=e+d.features[n].properties.winding;d.features[n].properties.netWinding=i,r(n,i)}}if("Feature"!=t.type)throw new Error("The input must a geojson object of type Feature");if(void 0===t.geometry||null==t.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=t.geometry.type)throw new Error("The input must be a geojson Polygon");for(var i=t.geometry.coordinates.length,a=[],s=0;s<i;s++){var l=t.geometry.coordinates[s];Ln(l[0],l[l.length-1])||l.push(l[0]),a.push.apply(a,l.slice(0,l.length-1))}if(!function(t){for(var e={},n=1,r=0,i=t.length;r<i;++r){if(e.hasOwnProperty(t[r])){n=0;break}e[t[r]]=1}return n}(a))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var c=a.length,h=function(t,e,n){function r(t,n,r,i){var l,u,c=o[t][n],h=o[t][n+1],f=o[r][i],p=o[r][i+1],d=function(t,e,n,r){if(wn(t,n)||wn(t,r)||wn(e,n)||wn(r,n))return null;var i=t[0],o=t[1],a=e[0],s=e[1],l=n[0],u=n[1],c=r[0],h=r[1],f=(i-a)*(u-h)-(o-s)*(l-c);return 0===f?null:[((i*s-o*a)*(l-c)-(i-a)*(l*h-u*c))/f,((i*s-o*a)*(u-h)-(o-s)*(l*h-u*c))/f]}(c,h,f,p);if(null!==d&&(l=h[0]!==c[0]?(d[0]-c[0])/(h[0]-c[0]):(d[1]-c[1])/(h[1]-c[1]),u=p[0]!==f[0]?(d[0]-f[0])/(p[0]-f[0]):(d[1]-f[1])/(p[1]-f[1]),!(l>=1||l<=0||u>=1||u<=0))){var g=d,y=!s[g];y&&(s[g]=!0),e?a.push(e(d,t,n,c,h,l,r,i,f,p,u,y)):a.push(d)}}function i(t,e){var n,r,i,a,s=o[t][e],l=o[t][e+1];return s[0]<l[0]?(n=s[0],r=l[0]):(n=l[0],r=s[0]),s[1]<l[1]?(i=s[1],a=l[1]):(i=l[1],a=s[1]),{minX:n,minY:i,maxX:r,maxY:a,ring:t,edge:e}}if("Polygon"!==t.geometry.type)throw new Error("The input feature must be a Polygon");void 0===n&&(n=1);var o=t.geometry.coordinates,a=[],s={};if(n){for(var l=[],u=0;u<o.length;u++)for(var c=0;c<o[u].length-1;c++)l.push(i(u,c));var h=Io();h.load(l)}for(var f=0;f<o.length;f++)for(var p=0;p<o[f].length-1;p++)if(n)h.search(i(f,p)).forEach((function(t){var e=t.ring,n=t.edge;r(f,p,e,n)}));else for(var d=0;d<o.length;d++)for(var g=0;g<o[d].length-1;g++)r(f,p,d,g);return e||(a={type:"Feature",geometry:{type:"MultiPoint",coordinates:a}}),a}(t,(function(t,e,n,r,i,o,a,s,l,u,c,h){return[t,e,n,r,i,o,a,s,l,u,c,h]})),f=h.length;if(0==f){var p=[];for(s=0;s<i;s++)p.push(o([t.geometry.coordinates[s]],{parent:-1,winding:function(t){for(var e=0,n=0;n<t.length-1;n++)t[n][0]<t[e][0]&&(e=n);if(xn([t[(e-1).modulo(t.length-1)],t[e],t[(e+1).modulo(t.length-1)]],!0))var r=1;else r=-1;return r}(t.geometry.coordinates[s])}));var d=u(p);return e(),n(),d}var g=[],y=[];for(s=0;s<i;s++){g.push([]);for(var m=0;m<t.geometry.coordinates[s].length-1;m++)g[s].push([new pa(t.geometry.coordinates[s][(m+1).modulo(t.geometry.coordinates[s].length-1)],1,[s,m],[s,(m+1).modulo(t.geometry.coordinates[s].length-1)],void 0)]),y.push(new da(t.geometry.coordinates[s][m],[s,(m-1).modulo(t.geometry.coordinates[s].length-1)],[s,m],void 0,void 0,!1,!0))}for(s=0;s<f;s++)g[h[s][1]][h[s][2]].push(new pa(h[s][0],h[s][5],[h[s][1],h[s][2]],[h[s][6],h[s][7]],void 0)),h[s][11]&&y.push(new da(h[s][0],[h[s][1],h[s][2]],[h[s][6],h[s][7]],void 0,void 0,!0,!0));var v=y.length;for(s=0;s<g.length;s++)for(m=0;m<g[s].length;m++)g[s][m].sort((function(t,e){return t.param<e.param?-1:1}));var _=[];for(s=0;s<v;s++)_.push({minX:y[s].coord[0],minY:y[s].coord[1],maxX:y[s].coord[0],maxY:y[s].coord[1],index:s});var b=Io();for(b.load(_),s=0;s<g.length;s++)for(m=0;m<g[s].length;m++)for(var w=0;w<g[s][m].length;w++){L=w==g[s][m].length-1?g[s][(m+1).modulo(t.geometry.coordinates[s].length-1)][0].coord:g[s][m][w+1].coord;var x=b.search({minX:L[0],minY:L[1],maxX:L[0],maxY:L[1]})[0];g[s][m][w].nxtIsectAlongEdgeIn=x.index}for(s=0;s<g.length;s++)for(m=0;m<g[s].length;m++)for(w=0;w<g[s][m].length;w++){var L=g[s][m][w].coord,E=(x=b.search({minX:L[0],minY:L[1],maxX:L[0],maxY:L[1]})[0]).index;E<c?y[E].nxtIsectAlongRingAndEdge2=g[s][m][w].nxtIsectAlongEdgeIn:Ln(y[E].ringAndEdge1,g[s][m][w].ringAndEdgeIn)?y[E].nxtIsectAlongRingAndEdge1=g[s][m][w].nxtIsectAlongEdgeIn:y[E].nxtIsectAlongRingAndEdge2=g[s][m][w].nxtIsectAlongEdgeIn}var C=[];for(s=0,m=0;m<i;m++){var k=s;for(w=0;w<t.geometry.coordinates[m].length-1;w++)y[s].coord[0]<y[k].coord[0]&&(k=s),s++;var S=y[k].nxtIsectAlongRingAndEdge2;for(w=0;w<y.length;w++)if(y[w].nxtIsectAlongRingAndEdge1==k||y[w].nxtIsectAlongRingAndEdge2==k){var P=w;break}var M=xn([y[P].coord,y[k].coord,y[S].coord],!0)?1:-1;C.push({isect:k,parent:-1,winding:M})}for(C.sort((function(t,e){return y[t.isect].coord>y[e.isect].coord?-1:1})),p=[];C.length>0;){var T=C.pop(),O=T.isect,I=T.parent,N=T.winding,D=p.length,R=[y[O].coord],A=O;if(y[O].ringAndEdge1Walkable)var j=y[O].ringAndEdge1,B=y[O].nxtIsectAlongRingAndEdge1;else j=y[O].ringAndEdge2,B=y[O].nxtIsectAlongRingAndEdge2;for(;!Ln(y[O].coord,y[B].coord);){R.push(y[B].coord);var z=void 0;for(s=0;s<C.length;s++)if(C[s].isect==B){z=s;break}if(null!=z&&C.splice(z,1),Ln(j,y[B].ringAndEdge1)){if(j=y[B].ringAndEdge2,y[B].ringAndEdge2Walkable=!1,y[B].ringAndEdge1Walkable){var F={isect:B};xn([y[A].coord,y[B].coord,y[y[B].nxtIsectAlongRingAndEdge2].coord],1==N)?(F.parent=I,F.winding=-N):(F.parent=D,F.winding=N),C.push(F)}A=B,B=y[B].nxtIsectAlongRingAndEdge2}else j=y[B].ringAndEdge1,y[B].ringAndEdge1Walkable=!1,y[B].ringAndEdge2Walkable&&(F={isect:B},xn([y[A].coord,y[B].coord,y[y[B].nxtIsectAlongRingAndEdge1].coord],1==N)?(F.parent=I,F.winding=-N):(F.parent=D,F.winding=N),C.push(F)),A=B,B=y[B].nxtIsectAlongRingAndEdge1}R.push(y[B].coord),p.push(o([R],{index:D,parent:I,winding:N,netWinding:void 0}))}return d=u(p),e(),n(),d},pa=function(t,e,n,r,i){this.coord=t,this.param=e,this.ringAndEdgeIn=n,this.ringAndEdgeOut=r,this.nxtIsectAlongEdgeIn=i},da=function(t,e,n,r,i,o,a){this.coord=t,this.ringAndEdge1=e,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=r,this.nxtIsectAlongRingAndEdge2=i,this.ringAndEdge1Walkable=o,this.ringAndEdge2Walkable=a};Number.prototype.modulo=function(t){return(this%t+t)%t};var ga=Math.PI/180,ya=180/Math.PI,ma=function(t,e){this.lon=t,this.lat=e,this.x=ga*t,this.y=ga*e};ma.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},ma.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new ma(e,t)};var va=function(){this.coords=[],this.length=0};va.prototype.move_to=function(t){this.length++,this.coords.push(t)};var _a=function(t){this.properties=t||{},this.geometries=[]};_a.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},_a.prototype.wkt=function(){for(var t="",e="LINESTRING(",n=function(t){e+=t[0]+" "+t[1]+","},r=0;r<this.geometries.length;r++){if(0===this.geometries[r].coords.length)return"LINESTRING(empty)";this.geometries[r].coords.forEach(n),t+=e.substring(0,e.length-1)+")"}return t};var ba=function(t,e,n){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new ma(t.x,t.y),this.end=new ma(e.x,e.y),this.properties=n||{};var r=this.start.x-this.end.x,i=this.start.y-this.end.y,o=Math.pow(Math.sin(i/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};ba.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),n=Math.sin(t*this.g)/Math.sin(this.g),r=e*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),i=e*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+n*Math.sin(this.end.y),a=ya*Math.atan2(o,Math.sqrt(Math.pow(r,2)+Math.pow(i,2)));return[ya*Math.atan2(i,r),a]},ba.prototype.Arc=function(t,e){var n=[];if(!t||t<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var r=1/(t-1),i=0;i<t;++i){var o=r*i,a=this.interpolate(o);n.push(a)}for(var s=!1,l=0,u=e&&e.offset?e.offset:10,c=180-u,h=-180+u,f=360-u,p=1;p<n.length;++p){var d=n[p-1][0],g=n[p][0],y=Math.abs(g-d);y>f&&(g>c&&d<h||d>c&&g<h)?s=!0:y>l&&(l=y)}var m=[];if(s&&l<u){var v=[];m.push(v);for(var _=0;_<n.length;++_){var b=parseFloat(n[_][0]);if(_>0&&Math.abs(b-n[_-1][0])>f){var w=parseFloat(n[_-1][0]),x=parseFloat(n[_-1][1]),L=parseFloat(n[_][0]),E=parseFloat(n[_][1]);if(w>-180&&w<h&&180===L&&_+1<n.length&&n[_-1][0]>-180&&n[_-1][0]<h){v.push([-180,n[_][1]]),_++,v.push([n[_][0],n[_][1]]);continue}if(w>c&&w<180&&-180===L&&_+1<n.length&&n[_-1][0]>c&&n[_-1][0]<180){v.push([180,n[_][1]]),_++,v.push([n[_][0],n[_][1]]);continue}if(w<h&&L>c){var C=w;w=L,L=C;var k=x;x=E,E=k}if(w>c&&L<h&&(L+=360),w<=180&&L>=180&&w<L){var S=(180-w)/(L-w),P=S*E+(1-S)*x;v.push([n[_-1][0]>c?180:-180,P]),(v=[]).push([n[_-1][0]>c?-180:180,P]),m.push(v)}else v=[],m.push(v);v.push([b,n[_][1]])}else v.push([n[_][0],n[_][1]])}}else{var M=[];m.push(M);for(var T=0;T<n.length;++T)M.push([n[T][0],n[T][1]])}for(var O=new _a(this.properties),I=0;I<m.length;++I){var N=new va;O.geometries.push(N);for(var D=m[I],R=0;R<D.length;++R)N.move_to(D[R])}return O};var wa=Rn;Rn.polyline=Rn,Rn.polygon=function(t,e){var n,r,i,o,a,s,l;for(r=1;r<=8;r*=2){for(n=[],o=!(jn(i=t[t.length-1],e)&r),a=0;a<t.length;a++)(l=!(jn(s=t[a],e)&r))!==o&&n.push(An(i,s,r,e)),l&&n.push(s),i=s,o=l;if(!(t=n).length)break}return n};var xa=Array.prototype.slice,La={successCallback:null,verbose:!1,polygons:!1},Ea={},Ca=64,ka=16,Sa=4,Pa=1,Ma=[],Ta=[],Oa=[],Ia=[],Na=[],Da=[],Ra=[],Aa=[],ja=[],Ba=[],za=[],Fa=[],Ga=[],Ua=[],qa=[],Ha=[],Va=[],Ya=[],Wa=[],Xa=[],Za=[],Ka=[],Ja=[],Qa=[];Ra[85]=Ba[85]=-1,Aa[85]=za[85]=0,ja[85]=Fa[85]=1,Wa[85]=Ka[85]=1,Xa[85]=Ja[85]=0,Za[85]=Qa[85]=1,Ma[85]=Ia[85]=0,Ta[85]=Na[85]=-1,Oa[85]=qa[85]=0,Ha[85]=Ga[85]=0,Va[85]=Ua[85]=1,Da[85]=Ya[85]=1,Ka[1]=Ka[169]=0,Ja[1]=Ja[169]=-1,Qa[1]=Qa[169]=0,Ga[1]=Ga[169]=-1,Ua[1]=Ua[169]=0,qa[1]=qa[169]=0,Ba[4]=Ba[166]=0,za[4]=za[166]=-1,Fa[4]=Fa[166]=1,Ha[4]=Ha[166]=1,Va[4]=Va[166]=0,Ya[4]=Ya[166]=0,Ra[16]=Ra[154]=0,Aa[16]=Aa[154]=1,ja[16]=ja[154]=1,Ia[16]=Ia[154]=1,Na[16]=Na[154]=0,Da[16]=Da[154]=1,Wa[64]=Wa[106]=0,Xa[64]=Xa[106]=1,Za[64]=Za[106]=0,Ma[64]=Ma[106]=-1,Ta[64]=Ta[106]=0,Oa[64]=Oa[106]=1,Wa[2]=Wa[168]=0,Xa[2]=Xa[168]=-1,Za[2]=Za[168]=1,Ka[2]=Ka[168]=0,Ja[2]=Ja[168]=-1,Qa[2]=Qa[168]=0,Ga[2]=Ga[168]=-1,Ua[2]=Ua[168]=0,qa[2]=qa[168]=0,Ha[2]=Ha[168]=-1,Va[2]=Va[168]=0,Ya[2]=Ya[168]=1,Ra[8]=Ra[162]=0,Aa[8]=Aa[162]=-1,ja[8]=ja[162]=0,Ba[8]=Ba[162]=0,za[8]=za[162]=-1,Fa[8]=Fa[162]=1,Ga[8]=Ga[162]=1,Ua[8]=Ua[162]=0,qa[8]=qa[162]=1,Ha[8]=Ha[162]=1,Va[8]=Va[162]=0,Ya[8]=Ya[162]=0,Ra[32]=Ra[138]=0,Aa[32]=Aa[138]=1,ja[32]=ja[138]=1,Ba[32]=Ba[138]=0,za[32]=za[138]=1,Fa[32]=Fa[138]=0,Ma[32]=Ma[138]=1,Ta[32]=Ta[138]=0,Oa[32]=Oa[138]=0,Ia[32]=Ia[138]=1,Na[32]=Na[138]=0,Da[32]=Da[138]=1,Ka[128]=Ka[42]=0,Ja[128]=Ja[42]=1,Qa[128]=Qa[42]=1,Wa[128]=Wa[42]=0,Xa[128]=Xa[42]=1,Za[128]=Za[42]=0,Ma[128]=Ma[42]=-1,Ta[128]=Ta[42]=0,Oa[128]=Oa[42]=1,Ia[128]=Ia[42]=-1,Na[128]=Na[42]=0,Da[128]=Da[42]=0,Ba[5]=Ba[165]=-1,za[5]=za[165]=0,Fa[5]=Fa[165]=0,Ka[5]=Ka[165]=1,Ja[5]=Ja[165]=0,Qa[5]=Qa[165]=0,Ha[20]=Ha[150]=0,Va[20]=Va[150]=1,Ya[20]=Ya[150]=1,Ia[20]=Ia[150]=0,Na[20]=Na[150]=-1,Da[20]=Da[150]=1,Ra[80]=Ra[90]=-1,Aa[80]=Aa[90]=0,ja[80]=ja[90]=1,Wa[80]=Wa[90]=1,Xa[80]=Xa[90]=0,Za[80]=Za[90]=1,Ga[65]=Ga[105]=0,Ua[65]=Ua[105]=1,qa[65]=qa[105]=0,Ma[65]=Ma[105]=0,Ta[65]=Ta[105]=-1,Oa[65]=Oa[105]=0,Ra[160]=Ra[10]=-1,Aa[160]=Aa[10]=0,ja[160]=ja[10]=1,Ba[160]=Ba[10]=-1,za[160]=za[10]=0,Fa[160]=Fa[10]=0,Ka[160]=Ka[10]=1,Ja[160]=Ja[10]=0,Qa[160]=Qa[10]=0,Wa[160]=Wa[10]=1,Xa[160]=Xa[10]=0,Za[160]=Za[10]=1,Ha[130]=Ha[40]=0,Va[130]=Va[40]=1,Ya[130]=Ya[40]=1,Ga[130]=Ga[40]=0,Ua[130]=Ua[40]=1,qa[130]=qa[40]=0,Ma[130]=Ma[40]=0,Ta[130]=Ta[40]=-1,Oa[130]=Oa[40]=0,Ia[130]=Ia[40]=0,Na[130]=Na[40]=-1,Da[130]=Da[40]=1,Ba[37]=Ba[133]=0,za[37]=za[133]=1,Fa[37]=Fa[133]=1,Ka[37]=Ka[133]=0,Ja[37]=Ja[133]=1,Qa[37]=Qa[133]=0,Ma[37]=Ma[133]=-1,Ta[37]=Ta[133]=0,Oa[37]=Oa[133]=0,Ia[37]=Ia[133]=1,Na[37]=Na[133]=0,Da[37]=Da[133]=0,Ha[148]=Ha[22]=-1,Va[148]=Va[22]=0,Ya[148]=Ya[22]=0,Ka[148]=Ka[22]=0,Ja[148]=Ja[22]=-1,Qa[148]=Qa[22]=1,Wa[148]=Wa[22]=0,Xa[148]=Xa[22]=1,Za[148]=Za[22]=1,Ia[148]=Ia[22]=-1,Na[148]=Na[22]=0,Da[148]=Da[22]=1,Ra[82]=Ra[88]=0,Aa[82]=Aa[88]=-1,ja[82]=ja[88]=1,Ha[82]=Ha[88]=1,Va[82]=Va[88]=0,Ya[82]=Ya[88]=1,Ga[82]=Ga[88]=-1,Ua[82]=Ua[88]=0,qa[82]=qa[88]=1,Wa[82]=Wa[88]=0,Xa[82]=Xa[88]=-1,Za[82]=Za[88]=0,Ra[73]=Ra[97]=0,Aa[73]=Aa[97]=1,ja[73]=ja[97]=0,Ba[73]=Ba[97]=0,za[73]=za[97]=-1,Fa[73]=Fa[97]=0,Ga[73]=Ga[97]=1,Ua[73]=Ua[97]=0,qa[73]=qa[97]=0,Ma[73]=Ma[97]=1,Ta[73]=Ta[97]=0,Oa[73]=Oa[97]=1,Ra[145]=Ra[25]=0,Aa[145]=Aa[25]=-1,ja[145]=ja[25]=0,Ga[145]=Ga[25]=1,Ua[145]=Ua[25]=0,qa[145]=qa[25]=1,Ka[145]=Ka[25]=0,Ja[145]=Ja[25]=1,Qa[145]=Qa[25]=1,Ia[145]=Ia[25]=-1,Na[145]=Na[25]=0,Da[145]=Da[25]=0,Ba[70]=Ba[100]=0,za[70]=za[100]=1,Fa[70]=Fa[100]=0,Ha[70]=Ha[100]=-1,Va[70]=Va[100]=0,Ya[70]=Ya[100]=1,Wa[70]=Wa[100]=0,Xa[70]=Xa[100]=-1,Za[70]=Za[100]=1,Ma[70]=Ma[100]=1,Ta[70]=Ta[100]=0,Oa[70]=Oa[100]=0,Ba[101]=Ba[69]=0,za[101]=za[69]=1,Fa[101]=Fa[69]=0,Ma[101]=Ma[69]=1,Ta[101]=Ta[69]=0,Oa[101]=Oa[69]=0,Ka[149]=Ka[21]=0,Ja[149]=Ja[21]=1,Qa[149]=Qa[21]=1,Ia[149]=Ia[21]=-1,Na[149]=Na[21]=0,Da[149]=Da[21]=0,Ha[86]=Ha[84]=-1,Va[86]=Va[84]=0,Ya[86]=Ya[84]=1,Wa[86]=Wa[84]=0,Xa[86]=Xa[84]=-1,Za[86]=Za[84]=1,Ra[89]=Ra[81]=0,Aa[89]=Aa[81]=-1,ja[89]=ja[81]=0,Ga[89]=Ga[81]=1,Ua[89]=Ua[81]=0,qa[89]=qa[81]=1,Ra[96]=Ra[74]=0,Aa[96]=Aa[74]=1,ja[96]=ja[74]=0,Ba[96]=Ba[74]=-1,za[96]=za[74]=0,Fa[96]=Fa[74]=1,Wa[96]=Wa[74]=1,Xa[96]=Xa[74]=0,Za[96]=Za[74]=0,Ma[96]=Ma[74]=1,Ta[96]=Ta[74]=0,Oa[96]=Oa[74]=1,Ra[24]=Ra[146]=0,Aa[24]=Aa[146]=-1,ja[24]=ja[146]=1,Ha[24]=Ha[146]=1,Va[24]=Va[146]=0,Ya[24]=Ya[146]=1,Ga[24]=Ga[146]=0,Ua[24]=Ua[146]=1,qa[24]=qa[146]=1,Ia[24]=Ia[146]=0,Na[24]=Na[146]=-1,Da[24]=Da[146]=0,Ba[6]=Ba[164]=-1,za[6]=za[164]=0,Fa[6]=Fa[164]=1,Ha[6]=Ha[164]=-1,Va[6]=Va[164]=0,Ya[6]=Ya[164]=0,Ka[6]=Ka[164]=0,Ja[6]=Ja[164]=-1,Qa[6]=Qa[164]=1,Wa[6]=Wa[164]=1,Xa[6]=Xa[164]=0,Za[6]=Za[164]=0,Ga[129]=Ga[41]=0,Ua[129]=Ua[41]=1,qa[129]=qa[41]=1,Ka[129]=Ka[41]=0,Ja[129]=Ja[41]=1,Qa[129]=Qa[41]=0,Ma[129]=Ma[41]=-1,Ta[129]=Ta[41]=0,Oa[129]=Oa[41]=0,Ia[129]=Ia[41]=0,Na[129]=Na[41]=-1,Da[129]=Da[41]=0,Ha[66]=Ha[104]=0,Va[66]=Va[104]=1,Ya[66]=Ya[104]=0,Ga[66]=Ga[104]=-1,Ua[66]=Ua[104]=0,qa[66]=qa[104]=1,Wa[66]=Wa[104]=0,Xa[66]=Xa[104]=-1,Za[66]=Za[104]=0,Ma[66]=Ma[104]=0,Ta[66]=Ta[104]=-1,Oa[66]=Oa[104]=1,Ra[144]=Ra[26]=-1,Aa[144]=Aa[26]=0,ja[144]=ja[26]=0,Ka[144]=Ka[26]=1,Ja[144]=Ja[26]=0,Qa[144]=Qa[26]=1,Wa[144]=Wa[26]=0,Xa[144]=Xa[26]=1,Za[144]=Za[26]=1,Ia[144]=Ia[26]=-1,Na[144]=Na[26]=0,Da[144]=Da[26]=1,Ba[36]=Ba[134]=0,za[36]=za[134]=1,Fa[36]=Fa[134]=1,Ha[36]=Ha[134]=0,Va[36]=Va[134]=1,Ya[36]=Ya[134]=0,Ma[36]=Ma[134]=0,Ta[36]=Ta[134]=-1,Oa[36]=Oa[134]=1,Ia[36]=Ia[134]=1,Na[36]=Na[134]=0,Da[36]=Da[134]=0,Ra[9]=Ra[161]=-1,Aa[9]=Aa[161]=0,ja[9]=ja[161]=0,Ba[9]=Ba[161]=0,za[9]=za[161]=-1,Fa[9]=Fa[161]=0,Ga[9]=Ga[161]=1,Ua[9]=Ua[161]=0,qa[9]=qa[161]=0,Ka[9]=Ka[161]=1,Ja[9]=Ja[161]=0,Qa[9]=Qa[161]=1,Ra[136]=0,Aa[136]=1,ja[136]=1,Ba[136]=0,za[136]=1,Fa[136]=0,Ha[136]=-1,Va[136]=0,Ya[136]=1,Ga[136]=-1,Ua[136]=0,qa[136]=0,Ka[136]=0,Ja[136]=-1,Qa[136]=0,Wa[136]=0,Xa[136]=-1,Za[136]=1,Ma[136]=1,Ta[136]=0,Oa[136]=0,Ia[136]=1,Na[136]=0,Da[136]=1,Ra[34]=0,Aa[34]=-1,ja[34]=0,Ba[34]=0,za[34]=-1,Fa[34]=1,Ha[34]=1,Va[34]=0,Ya[34]=0,Ga[34]=1,Ua[34]=0,qa[34]=1,Ka[34]=0,Ja[34]=1,Qa[34]=1,Wa[34]=0,Xa[34]=1,Za[34]=0,Ma[34]=-1,Ta[34]=0,Oa[34]=1,Ia[34]=-1,Na[34]=0,Da[34]=0,Ra[35]=0,Aa[35]=1,ja[35]=1,Ba[35]=0,za[35]=-1,Fa[35]=1,Ha[35]=1,Va[35]=0,Ya[35]=0,Ga[35]=-1,Ua[35]=0,qa[35]=0,Ka[35]=0,Ja[35]=-1,Qa[35]=0,Wa[35]=0,Xa[35]=1,Za[35]=0,Ma[35]=-1,Ta[35]=0,Oa[35]=1,Ia[35]=1,Na[35]=0,Da[35]=1,Ra[153]=0,Aa[153]=1,ja[153]=1,Ga[153]=-1,Ua[153]=0,qa[153]=0,Ka[153]=0,Ja[153]=-1,Qa[153]=0,Ia[153]=1,Na[153]=0,Da[153]=1,Ba[102]=0,za[102]=-1,Fa[102]=1,Ha[102]=1,Va[102]=0,Ya[102]=0,Wa[102]=0,Xa[102]=1,Za[102]=0,Ma[102]=-1,Ta[102]=0,Oa[102]=1,Ra[155]=0,Aa[155]=-1,ja[155]=0,Ga[155]=1,Ua[155]=0,qa[155]=1,Ka[155]=0,Ja[155]=1,Qa[155]=1,Ia[155]=-1,Na[155]=0,Da[155]=0,Ba[103]=0,za[103]=1,Fa[103]=0,Ha[103]=-1,Va[103]=0,Ya[103]=1,Wa[103]=0,Xa[103]=-1,Za[103]=1,Ma[103]=1,Ta[103]=0,Oa[103]=0,Ra[152]=0,Aa[152]=1,ja[152]=1,Ha[152]=-1,Va[152]=0,Ya[152]=1,Ga[152]=-1,Ua[152]=0,qa[152]=0,Ka[152]=0,Ja[152]=-1,Qa[152]=0,Wa[152]=0,Xa[152]=-1,Za[152]=1,Ia[152]=1,Na[152]=0,Da[152]=1,Ra[156]=0,Aa[156]=-1,ja[156]=1,Ha[156]=1,Va[156]=0,Ya[156]=1,Ga[156]=-1,Ua[156]=0,qa[156]=0,Ka[156]=0,Ja[156]=-1,Qa[156]=0,Wa[156]=0,Xa[156]=1,Za[156]=1,Ia[156]=-1,Na[156]=0,Da[156]=1,Ra[137]=0,Aa[137]=1,ja[137]=1,Ba[137]=0,za[137]=1,Fa[137]=0,Ga[137]=-1,Ua[137]=0,qa[137]=0,Ka[137]=0,Ja[137]=-1,Qa[137]=0,Ma[137]=1,Ta[137]=0,Oa[137]=0,Ia[137]=1,Na[137]=0,Da[137]=1,Ra[139]=0,Aa[139]=1,ja[139]=1,Ba[139]=0,za[139]=-1,Fa[139]=0,Ga[139]=1,Ua[139]=0,qa[139]=0,Ka[139]=0,Ja[139]=1,Qa[139]=0,Ma[139]=-1,Ta[139]=0,Oa[139]=0,Ia[139]=1,Na[139]=0,Da[139]=1,Ra[98]=0,Aa[98]=-1,ja[98]=0,Ba[98]=0,za[98]=-1,Fa[98]=1,Ha[98]=1,Va[98]=0,Ya[98]=0,Ga[98]=1,Ua[98]=0,qa[98]=1,Wa[98]=0,Xa[98]=1,Za[98]=0,Ma[98]=-1,Ta[98]=0,Oa[98]=1,Ra[99]=0,Aa[99]=1,ja[99]=0,Ba[99]=0,za[99]=-1,Fa[99]=1,Ha[99]=1,Va[99]=0,Ya[99]=0,Ga[99]=-1,Ua[99]=0,qa[99]=1,Wa[99]=0,Xa[99]=-1,Za[99]=0,Ma[99]=1,Ta[99]=0,Oa[99]=1,Ba[38]=0,za[38]=-1,Fa[38]=1,Ha[38]=1,Va[38]=0,Ya[38]=0,Ka[38]=0,Ja[38]=1,Qa[38]=1,Wa[38]=0,Xa[38]=1,Za[38]=0,Ma[38]=-1,Ta[38]=0,Oa[38]=1,Ia[38]=-1,Na[38]=0,Da[38]=0,Ba[39]=0,za[39]=1,Fa[39]=1,Ha[39]=-1,Va[39]=0,Ya[39]=0,Ka[39]=0,Ja[39]=-1,Qa[39]=1,Wa[39]=0,Xa[39]=1,Za[39]=0,Ma[39]=-1,Ta[39]=0,Oa[39]=1,Ia[39]=1,Na[39]=0,Da[39]=0;var $a=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},ts=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},es=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},ns=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},rs=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},is=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},os=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},as=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},ss=[],ls=[],us=[],cs=[],hs=[],fs=[],ps=[],ds=[];cs[1]=hs[1]=18,cs[169]=hs[169]=18,us[4]=ls[4]=12,us[166]=ls[166]=12,ss[16]=ds[16]=4,ss[154]=ds[154]=4,fs[64]=ps[64]=22,fs[106]=ps[106]=22,us[2]=fs[2]=17,cs[2]=hs[2]=18,us[168]=fs[168]=17,cs[168]=hs[168]=18,ss[8]=cs[8]=9,ls[8]=us[8]=12,ss[162]=cs[162]=9,ls[162]=us[162]=12,ss[32]=ds[32]=4,ls[32]=ps[32]=1,ss[138]=ds[138]=4,ls[138]=ps[138]=1,hs[128]=ds[128]=21,fs[128]=ps[128]=22,hs[42]=ds[42]=21,fs[42]=ps[42]=22,ls[5]=hs[5]=14,ls[165]=hs[165]=14,us[20]=ds[20]=6,us[150]=ds[150]=6,ss[80]=fs[80]=11,ss[90]=fs[90]=11,cs[65]=ps[65]=3,cs[105]=ps[105]=3,ss[160]=fs[160]=11,ls[160]=hs[160]=14,ss[10]=fs[10]=11,ls[10]=hs[10]=14,us[130]=ds[130]=6,cs[130]=ps[130]=3,us[40]=ds[40]=6,cs[40]=ps[40]=3,ls[101]=ps[101]=1,ls[69]=ps[69]=1,hs[149]=ds[149]=21,hs[21]=ds[21]=21,us[86]=fs[86]=17,us[84]=fs[84]=17,ss[89]=cs[89]=9,ss[81]=cs[81]=9,ss[96]=ps[96]=0,ls[96]=fs[96]=15,ss[74]=ps[74]=0,ls[74]=fs[74]=15,ss[24]=us[24]=8,cs[24]=ds[24]=7,ss[146]=us[146]=8,cs[146]=ds[146]=7,ls[6]=fs[6]=15,us[6]=hs[6]=16,ls[164]=fs[164]=15,us[164]=hs[164]=16,cs[129]=ds[129]=7,hs[129]=ps[129]=20,cs[41]=ds[41]=7,hs[41]=ps[41]=20,us[66]=ps[66]=2,cs[66]=fs[66]=19,us[104]=ps[104]=2,cs[104]=fs[104]=19,ss[144]=hs[144]=10,fs[144]=ds[144]=23,ss[26]=hs[26]=10,fs[26]=ds[26]=23,ls[36]=ds[36]=5,us[36]=ps[36]=2,ls[134]=ds[134]=5,us[134]=ps[134]=2,ss[9]=hs[9]=10,ls[9]=cs[9]=13,ss[161]=hs[161]=10,ls[161]=cs[161]=13,ls[37]=ds[37]=5,hs[37]=ps[37]=20,ls[133]=ds[133]=5,hs[133]=ps[133]=20,us[148]=hs[148]=16,fs[148]=ds[148]=23,us[22]=hs[22]=16,fs[22]=ds[22]=23,ss[82]=us[82]=8,cs[82]=fs[82]=19,ss[88]=us[88]=8,cs[88]=fs[88]=19,ss[73]=ps[73]=0,ls[73]=cs[73]=13,ss[97]=ps[97]=0,ls[97]=cs[97]=13,ss[145]=cs[145]=9,hs[145]=ds[145]=21,ss[25]=cs[25]=9,hs[25]=ds[25]=21,ls[70]=ps[70]=1,us[70]=fs[70]=17,ls[100]=ps[100]=1,us[100]=fs[100]=17,ss[34]=cs[34]=9,ls[34]=us[34]=12,hs[34]=ds[34]=21,fs[34]=ps[34]=22,ss[136]=ds[136]=4,ls[136]=ps[136]=1,us[136]=fs[136]=17,cs[136]=hs[136]=18,ss[35]=ds[35]=4,ls[35]=us[35]=12,cs[35]=hs[35]=18,fs[35]=ps[35]=22,ss[153]=ds[153]=4,cs[153]=hs[153]=18,ls[102]=us[102]=12,fs[102]=ps[102]=22,ss[155]=cs[155]=9,hs[155]=ds[155]=23,ls[103]=ps[103]=1,us[103]=fs[103]=17,ss[152]=ds[152]=4,us[152]=fs[152]=17,cs[152]=hs[152]=18,ss[156]=us[156]=8,cs[156]=hs[156]=18,fs[156]=ds[156]=23,ss[137]=ds[137]=4,ls[137]=ps[137]=1,cs[137]=hs[137]=18,ss[139]=ds[139]=4,ls[139]=cs[139]=13,hs[139]=ps[139]=20,ss[98]=cs[98]=9,ls[98]=us[98]=12,fs[98]=ps[98]=22,ss[99]=ps[99]=0,ls[99]=us[99]=12,cs[99]=fs[99]=19,ls[38]=us[38]=12,hs[38]=ds[38]=21,fs[38]=ps[38]=22,ls[39]=ds[39]=5,us[39]=hs[39]=16,fs[39]=ps[39]=22;var gs=[];gs[1]=gs[169]=$a,gs[4]=gs[166]=ts,gs[16]=gs[154]=es,gs[64]=gs[106]=ns,gs[168]=gs[2]=rs,gs[162]=gs[8]=is,gs[138]=gs[32]=os,gs[42]=gs[128]=as,gs[5]=gs[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},gs[20]=gs[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},gs[80]=gs[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},gs[65]=gs[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},gs[160]=gs[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},gs[130]=gs[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},gs[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},gs[101]=gs[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},gs[149]=gs[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},gs[86]=gs[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},gs[89]=gs[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},gs[96]=gs[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},gs[24]=gs[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},gs[6]=gs[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},gs[129]=gs[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},gs[66]=gs[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},gs[144]=gs[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},gs[36]=gs[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},gs[9]=gs[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},gs[37]=gs[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},gs[148]=gs[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},gs[82]=gs[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},gs[73]=gs[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},gs[145]=gs[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},gs[70]=gs[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},gs[34]=function(t){return[as(t),is(t)]},gs[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},gs[136]=function(t){return[os(t),rs(t)]},gs[153]=function(t){return[es(t),$a(t)]},gs[102]=function(t){return[ts(t),ns(t)]},gs[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},gs[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},gs[152]=function(t){return[es(t),rs(t)]},gs[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},gs[137]=function(t){return[os(t),$a(t)]},gs[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},gs[98]=function(t){return[is(t),ns(t)]},gs[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},gs[38]=function(t){return[ts(t),as(t)]},gs[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};var ys=function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1};ys.buildId=function(t){return t.join(",")},ys.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter((function(e){return e.from.id!==t.from.id}))},ys.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter((function(e){return e.to.id!==t.to.id}))},ys.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},ys.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort((function(e,n){var r=e.to,i=n.to;if(r.coordinates[0]-t.coordinates[0]>=0&&i.coordinates[0]-t.coordinates[0]<0)return 1;if(r.coordinates[0]-t.coordinates[0]<0&&i.coordinates[0]-t.coordinates[0]>=0)return-1;if(r.coordinates[0]-t.coordinates[0]==0&&i.coordinates[0]-t.coordinates[0]==0)return r.coordinates[1]-t.coordinates[1]>=0||i.coordinates[1]-t.coordinates[1]>=0?r.coordinates[1]-i.coordinates[1]:i.coordinates[1]-r.coordinates[1];var o=lr(t.coordinates,r.coordinates,i.coordinates);return o<0?1:o>0?-1:Math.pow(r.coordinates[0]-t.coordinates[0],2)+Math.pow(r.coordinates[1]-t.coordinates[1],2)-(Math.pow(i.coordinates[0]-t.coordinates[0],2)+Math.pow(i.coordinates[1]-t.coordinates[1],2))})),this.outerEdgesSorted=!0)},ys.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},ys.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},ys.prototype.addInnerEdge=function(t){this.innerEdges.push(t)};var ms=function(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)};ms.prototype.getSymetric=function(){return this.symetric||(this.symetric=new ms(this.to,this.from),this.symetric.symetric=this),this.symetric},ms.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},ms.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},ms.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},ms.prototype.toLineString=function(){return s([this.from.coordinates,this.to.coordinates])},ms.prototype.compareTo=function(t){return lr(t.from.coordinates,t.to.coordinates,this.to.coordinates)};var vs=function(){this.edges=[],this.polygon=void 0,this.envelope=void 0},_s={length:{configurable:!0}};vs.prototype.push=function(t){this[this.edges.length]=t,this.edges.push(t),this.polygon=this.envelope=void 0},vs.prototype.get=function(t){return this.edges[t]},_s.length.get=function(){return this.edges.length},vs.prototype.forEach=function(t){this.edges.forEach(t)},vs.prototype.map=function(t){return this.edges.map(t)},vs.prototype.some=function(t){return this.edges.some(t)},vs.prototype.isValid=function(){return!0},vs.prototype.isHole=function(){var t=this,e=this.edges.reduce((function(e,n,r){return n.from.coordinates[1]>t.edges[e].from.coordinates[1]&&(e=r),e}),0),n=(0===e?this.length:e)-1,r=(e+1)%this.length,i=lr(this.edges[n].from.coordinates,this.edges[e].from.coordinates,this.edges[r].from.coordinates);return 0===i?this.edges[n].from.coordinates[0]>this.edges[r].from.coordinates[0]:i>0},vs.prototype.toMultiPoint=function(){return h(this.edges.map((function(t){return t.from.coordinates})))},vs.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map((function(t){return t.from.coordinates}));return t.push(this.edges[0].from.coordinates),this.polygon=o([t])},vs.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=ie(this.toPolygon())},vs.findEdgeRingContaining=function(t,e){var n,i,o=t.getEnvelope();return e.forEach((function(e){var a=e.getEnvelope();if(i&&(n=i.getEnvelope()),!function(t,e){var n=t.geometry.coordinates.map((function(t){return t[0]})),r=t.geometry.coordinates.map((function(t){return t[1]})),i=e.geometry.coordinates.map((function(t){return t[0]})),o=e.geometry.coordinates.map((function(t){return t[1]}));return Math.max(null,n)===Math.max(null,i)&&Math.max(null,r)===Math.max(null,o)&&Math.min(null,n)===Math.min(null,i)&&Math.min(null,r)===Math.min(null,o)}(a,o)&&ur(a,o)){var s=t.map((function(t){return t.from.coordinates})).find((function(t){return!e.some((function(e){return function(t,e){return t[0]===e[0]&&t[1]===e[1]}(t,e.from.coordinates)}))}));s&&e.inside(r(s))&&(i&&!ur(n,a)||(i=e))}})),i},vs.prototype.inside=function(t){return Pt(t,this.toPolygon())},Object.defineProperties(vs.prototype,_s);var bs=function(){this.edges=[],this.nodes={}};bs.fromGeoJson=function(t){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(t);var e=new bs;return A(t,(function(t){W(t,"LineString","Graph::fromGeoJson"),P(t,(function(t,n){if(t){var r=e.getNode(t),i=e.getNode(n);e.addEdge(r,i)}return n}))})),e},bs.prototype.getNode=function(t){var e=ys.buildId(t),n=this.nodes[e];return n||(n=this.nodes[e]=new ys(t)),n},bs.prototype.addEdge=function(t,e){var n=new ms(t,e),r=n.getSymetric();this.edges.push(n),this.edges.push(r)},bs.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map((function(e){return t.nodes[e]})).forEach((function(e){return t._removeIfDangle(e)}))},bs.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var n=t.getOuterEdges().map((function(t){return t.to}));this.removeNode(t),n.forEach((function(t){return e._removeIfDangle(t)}))}},bs.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach((function(e){e.label===e.symetric.label&&(t.removeEdge(e.symetric),t.removeEdge(e))}))},bs.prototype._computeNextCWEdges=function(t){var e=this;void 0===t?Object.keys(this.nodes).forEach((function(t){return e._computeNextCWEdges(e.nodes[t])})):t.getOuterEdges().forEach((function(e,n){t.getOuterEdge((0===n?t.getOuterEdges().length:n)-1).symetric.next=e}))},bs.prototype._computeNextCCWEdges=function(t,e){for(var n,r,i=t.getOuterEdges(),o=i.length-1;o>=0;--o){var a=i[o],s=a.symetric,l=void 0,u=void 0;a.label===e&&(l=a),s.label===e&&(u=s),l&&u&&(u&&(r=u),l&&(r&&(r.next=l,r=void 0),n||(n=l)))}r&&(r.next=n)},bs.prototype._findLabeledEdgeRings=function(){var t=[],e=0;return this.edges.forEach((function(n){if(!(n.label>=0)){t.push(n);var r=n;do{r.label=e,r=r.next}while(!n.isEqual(r));e++}})),t},bs.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach((function(t){t.label=void 0})),this._findLabeledEdgeRings().forEach((function(e){t._findIntersectionNodes(e).forEach((function(n){t._computeNextCCWEdges(n,e.label)}))}));var e=[];return this.edges.forEach((function(n){n.ring||e.push(t._findEdgeRing(n))})),e},bs.prototype._findIntersectionNodes=function(t){var e=[],n=t,r=function(){var r=0;n.from.getOuterEdges().forEach((function(e){e.label===t.label&&++r})),r>1&&e.push(n.from),n=n.next};do{r()}while(!t.isEqual(n));return e},bs.prototype._findEdgeRing=function(t){var e=t,n=new vs;do{n.push(e),e.ring=n,e=e.next}while(!t.isEqual(e));return n},bs.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach((function(t){return e.removeEdge(t)})),t.innerEdges.forEach((function(t){return e.removeEdge(t)})),delete this.nodes[t.id]},bs.prototype.removeEdge=function(t){this.edges=this.edges.filter((function(e){return!e.isEqual(t)})),t.deleteEdge()};var ws=yt((function(t,e){function n(t){var e=[];for(var n in t)e.push(n);return e}(t.exports="function"==typeof Object.keys?Object.keys:n).shim=n})),xs=(ws.shim,yt((function(t,e){function n(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function r(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}var i="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();(e=t.exports=i?n:r).supported=n,e.unsupported=r}))),Ls=(xs.supported,xs.unsupported,yt((function(t){function e(t){return null==t}function n(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}var r=Array.prototype.slice,i=t.exports=function(t,o,a){return a||(a={}),t===o||(t instanceof Date&&o instanceof Date?t.getTime()===o.getTime():!t||!o||"object"!=typeof t&&"object"!=typeof o?a.strict?t===o:t==o:function(t,o,a){var s,l;if(e(t)||e(o))return!1;if(t.prototype!==o.prototype)return!1;if(xs(t))return!!xs(o)&&(t=r.call(t),o=r.call(o),i(t,o,a));if(n(t)){if(!n(o))return!1;if(t.length!==o.length)return!1;for(s=0;s<t.length;s++)if(t[s]!==o[s])return!1;return!0}try{var u=ws(t),c=ws(o)}catch(t){return!1}if(u.length!=c.length)return!1;for(u.sort(),c.sort(),s=u.length-1;s>=0;s--)if(u[s]!=c[s])return!1;for(s=u.length-1;s>=0;s--)if(l=u[s],!i(t[l],o[l],a))return!1;return typeof t==typeof o}(t,o,a))}}))),Es=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:br};Es.prototype.compare=function(t,e){if(t.type!==e.type||!_r(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var n=this,r=vr(t),i=vr(e);return r.every((function(t){return this.some((function(e){return n.compare(t,e)}))}),i)}}return!1},Es.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toFixed(this.precision)!==e[n].toFixed(this.precision))return!1;return!0},Es.prototype.compareLine=function(t,e,n,r){if(!_r(t,e))return!1;var i=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!r||this.compareCoord(i[0],o[0])||(o=this.fixStartIndex(o,i))){var a=this.compareCoord(i[n],o[n]);return this.direction||a?this.comparePath(i,o):!!this.compareCoord(i[n],o[o.length-(1+n)])&&this.comparePath(i.slice().reverse(),o)}},Es.prototype.fixStartIndex=function(t,e){for(var n,r=-1,i=0;i<t.length;i++)if(this.compareCoord(t[i],e[0])){r=i;break}return r>=0&&(n=[].concat(t.slice(r,t.length),t.slice(1,r+1))),n},Es.prototype.comparePath=function(t,e){var n=this;return t.every((function(t,e){return n.compareCoord(t,this[e])}),e)},Es.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var n=t.coordinates.slice(1,t.coordinates.length),r=e.coordinates.slice(1,e.coordinates.length),i=this;return n.every((function(t){return this.some((function(e){return i.compareLine(t,e,1,!0)}))}),r)}return!1},Es.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},Es.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},Es.prototype.removePseudo=function(t){return t};var Cs=Es,ks=yt((function(t){function e(t,e,n,r){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,n,r)}e.prototype.run=function(t,e,n,r){this._init(t,e,n,r);for(var i=0;i<this._datasetLength;i++)if(1!==this._visited[i]){this._visited[i]=1;var o=this._regionQuery(i);if(o.length<this.minPts)this.noise.push(i);else{var a=this.clusters.length;this.clusters.push([]),this._addToCluster(i,a),this._expandCluster(a,o)}}return this.clusters},e.prototype._init=function(t,e,n,r){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),n&&(this.minPts=n),r&&(this.distance=r)},e.prototype._expandCluster=function(t,e){for(var n=0;n<e.length;n++){var r=e[n];if(1!==this._visited[r]){this._visited[r]=1;var i=this._regionQuery(r);i.length>=this.minPts&&(e=this._mergeArrays(e,i))}1!==this._assigned[r]&&this._addToCluster(r,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],n=0;n<this._datasetLength;n++)this.distance(this.dataset[t],this.dataset[n])<this.epsilon&&e.push(n);return e},e.prototype._mergeArrays=function(t,e){for(var n=e.length,r=0;r<n;r++){var i=e[r];t.indexOf(i)<0&&t.push(i)}return t},e.prototype._euclideanDistance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;)n+=(t[r]-e[r])*(t[r]-e[r]);return Math.sqrt(n)},t.exports&&(t.exports=e)})),Ss=yt((function(t){function e(t,e,n){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,n)}e.prototype.init=function(t,e,n){this.assignments=[],this.centroids=[],void 0!==t&&(this.dataset=t),void 0!==e&&(this.k=e),void 0!==n&&(this.distance=n)},e.prototype.run=function(t,e){this.init(t,e);for(var n=this.dataset.length,r=0;r<this.k;r++)this.centroids[r]=this.randomCentroid();for(var i=!0;i;){i=this.assign();for(var o=0;o<this.k;o++){for(var a=new Array(c),s=0,l=0;l<c;l++)a[l]=0;for(var u=0;u<n;u++){var c=this.dataset[u].length;if(o===this.assignments[u]){for(l=0;l<c;l++)a[l]+=this.dataset[u][l];s++}}if(s>0){for(l=0;l<c;l++)a[l]/=s;this.centroids[o]=a}else this.centroids[o]=this.randomCentroid(),i=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){var t,e,n=this.dataset.length-1;do{e=Math.round(Math.random()*n),t=this.dataset[e]}while(this.centroids.indexOf(t)>=0);return t},e.prototype.assign=function(){for(var t,e=!1,n=this.dataset.length,r=0;r<n;r++)(t=this.argmin(this.dataset[r],this.centroids,this.distance))!=this.assignments[r]&&(this.assignments[r]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),n=0;n<this.assignments.length;n++)void 0===e[t=this.assignments[n]]&&(e[t]=[]),e[t].push(n);return e},e.prototype.argmin=function(t,e,n){for(var r,i=Number.MAX_VALUE,o=0,a=e.length,s=0;s<a;s++)(r=n(t,e[s]))<i&&(i=r,o=s);return o},e.prototype.distance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;){var i=t[r]-e[r];n+=i*i}return Math.sqrt(n)},t.exports&&(t.exports=e)})),Ps=yt((function(t){function e(t,e,n){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,n)}e.prototype.insert=function(t,e){for(var n=this._queue.length,r=n;r--;){var i=this._priorities[r];"desc"===this._sorting?e>i&&(n=r):e<i&&(n=r)}this._insertAt(t,e,n)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;)if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,n=this._queue.length;e<n;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,n){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var r=0;r<t.length;r++)this.insert(t[r],e[r])}n&&(this._sorting=n)},e.prototype._insertAt=function(t,e,n){this._queue.length===n?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(n,0,t),this._priorities.splice(n,0,e))},t.exports&&(t.exports=e)})),Ms=yt((function(t){function e(t,e,n,r){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,n,r)}if(t.exports)var n=Ps;e.prototype.run=function(t,e,r,i){this._init(t,e,r,i);for(var o=0,a=this.dataset.length;o<a;o++)if(1!==this._processed[o]){this._processed[o]=1,this.clusters.push([o]);var s=this.clusters.length-1;this._orderedList.push(o);var l=new n(null,null,"asc"),u=this._regionQuery(o);void 0!==this._distanceToCore(o)&&(this._updateQueue(o,u,l),this._expandCluster(s,l))}return this.clusters},e.prototype.getReachabilityPlot=function(){for(var t=[],e=0,n=this._orderedList.length;e<n;e++){var r=this._orderedList[e],i=this._reachability[r];t.push([r,i])}return t},e.prototype._init=function(t,e,n,r){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),n&&(this.minPts=n),r&&(this.distance=r)},e.prototype._updateQueue=function(t,e,n){var r=this;this._coreDistance=this._distanceToCore(t),e.forEach((function(e){if(void 0===r._processed[e]){var i=r.distance(r.dataset[t],r.dataset[e]),o=Math.max(r._coreDistance,i);void 0===r._reachability[e]?(r._reachability[e]=o,n.insert(e,o)):o<r._reachability[e]&&(r._reachability[e]=o,n.remove(e),n.insert(e,o))}}))},e.prototype._expandCluster=function(t,e){for(var n=e.getElements(),r=0,i=n.length;r<i;r++){var o=n[r];if(void 0===this._processed[o]){var a=this._regionQuery(o);this._processed[o]=1,this.clusters[t].push(o),this._orderedList.push(o),void 0!==this._distanceToCore(o)&&(this._updateQueue(o,a,e),this._expandCluster(t,e))}}},e.prototype._distanceToCore=function(t){for(var e=this.epsilon,n=0;n<e;n++)if(this._regionQuery(t,n).length>=this.minPts)return n},e.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var n=[],r=0,i=this.dataset.length;r<i;r++)this.distance(this.dataset[t],this.dataset[r])<e&&n.push(r);return n},e.prototype._euclideanDistance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;)n+=(t[r]-e[r])*(t[r]-e[r]);return Math.sqrt(n)},t.exports&&(t.exports=e)})),Ts=yt((function(t){t.exports&&(t.exports={DBSCAN:ks,KMEANS:Ss,OPTICS:Ms,PriorityQueue:Ps})})),Os=(Ts.DBSCAN,Ts.KMEANS,Ts.OPTICS,Ts.PriorityQueue,function(t,e,n){for(var r=t.length,i=0,o=0;o<r;o++){var a=(t[o]||0)-(e[o]||0);i+=a*a}return n?Math.sqrt(i):i}),Is=Os,Ns=function(t,e,n){var r=Math.abs(t-e);return n?r:r*r},Ds=Os,Rs=function(t,e,n,r){var i=[],o=[],a=[],s=[],l=!1,u=r||1e4,c=t.length,h=t[0].length,f=h>0,p=[];if(n)i="kmrand"==n?function(t,e){for(var n={},r=[],i=e<<2,o=t.length,a=t[0].length>0;r.length<e&&i-- >0;){var s=t[Math.floor(Math.random()*o)],l=a?s.join("_"):""+s;n[l]||(n[l]=!0,r.push(s))}if(r.length<e)throw new Error("Error initializating clusters");return r}(t,e):"kmpp"==n?function(t,e){var n=t[0].length?Is:Ns,r=[],i=t.length,o=t[0].length>0,a=t[Math.floor(Math.random()*i)];for(o&&a.join("_"),r.push(a);r.length<e;){for(var s=[],l=r.length,u=0,c=[],h=0;h<i;h++){for(var f=1/0,p=0;p<l;p++){var d=n(t[h],r[p]);d<=f&&(f=d)}s[h]=f}for(var g=0;g<i;g++)u+=s[g];for(var y=0;y<i;y++)c[y]={i:y,v:t[y],pr:s[y]/u,cs:0};c.sort((function(t,e){return t.pr-e.pr})),c[0].cs=c[0].pr;for(var m=1;m<i;m++)c[m].cs=c[m-1].cs+c[m].pr;for(var v=Math.random(),_=0;_<i-1&&c[_++].cs<v;);r.push(c[_-1].v)}return r}(t,e):n;else for(var d={};i.length<e;){var g=Math.floor(Math.random()*c);d[g]||(d[g]=!0,i.push(t[g]))}do{xr(e,0,p);for(var y=0;y<c;y++){for(var m=1/0,v=0,_=0;_<e;_++)(s=f?Ds(t[y],i[_]):Math.abs(t[y]-i[_]))<=m&&(m=s,v=_);a[y]=v,p[v]++}for(var b=[],w=(o=[],0);w<e;w++)b[w]=f?xr(h,0,b[w]):0,o[w]=i[w];if(f){for(var x=0;x<e;x++)i[x]=[];for(var L=0;L<c;L++)for(var E=b[a[L]],C=t[L],k=0;k<h;k++)E[k]+=C[k];l=!0;for(var S=0;S<e;S++){for(var P=i[S],M=b[S],T=o[S],O=p[S],I=0;I<h;I++)P[I]=M[I]/O||0;if(l)for(var N=0;N<h;N++)if(T[N]!=P[N]){l=!1;break}}}else{for(var D=0;D<c;D++)b[a[D]]+=t[D];for(var R=0;R<e;R++)i[R]=b[R]/p[R]||0;l=!0;for(var A=0;A<e;A++)if(o[A]!=i[A]){l=!1;break}}l=l||--u<=0}while(!l);return{it:1e4-u,k:e,idxs:a,centroids:i}},As={search:function(t,e,n,r){t.cleanDirty();var i=(r=r||{}).heuristic||As.heuristics.manhattan,o=r.closest||!1,a=new Sr((function(t){return t.f})),s=e;for(e.h=i(e,n),a.push(e);a.size()>0;){var l=a.pop();if(l===n)return Er(l);l.closed=!0;for(var u=t.neighbors(l),c=0,h=u.length;c<h;++c){var f=u[c];if(!f.closed&&!f.isWall()){var p=l.g+f.getCost(l),d=f.visited;(!d||p<f.g)&&(f.visited=!0,f.parent=l,f.h=f.h||i(f,n),f.g=p,f.f=f.g+f.h,t.markDirty(f),o&&(f.h<s.h||f.h===s.h&&f.g<s.g)&&(s=f),d?a.rescoreElement(f):a.push(f))}}}return o?Er(s):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var n=Math.sqrt(2),r=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return 1*(r+i)+(n-2)*Math.min(r,i)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};Cr.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)As.cleanNode(this.nodes[t])},Cr.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)As.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},Cr.prototype.markDirty=function(t){this.dirtyNodes.push(t)},Cr.prototype.neighbors=function(t){var e=[],n=t.x,r=t.y,i=this.grid;return i[n-1]&&i[n-1][r]&&e.push(i[n-1][r]),i[n+1]&&i[n+1][r]&&e.push(i[n+1][r]),i[n]&&i[n][r-1]&&e.push(i[n][r-1]),i[n]&&i[n][r+1]&&e.push(i[n][r+1]),this.diagonal&&(i[n-1]&&i[n-1][r-1]&&e.push(i[n-1][r-1]),i[n+1]&&i[n+1][r-1]&&e.push(i[n+1][r-1]),i[n-1]&&i[n-1][r+1]&&e.push(i[n-1][r+1]),i[n+1]&&i[n+1][r+1]&&e.push(i[n+1][r+1])),e},Cr.prototype.toString=function(){for(var t,e,n,r,i=[],o=this.grid,a=0,s=o.length;a<s;a++){for(t=[],n=0,r=(e=o[a]).length;n<r;n++)t.push(e[n].weight);i.push(t.join(" "))}return i.join("\n")},kr.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},kr.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},kr.prototype.isWall=function(){return 0===this.weight},Sr.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),n=this.content.pop();e!==this.content.length-1&&(this.content[e]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];t>0;){var n=(t+1>>1)-1,r=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(r)))break;this.content[n]=e,this.content[t]=r,t=n}},bubbleUp:function(t){for(var e=this.content.length,n=this.content[t],r=this.scoreFunction(n);;){var i,o=t+1<<1,a=o-1,s=null;if(a<e){var l=this.content[a];(i=this.scoreFunction(l))<r&&(s=a)}if(o<e){var u=this.content[o];this.scoreFunction(u)<(null===s?r:i)&&(s=o)}if(null===s)break;this.content[t]=this.content[s],this.content[s]=n,t=s}}};var js=function(t){return function(){return t}};Tr.prototype={constructor:Tr,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Dr(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Ir(this,n),n=(t=n).U),n.C=!1,r.C=!0,Nr(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Nr(this,n),n=(t=n).U),n.C=!1,r.C=!0,Ir(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,a=t.R;if(n=o?a?Dr(a):o:a,i?i.L===t?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=a,a.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,Ir(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Nr(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,Ir(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,Nr(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Ir(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,Nr(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var Bs,zs,Fs,Gs,Us,qs=[],Hs=[],Vs=1e-6,Ys=1e-12;Qr.prototype={constructor:Qr,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return Gr(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(o=(i=n.halfedges).length)for(var i,o,a,s=n.site,l=-1,u=e[i[o-1]],c=u.left===s?u.right:u.left;++l<o;)a=c,c=(u=e[i[l]]).left===s?u.right:u.left,a&&c&&r<a.index&&r<c.index&&Kr(s,a,c)<0&&t.push([s.data,a.data,c.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var l=t-i.site[0],u=e-i.site[1],c=l*l+u*u;do{i=o.cells[r=a],a=null,i.halfedges.forEach((function(n){var r=o.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var l=t-s[0],u=e-s[1],h=l*l+u*u;h<c&&(c=h,a=s.index)}}))}while(null!==a);return o._found=r,null==n||c<=n*n?i.site:null}};var Ws=Object.freeze({randomPosition:oi,randomPoint:ai,randomPolygon:si,randomLineString:li}),Xs=Object.freeze({getCluster:ci,clusterEach:hi,clusterReduce:fi,createBins:pi,applyFilter:di,propertiesContainsFilter:gi,filterProperties:yi});"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,r=1 in arguments&&parseInt(Number(arguments[1]),10)||0;r=r<0?Math.max(n+r,0):Math.min(r,n);var i=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(i=i<0?Math.max(n+arguments[2],0):Math.min(i,n);r<i;)e[r]=t,++r;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var Zs=function(){};Zs.prototype.interfaces_=function(){return[]},Zs.prototype.getClass=function(){return Zs},Zs.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var Ks=function(){},Js=function(){},Qs={MAX_VALUE:{configurable:!0}};Js.isNaN=function(t){return Number.isNaN(t)},Js.doubleToLongBits=function(t){return t},Js.longBitsToDouble=function(t){return t},Js.isInfinite=function(t){return!Number.isFinite(t)},Qs.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(Js,Qs);var $s=function(){},tl=function(){},el=function(){},nl=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},rl={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};nl.prototype.setOrdinate=function(t,e){switch(t){case nl.X:this.x=e;break;case nl.Y:this.y=e;break;case nl.Z:this.z=e;break;default:throw new Ks("Invalid ordinate index: "+t)}},nl.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!Zs.equalsWithTolerance(this.x,e.x,n)&&!!Zs.equalsWithTolerance(this.y,e.y,n)}},nl.prototype.getOrdinate=function(t){switch(t){case nl.X:return this.x;case nl.Y:return this.y;case nl.Z:return this.z}throw new Ks("Invalid ordinate index: "+t)},nl.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||Js.isNaN(this.z))&&Js.isNaN(t.z)},nl.prototype.equals=function(t){return t instanceof nl&&this.equals2D(t)},nl.prototype.equalInZ=function(t,e){return Zs.equalsWithTolerance(this.z,t.z,e)},nl.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},nl.prototype.clone=function(){},nl.prototype.copy=function(){return new nl(this)},nl.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},nl.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return Math.sqrt(e*e+n*n+r*r)},nl.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},nl.prototype.hashCode=function(){var t=17;return 37*(t=37*t+nl.hashCode(this.x))+nl.hashCode(this.y)},nl.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},nl.prototype.interfaces_=function(){return[$s,tl,mi]},nl.prototype.getClass=function(){return nl},nl.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=Js.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},rl.DimensionalComparator.get=function(){return il},rl.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},rl.NULL_ORDINATE.get=function(){return Js.NaN},rl.X.get=function(){return 0},rl.Y.get=function(){return 1},rl.Z.get=function(){return 2},Object.defineProperties(nl,rl);var il=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new Ks("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};il.prototype.compare=function(t,e){var n=t,r=e,i=il.compare(n.x,r.x);if(0!==i)return i;var o=il.compare(n.y,r.y);return 0!==o?o:this._dimensionsToTest<=2?0:il.compare(n.z,r.z)},il.prototype.interfaces_=function(){return[el]},il.prototype.getClass=function(){return il},il.compare=function(t,e){return t<e?-1:t>e?1:Js.isNaN(t)?Js.isNaN(e)?0:-1:Js.isNaN(e)?1:0};var ol=function(){};ol.prototype.create=function(){},ol.prototype.interfaces_=function(){return[]},ol.prototype.getClass=function(){return ol};var al=function(){},sl={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};al.prototype.interfaces_=function(){return[]},al.prototype.getClass=function(){return al},al.toLocationSymbol=function(t){switch(t){case al.EXTERIOR:return"e";case al.BOUNDARY:return"b";case al.INTERIOR:return"i";case al.NONE:return"-"}throw new Ks("Unknown location value: "+t)},sl.INTERIOR.get=function(){return 0},sl.BOUNDARY.get=function(){return 1},sl.EXTERIOR.get=function(){return 2},sl.NONE.get=function(){return-1},Object.defineProperties(al,sl);var ll=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},ul=function(){},cl={LOG_10:{configurable:!0}};ul.prototype.interfaces_=function(){return[]},ul.prototype.getClass=function(){return ul},ul.log10=function(t){var e=Math.log(t);return Js.isInfinite(e)||Js.isNaN(e)?e:e/ul.LOG_10},ul.min=function(t,e,n,r){var i=t;return e<i&&(i=e),n<i&&(i=n),r<i&&(i=r),i},ul.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],i=arguments[1],o=arguments[2];return r<i?i:r>o?o:r}},ul.wrap=function(t,e){return t<0?e- -t%e:t%e},ul.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=t;return e>r&&(r=e),n>r&&(r=n),r}if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],l=i;return o>l&&(l=o),a>l&&(l=a),s>l&&(l=s),l}},ul.average=function(t,e){return(t+e)/2},cl.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(ul,cl);var hl=function(t){this.str=t};hl.prototype.append=function(t){this.str+=t},hl.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},hl.prototype.toString=function(t){return this.str};var fl=function(t){this.value=t};fl.prototype.intValue=function(){return this.value},fl.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},fl.isNaN=function(t){return Number.isNaN(t)};var pl=function(){};pl.isWhitespace=function(t){return t<=32&&t>=0||127===t},pl.toUpperCase=function(t){return t.toUpperCase()};var dl=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else if("string"==typeof arguments[0]){var r=arguments[0];t.call(this,t.parse(r))}}else if(2===arguments.length){var i=arguments[0],o=arguments[1];this.init(i,o)}},gl={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};dl.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},dl.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),r=dl.magnitude(n._hi),i=dl.TEN.pow(r);(n=n.divide(i)).gt(dl.TEN)?(n=n.divide(dl.TEN),r+=1):n.lt(dl.ONE)&&(n=n.multiply(dl.TEN),r-=1);for(var o=r+1,a=new hl,s=dl.MAX_PRINT_DIGITS-1,l=0;l<=s;l++){t&&l===o&&a.append(".");var u=Math.trunc(n._hi);if(u<0)break;var c=!1,h=0;u>9?(c=!0,h="9"):h="0"+u,a.append(h),n=n.subtract(dl.valueOf(u)).multiply(dl.TEN),c&&n.selfAdd(dl.TEN);var f=!0,p=dl.magnitude(n._hi);if(p<0&&Math.abs(p)>=s-l&&(f=!1),!f)break}return e[0]=r,a.toString()},dl.prototype.sqr=function(){return this.multiply(this)},dl.prototype.doubleValue=function(){return this._hi+this._lo},dl.prototype.subtract=function(){if(arguments[0]instanceof dl){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},dl.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},dl.prototype.isZero=function(){return 0===this._hi&&0===this._lo},dl.prototype.selfSubtract=function(){if(arguments[0]instanceof dl){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},dl.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},dl.prototype.min=function(t){return this.le(t)?this:t},dl.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof dl){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=null,o=null,a=null,s=null,l=null,u=null,c=null,h=null;return l=this._hi/n,h=(i=(u=dl.SPLIT*l)-(i=u-l))*(a=(h=dl.SPLIT*n)-(a=h-n))-(c=l*n)+i*(s=n-a)+(o=l-i)*a+o*s,h=l+(u=(this._hi-c-h+this._lo-l*r)/n),this._hi=h,this._lo=l-h+u,this}},dl.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},dl.prototype.divide=function(){if(arguments[0]instanceof dl){var t=arguments[0],e=null,n=null,r=null,i=null,o=null,a=null,s=null,l=null;return n=(o=this._hi/t._hi)-(e=(a=dl.SPLIT*o)-(e=a-o)),l=e*(r=(l=dl.SPLIT*t._hi)-(r=l-t._hi))-(s=o*t._hi)+e*(i=t._hi-r)+n*r+n*i,a=(this._hi-s-l+this._lo-o*t._lo)/t._hi,new dl(l=o+a,o-l+a)}if("number"==typeof arguments[0]){var u=arguments[0];return Js.isNaN(u)?dl.createNaN():dl.copy(this).selfDivide(u,0)}},dl.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},dl.prototype.pow=function(t){if(0===t)return dl.valueOf(1);var e=new dl(this),n=dl.valueOf(1),r=Math.abs(t);if(r>1)for(;r>0;)r%2==1&&n.selfMultiply(e),(r/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},dl.prototype.ceil=function(){if(this.isNaN())return dl.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new dl(t,e)},dl.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},dl.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},dl.prototype.setValue=function(){if(arguments[0]instanceof dl){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},dl.prototype.max=function(t){return this.ge(t)?this:t},dl.prototype.sqrt=function(){if(this.isZero())return dl.valueOf(0);if(this.isNegative())return dl.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=dl.valueOf(e),r=this.subtract(n.sqr())._hi*(.5*t);return n.add(r)},dl.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof dl){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,r=null,i=null,o=null,a=null,s=null;return o=(i=this._hi+e)-(a=i-this._hi),r=(s=(o=e-a+(this._hi-o))+this._lo)+(i-(n=i+s)),this._hi=n+r,this._lo=r+(n-this._hi),this}}else if(2===arguments.length){var l=arguments[0],u=arguments[1],c=null,h=null,f=null,p=null,d=null,g=null,y=null;p=this._hi+l,h=this._lo+u,d=p-(g=p-this._hi),f=h-(y=h-this._lo);var m=(c=p+(g=(d=l-g+(this._hi-d))+h))+(g=(f=u-y+(this._lo-f))+(g+(p-c))),v=g+(c-m);return this._hi=m,this._lo=v,this}},dl.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof dl){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=null,o=null,a=null,s=null,l=null,u=null;i=(l=dl.SPLIT*this._hi)-this._hi,u=dl.SPLIT*n,i=l-i,o=this._hi-i,a=u-n;var c=(l=this._hi*n)+(u=i*(a=u-a)-l+i*(s=n-a)+o*a+o*s+(this._hi*r+this._lo*n)),h=u+(i=l-c);return this._hi=c,this._lo=h,this}},dl.prototype.selfSqr=function(){return this.selfMultiply(this)},dl.prototype.floor=function(){if(this.isNaN())return dl.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new dl(t,e)},dl.prototype.negate=function(){return this.isNaN()?this:new dl(-this._hi,-this._lo)},dl.prototype.clone=function(){},dl.prototype.multiply=function(){if(arguments[0]instanceof dl){var t=arguments[0];return t.isNaN()?dl.createNaN():dl.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return Js.isNaN(e)?dl.createNaN():dl.copy(this).selfMultiply(e,0)}},dl.prototype.isNaN=function(){return Js.isNaN(this._hi)},dl.prototype.intValue=function(){return Math.trunc(this._hi)},dl.prototype.toString=function(){var t=dl.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},dl.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),r=e[0]+1,i=n;if("."===n.charAt(0))i="0"+n;else if(r<0)i="0."+dl.stringOfChar("0",-r)+n;else if(-1===n.indexOf(".")){var o=r-n.length;i=n+dl.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+i:i},dl.prototype.reciprocal=function(){var t,e,n,r,i=null,o=null,a=null,s=null;t=(n=1/this._hi)-(i=(a=dl.SPLIT*n)-(i=a-n)),o=(s=dl.SPLIT*this._hi)-this._hi;var l=n+(a=(1-(r=n*this._hi)-(s=i*(o=s-o)-r+i*(e=this._hi-o)+t*o+t*e)-n*this._lo)/this._hi);return new dl(l,n-l+a)},dl.prototype.toSciNotation=function(){if(this.isZero())return dl.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),r=dl.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var i="";n.length>1&&(i=n.substring(1));var o=n.charAt(0)+"."+i;return this.isNegative()?"-"+o+r:o+r},dl.prototype.abs=function(){return this.isNaN()?dl.NaN:this.isNegative()?this.negate():new dl(this)},dl.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},dl.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},dl.prototype.add=function(){if(arguments[0]instanceof dl){var t=arguments[0];return dl.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return dl.copy(this).selfAdd(e)}},dl.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof dl){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this._hi=n,this._lo=r}},dl.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},dl.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},dl.prototype.trunc=function(){return this.isNaN()?dl.NaN:this.isPositive()?this.floor():this.ceil()},dl.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},dl.prototype.interfaces_=function(){return[mi,$s,tl]},dl.prototype.getClass=function(){return dl},dl.sqr=function(t){return dl.valueOf(t).selfMultiply(t)},dl.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return dl.parse(t)}if("number"==typeof arguments[0]){var e=arguments[0];return new dl(e)}},dl.sqrt=function(t){return dl.valueOf(t).sqrt()},dl.parse=function(t){for(var e=0,n=t.length;pl.isWhitespace(t.charAt(e));)e++;var r=!1;if(e<n){var i=t.charAt(e);"-"!==i&&"+"!==i||(e++,"-"===i&&(r=!0))}for(var o=new dl,a=0,s=0,l=0;!(e>=n);){var u=t.charAt(e);if(e++,pl.isDigit(u)){var c=u-"0";o.selfMultiply(dl.TEN),o.selfAdd(c),a++}else{if("."!==u){if("e"===u||"E"===u){var h=t.substring(e);try{l=fl.parseInt(h)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+h+" in string "+t):e}break}throw new Error("Unexpected character '"+u+"' at position "+e+" in string "+t)}s=a}}var f=o,p=a-s-l;if(0===p)f=o;else if(p>0){var d=dl.TEN.pow(p);f=o.divide(d)}else if(p<0){var g=dl.TEN.pow(-p);f=o.multiply(g)}return r?f.negate():f},dl.createNaN=function(){return new dl(Js.NaN,Js.NaN)},dl.copy=function(t){return new dl(t)},dl.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),r=Math.trunc(Math.floor(n));return 10*Math.pow(10,r)<=e&&(r+=1),r},dl.stringOfChar=function(t,e){for(var n=new hl,r=0;r<e;r++)n.append(t);return n.toString()},gl.PI.get=function(){return new dl(3.141592653589793,12246467991473532e-32)},gl.TWO_PI.get=function(){return new dl(6.283185307179586,24492935982947064e-32)},gl.PI_2.get=function(){return new dl(1.5707963267948966,6123233995736766e-32)},gl.E.get=function(){return new dl(2.718281828459045,14456468917292502e-32)},gl.NaN.get=function(){return new dl(Js.NaN,Js.NaN)},gl.EPS.get=function(){return 123259516440783e-46},gl.SPLIT.get=function(){return 134217729},gl.MAX_PRINT_DIGITS.get=function(){return 32},gl.TEN.get=function(){return dl.valueOf(10)},gl.ONE.get=function(){return dl.valueOf(1)},gl.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},gl.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(dl,gl);var yl=function(){},ml={DP_SAFE_EPSILON:{configurable:!0}};yl.prototype.interfaces_=function(){return[]},yl.prototype.getClass=function(){return yl},yl.orientationIndex=function(t,e,n){var r=yl.orientationIndexFilter(t,e,n);if(r<=1)return r;var i=dl.valueOf(e.x).selfAdd(-t.x),o=dl.valueOf(e.y).selfAdd(-t.y),a=dl.valueOf(n.x).selfAdd(-e.x),s=dl.valueOf(n.y).selfAdd(-e.y);return i.selfMultiply(s).selfSubtract(o.selfMultiply(a)).signum()},yl.signOfDet2x2=function(t,e,n,r){return t.multiply(r).selfSubtract(e.multiply(n)).signum()},yl.intersection=function(t,e,n,r){var i=dl.valueOf(r.y).selfSubtract(n.y).selfMultiply(dl.valueOf(e.x).selfSubtract(t.x)),o=dl.valueOf(r.x).selfSubtract(n.x).selfMultiply(dl.valueOf(e.y).selfSubtract(t.y)),a=i.subtract(o),s=dl.valueOf(r.x).selfSubtract(n.x).selfMultiply(dl.valueOf(t.y).selfSubtract(n.y)),l=dl.valueOf(r.y).selfSubtract(n.y).selfMultiply(dl.valueOf(t.x).selfSubtract(n.x)),u=s.subtract(l).selfDivide(a).doubleValue(),c=dl.valueOf(t.x).selfAdd(dl.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),h=dl.valueOf(e.x).selfSubtract(t.x).selfMultiply(dl.valueOf(t.y).selfSubtract(n.y)),f=dl.valueOf(e.y).selfSubtract(t.y).selfMultiply(dl.valueOf(t.x).selfSubtract(n.x)),p=h.subtract(f).selfDivide(a).doubleValue(),d=dl.valueOf(n.y).selfAdd(dl.valueOf(r.y).selfSubtract(n.y).selfMultiply(p)).doubleValue();return new nl(c,d)},yl.orientationIndexFilter=function(t,e,n){var r=null,i=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),a=i-o;if(i>0){if(o<=0)return yl.signum(a);r=i+o}else{if(!(i<0))return yl.signum(a);if(o>=0)return yl.signum(a);r=-i-o}var s=yl.DP_SAFE_EPSILON*r;return a>=s||-a>=s?yl.signum(a):2},yl.signum=function(t){return t>0?1:t<0?-1:0},ml.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(yl,ml);var vl=function(){},_l={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};_l.X.get=function(){return 0},_l.Y.get=function(){return 1},_l.Z.get=function(){return 2},_l.M.get=function(){return 3},vl.prototype.setOrdinate=function(t,e,n){},vl.prototype.size=function(){},vl.prototype.getOrdinate=function(t,e){},vl.prototype.getCoordinate=function(){},vl.prototype.getCoordinateCopy=function(t){},vl.prototype.getDimension=function(){},vl.prototype.getX=function(t){},vl.prototype.clone=function(){},vl.prototype.expandEnvelope=function(t){},vl.prototype.copy=function(){},vl.prototype.getY=function(t){},vl.prototype.toCoordinateArray=function(){},vl.prototype.interfaces_=function(){return[tl]},vl.prototype.getClass=function(){return vl},Object.defineProperties(vl,_l);var bl=function(){},wl=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(bl),xl=function(){};xl.arraycopy=function(t,e,n,r,i){for(var o=0,a=e;a<e+i;a++)n[r+o]=t[a],o++},xl.getProperty=function(t){return{"line.separator":"\n"}[t]};var Ll=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var i=arguments[0],o=arguments[1];this.x=i.y*o.w-o.y*i.w,this.y=o.x*i.w-i.x*o.w,this.w=i.x*o.y-o.x*i.y}else if(arguments[0]instanceof nl&&arguments[1]instanceof nl){var a=arguments[0],s=arguments[1];this.x=a.y-s.y,this.y=s.x-a.x,this.w=a.x*s.y-s.x*a.y}}else if(3===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2];this.x=l,this.y=u,this.w=c}else if(4===arguments.length){var h=arguments[0],f=arguments[1],p=arguments[2],d=arguments[3],g=h.y-f.y,y=f.x-h.x,m=h.x*f.y-f.x*h.y,v=p.y-d.y,_=d.x-p.x,b=p.x*d.y-d.x*p.y;this.x=y*b-_*m,this.y=v*m-g*b,this.w=g*_-v*y}};Ll.prototype.getY=function(){var t=this.y/this.w;if(Js.isNaN(t)||Js.isInfinite(t))throw new wl;return t},Ll.prototype.getX=function(){var t=this.x/this.w;if(Js.isNaN(t)||Js.isInfinite(t))throw new wl;return t},Ll.prototype.getCoordinate=function(){var t=new nl;return t.x=this.getX(),t.y=this.getY(),t},Ll.prototype.interfaces_=function(){return[]},Ll.prototype.getClass=function(){return Ll},Ll.intersection=function(t,e,n,r){var i=t.y-e.y,o=e.x-t.x,a=t.x*e.y-e.x*t.y,s=n.y-r.y,l=r.x-n.x,u=n.x*r.y-r.x*n.y,c=i*l-s*o,h=(o*u-l*a)/c,f=(s*a-i*u)/c;if(Js.isNaN(h)||Js.isInfinite(h)||Js.isNaN(f)||Js.isInfinite(f))throw new wl;return new nl(h,f)};var El=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof nl){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.init(r.x,i.x,r.y,i.y)}else if(4===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2],l=arguments[3];this.init(o,a,s,l)}},Cl={serialVersionUID:{configurable:!0}};El.prototype.getArea=function(){return this.getWidth()*this.getHeight()},El.prototype.equals=function(t){if(!(t instanceof El))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},El.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new El;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,r=this._maxx<t._maxx?this._maxx:t._maxx,i=this._maxy<t._maxy?this._maxy:t._maxy;return new El(e,r,n,i)},El.prototype.isNull=function(){return this._maxx<this._minx},El.prototype.getMaxX=function(){return this._maxx},El.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof nl){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof El){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&r>=this._miny&&r<=this._maxy}},El.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof El){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof nl){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||r>this._maxy||r<this._miny)}},El.prototype.getMinY=function(){return this._miny},El.prototype.getMinX=function(){return this._minx},El.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof nl){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof El){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=r,this._maxy=r):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}},El.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},El.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},El.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},El.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},El.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},El.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},El.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},El.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},El.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},El.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof El){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof nl){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.covers(n,r)}},El.prototype.centre=function(){return this.isNull()?null:new nl((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},El.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof nl){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof El){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];i<o?(this._minx=i,this._maxx=o):(this._minx=o,this._maxx=i),a<s?(this._miny=a,this._maxy=s):(this._miny=s,this._maxy=a)}},El.prototype.getMaxY=function(){return this._maxy},El.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},El.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+nl.hashCode(this._minx))+nl.hashCode(this._maxx))+nl.hashCode(this._miny))+nl.hashCode(this._maxy)},El.prototype.interfaces_=function(){return[$s,mi]},El.prototype.getClass=function(){return El},El.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3],s=Math.min(o.x,a.x),l=Math.max(o.x,a.x),u=Math.min(r.x,i.x),c=Math.max(r.x,i.x);return!(u>l||c<s||(s=Math.min(o.y,a.y),l=Math.max(o.y,a.y),u=Math.min(r.y,i.y),c=Math.max(r.y,i.y),u>l||c<s))}},Cl.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(El,Cl);var kl={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Sl=function(t){this.geometryFactory=t||new Ku};Sl.prototype.read=function(t){var e,n,r;t=t.replace(/[\n\r]/g," ");var i=kl.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((i=kl.emptyTypeStr.exec(t))[2]=void 0),i&&(n=i[1].toLowerCase(),r=i[2],Ml[n]&&(e=Ml[n].apply(this,[r]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},Sl.prototype.write=function(t){return this.extractGeometry(t)},Sl.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Pl[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Pl[e].apply(this,[t])+")"};var Pl={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Pl.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+Pl.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push(Pl.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push(Pl.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+Pl.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Pl.linestring.apply(this,[t._shell])+")");for(var n=0,r=t._holes.length;n<r;++n)e.push("("+Pl.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+Pl.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},Ml={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(kl.spaces);return this.geometryFactory.createPoint(new nl(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(kl.trimParens,"$1"),r.push(Ml.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(r)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(kl.spaces),r.push(new nl(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(kl.spaces),r.push(new nl(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(kl.parenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(kl.trimParens,"$1"),r.push(Ml.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(r)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,r,i,o=t.trim().split(kl.parenComma),a=[],s=0,l=o.length;s<l;++s)e=o[s].replace(kl.trimParens,"$1"),n=Ml.linestring.apply(this,[e]),r=this.geometryFactory.createLinearRing(n._points),0===s?i=r:a.push(r);return this.geometryFactory.createPolygon(i,a)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(kl.doubleParenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(kl.trimParens,"$1"),r.push(Ml.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(r)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],r=0,i=e.length;r<i;++r)n.push(this.read(e[r]));return this.geometryFactory.createGeometryCollection(n)}},Tl=function(t){this.parser=new Sl(t)};Tl.prototype.write=function(t){return this.parser.write(t)},Tl.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var Ol=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),Il=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ol),Nl=function(){};Nl.prototype.interfaces_=function(){return[]},Nl.prototype.getClass=function(){return Nl},Nl.shouldNeverReachHere=function(){if(0===arguments.length)Nl.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new Il("Should never reach here"+(null!==t?": "+t:""))}},Nl.isTrue=function(){var t,e;if(1===arguments.length)t=arguments[0],Nl.isTrue(t,null);else if(2===arguments.length&&(t=arguments[0],e=arguments[1],!t))throw null===e?new Il:new Il(e)},Nl.equals=function(){var t,e,n;if(2===arguments.length)t=arguments[0],e=arguments[1],Nl.equals(t,e,null);else if(3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],!e.equals(t)))throw new Il("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var Dl=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new nl,this._intPt[1]=new nl,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},Rl={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Dl.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},Dl.prototype.getTopologySummary=function(){var t=new hl;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},Dl.prototype.computeIntersection=function(t,e,n,r){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=r,this._result=this.computeIntersect(t,e,n,r)},Dl.prototype.getIntersectionNum=function(){return this._result},Dl.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},Dl.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},Dl.prototype.setPrecisionModel=function(t){this._precisionModel=t},Dl.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},Dl.prototype.getIntersection=function(t){return this._intPt[t]},Dl.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},Dl.prototype.hasIntersection=function(){return this._result!==Dl.NO_INTERSECTION},Dl.prototype.getEdgeDistance=function(t,e){return Dl.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},Dl.prototype.isCollinear=function(){return this._result===Dl.COLLINEAR_INTERSECTION},Dl.prototype.toString=function(){return Tl.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Tl.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},Dl.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},Dl.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},Dl.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},Dl.prototype.interfaces_=function(){return[]},Dl.prototype.getClass=function(){return Dl},Dl.computeEdgeDistance=function(t,e,n){var r=Math.abs(n.x-e.x),i=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=r>i?r:i;else{var a=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y);0!==(o=r>i?a:s)||t.equals(e)||(o=Math.max(a,s))}return Nl.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},Dl.nonRobustComputeEdgeDistance=function(t,e,n){var r=t.x-e.x,i=t.y-e.y,o=Math.sqrt(r*r+i*i);return Nl.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},Rl.DONT_INTERSECT.get=function(){return 0},Rl.DO_INTERSECT.get=function(){return 1},Rl.COLLINEAR.get=function(){return 2},Rl.NO_INTERSECTION.get=function(){return 0},Rl.POINT_INTERSECTION.get=function(){return 1},Rl.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(Dl,Rl);var Al=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new El(this._inputLines[0][0],this._inputLines[0][1]),n=new El(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],r=arguments[2];if(this._isProper=!1,El.intersects(n,r,e)&&0===zl.orientationIndex(n,r,e)&&0===zl.orientationIndex(r,n,e))return this._isProper=!0,(e.equals(n)||e.equals(r))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,n,r,i){i.x=this.smallestInAbsValue(t.x,e.x,n.x,r.x),i.y=this.smallestInAbsValue(t.y,e.y,n.y,r.y),t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},e.prototype.safeHCoordinateIntersection=function(t,n,r,i){var o=null;try{o=Ll.intersection(t,n,r,i)}catch(a){if(!(a instanceof wl))throw a;o=e.nearestEndpoint(t,n,r,i)}return o},e.prototype.intersection=function(t,n,r,i){var o=this.intersectionWithNormalization(t,n,r,i);return this.isInSegmentEnvelopes(o)||(o=new nl(e.nearestEndpoint(t,n,r,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,n,r){var i=t,o=Math.abs(i);return Math.abs(e)<o&&(i=e,o=Math.abs(e)),Math.abs(n)<o&&(i=n,o=Math.abs(n)),Math.abs(r)<o&&(i=r),i},e.prototype.checkDD=function(t,e,n,r,i){var o=yl.intersection(t,e,n,r),a=this.isInSegmentEnvelopes(o);xl.out.println("DD in env = "+a+"  --------------------- "+o),i.distance(o)>1e-4&&xl.out.println("Distance = "+i.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,n,r){var i=new nl(t),o=new nl(e),a=new nl(n),s=new nl(r),l=new nl;this.normalizeToEnvCentre(i,o,a,s,l);var u=this.safeHCoordinateIntersection(i,o,a,s);return u.x+=l.x,u.y+=l.y,u},e.prototype.computeCollinearIntersection=function(e,n,r,i){var o=El.intersects(e,n,r),a=El.intersects(e,n,i),s=El.intersects(r,i,e),l=El.intersects(r,i,n);return o&&a?(this._intPt[0]=r,this._intPt[1]=i,t.COLLINEAR_INTERSECTION):s&&l?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):o&&s?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||a||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&l?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||a||s?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):a&&s?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||o||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):a&&l?(this._intPt[0]=i,this._intPt[1]=n,!i.equals(n)||o||s?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,r,i){var o=t.x<e.x?t.x:e.x,a=t.y<e.y?t.y:e.y,s=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=n.x<r.x?n.x:r.x,c=n.y<r.y?n.y:r.y,h=n.x>r.x?n.x:r.x,f=n.y>r.y?n.y:r.y,p=((o>u?o:u)+(s<h?s:h))/2,d=((a>c?a:c)+(l<f?l:f))/2;i.x=p,i.y=d,t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},e.prototype.computeIntersect=function(e,n,r,i){if(this._isProper=!1,!El.intersects(e,n,r,i))return t.NO_INTERSECTION;var o=zl.orientationIndex(e,n,r),a=zl.orientationIndex(e,n,i);if(o>0&&a>0||o<0&&a<0)return t.NO_INTERSECTION;var s=zl.orientationIndex(r,i,e),l=zl.orientationIndex(r,i,n);return s>0&&l>0||s<0&&l<0?t.NO_INTERSECTION:0===o&&0===a&&0===s&&0===l?this.computeCollinearIntersection(e,n,r,i):(0===o||0===a||0===s||0===l?(this._isProper=!1,e.equals2D(r)||e.equals2D(i)?this._intPt[0]=e:n.equals2D(r)||n.equals2D(i)?this._intPt[0]=n:0===o?this._intPt[0]=new nl(r):0===a?this._intPt[0]=new nl(i):0===s?this._intPt[0]=new nl(e):0===l&&(this._intPt[0]=new nl(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,r,i)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,r){var i=t,o=zl.distancePointLine(t,n,r),a=zl.distancePointLine(e,n,r);return a<o&&(o=a,i=e),(a=zl.distancePointLine(n,t,e))<o&&(o=a,i=n),(a=zl.distancePointLine(r,t,e))<o&&(o=a,i=r),i},e}(Dl),jl=function(){};jl.prototype.interfaces_=function(){return[]},jl.prototype.getClass=function(){return jl},jl.orientationIndex=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=n.x-e.x,a=n.y-e.y;return jl.signOfDet2x2(r,i,o,a)},jl.signOfDet2x2=function(t,e,n,r){var i=null,o=null,a=null;if(i=1,0===t||0===r)return 0===e||0===n?0:e>0?n>0?-i:i:n>0?i:-i;if(0===e||0===n)return r>0?t>0?i:-i:t>0?-i:i;if(e>0?r>0?e<=r||(i=-i,o=t,t=n,n=o,o=e,e=r,r=o):e<=-r?(i=-i,n=-n,r=-r):(o=t,t=-n,n=o,o=e,e=-r,r=o):r>0?-e<=r?(i=-i,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=r,r=o):e>=r?(t=-t,e=-e,n=-n,r=-r):(i=-i,o=-t,t=-n,n=o,o=-e,e=-r,r=o),t>0){if(!(n>0))return i;if(!(t<=n))return i}else{if(n>0)return-i;if(!(t>=n))return-i;i=-i,t=-t,n=-n}for(;;){if((r-=(a=Math.floor(n/t))*e)<0)return-i;if(r>e)return i;if(t>(n-=a*t)+n){if(e<r+r)return i}else{if(e>r+r)return-i;n=t-n,r=e-r,i=-i}if(0===r)return 0===n?0:-i;if(0===n)return i;if((e-=(a=Math.floor(t/n))*r)<0)return i;if(e>r)return-i;if(n>(t-=a*n)+t){if(r<e+e)return-i}else{if(r>e+e)return i;t=n-t,e=r-e,i=-i}if(0===e)return 0===t?0:i;if(0===t)return-i}};var Bl=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};Bl.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,r=e.x;return n>r&&(n=e.x,r=t.x),this._p.x>=n&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var i=t.x-this._p.x,o=t.y-this._p.y,a=e.x-this._p.x,s=e.y-this._p.y,l=jl.signOfDet2x2(i,o,a,s);if(0===l)return this._isPointOnSegment=!0,null;s<o&&(l=-l),l>0&&this._crossingCount++}},Bl.prototype.isPointInPolygon=function(){return this.getLocation()!==al.EXTERIOR},Bl.prototype.getLocation=function(){return this._isPointOnSegment?al.BOUNDARY:this._crossingCount%2==1?al.INTERIOR:al.EXTERIOR},Bl.prototype.isOnSegment=function(){return this._isPointOnSegment},Bl.prototype.interfaces_=function(){return[]},Bl.prototype.getClass=function(){return Bl},Bl.locatePointInRing=function(){if(arguments[0]instanceof nl&&ll(arguments[1],vl)){for(var t=arguments[0],e=arguments[1],n=new Bl(t),r=new nl,i=new nl,o=1;o<e.size();o++)if(e.getCoordinate(o,r),e.getCoordinate(o-1,i),n.countSegment(r,i),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof nl&&arguments[1]instanceof Array){for(var a=arguments[0],s=arguments[1],l=new Bl(a),u=1;u<s.length;u++){var c=s[u],h=s[u-1];if(l.countSegment(c,h),l.isOnSegment())return l.getLocation()}return l.getLocation()}};var zl=function(){},Fl={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};zl.prototype.interfaces_=function(){return[]},zl.prototype.getClass=function(){return zl},zl.orientationIndex=function(t,e,n){return yl.orientationIndex(t,e,n)},zl.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,r=1;r<t.length-1;r++){var i=t[r].x-n,o=t[r+1].y;e+=i*(t[r-1].y-o)}return e/2}if(ll(arguments[0],vl)){var a=arguments[0],s=a.size();if(s<3)return 0;var l=new nl,u=new nl,c=new nl;a.getCoordinate(0,u),a.getCoordinate(1,c);var h=u.x;c.x-=h;for(var f=0,p=1;p<s-1;p++)l.y=u.y,u.x=c.x,u.y=c.y,a.getCoordinate(p+1,c),c.x-=h,f+=u.x*(l.y-c.y);return f/2}},zl.distanceLineLine=function(t,e,n,r){if(t.equals(e))return zl.distancePointLine(t,n,r);if(n.equals(r))return zl.distancePointLine(r,t,e);var i=!1;if(El.intersects(t,e,n,r)){var o=(e.x-t.x)*(r.y-n.y)-(e.y-t.y)*(r.x-n.x);if(0===o)i=!0;else{var a=(t.y-n.y)*(r.x-n.x)-(t.x-n.x)*(r.y-n.y),s=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,l=a/o;(l<0||l>1||s<0||s>1)&&(i=!0)}}else i=!0;return i?ul.min(zl.distancePointLine(t,n,r),zl.distancePointLine(e,n,r),zl.distancePointLine(n,t,e),zl.distancePointLine(r,t,e)):0},zl.isPointInRing=function(t,e){return zl.locatePointInRing(t,e)!==al.EXTERIOR},zl.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,r=new nl;t.getCoordinate(0,r);for(var i=r.x,o=r.y,a=1;a<e;a++){t.getCoordinate(a,r);var s=r.x,l=r.y,u=s-i,c=l-o;n+=Math.sqrt(u*u+c*c),i=s,o=l}return n},zl.isCCW=function(t){var e=t.length-1;if(e<3)throw new Ks("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],r=0,i=1;i<=e;i++){var o=t[i];o.y>n.y&&(n=o,r=i)}var a=r;do{(a-=1)<0&&(a=e)}while(t[a].equals2D(n)&&a!==r);var s=r;do{s=(s+1)%e}while(t[s].equals2D(n)&&s!==r);var l=t[a],u=t[s];if(l.equals2D(n)||u.equals2D(n)||l.equals2D(u))return!1;var c=zl.computeOrientation(l,n,u);return 0===c?l.x>u.x:c>0},zl.locatePointInRing=function(t,e){return Bl.locatePointInRing(t,e)},zl.distancePointLinePerpendicular=function(t,e,n){var r=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),i=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/r;return Math.abs(i)*Math.sqrt(r)},zl.computeOrientation=function(t,e,n){return zl.orientationIndex(t,e,n)},zl.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new Ks("Line array must contain at least one vertex");for(var n=t.distance(e[0]),r=0;r<e.length-1;r++){var i=zl.distancePointLine(t,e[r],e[r+1]);i<n&&(n=i)}return n}if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];if(a.x===s.x&&a.y===s.y)return o.distance(a);var l=(s.x-a.x)*(s.x-a.x)+(s.y-a.y)*(s.y-a.y),u=((o.x-a.x)*(s.x-a.x)+(o.y-a.y)*(s.y-a.y))/l;if(u<=0)return o.distance(a);if(u>=1)return o.distance(s);var c=((a.y-o.y)*(s.x-a.x)-(a.x-o.x)*(s.y-a.y))/l;return Math.abs(c)*Math.sqrt(l)}},zl.isOnLine=function(t,e){for(var n=new Al,r=1;r<e.length;r++){var i=e[r-1],o=e[r];if(n.computeIntersection(t,i,o),n.hasIntersection())return!0}return!1},Fl.CLOCKWISE.get=function(){return-1},Fl.RIGHT.get=function(){return zl.CLOCKWISE},Fl.COUNTERCLOCKWISE.get=function(){return 1},Fl.LEFT.get=function(){return zl.COUNTERCLOCKWISE},Fl.COLLINEAR.get=function(){return 0},Fl.STRAIGHT.get=function(){return zl.COLLINEAR},Object.defineProperties(zl,Fl);var Gl=function(){};Gl.prototype.filter=function(t){},Gl.prototype.interfaces_=function(){return[]},Gl.prototype.getClass=function(){return Gl};var Ul=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},ql={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Ul.prototype.isGeometryCollection=function(){return this.getSortIndex()===Ul.SORTINDEX_GEOMETRYCOLLECTION},Ul.prototype.getFactory=function(){return this._factory},Ul.prototype.getGeometryN=function(t){return this},Ul.prototype.getArea=function(){return 0},Ul.prototype.isRectangle=function(){return!1},Ul.prototype.equals=function(){if(arguments[0]instanceof Ul){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof Ul))return!1;var n=e;return this.equalsExact(n)}},Ul.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},Ul.prototype.geometryChanged=function(){this.apply(Ul.geometryChangedFilter)},Ul.prototype.geometryChangedAction=function(){this._envelope=null},Ul.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},Ul.prototype.getLength=function(){return 0},Ul.prototype.getNumGeometries=function(){return 1},Ul.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,r)}},Ul.prototype.getUserData=function(){return this._userData},Ul.prototype.getSRID=function(){return this._SRID},Ul.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},Ul.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===Ul.SORTINDEX_GEOMETRYCOLLECTION)throw new Ks("This method does not support GeometryCollection arguments")},Ul.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},Ul.prototype.norm=function(){var t=this.copy();return t.normalize(),t},Ul.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},Ul.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new El(this._envelope)},Ul.prototype.setSRID=function(t){this._SRID=t},Ul.prototype.setUserData=function(t){this._userData=t},Ul.prototype.compare=function(t,e){for(var n=t.iterator(),r=e.iterator();n.hasNext()&&r.hasNext();){var i=n.next(),o=r.next(),a=i.compareTo(o);if(0!==a)return a}return n.hasNext()?1:r.hasNext()?-1:0},Ul.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},Ul.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Ul.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Ul.SORTINDEX_MULTIPOINT||this.getSortIndex()===Ul.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Ul.SORTINDEX_MULTIPOLYGON},Ul.prototype.interfaces_=function(){return[tl,$s,mi]},Ul.prototype.getClass=function(){return Ul},Ul.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},Ul.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},ql.serialVersionUID.get=function(){return 0x799ea46522854c00},ql.SORTINDEX_POINT.get=function(){return 0},ql.SORTINDEX_MULTIPOINT.get=function(){return 1},ql.SORTINDEX_LINESTRING.get=function(){return 2},ql.SORTINDEX_LINEARRING.get=function(){return 3},ql.SORTINDEX_MULTILINESTRING.get=function(){return 4},ql.SORTINDEX_POLYGON.get=function(){return 5},ql.SORTINDEX_MULTIPOLYGON.get=function(){return 6},ql.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},ql.geometryChangedFilter.get=function(){return Hl},Object.defineProperties(Ul,ql);var Hl=function(){};Hl.interfaces_=function(){return[Gl]},Hl.filter=function(t){t.geometryChangedAction()};var Vl=function(){};Vl.prototype.filter=function(t){},Vl.prototype.interfaces_=function(){return[]},Vl.prototype.getClass=function(){return Vl};var Yl=function(){},Wl={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Yl.prototype.isInBoundary=function(t){},Yl.prototype.interfaces_=function(){return[]},Yl.prototype.getClass=function(){return Yl},Wl.Mod2BoundaryNodeRule.get=function(){return Xl},Wl.EndPointBoundaryNodeRule.get=function(){return Zl},Wl.MultiValentEndPointBoundaryNodeRule.get=function(){return Kl},Wl.MonoValentEndPointBoundaryNodeRule.get=function(){return Jl},Wl.MOD2_BOUNDARY_RULE.get=function(){return new Xl},Wl.ENDPOINT_BOUNDARY_RULE.get=function(){return new Zl},Wl.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Kl},Wl.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Jl},Wl.OGC_SFS_BOUNDARY_RULE.get=function(){return Yl.MOD2_BOUNDARY_RULE},Object.defineProperties(Yl,Wl);var Xl=function(){};Xl.prototype.isInBoundary=function(t){return t%2==1},Xl.prototype.interfaces_=function(){return[Yl]},Xl.prototype.getClass=function(){return Xl};var Zl=function(){};Zl.prototype.isInBoundary=function(t){return t>0},Zl.prototype.interfaces_=function(){return[Yl]},Zl.prototype.getClass=function(){return Zl};var Kl=function(){};Kl.prototype.isInBoundary=function(t){return t>1},Kl.prototype.interfaces_=function(){return[Yl]},Kl.prototype.getClass=function(){return Kl};var Jl=function(){};Jl.prototype.isInBoundary=function(t){return 1===t},Jl.prototype.interfaces_=function(){return[Yl]},Jl.prototype.getClass=function(){return Jl};var Ql=function(){};Ql.prototype.add=function(){},Ql.prototype.addAll=function(){},Ql.prototype.isEmpty=function(){},Ql.prototype.iterator=function(){},Ql.prototype.size=function(){},Ql.prototype.toArray=function(){},Ql.prototype.remove=function(){};var $l=function(t){function e(e){t.call(this),this.message=e||""}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={name:{configurable:!0}};return n.name.get=function(){return"IndexOutOfBoundsException"},Object.defineProperties(e,n),e}(Error),tu=function(){};tu.prototype.hasNext=function(){},tu.prototype.next=function(){},tu.prototype.remove=function(){};var eu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(Ql);(vi.prototype=new Error).name="NoSuchElementException";var nu=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ql&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,Ql]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new ru(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new $l;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,r=this.array_.length;n<r;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(eu),ru=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new vi;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(tu),iu=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.ensureCapacity(n.length),this.add(n,r)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[0],n=arguments[1],r=!1,i=e.iterator();i.hasNext();)this.add(i.next(),n),r=!0;return r}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],r=arguments[1];return this.add(n,r,!0),!0}if(arguments[0]instanceof nl&&"boolean"==typeof arguments[1]){var i=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(i))return null;t.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1];return this.add(o,a),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var s=arguments[0],l=arguments[1];if(arguments[2])for(var u=0;u<s.length;u++)this.add(s[u],l);else for(var c=s.length-1;c>=0;c--)this.add(s[c],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof nl){var h=arguments[0],f=arguments[1];if(!arguments[2]){var p=this.size();if(p>0){if(h>0&&this.get(h-1).equals2D(f))return null;if(h<p&&this.get(h).equals2D(f))return null}}t.prototype.add.call(this,h,f)}}else if(4===arguments.length){var d=arguments[0],g=arguments[1],y=arguments[2],m=arguments[3],v=1;y>m&&(v=-1);for(var _=y;_!==m;_+=v)this.add(d[_],g);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new nl(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(nu),ou=function(){},au={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};au.ForwardComparator.get=function(){return su},au.BidirectionalComparator.get=function(){return lu},au.coordArrayType.get=function(){return new Array(0).fill(null)},ou.prototype.interfaces_=function(){return[]},ou.prototype.getClass=function(){return ou},ou.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},ou.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(ou.indexOf(r,e)<0)return r}return null},ou.scroll=function(t,e){var n=ou.indexOf(e,t);if(n<0)return null;var r=new Array(t.length).fill(null);xl.arraycopy(t,n,r,0,t.length-n),xl.arraycopy(t,0,r,t.length-n,n),xl.arraycopy(r,0,t,0,t.length)},ou.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];if(r===i)return!0;if(null===r||null===i)return!1;if(r.length!==i.length)return!1;for(var a=0;a<r.length;a++)if(0!==o.compare(r[a],i[a]))return!1;return!0}},ou.intersection=function(t,e){for(var n=new iu,r=0;r<t.length;r++)e.intersects(t[r])&&n.add(t[r],!0);return n.toCoordinateArray()},ou.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},ou.removeRepeatedPoints=function(t){return ou.hasRepeatedPoints(t)?new iu(t,!1).toCoordinateArray():t},ou.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),r=0;r<=n;r++){var i=t[r];t[r]=t[e-r],t[e-r]=i}},ou.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var r=new Array(e).fill(null);if(0===e)return r;for(var i=0,o=0;o<t.length;o++)null!==t[o]&&(r[i++]=t[o]);return r},ou.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new nl(t[n]);return e}if(5===arguments.length)for(var r=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3],s=arguments[4],l=0;l<s;l++)o[a+l]=new nl(r[i+l])},ou.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=e[t.length-n-1];if(0!==r.compareTo(i))return!1}return!0},ou.envelope=function(t){for(var e=new El,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},ou.toCoordinateArray=function(t){return t.toArray(ou.coordArrayType)},ou.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},ou.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},ou.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,r=t[e].compareTo(t[n]);if(0!==r)return r}return 1},ou.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var r=t[n].compareTo(e[n]);if(0!==r)return r;n++}return n<e.length?-1:n<t.length?1:0},ou.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},ou.extract=function(t,e,n){e=ul.clamp(e,0,t.length);var r=(n=ul.clamp(n,-1,t.length))-e+1;n<0&&(r=0),e>=t.length&&(r=0),n<e&&(r=0);var i=new Array(r).fill(null);if(0===r)return i;for(var o=0,a=e;a<=n;a++)i[o++]=t[a];return i},Object.defineProperties(ou,au);var su=function(){};su.prototype.compare=function(t,e){return ou.compare(t,e)},su.prototype.interfaces_=function(){return[el]},su.prototype.getClass=function(){return su};var lu=function(){};lu.prototype.compare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;var i=ou.compare(n,r);return ou.isEqualReversed(n,r)?0:i},lu.prototype.OLDcompare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;for(var i=ou.increasingDirection(n),o=ou.increasingDirection(r),a=i>0?0:n.length-1,s=o>0?0:n.length-1,l=0;l<n.length;l++){var u=n[a].compareTo(r[s]);if(0!==u)return u;a+=i,s+=o}return 0},lu.prototype.interfaces_=function(){return[el]},lu.prototype.getClass=function(){return lu};var uu=function(){};uu.prototype.get=function(){},uu.prototype.put=function(){},uu.prototype.size=function(){},uu.prototype.values=function(){},uu.prototype.entrySet=function(){};var cu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(uu);(_i.prototype=new Error).name="OperationNotSupported",(bi.prototype=new Ql).contains=function(){};var hu=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ql&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new fu(this)},e}(bi),fu=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new vi;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new _i},e}(tu),pu=0;(ki.prototype=new cu).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},ki.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:pu,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,r,i=this.root_;do{if(n=i,(r=t.compareTo(i.key))<0)i=i.left;else{if(!(r>0)){var o=i.value;return i.value=e,o}i=i.right}}while(null!==i);var a={key:t,left:null,right:null,value:e,parent:n,color:pu,getValue:function(){return this.value},getKey:function(){return this.key}};return r<0?n.left=a:n.right=a,this.fixAfterInsertion(a),this.size_++,null},ki.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(xi(t)===Ei(xi(xi(t)))){var e=Ci(xi(xi(t)));1===wi(e)?(Li(xi(t),pu),Li(e,pu),Li(xi(xi(t)),1),t=xi(xi(t))):(t===Ci(xi(t))&&(t=xi(t),this.rotateLeft(t)),Li(xi(t),pu),Li(xi(xi(t)),1),this.rotateRight(xi(xi(t))))}else{var n=Ei(xi(xi(t)));1===wi(n)?(Li(xi(t),pu),Li(n,pu),Li(xi(xi(t)),1),t=xi(xi(t))):(t===Ei(xi(t))&&(t=xi(t),this.rotateRight(t)),Li(xi(t),pu),Li(xi(xi(t)),1),this.rotateLeft(xi(xi(t))))}this.root_.color=pu},ki.prototype.values=function(){var t=new nu,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=ki.successor(e));)t.add(e.value);return t},ki.prototype.entrySet=function(){var t=new hu,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=ki.successor(e));)t.add(e);return t},ki.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},ki.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},ki.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},ki.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,r=t;null!==n&&r===n.right;)r=n,n=n.parent;return n},ki.prototype.size=function(){return this.size_};var du=function(){};du.prototype.interfaces_=function(){return[]},du.prototype.getClass=function(){return du},Si.prototype=new bi,(Pi.prototype=new Si).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},Pi.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},Pi.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Pi.prototype.remove=function(t){throw new _i},Pi.prototype.size=function(){return this.array_.length},Pi.prototype.isEmpty=function(){return 0===this.array_.length},Pi.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},Pi.prototype.iterator=function(){return new gu(this)};var gu=function(t){this.treeSet_=t,this.position_=0};gu.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new vi;return this.treeSet_.array_[this.position_++]},gu.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},gu.prototype.remove=function(){throw new _i};var yu=function(){};yu.sort=function(){var t,e,n,r,i=arguments[0];if(1===arguments.length)r=function(t,e){return t.compareTo(e)},i.sort(r);else if(2===arguments.length)n=arguments[1],r=function(t,e){return n.compare(t,e)},i.sort(r);else if(3===arguments.length){(e=i.slice(arguments[1],arguments[2])).sort();var o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length));for(i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t])}else if(4===arguments.length)for(e=i.slice(arguments[1],arguments[2]),n=arguments[3],r=function(t,e){return n.compare(t,e)},e.sort(r),o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length)),i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t])},yu.asList=function(t){for(var e=new nu,n=0,r=t.length;n<r;n++)e.add(t[n]);return e};var mu=function(){},vu={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};vu.P.get=function(){return 0},vu.L.get=function(){return 1},vu.A.get=function(){return 2},vu.FALSE.get=function(){return-1},vu.TRUE.get=function(){return-2},vu.DONTCARE.get=function(){return-3},vu.SYM_FALSE.get=function(){return"F"},vu.SYM_TRUE.get=function(){return"T"},vu.SYM_DONTCARE.get=function(){return"*"},vu.SYM_P.get=function(){return"0"},vu.SYM_L.get=function(){return"1"},vu.SYM_A.get=function(){return"2"},mu.prototype.interfaces_=function(){return[]},mu.prototype.getClass=function(){return mu},mu.toDimensionSymbol=function(t){switch(t){case mu.FALSE:return mu.SYM_FALSE;case mu.TRUE:return mu.SYM_TRUE;case mu.DONTCARE:return mu.SYM_DONTCARE;case mu.P:return mu.SYM_P;case mu.L:return mu.SYM_L;case mu.A:return mu.SYM_A}throw new Ks("Unknown dimension value: "+t)},mu.toDimensionValue=function(t){switch(pl.toUpperCase(t)){case mu.SYM_FALSE:return mu.FALSE;case mu.SYM_TRUE:return mu.TRUE;case mu.SYM_DONTCARE:return mu.DONTCARE;case mu.SYM_P:return mu.P;case mu.SYM_L:return mu.L;case mu.SYM_A:return mu.A}throw new Ks("Unknown dimension symbol: "+t)},Object.defineProperties(mu,vu);var _u=function(){};_u.prototype.filter=function(t){},_u.prototype.interfaces_=function(){return[]},_u.prototype.getClass=function(){return _u};var bu=function(){};bu.prototype.filter=function(t,e){},bu.prototype.isDone=function(){},bu.prototype.isGeometryChanged=function(){},bu.prototype.interfaces_=function(){return[]},bu.prototype.getClass=function(){return bu};var wu=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new Ks("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new El,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var r=this._geometries[n].getCoordinates(),i=0;i<r.length;i++)t[++e]=r[i];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e;if(this._geometries.length!==r._geometries.length)return!1;for(var i=0;i<this._geometries.length;i++)if(!this._geometries[i].equalsExact(r._geometries[i],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();yu.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=mu.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=mu.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new Pi(yu.asList(this._geometries)),n=new Pi(yu.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var r=arguments[0],i=arguments[1],o=r,a=this.getNumGeometries(),s=o.getNumGeometries(),l=0;l<a&&l<s;){var u=this.getGeometryN(l),c=o.getGeometryN(l),h=u.compareToSameClass(c,i);if(0!==h)return h;l++}return l<a?1:l<s?-1:0}},e.prototype.apply=function(){if(ll(arguments[0],Vl))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(ll(arguments[0],bu)){var n=arguments[0];if(0===this._geometries.length)return null;for(var r=0;r<this._geometries.length&&(this._geometries[r].apply(n),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else if(ll(arguments[0],_u)){var i=arguments[0];i.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(i)}else if(ll(arguments[0],Gl)){var a=arguments[0];a.filter(this);for(var s=0;s<this._geometries.length;s++)this._geometries[s].apply(a)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Nl.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(Ul),xu=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Ul.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?mu.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new Lu(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[du]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(wu),Lu=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=Yl.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=r}};Lu.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},Lu.prototype.getBoundary=function(){return this._geom instanceof Pu?this.boundaryLineString(this._geom):this._geom instanceof xu?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Lu.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},Lu.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Lu.prototype.computeBoundaryCoordinates=function(t){var e=new nu;this._endpointMap=new ki;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);0!==r.getNumPoints()&&(this.addEndpoint(r.getCoordinateN(0)),this.addEndpoint(r.getCoordinateN(r.getNumPoints()-1)))}for(var i=this._endpointMap.entrySet().iterator();i.hasNext();){var o=i.next(),a=o.getValue().count;this._bnRule.isInBoundary(a)&&e.add(o.getKey())}return ou.toCoordinateArray(e)},Lu.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Eu,this._endpointMap.put(t,e)),e.count++},Lu.prototype.interfaces_=function(){return[]},Lu.prototype.getClass=function(){return Lu},Lu.getBoundary=function(){if(1===arguments.length){var t=arguments[0];return new Lu(t).getBoundary()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new Lu(e,n).getBoundary()}};var Eu=function(){this.count=null};Eu.prototype.interfaces_=function(){return[]},Eu.prototype.getClass=function(){return Eu};var Cu=function(){},ku={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Cu.prototype.interfaces_=function(){return[]},Cu.prototype.getClass=function(){return Cu},Cu.chars=function(t,e){for(var n=new Array(e).fill(null),r=0;r<e;r++)n[r]=t;return String(n)},Cu.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var r=arguments[0],i=arguments[1],o="",a=new function(){}(new function(){}(Cu.getStackTrace(r))),s=0;s<i;s++)try{o+=a.readLine()+Cu.NEWLINE}catch(t){if(!(t instanceof Mi))throw t;Nl.shouldNeverReachHere()}return o}},Cu.split=function(t,e){for(var n=e.length,r=new nu,i=""+t,o=i.indexOf(e);o>=0;){var a=i.substring(0,o);r.add(a),o=(i=i.substring(o+n)).indexOf(e)}i.length>0&&r.add(i);for(var s=new Array(r.size()).fill(null),l=0;l<s.length;l++)s[l]=r.get(l);return s},Cu.toString=function(){if(1===arguments.length){var t=arguments[0];return Cu.SIMPLE_ORDINATE_FORMAT.format(t)}},Cu.spaces=function(t){return Cu.chars(" ",t)},ku.NEWLINE.get=function(){return xl.getProperty("line.separator")},ku.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Cu,ku);var Su=function(){};Su.prototype.interfaces_=function(){return[]},Su.prototype.getClass=function(){return Su},Su.copyCoord=function(t,e,n,r){for(var i=Math.min(t.getDimension(),n.getDimension()),o=0;o<i;o++)n.setOrdinate(r,o,t.getOrdinate(e,o))},Su.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,vl.X)===t.getOrdinate(e-1,vl.X)&&t.getOrdinate(0,vl.Y)===t.getOrdinate(e-1,vl.Y)},Su.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var r=Math.min(t.getDimension(),e.getDimension()),i=0;i<n;i++)for(var o=0;o<r;o++){var a=t.getOrdinate(i,o),s=e.getOrdinate(i,o);if(!(t.getOrdinate(i,o)===e.getOrdinate(i,o)||Js.isNaN(a)&&Js.isNaN(s)))return!1}return!0},Su.extend=function(t,e,n){var r=t.create(n,e.getDimension()),i=e.size();if(Su.copy(e,0,r,0,i),i>0)for(var o=i;o<n;o++)Su.copy(e,i-1,r,o,1);return r},Su.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),r=0;r<=n;r++)Su.swap(t,r,e-r)},Su.swap=function(t,e,n){if(e===n)return null;for(var r=0;r<t.getDimension();r++){var i=t.getOrdinate(e,r);t.setOrdinate(e,r,t.getOrdinate(n,r)),t.setOrdinate(n,r,i)}},Su.copy=function(t,e,n,r,i){for(var o=0;o<i;o++)Su.copyCoord(t,e+o,n,r+o)},Su.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),r=new hl;r.append("(");for(var i=0;i<e;i++){i>0&&r.append(" ");for(var o=0;o<n;o++)o>0&&r.append(","),r.append(Cu.toString(t.getOrdinate(i,o)))}return r.append(")"),r.toString()}},Su.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Su.createClosedRing(t,e,4):e.getOrdinate(0,vl.X)===e.getOrdinate(n-1,vl.X)&&e.getOrdinate(0,vl.Y)===e.getOrdinate(n-1,vl.Y)?e:Su.createClosedRing(t,e,n+1)},Su.createClosedRing=function(t,e,n){var r=t.create(n,e.getDimension()),i=e.size();Su.copy(e,0,r,0,i);for(var o=i;o<n;o++)Su.copy(e,0,r,o,1);return r};var Pu=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new El:this._points.expandEnvelope(new El)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e;if(this._points.size()!==r._points.size())return!1;for(var i=0;i<this._points.size();i++)if(!this.equal(this._points.getCoordinate(i),r._points.getCoordinate(i),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&Su.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?mu.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return zl.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Su.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var r=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==r)return r;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var i=arguments[0];return arguments[1].compare(this._points,i._points)}},e.prototype.apply=function(){if(ll(arguments[0],Vl))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(ll(arguments[0],bu)){var n=arguments[0];if(0===this._points.size())return null;for(var r=0;r<this._points.size()&&(n.filter(this._points,r),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else(ll(arguments[0],_u)||ll(arguments[0],Gl))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new Lu(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new Ks("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[du]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(Ul),Mu=function(){};Mu.prototype.interfaces_=function(){return[]},Mu.prototype.getClass=function(){return Mu};var Tu=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new El;var t=new El;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return mu.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(ll(arguments[0],Vl)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(ll(arguments[0],bu)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(ll(arguments[0],_u)||ll(arguments[0],Gl))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),Nl.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Mu]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(Ul),Ou=function(){};Ou.prototype.interfaces_=function(){return[]},Ou.prototype.getClass=function(){return Ou};var Iu=function(t){function e(e,n,r){if(t.call(this,r),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new Ks("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new Ks("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];for(var i=0;i<this._holes.length;i++)for(var o=this._holes[i].getCoordinates(),a=0;a<o.length;a++)t[++e]=o[a];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(zl.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(zl.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var r=t.getX(n);if(r!==e.getMinX()&&r!==e.getMaxX())return!1;var i=t.getY(n);if(i!==e.getMinY()&&i!==e.getMaxY())return!1}for(var o=t.getX(0),a=t.getY(0),s=1;s<=4;s++){var l=t.getX(s),u=t.getY(s);if(l!==o==(u!==a))return!1;o=l,a=u}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e,i=this._shell,o=r._shell;if(!i.equalsExact(o,n))return!1;if(this._holes.length!==r._holes.length)return!1;for(var a=0;a<this._holes.length;a++)if(!this._holes[a].equalsExact(r._holes[a],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);yu.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var r=new Array(e.getCoordinates().length-1).fill(null);xl.arraycopy(e.getCoordinates(),0,r,0,r.length);var i=ou.minCoordinate(e.getCoordinates());ou.scroll(r,i),xl.arraycopy(r,0,e.getCoordinates(),0,r.length),e.getCoordinates()[r.length]=r[0],zl.isCCW(e.getCoordinates())===n&&ou.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var r=arguments[0],i=arguments[1],o=r,a=this._shell,s=o._shell,l=a.compareToSameClass(s,i);if(0!==l)return l;for(var u=this.getNumInteriorRing(),c=o.getNumInteriorRing(),h=0;h<u&&h<c;){var f=this.getInteriorRingN(h),p=o.getInteriorRingN(h),d=f.compareToSameClass(p,i);if(0!==d)return d;h++}return h<u?1:h<c?-1:0}},e.prototype.apply=function(t){if(ll(t,Vl)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(ll(t,bu)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(ll(t,_u))t.filter(this);else if(ll(t,Gl)){t.filter(this),this._shell.apply(t);for(var r=0;r<this._holes.length;r++)this._holes[r].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),r=0;r<n.length;r++)n[r]=this._holes[r].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[Ou]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(Ul),Nu=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Ul.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return mu.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Mu]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(wu),Du=function(t){function e(e,n){e instanceof nl&&n instanceof Ku&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Ul.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return mu.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Su.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new Ks("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new Ks("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Pu),Ru=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Ul.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new nu,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),r=0;r<n.getNumGeometries();r++)t.add(n.getGeometryN(r));var i=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(i))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Ou]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(wu),Au=function(t){this._factory=t||null,this._isUserDataCopied=!1},ju={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Au.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},Au.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},Au.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof wu?this.editGeometryCollection(t,e):t instanceof Iu?this.editPolygon(t,e):t instanceof Tu||t instanceof Pu?e.edit(t,this._factory):(Nl.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},Au.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),r=new nu,i=0;i<n.getNumGeometries();i++){var o=this.edit(n.getGeometryN(i),e);null===o||o.isEmpty()||r.add(o)}return n.getClass()===Nu?this._factory.createMultiPoint(r.toArray([])):n.getClass()===xu?this._factory.createMultiLineString(r.toArray([])):n.getClass()===Ru?this._factory.createMultiPolygon(r.toArray([])):this._factory.createGeometryCollection(r.toArray([]))},Au.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var r=this.edit(n.getExteriorRing(),e);if(null===r||r.isEmpty())return this._factory.createPolygon();for(var i=new nu,o=0;o<n.getNumInteriorRing();o++){var a=this.edit(n.getInteriorRingN(o),e);null===a||a.isEmpty()||i.add(a)}return this._factory.createPolygon(r,i.toArray([]))},Au.prototype.interfaces_=function(){return[]},Au.prototype.getClass=function(){return Au},Au.GeometryEditorOperation=function(){},ju.NoOpGeometryOperation.get=function(){return Bu},ju.CoordinateOperation.get=function(){return zu},ju.CoordinateSequenceOperation.get=function(){return Fu},Object.defineProperties(Au,ju);var Bu=function(){};Bu.prototype.edit=function(t,e){return t},Bu.prototype.interfaces_=function(){return[Au.GeometryEditorOperation]},Bu.prototype.getClass=function(){return Bu};var zu=function(){};zu.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof Du?e.createLinearRing(n):t instanceof Pu?e.createLineString(n):t instanceof Tu?n.length>0?e.createPoint(n[0]):e.createPoint():t},zu.prototype.interfaces_=function(){return[Au.GeometryEditorOperation]},zu.prototype.getClass=function(){return zu};var Fu=function(){};Fu.prototype.edit=function(t,e){return t instanceof Du?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Pu?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Tu?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},Fu.prototype.interfaces_=function(){return[Au.GeometryEditorOperation]},Fu.prototype.getClass=function(){return Fu};var Gu=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new nl}else if(ll(arguments[0],vl)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var r=0;r<this._coordinates.length;r++)this._coordinates[r]=n.getCoordinateCopy(r)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var i=arguments[0],o=arguments[1];this._coordinates=i,this._dimension=o,null===i&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var a=arguments[0],s=arguments[1];this._coordinates=new Array(a).fill(null),this._dimension=s;for(var l=0;l<a;l++)this._coordinates[l]=new nl}},Uu={serialVersionUID:{configurable:!0}};Gu.prototype.setOrdinate=function(t,e,n){switch(e){case vl.X:this._coordinates[t].x=n;break;case vl.Y:this._coordinates[t].y=n;break;case vl.Z:this._coordinates[t].z=n;break;default:throw new Ks("invalid ordinateIndex")}},Gu.prototype.size=function(){return this._coordinates.length},Gu.prototype.getOrdinate=function(t,e){switch(e){case vl.X:return this._coordinates[t].x;case vl.Y:return this._coordinates[t].y;case vl.Z:return this._coordinates[t].z}return Js.NaN},Gu.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},Gu.prototype.getCoordinateCopy=function(t){return new nl(this._coordinates[t])},Gu.prototype.getDimension=function(){return this._dimension},Gu.prototype.getX=function(t){return this._coordinates[t].x},Gu.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new Gu(t,this._dimension)},Gu.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},Gu.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new Gu(t,this._dimension)},Gu.prototype.toString=function(){if(this._coordinates.length>0){var t=new hl(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},Gu.prototype.getY=function(t){return this._coordinates[t].y},Gu.prototype.toCoordinateArray=function(){return this._coordinates},Gu.prototype.interfaces_=function(){return[vl,mi]},Gu.prototype.getClass=function(){return Gu},Uu.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Gu,Uu);var qu=function(){},Hu={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};qu.prototype.readResolve=function(){return qu.instance()},qu.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new Gu(t)}if(ll(arguments[0],vl)){var e=arguments[0];return new Gu(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return r>3&&(r=3),r<2?new Gu(n):new Gu(n,r)}},qu.prototype.interfaces_=function(){return[ol,mi]},qu.prototype.getClass=function(){return qu},qu.instance=function(){return qu.instanceObject},Hu.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},Hu.instanceObject.get=function(){return new qu},Object.defineProperties(qu,Hu);var Vu=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new nu,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new hu;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(uu),Yu=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Xu){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}},Wu={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Yu.prototype.equals=function(t){if(!(t instanceof Yu))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},Yu.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),r=e.getMaximumSignificantDigits();return new fl(n).compareTo(new fl(r))},Yu.prototype.getScale=function(){return this._scale},Yu.prototype.isFloating=function(){return this._modelType===Yu.FLOATING||this._modelType===Yu.FLOATING_SINGLE},Yu.prototype.getType=function(){return this._modelType},Yu.prototype.toString=function(){var t="UNKNOWN";return this._modelType===Yu.FLOATING?t="Floating":this._modelType===Yu.FLOATING_SINGLE?t="Floating-Single":this._modelType===Yu.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},Yu.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return Js.isNaN(t)||this._modelType===Yu.FLOATING_SINGLE?t:this._modelType===Yu.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof nl){var e=arguments[0];if(this._modelType===Yu.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},Yu.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===Yu.FLOATING?t=16:this._modelType===Yu.FLOATING_SINGLE?t=6:this._modelType===Yu.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},Yu.prototype.setScale=function(t){this._scale=Math.abs(t)},Yu.prototype.interfaces_=function(){return[mi,$s]},Yu.prototype.getClass=function(){return Yu},Yu.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},Wu.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},Wu.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Yu,Wu);var Xu=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},Zu={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Xu.prototype.readResolve=function(){return Xu.nameToTypeMap.get(this._name)},Xu.prototype.toString=function(){return this._name},Xu.prototype.interfaces_=function(){return[mi]},Xu.prototype.getClass=function(){return Xu},Zu.serialVersionUID.get=function(){return-552860263173159e4},Zu.nameToTypeMap.get=function(){return new Vu},Object.defineProperties(Xu,Zu),Yu.Type=Xu,Yu.FIXED=new Xu("FIXED"),Yu.FLOATING=new Xu("FLOATING"),Yu.FLOATING_SINGLE=new Xu("FLOATING SINGLE");var Ku=function t(){this._precisionModel=new Yu,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?ll(arguments[0],ol)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Yu&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Ju={serialVersionUID:{configurable:!0}};Ku.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new nl(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new nl(t.getMinX(),t.getMinY()),new nl(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new nl(t.getMinX(),t.getMinY()),new nl(t.getMinX(),t.getMaxY()),new nl(t.getMaxX(),t.getMaxY()),new nl(t.getMaxX(),t.getMinY()),new nl(t.getMinX(),t.getMinY())]),null)},Ku.prototype.createLineString=function(t){return t?t instanceof Array?new Pu(this.getCoordinateSequenceFactory().create(t),this):ll(t,vl)?new Pu(t,this):void 0:new Pu(this.getCoordinateSequenceFactory().create([]),this)},Ku.prototype.createMultiLineString=function(){if(0===arguments.length)return new xu(null,this);if(1===arguments.length){var t=arguments[0];return new xu(t,this)}},Ku.prototype.buildGeometry=function(t){for(var e=null,n=!1,r=!1,i=t.iterator();i.hasNext();){var o=i.next(),a=o.getClass();null===e&&(e=a),a!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(r=!0)}if(null===e)return this.createGeometryCollection();if(n||r)return this.createGeometryCollection(Ku.toGeometryArray(t));var s=t.iterator().next();if(t.size()>1){if(s instanceof Iu)return this.createMultiPolygon(Ku.toPolygonArray(t));if(s instanceof Pu)return this.createMultiLineString(Ku.toLineStringArray(t));if(s instanceof Tu)return this.createMultiPoint(Ku.toPointArray(t));Nl.shouldNeverReachHere("Unhandled class: "+s.getClass().getName())}return s},Ku.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},Ku.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof nl){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(ll(arguments[0],vl)){var e=arguments[0];return new Tu(e,this)}}},Ku.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Ku.prototype.createPolygon=function(){if(0===arguments.length)return new Iu(null,null,this);if(1===arguments.length){if(ll(arguments[0],vl)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Du){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];return new Iu(r,i,this)}},Ku.prototype.getSRID=function(){return this._SRID},Ku.prototype.createGeometryCollection=function(){if(0===arguments.length)return new wu(null,this);if(1===arguments.length){var t=arguments[0];return new wu(t,this)}},Ku.prototype.createGeometry=function(t){return new Au(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},Ku.prototype.getPrecisionModel=function(){return this._precisionModel},Ku.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(ll(arguments[0],vl)){var e=arguments[0];return new Du(e,this)}}},Ku.prototype.createMultiPolygon=function(){if(0===arguments.length)return new Ru(null,this);if(1===arguments.length){var t=arguments[0];return new Ru(t,this)}},Ku.prototype.createMultiPoint=function(){if(0===arguments.length)return new Nu(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new Nu(t,this)}if(arguments[0]instanceof Array){var e=arguments[0];return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(ll(arguments[0],vl)){var n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var r=new Array(n.size()).fill(null),i=0;i<n.size();i++){var o=this.getCoordinateSequenceFactory().create(1,n.getDimension());Su.copy(n,i,o,0,1),r[i]=this.createPoint(o)}return this.createMultiPoint(r)}}},Ku.prototype.interfaces_=function(){return[mi]},Ku.prototype.getClass=function(){return Ku},Ku.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ku.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},Ku.getDefaultCoordinateSequenceFactory=function(){return qu.instance()},Ku.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ku.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ku.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ku.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ku.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ku.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ku.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},Ju.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(Ku,Ju);var Qu=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],$u=function(t){this.geometryFactory=t||new Ku};$u.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!tc[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==Qu.indexOf(n)?tc[n].apply(this,[e.coordinates]):"GeometryCollection"===n?tc[n].apply(this,[e.geometries]):tc[n].apply(this,[e])},$u.prototype.write=function(t){var e=t.getGeometryType();if(!ec[e])throw new Error("Geometry is not supported");return ec[e].apply(this,[t])};var tc={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var r=t.geometry.type;if(!tc[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=tc.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(new nl(r[0],r[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new nl(t[0],t[1]),new nl(t[2],t[1]),new nl(t[2],t[3]),new nl(t[0],t[3]),new nl(t[0],t[1])])},Point:function(t){var e=new nl(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(tc.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=tc.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(tc.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=tc.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),r=[],i=1;i<t.length;++i){var o=t[i],a=tc.coordinates.apply(this,[o]),s=this.geometryFactory.createLinearRing(a);r.push(s)}return this.geometryFactory.createPolygon(n,r)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(tc.Polygon.apply(this,[r]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(this.read(r))}return this.geometryFactory.createGeometryCollection(e)}},ec={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:ec.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=ec.Point.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),r=0;r<n.length;++r){var i=n[r];e.push(ec.coordinate.apply(this,[i]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=ec.LineString.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=ec.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var r=0;r<t._holes.length;++r){var i=t._holes[r],o=ec.LineString.apply(this,[i]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=ec.Polygon.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=r.getGeometryType();e.push(ec[i].apply(this,[r]))}return{type:"GeometryCollection",geometries:e}}},nc=function(t){this.geometryFactory=t||new Ku,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new $u(this.geometryFactory)};nc.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Yu.FIXED&&this.reducePrecision(e),e},nc.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var rc=function(){this.parser=new $u(this.geometryFactory)};rc.prototype.write=function(t){return this.parser.write(t)};var ic=function(){},oc={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};ic.prototype.interfaces_=function(){return[]},ic.prototype.getClass=function(){return ic},ic.opposite=function(t){return t===ic.LEFT?ic.RIGHT:t===ic.RIGHT?ic.LEFT:t},oc.ON.get=function(){return 0},oc.LEFT.get=function(){return 1},oc.RIGHT.get=function(){return 2},Object.defineProperties(ic,oc),(Ti.prototype=new Error).name="EmptyStackException",(Oi.prototype=new eu).add=function(t){return this.array_.push(t),!0},Oi.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},Oi.prototype.push=function(t){return this.array_.push(t),t},Oi.prototype.pop=function(t){if(0===this.array_.length)throw new Ti;return this.array_.pop()},Oi.prototype.peek=function(){if(0===this.array_.length)throw new Ti;return this.array_[this.array_.length-1]},Oi.prototype.empty=function(){return 0===this.array_.length},Oi.prototype.isEmpty=function(){return this.empty()},Oi.prototype.search=function(t){return this.array_.indexOf(t)},Oi.prototype.size=function(){return this.array_.length},Oi.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var ac=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};ac.prototype.getCoordinate=function(){return this._minCoord},ac.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},ac.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();Nl.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],r=zl.computeOrientation(this._minCoord,n,e),i=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&r===zl.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&r===zl.CLOCKWISE)&&(i=!0),i&&(this._minIndex=this._minIndex-1)},ac.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var r=ic.LEFT;return n[e].y<n[e+1].y&&(r=ic.RIGHT),r},ac.prototype.getEdge=function(){return this._orientedDe},ac.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},ac.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},ac.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}Nl.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===ic.LEFT&&(this._orientedDe=this._minDe.getSym())},ac.prototype.interfaces_=function(){return[]},ac.prototype.getClass=function(){return ac};var sc=function(t){function e(n,r){t.call(this,e.msgWithCoord(n,r)),this.pt=r?new nl(r):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}(Ol),lc=function(){this.array_=[]};lc.prototype.addLast=function(t){this.array_.push(t)},lc.prototype.removeFirst=function(){return this.array_.shift()},lc.prototype.isEmpty=function(){return 0===this.array_.length};var uc=function(){this._finder=null,this._dirEdgeList=new nu,this._nodes=new nu,this._rightMostCoord=null,this._env=null,this._finder=new ac};uc.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},uc.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},uc.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var r=n.next();if(r.isVisited()||r.getSym().isVisited()){e=r;break}}if(null===e)throw new sc("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var i=t.getEdges().iterator();i.hasNext();){var o=i.next();o.setVisited(!0),this.copySymDepths(o)}},uc.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(ic.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},uc.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},uc.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(ic.RIGHT)>=1&&e.getDepth(ic.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},uc.prototype.computeDepths=function(t){var e=new hu,n=new lc,r=t.getNode();for(n.addLast(r),e.add(r),t.setVisited(!0);!n.isEmpty();){var i=n.removeFirst();e.add(i),this.computeNodeDepth(i);for(var o=i.getEdges().iterator();o.hasNext();){var a=o.next().getSym();if(!a.isVisited()){var s=a.getNode();e.contains(s)||(n.addLast(s),e.add(s))}}}},uc.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},uc.prototype.getEnvelope=function(){if(null===this._env){for(var t=new El,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),r=0;r<n.length-1;r++)t.expandToInclude(n[r]);this._env=t}return this._env},uc.prototype.addReachable=function(t){var e=new Oi;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},uc.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(ic.LEFT,t.getDepth(ic.RIGHT)),e.setDepth(ic.RIGHT,t.getDepth(ic.LEFT))},uc.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var r=n.next();this._dirEdgeList.add(r);var i=r.getSym().getNode();i.isVisited()||e.push(i)}},uc.prototype.getNodes=function(){return this._nodes},uc.prototype.getDirectedEdges=function(){return this._dirEdgeList},uc.prototype.interfaces_=function(){return[$s]},uc.prototype.getClass=function(){return uc};var cc=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[ic.ON]=n}else if(arguments[0]instanceof t){var r=arguments[0];if(this.init(r.location.length),null!==r)for(var i=0;i<this.location.length;i++)this.location[i]=r.location[i]}}else if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];this.init(3),this.location[ic.ON]=o,this.location[ic.LEFT]=a,this.location[ic.RIGHT]=s}};cc.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},cc.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==al.NONE)return!1;return!0},cc.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===al.NONE&&(this.location[e]=t)},cc.prototype.isLine=function(){return 1===this.location.length},cc.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[ic.ON]=this.location[ic.ON],e[ic.LEFT]=al.NONE,e[ic.RIGHT]=al.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===al.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},cc.prototype.getLocations=function(){return this.location},cc.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[ic.LEFT];this.location[ic.LEFT]=this.location[ic.RIGHT],this.location[ic.RIGHT]=t},cc.prototype.toString=function(){var t=new hl;return this.location.length>1&&t.append(al.toLocationSymbol(this.location[ic.LEFT])),t.append(al.toLocationSymbol(this.location[ic.ON])),this.location.length>1&&t.append(al.toLocationSymbol(this.location[ic.RIGHT])),t.toString()},cc.prototype.setLocations=function(t,e,n){this.location[ic.ON]=t,this.location[ic.LEFT]=e,this.location[ic.RIGHT]=n},cc.prototype.get=function(t){return t<this.location.length?this.location[t]:al.NONE},cc.prototype.isArea=function(){return this.location.length>1},cc.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===al.NONE)return!0;return!1},cc.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(ic.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},cc.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(al.NONE)},cc.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},cc.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},cc.prototype.interfaces_=function(){return[]},cc.prototype.getClass=function(){return cc};var hc=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new cc(e),this.elt[1]=new cc(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new cc(n.elt[0]),this.elt[1]=new cc(n.elt[1])}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.elt[0]=new cc(al.NONE),this.elt[1]=new cc(al.NONE),this.elt[r].setLocation(i)}else if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];this.elt[0]=new cc(o,a,s),this.elt[1]=new cc(o,a,s)}else if(4===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2],h=arguments[3];this.elt[0]=new cc(al.NONE,al.NONE,al.NONE),this.elt[1]=new cc(al.NONE,al.NONE,al.NONE),this.elt[l].setLocations(u,c,h)}};hc.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},hc.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},hc.prototype.isNull=function(t){return this.elt[t].isNull()},hc.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},hc.prototype.isLine=function(t){return this.elt[t].isLine()},hc.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new cc(t.elt[e]):this.elt[e].merge(t.elt[e])},hc.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},hc.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(ic.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},hc.prototype.toString=function(){var t=new hl;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},hc.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},hc.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},hc.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(ic.ON,e)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.elt[n].setLocation(r,i)}},hc.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},hc.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},hc.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new cc(this.elt[t].location[0]))},hc.prototype.interfaces_=function(){return[]},hc.prototype.getClass=function(){return hc},hc.toLineLabel=function(t){for(var e=new hc(al.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var fc=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new nu,this._pts=new nu,this._label=new hc(al.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new nu,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};fc.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=zl.isCCW(this._ring.getCoordinates())},fc.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},fc.prototype.computePoints=function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new sc("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new sc("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var r=e.getLabel();Nl.isTrue(r.isArea()),this.mergeLabel(r),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},fc.prototype.getLinearRing=function(){return this._ring},fc.prototype.getCoordinate=function(t){return this._pts.get(t)},fc.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},fc.prototype.addPoints=function(t,e,n){var r=t.getCoordinates();if(e){var i=1;n&&(i=0);for(var o=i;o<r.length;o++)this._pts.add(r[o])}else{var a=r.length-2;n&&(a=r.length-1);for(var s=a;s>=0;s--)this._pts.add(r[s])}},fc.prototype.isHole=function(){return this._isHole},fc.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},fc.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!zl.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},fc.prototype.addHole=function(t){this._holes.add(t)},fc.prototype.isShell=function(){return null===this._shell},fc.prototype.getLabel=function(){return this._label},fc.prototype.getEdges=function(){return this._edges},fc.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},fc.prototype.getShell=function(){return this._shell},fc.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=e.getLocation(n,ic.RIGHT);if(r===al.NONE)return null;if(this._label.getLocation(n)===al.NONE)return this._label.setLocation(n,r),null}},fc.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},fc.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},fc.prototype.interfaces_=function(){return[]},fc.prototype.getClass=function(){return fc};var pc=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(fc),dc=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new nu,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new pc(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(fc),gc=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};gc.prototype.setVisited=function(t){this._isVisited=t},gc.prototype.setInResult=function(t){this._isInResult=t},gc.prototype.isCovered=function(){return this._isCovered},gc.prototype.isCoveredSet=function(){return this._isCoveredSet},gc.prototype.setLabel=function(t){this._label=t},gc.prototype.getLabel=function(){return this._label},gc.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},gc.prototype.updateIM=function(t){Nl.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},gc.prototype.isInResult=function(){return this._isInResult},gc.prototype.isVisited=function(){return this._isVisited},gc.prototype.interfaces_=function(){return[]},gc.prototype.getClass=function(){return gc};var yc=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new hc(0,al.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=al.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var r=t.getLocation(e);n!==al.BOUNDARY&&(n=r)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new hc(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof hc)for(var n=arguments[0],r=0;r<2;r++){var i=this.computeMergedLocation(n,r);this._label.getLocation(r)===al.NONE&&this._label.setLocation(r,i)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=al.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case al.BOUNDARY:n=al.INTERIOR;break;case al.INTERIOR:default:n=al.BOUNDARY}this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(gc),mc=function(){this.nodeMap=new ki,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};mc.prototype.find=function(t){return this.nodeMap.get(t)},mc.prototype.addNode=function(){if(arguments[0]instanceof nl){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof yc){var n=arguments[0],r=this.nodeMap.get(n.getCoordinate());return null===r?(this.nodeMap.put(n.getCoordinate(),n),n):(r.mergeLabel(n),r)}},mc.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},mc.prototype.iterator=function(){return this.nodeMap.values().iterator()},mc.prototype.values=function(){return this.nodeMap.values()},mc.prototype.getBoundaryNodes=function(t){for(var e=new nu,n=this.iterator();n.hasNext();){var r=n.next();r.getLabel().getLocation(t)===al.BOUNDARY&&e.add(r)}return e},mc.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},mc.prototype.interfaces_=function(){return[]},mc.prototype.getClass=function(){return mc};var vc=function(){},_c={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};vc.prototype.interfaces_=function(){return[]},vc.prototype.getClass=function(){return vc},vc.isNorthern=function(t){return t===vc.NE||t===vc.NW},vc.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},vc.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},vc.isInHalfPlane=function(t,e){return e===vc.SE?t===vc.SE||t===vc.SW:t===e||t===e+1},vc.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new Ks("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?vc.NE:vc.SE:e>=0?vc.NW:vc.SW}if(arguments[0]instanceof nl&&arguments[1]instanceof nl){var n=arguments[0],r=arguments[1];if(r.x===n.x&&r.y===n.y)throw new Ks("Cannot compute the quadrant for two identical points "+n);return r.x>=n.x?r.y>=n.y?vc.NE:vc.SE:r.y>=n.y?vc.NW:vc.SW}},_c.NE.get=function(){return 0},_c.NW.get=function(){return 1},_c.SW.get=function(){return 2},_c.SE.get=function(){return 3},Object.defineProperties(vc,_c);var bc=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];this._edge=e,this.init(n,r),this._label=null}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this._edge=i,this.init(o,a),this._label=s}};bc.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:zl.computeOrientation(t._p0,t._p1,this._p1)},bc.prototype.getDy=function(){return this._dy},bc.prototype.getCoordinate=function(){return this._p0},bc.prototype.setNode=function(t){this._node=t},bc.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),i=n.substring(r+1);t.print("  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},bc.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},bc.prototype.getDirectedCoordinate=function(){return this._p1},bc.prototype.getDx=function(){return this._dx},bc.prototype.getLabel=function(){return this._label},bc.prototype.getEdge=function(){return this._edge},bc.prototype.getQuadrant=function(){return this._quadrant},bc.prototype.getNode=function(){return this._node},bc.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},bc.prototype.computeLabel=function(t){},bc.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=vc.quadrant(this._dx,this._dy),Nl.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},bc.prototype.interfaces_=function(){return[$s]},bc.prototype.getClass=function(){return bc};var wc=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var r=e.getNumPoints()-1;this.init(e.getCoordinate(r),e.getCoordinate(r-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new hc(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new sc("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,ic.LEFT)===al.INTERIOR&&this._label.getLocation(e,ic.RIGHT)===al.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[ic.LEFT]+"/"+this._depth[ic.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,al.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,al.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var r=1;t===ic.LEFT&&(r=-1);var i=ic.opposite(t),o=e+n*r;this.setDepth(t,e),this.setDepth(i,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===al.EXTERIOR&&e===al.INTERIOR?1:t===al.INTERIOR&&e===al.EXTERIOR?-1:0},e}(bc),xc=function(){};xc.prototype.createNode=function(t){return new yc(t,null)},xc.prototype.interfaces_=function(){return[]},xc.prototype.getClass=function(){return xc};var Lc=function(){if(this._edges=new nu,this._nodes=null,this._edgeEndList=new nu,0===arguments.length)this._nodes=new mc(new xc);else if(1===arguments.length){var t=arguments[0];this._nodes=new mc(t)}};Lc.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},Lc.prototype.find=function(t){return this._nodes.find(t)},Lc.prototype.addNode=function(){if(arguments[0]instanceof yc){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof nl){var e=arguments[0];return this._nodes.addNode(e)}},Lc.prototype.getNodeIterator=function(){return this._nodes.iterator()},Lc.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},Lc.prototype.debugPrintln=function(t){xl.out.println(t)},Lc.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var r=n.getLabel();return null!==r&&r.getLocation(t)===al.BOUNDARY},Lc.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},Lc.prototype.matchInSameDirection=function(t,e,n,r){return!!t.equals(n)&&zl.computeOrientation(t,e,r)===zl.COLLINEAR&&vc.quadrant(t,e)===vc.quadrant(n,r)},Lc.prototype.getEdgeEnds=function(){return this._edgeEndList},Lc.prototype.debugPrint=function(t){xl.out.print(t)},Lc.prototype.getEdgeIterator=function(){return this._edges.iterator()},Lc.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(this.matchInSameDirection(t,e,i[0],i[1]))return r;if(this.matchInSameDirection(t,e,i[i.length-1],i[i.length-2]))return r}return null},Lc.prototype.insertEdge=function(t){this._edges.add(t)},Lc.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},Lc.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var r=new wc(n,!0),i=new wc(n,!1);r.setSym(i),i.setSym(r),this.add(r),this.add(i)}},Lc.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},Lc.prototype.getNodes=function(){return this._nodes.values()},Lc.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(t.equals(i[0])&&e.equals(i[1]))return r}return null},Lc.prototype.interfaces_=function(){return[]},Lc.prototype.getClass=function(){return Lc},Lc.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var Ec=function(){this._geometryFactory=null,this._shellList=new nu;var t=arguments[0];this._geometryFactory=t};Ec.prototype.sortShellsAndHoles=function(t,e,n){for(var r=t.iterator();r.hasNext();){var i=r.next();i.isHole()?n.add(i):e.add(i)}},Ec.prototype.computePolygons=function(t){for(var e=new nu,n=t.iterator();n.hasNext();){var r=n.next().toPolygon(this._geometryFactory);e.add(r)}return e},Ec.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(null===r.getShell()){var i=this.findEdgeRingContaining(r,t);if(null===i)throw new sc("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(i)}}},Ec.prototype.buildMinimalEdgeRings=function(t,e,n){for(var r=new nu,i=t.iterator();i.hasNext();){var o=i.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var a=o.buildMinimalRings(),s=this.findShell(a);null!==s?(this.placePolygonHoles(s,a),e.add(s)):n.addAll(a)}else r.add(o)}return r},Ec.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},Ec.prototype.buildMaximalEdgeRings=function(t){for(var e=new nu,n=t.iterator();n.hasNext();){var r=n.next();if(r.isInResult()&&r.getLabel().isArea()&&null===r.getEdgeRing()){var i=new dc(r,this._geometryFactory);e.add(i),i.setInResult()}}return e},Ec.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(t)}},Ec.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Ec.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),r=n.getEnvelopeInternal(),i=n.getCoordinateN(0),o=null,a=null,s=e.iterator();s.hasNext();){var l=s.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();null!==o&&(a=o.getLinearRing().getEnvelopeInternal());var h=!1;c.contains(r)&&zl.isPointInRing(i,u.getCoordinates())&&(h=!0),h&&(null===o||a.contains(c))&&(o=l)}return o},Ec.prototype.findShell=function(t){for(var e=0,n=null,r=t.iterator();r.hasNext();){var i=r.next();i.isHole()||(n=i,e++)}return Nl.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},Ec.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Lc.linkResultDirectedEdges(n);var r=this.buildMaximalEdgeRings(e),i=new nu,o=this.buildMinimalEdgeRings(r,this._shellList,i);this.sortShellsAndHoles(o,this._shellList,i),this.placeFreeHoles(this._shellList,i)}},Ec.prototype.interfaces_=function(){return[]},Ec.prototype.getClass=function(){return Ec};var Cc=function(){};Cc.prototype.getBounds=function(){},Cc.prototype.interfaces_=function(){return[]},Cc.prototype.getClass=function(){return Cc};var kc=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};kc.prototype.getItem=function(){return this._item},kc.prototype.getBounds=function(){return this._bounds},kc.prototype.interfaces_=function(){return[Cc,mi]},kc.prototype.getClass=function(){return kc};var Sc=function(){this._size=null,this._items=null,this._size=0,this._items=new nu,this._items.add(null)};Sc.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},Sc.prototype.size=function(){return this._size},Sc.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},Sc.prototype.clear=function(){this._size=0,this._items.clear()},Sc.prototype.isEmpty=function(){return 0===this._size},Sc.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Sc.prototype.interfaces_=function(){return[]},Sc.prototype.getClass=function(){return Sc};var Pc=function(){};Pc.prototype.visitItem=function(t){},Pc.prototype.interfaces_=function(){return[]},Pc.prototype.getClass=function(){return Pc};var Mc=function(){};Mc.prototype.insert=function(t,e){},Mc.prototype.remove=function(t,e){},Mc.prototype.query=function(){},Mc.prototype.interfaces_=function(){return[]},Mc.prototype.getClass=function(){return Mc};var Tc=function(){if(this._childBoundables=new nu,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Oc={serialVersionUID:{configurable:!0}};Tc.prototype.getLevel=function(){return this._level},Tc.prototype.size=function(){return this._childBoundables.size()},Tc.prototype.getChildBoundables=function(){return this._childBoundables},Tc.prototype.addChildBoundable=function(t){Nl.isTrue(null===this._bounds),this._childBoundables.add(t)},Tc.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Tc.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Tc.prototype.interfaces_=function(){return[Cc,mi]},Tc.prototype.getClass=function(){return Tc},Oc.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Tc,Oc);var Ic=function(){};Ic.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Ic.min=function(t){return Ic.sort(t),t.get(0)},Ic.sort=function(t,e){var n=t.toArray();e?yu.sort(n,e):yu.sort(n);for(var r=t.iterator(),i=0,o=n.length;i<o;i++)r.next(),r.set(n[i])},Ic.singletonList=function(t){var e=new nu;return e.add(t),e};var Nc=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};Nc.prototype.expandToQueue=function(t,e){var n=Nc.isComposite(this._boundable1),r=Nc.isComposite(this._boundable2);if(n&&r)return Nc.area(this._boundable1)>Nc.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(r)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new Ks("neither boundable is composite")},Nc.prototype.isLeaves=function(){return!(Nc.isComposite(this._boundable1)||Nc.isComposite(this._boundable2))},Nc.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},Nc.prototype.expand=function(t,e,n,r){for(var i=t.getChildBoundables().iterator();i.hasNext();){var o=i.next(),a=new Nc(o,e,this._itemDistance);a.getDistance()<r&&n.add(a)}},Nc.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},Nc.prototype.getDistance=function(){return this._distance},Nc.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Nc.prototype.interfaces_=function(){return[$s]},Nc.prototype.getClass=function(){return Nc},Nc.area=function(t){return t.getBounds().getArea()},Nc.isComposite=function(t){return t instanceof Tc};var Dc=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new nu,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];Nl.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},Rc={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Dc.prototype.getNodeCapacity=function(){return this._nodeCapacity},Dc.prototype.lastNode=function(t){return t.get(t.size()-1)},Dc.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Tc?t+=this.size(n):n instanceof kc&&(t+=1)}return t}},Dc.prototype.removeItem=function(t,e){for(var n=null,r=t.getChildBoundables().iterator();r.hasNext();){var i=r.next();i instanceof kc&&i.getItem()===e&&(n=i)}return null!==n&&(t.getChildBoundables().remove(n),!0)},Dc.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new nu:t}if(1===arguments.length){for(var e=arguments[0],n=new nu,r=e.getChildBoundables().iterator();r.hasNext();){var i=r.next();if(i instanceof Tc){var o=this.itemsTree(i);null!==o&&n.add(o)}else i instanceof kc?n.add(i.getItem()):Nl.shouldNeverReachHere()}return n.size()<=0?null:n}},Dc.prototype.insert=function(t,e){Nl.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new kc(t,e))},Dc.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new nu;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];if(Nl.isTrue(n>-2),r.getLevel()===n)return i.add(r),null;for(var o=r.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof Tc?this.boundablesAtLevel(n,a,i):(Nl.isTrue(a instanceof kc),-1===n&&i.add(a))}return null}},Dc.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new nu;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r)}else if(3===arguments.length)if(ll(arguments[2],Pc)&&arguments[0]instanceof Object&&arguments[1]instanceof Tc)for(var i=arguments[0],o=arguments[1],a=arguments[2],s=o.getChildBoundables(),l=0;l<s.size();l++){var u=s.get(l);this.getIntersectsOp().intersects(u.getBounds(),i)&&(u instanceof Tc?this.query(i,u,a):u instanceof kc?a.visitItem(u.getItem()):Nl.shouldNeverReachHere())}else if(ll(arguments[2],eu)&&arguments[0]instanceof Object&&arguments[1]instanceof Tc)for(var c=arguments[0],h=arguments[1],f=arguments[2],p=h.getChildBoundables(),d=0;d<p.size();d++){var g=p.get(d);this.getIntersectsOp().intersects(g.getBounds(),c)&&(g instanceof Tc?this.query(c,g,f):g instanceof kc?f.add(g.getItem()):Nl.shouldNeverReachHere())}},Dc.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},Dc.prototype.getRoot=function(){return this.build(),this._root},Dc.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=this.removeItem(r,i);if(o)return!0;for(var a=null,s=r.getChildBoundables().iterator();s.hasNext();){var l=s.next();if(this.getIntersectsOp().intersects(l.getBounds(),n)&&l instanceof Tc&&(o=this.remove(n,l,i))){a=l;break}}return null!==a&&a.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(a),o}},Dc.prototype.createHigherLevels=function(t,e){Nl.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},Dc.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Tc){var r=this.depth(n);r>t&&(t=r)}}return t+1}},Dc.prototype.createParentBoundables=function(t,e){Nl.isTrue(!t.isEmpty());var n=new nu;n.add(this.createNode(e));var r=new nu(t);Ic.sort(r,this.getComparator());for(var i=r.iterator();i.hasNext();){var o=i.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},Dc.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},Dc.prototype.interfaces_=function(){return[mi]},Dc.prototype.getClass=function(){return Dc},Dc.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},Rc.IntersectsOp.get=function(){return Ac},Rc.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},Rc.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(Dc,Rc);var Ac=function(){},jc=function(){};jc.prototype.distance=function(t,e){},jc.prototype.interfaces_=function(){return[]},jc.prototype.getClass=function(){return jc};var Bc=function(t){function e(n){n=n||e.DEFAULT_NODE_CAPACITY,t.call(this,n)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return e.prototype.createParentBoundablesFromVerticalSlices=function(t,e){Nl.isTrue(t.length>0);for(var n=new nu,r=0;r<t.length;r++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[r],e));return n},e.prototype.createNode=function(t){return new zc(t)},e.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},e.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,n)},e.prototype.getIntersectsOp=function(){return e.intersectsOp},e.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),r=new Array(e).fill(null),i=t.iterator(),o=0;o<e;o++){r[o]=new nu;for(var a=0;i.hasNext()&&a<n;){var s=i.next();r[o].add(s),a++}}return r},e.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],r=arguments[1];t.prototype.query.call(this,n,r)}else if(3===arguments.length)if(ll(arguments[2],Pc)&&arguments[0]instanceof Object&&arguments[1]instanceof Tc){var i=arguments[0],o=arguments[1],a=arguments[2];t.prototype.query.call(this,i,o,a)}else if(ll(arguments[2],eu)&&arguments[0]instanceof Object&&arguments[1]instanceof Tc){var s=arguments[0],l=arguments[1],u=arguments[2];t.prototype.query.call(this,s,l,u)}},e.prototype.getComparator=function(){return e.yComparator},e.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},e.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},e.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},e.prototype.createParentBoundables=function(t,n){Nl.isTrue(!t.isEmpty());var r=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new nu(t);Ic.sort(i,e.xComparator);var o=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(r))));return this.createParentBoundablesFromVerticalSlices(o,n)},e.prototype.nearestNeighbour=function(){if(1===arguments.length){if(ll(arguments[0],jc)){var t=arguments[0],n=new Nc(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(n)}if(arguments[0]instanceof Nc){var r=arguments[0];return this.nearestNeighbour(r,Js.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof e&&ll(arguments[1],jc)){var i=arguments[0],o=arguments[1],a=new Nc(this.getRoot(),i.getRoot(),o);return this.nearestNeighbour(a)}if(arguments[0]instanceof Nc&&"number"==typeof arguments[1]){var s=arguments[0],l=arguments[1],u=null,c=new Sc;for(c.add(s);!c.isEmpty()&&l>0;){var h=c.poll(),f=h.getDistance();if(f>=l)break;h.isLeaves()?(l=f,u=h):h.expandToQueue(c,l)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var p=arguments[0],d=arguments[1],g=arguments[2],y=new kc(p,d),m=new Nc(this.getRoot(),y,g);return this.nearestNeighbour(m)[0]}},e.prototype.interfaces_=function(){return[Mc,mi]},e.prototype.getClass=function(){return e},e.centreX=function(t){return e.avg(t.getMinX(),t.getMaxX())},e.avg=function(t,e){return(t+e)/2},e.centreY=function(t){return e.avg(t.getMinY(),t.getMaxY())},n.STRtreeNode.get=function(){return zc},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[el]},compare:function(n,r){return t.compareDoubles(e.centreX(n.getBounds()),e.centreX(r.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[el]},compare:function(n,r){return t.compareDoubles(e.centreY(n.getBounds()),e.centreY(r.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(e,n),e}(Dc),zc=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new El(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Tc),Fc=function(){};Fc.prototype.interfaces_=function(){return[]},Fc.prototype.getClass=function(){return Fc},Fc.relativeSign=function(t,e){return t<e?-1:t>e?1:0},Fc.compare=function(t,e,n){if(e.equals2D(n))return 0;var r=Fc.relativeSign(e.x,n.x),i=Fc.relativeSign(e.y,n.y);switch(t){case 0:return Fc.compareValue(r,i);case 1:return Fc.compareValue(i,r);case 2:return Fc.compareValue(i,-r);case 3:return Fc.compareValue(-r,i);case 4:return Fc.compareValue(-r,-i);case 5:return Fc.compareValue(-i,-r);case 6:return Fc.compareValue(-i,r);case 7:return Fc.compareValue(r,-i)}return Nl.shouldNeverReachHere("invalid octant value"),0},Fc.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var Gc=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._segString=t,this.coord=new nl(e),this.segmentIndex=n,this._segmentOctant=r,this._isInterior=!e.equals2D(t.getCoordinate(n))};Gc.prototype.getCoordinate=function(){return this.coord},Gc.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},Gc.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:Fc.compare(this._segmentOctant,this.coord,e.coord)},Gc.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},Gc.prototype.isInterior=function(){return this._isInterior},Gc.prototype.interfaces_=function(){return[$s]},Gc.prototype.getClass=function(){return Gc};var Uc=function(){this._nodeMap=new ki,this._edge=null;var t=arguments[0];this._edge=t};Uc.prototype.getSplitCoordinates=function(){var t=new iu;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next();this.addEdgeCoordinates(n,r,t),n=r}return t.toCoordinateArray()},Uc.prototype.addCollapsedNodes=function(){var t=new nu;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},Uc.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Uc.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),r=this._edge.getCoordinate(e+2);n.equals2D(r)&&t.add(new fl(e+1))}},Uc.prototype.addEdgeCoordinates=function(t,e,n){var r=this._edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(r);n.add(new nl(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));i&&n.add(new nl(e.coord))},Uc.prototype.iterator=function(){return this._nodeMap.values().iterator()},Uc.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},Uc.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var r=e.segmentIndex-t.segmentIndex;return e.isInterior()||r--,1===r&&(n[0]=t.segmentIndex+1,!0)},Uc.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),r=n.next();n.hasNext();){var i=n.next();this.findCollapseIndex(r,i,e)&&t.add(new fl(e[0])),r=i}},Uc.prototype.getEdge=function(){return this._edge},Uc.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},Uc.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this._edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),a=0;o[a++]=new nl(t.coord);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)o[a++]=this._edge.getCoordinate(s);return i&&(o[a]=new nl(e.coord)),new Yc(o,this._edge.getData())},Uc.prototype.add=function(t,e){var n=new Gc(this._edge,t,e,this._edge.getSegmentOctant(e)),r=this._nodeMap.get(n);return null!==r?(Nl.isTrue(r.coord.equals2D(t),"Found equal nodes with different coordinates"),r):(this._nodeMap.put(n,n),n)},Uc.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new Ol("bad split edge start point at "+n);var r=t.get(t.size()-1).getCoordinates(),i=r[r.length-1];if(!i.equals2D(e[e.length-1]))throw new Ol("bad split edge end point at "+i)},Uc.prototype.interfaces_=function(){return[]},Uc.prototype.getClass=function(){return Uc};var qc=function(){};qc.prototype.interfaces_=function(){return[]},qc.prototype.getClass=function(){return qc},qc.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new Ks("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),r=Math.abs(e);return t>=0?e>=0?n>=r?0:1:n>=r?7:6:e>=0?n>=r?3:2:n>=r?4:5}if(arguments[0]instanceof nl&&arguments[1]instanceof nl){var i=arguments[0],o=arguments[1],a=o.x-i.x,s=o.y-i.y;if(0===a&&0===s)throw new Ks("Cannot compute the octant for two identical points "+i);return qc.octant(a,s)}};var Hc=function(){};Hc.prototype.getCoordinates=function(){},Hc.prototype.size=function(){},Hc.prototype.getCoordinate=function(t){},Hc.prototype.isClosed=function(){},Hc.prototype.setData=function(t){},Hc.prototype.getData=function(){},Hc.prototype.interfaces_=function(){return[]},Hc.prototype.getClass=function(){return Hc};var Vc=function(){};Vc.prototype.addIntersection=function(t,e){},Vc.prototype.interfaces_=function(){return[Hc]},Vc.prototype.getClass=function(){return Vc};var Yc=function(){this._nodeList=new Uc(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Yc.prototype.getCoordinates=function(){return this._pts},Yc.prototype.size=function(){return this._pts.length},Yc.prototype.getCoordinate=function(t){return this._pts[t]},Yc.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Yc.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},Yc.prototype.setData=function(t){this._data=t},Yc.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:qc.octant(t,e)},Yc.prototype.getData=function(){return this._data},Yc.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[3],o=new nl(n.getIntersection(i));this.addIntersection(o,r)}},Yc.prototype.toString=function(){return Tl.toLineString(new Gu(this._pts))},Yc.prototype.getNodeList=function(){return this._nodeList},Yc.prototype.addIntersectionNode=function(t,e){var n=e,r=n+1;if(r<this._pts.length){var i=this._pts[r];t.equals2D(i)&&(n=r)}return this._nodeList.add(t,n)},Yc.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},Yc.prototype.interfaces_=function(){return[Vc]},Yc.prototype.getClass=function(){return Yc},Yc.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new nu;return Yc.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],r=arguments[1],i=n.iterator();i.hasNext();)i.next().getNodeList().addSplitEdges(r)};var Wc=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new nl,this.p1=new nl;else if(1===arguments.length){var t=arguments[0];this.p0=new nl(t.p0),this.p1=new nl(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];this.p0=new nl(e,n),this.p1=new nl(r,i)}},Xc={serialVersionUID:{configurable:!0}};Wc.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Wc.prototype.orientationIndex=function(){if(arguments[0]instanceof Wc){var t=arguments[0],e=zl.orientationIndex(this.p0,this.p1,t.p0),n=zl.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof nl){var r=arguments[0];return zl.orientationIndex(this.p0,this.p1,r)}},Wc.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},Wc.prototype.isVertical=function(){return this.p0.x===this.p1.x},Wc.prototype.equals=function(t){if(!(t instanceof Wc))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},Wc.prototype.intersection=function(t){var e=new Al;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},Wc.prototype.project=function(){if(arguments[0]instanceof nl){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new nl(t);var e=this.projectionFactor(t),n=new nl;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof Wc){var r=arguments[0],i=this.projectionFactor(r.p0),o=this.projectionFactor(r.p1);if(i>=1&&o>=1)return null;if(i<=0&&o<=0)return null;var a=this.project(r.p0);i<0&&(a=this.p0),i>1&&(a=this.p1);var s=this.project(r.p1);return o<0&&(s=this.p0),o>1&&(s=this.p1),new Wc(a,s)}},Wc.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Wc.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Wc.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},Wc.prototype.distancePerpendicular=function(t){return zl.distancePointLinePerpendicular(t,this.p0,this.p1)},Wc.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Wc.prototype.midPoint=function(){return Wc.midPoint(this.p0,this.p1)},Wc.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,r=e*e+n*n;return r<=0?Js.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/r},Wc.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),r=Js.MAX_VALUE,i=null,o=this.closestPoint(t.p0);r=o.distance(t.p0),n[0]=o,n[1]=t.p0;var a=this.closestPoint(t.p1);(i=a.distance(t.p1))<r&&(r=i,n[0]=a,n[1]=t.p1);var s=t.closestPoint(this.p0);(i=s.distance(this.p0))<r&&(r=i,n[0]=this.p0,n[1]=s);var l=t.closestPoint(this.p1);return(i=l.distance(this.p1))<r&&(r=i,n[0]=this.p1,n[1]=l),n},Wc.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},Wc.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Wc.prototype.getLength=function(){return this.p0.distance(this.p1)},Wc.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},Wc.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},Wc.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},Wc.prototype.lineIntersection=function(t){try{return Ll.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof wl))throw t}return null},Wc.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Wc.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),r=this.p0.y+t*(this.p1.y-this.p0.y),i=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,a=Math.sqrt(i*i+o*o),s=0,l=0;if(0!==e){if(a<=0)throw new Error("Cannot compute offset from zero-length line segment");s=e*i/a,l=e*o/a}return new nl(n-l,r+s)},Wc.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},Wc.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||Js.isNaN(e))&&(e=1),e},Wc.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Wc.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Wc.prototype.distance=function(){if(arguments[0]instanceof Wc){var t=arguments[0];return zl.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof nl){var e=arguments[0];return zl.distancePointLine(e,this.p0,this.p1)}},Wc.prototype.pointAlong=function(t){var e=new nl;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},Wc.prototype.hashCode=function(){var t=Js.doubleToLongBits(this.p0.x);t^=31*Js.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=Js.doubleToLongBits(this.p1.x);return n^=31*Js.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},Wc.prototype.interfaces_=function(){return[$s,mi]},Wc.prototype.getClass=function(){return Wc},Wc.midPoint=function(t,e){return new nl((t.x+e.x)/2,(t.y+e.y)/2)},Xc.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Wc,Xc);var Zc=function(){this.tempEnv1=new El,this.tempEnv2=new El,this._overlapSeg1=new Wc,this._overlapSeg2=new Wc};Zc.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];t.getLineSegment(e,this._overlapSeg1),n.getLineSegment(r,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},Zc.prototype.interfaces_=function(){return[]},Zc.prototype.getClass=function(){return Zc};var Kc=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=r};Kc.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},Kc.prototype.computeSelect=function(t,e,n,r){var i=this._pts[e],o=this._pts[n];if(r.tempEnv1.init(i,o),n-e==1)return r.select(this,e),null;if(!t.intersects(r.tempEnv1))return null;var a=Math.trunc((e+n)/2);e<a&&this.computeSelect(t,e,a,r),a<n&&this.computeSelect(t,a,n,r)},Kc.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},Kc.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},Kc.prototype.setId=function(t){this._id=t},Kc.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},Kc.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new El(t,e)}return this._env},Kc.prototype.getEndIndex=function(){return this._end},Kc.prototype.getStartIndex=function(){return this._start},Kc.prototype.getContext=function(){return this._context},Kc.prototype.getId=function(){return this._id},Kc.prototype.computeOverlapsInternal=function(t,e,n,r,i,o){var a=this._pts[t],s=this._pts[e],l=n._pts[r],u=n._pts[i];if(e-t==1&&i-r==1)return o.overlap(this,t,n,r),null;if(o.tempEnv1.init(a,s),o.tempEnv2.init(l,u),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((t+e)/2),h=Math.trunc((r+i)/2);t<c&&(r<h&&this.computeOverlapsInternal(t,c,n,r,h,o),h<i&&this.computeOverlapsInternal(t,c,n,h,i,o)),c<e&&(r<h&&this.computeOverlapsInternal(c,e,n,r,h,o),h<i&&this.computeOverlapsInternal(c,e,n,h,i,o))},Kc.prototype.interfaces_=function(){return[]},Kc.prototype.getClass=function(){return Kc};var Jc=function(){};Jc.prototype.interfaces_=function(){return[]},Jc.prototype.getClass=function(){return Jc},Jc.getChainStartIndices=function(t){var e=0,n=new nu;n.add(new fl(e));do{var r=Jc.findChainEnd(t,e);n.add(new fl(r)),e=r}while(e<t.length-1);return Jc.toIntArray(n)},Jc.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var r=vc.quadrant(t[n],t[n+1]),i=e+1;i<t.length&&(t[i-1].equals2D(t[i])||vc.quadrant(t[i-1],t[i])===r);)i++;return i-1},Jc.getChains=function(){if(1===arguments.length){var t=arguments[0];return Jc.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],r=new nu,i=Jc.getChainStartIndices(e),o=0;o<i.length-1;o++){var a=new Kc(e,i[o],i[o+1],n);r.add(a)}return r}},Jc.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Qc=function(){};Qc.prototype.computeNodes=function(t){},Qc.prototype.getNodedSubstrings=function(){},Qc.prototype.interfaces_=function(){return[]},Qc.prototype.getClass=function(){return Qc};var $c=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};$c.prototype.setSegmentIntersector=function(t){this._segInt=t},$c.prototype.interfaces_=function(){return[Qc]},$c.prototype.getClass=function(){return $c};var th=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new nu,this._index=new Bc,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return Yc.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=Jc.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new eh(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),r=this._index.query(n.getEnvelope()).iterator();r.hasNext();){var i=r.next();if(i.getId()>n.getId()&&(n.computeOverlaps(i,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return eh},Object.defineProperties(e,n),e}($c),eh=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3],o=e.getContext(),a=r.getContext();this._si.processIntersections(o,n,a,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Zc),nh=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(o),this.setJoinStyle(a),this.setMitreLimit(s)}},rh={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};nh.prototype.getEndCapStyle=function(){return this._endCapStyle},nh.prototype.isSingleSided=function(){return this._isSingleSided},nh.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=nh.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=nh.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==nh.JOIN_ROUND&&(this._quadrantSegments=nh.DEFAULT_QUADRANT_SEGMENTS)},nh.prototype.getJoinStyle=function(){return this._joinStyle},nh.prototype.setJoinStyle=function(t){this._joinStyle=t},nh.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},nh.prototype.getSimplifyFactor=function(){return this._simplifyFactor},nh.prototype.getQuadrantSegments=function(){return this._quadrantSegments},nh.prototype.setEndCapStyle=function(t){this._endCapStyle=t},nh.prototype.getMitreLimit=function(){return this._mitreLimit},nh.prototype.setMitreLimit=function(t){this._mitreLimit=t},nh.prototype.setSingleSided=function(t){this._isSingleSided=t},nh.prototype.interfaces_=function(){return[]},nh.prototype.getClass=function(){return nh},nh.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},rh.CAP_ROUND.get=function(){return 1},rh.CAP_FLAT.get=function(){return 2},rh.CAP_SQUARE.get=function(){return 3},rh.JOIN_ROUND.get=function(){return 1},rh.JOIN_MITRE.get=function(){return 2},rh.JOIN_BEVEL.get=function(){return 3},rh.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},rh.DEFAULT_MITRE_LIMIT.get=function(){return 5},rh.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(nh,rh);var ih=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=zl.COUNTERCLOCKWISE,this._inputLine=t||null},oh={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};ih.prototype.isDeletable=function(t,e,n,r){var i=this._inputLine[t],o=this._inputLine[e],a=this._inputLine[n];return!!this.isConcave(i,o,a)&&!!this.isShallow(i,o,a,r)&&this.isShallowSampled(i,o,t,n,r)},ih.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),r=!1;n<this._inputLine.length;){var i=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=ih.DELETE,i=!0,r=!0),t=i?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return r},ih.prototype.isShallowConcavity=function(t,e,n,r){return zl.computeOrientation(t,e,n)===this._angleOrientation&&zl.distancePointLine(e,t,n)<r},ih.prototype.isShallowSampled=function(t,e,n,r,i){var o=Math.trunc((r-n)/ih.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var a=n;a<r;a+=o)if(!this.isShallow(t,e,this._inputLine[a],i))return!1;return!0},ih.prototype.isConcave=function(t,e,n){return zl.computeOrientation(t,e,n)===this._angleOrientation},ih.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=zl.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},ih.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===ih.DELETE;)e++;return e},ih.prototype.isShallow=function(t,e,n,r){return zl.distancePointLine(e,t,n)<r},ih.prototype.collapseLine=function(){for(var t=new iu,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==ih.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},ih.prototype.interfaces_=function(){return[]},ih.prototype.getClass=function(){return ih},ih.simplify=function(t,e){return new ih(t).simplify(e)},oh.INIT.get=function(){return 0},oh.DELETE.get=function(){return 1},oh.KEEP.get=function(){return 1},oh.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(ih,oh);var ah=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new nu},sh={COORDINATE_ARRAY_TYPE:{configurable:!0}};ah.prototype.getCoordinates=function(){return this._ptList.toArray(ah.COORDINATE_ARRAY_TYPE)},ah.prototype.setPrecisionModel=function(t){this._precisionModel=t},ah.prototype.addPt=function(t){var e=new nl(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},ah.prototype.revere=function(){},ah.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var r=t.length-1;r>=0;r--)this.addPt(t[r])},ah.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},ah.prototype.toString=function(){return(new Ku).createLineString(this.getCoordinates()).toString()},ah.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new nl(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},ah.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},ah.prototype.interfaces_=function(){return[]},ah.prototype.getClass=function(){return ah},sh.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(ah,sh);var lh=function(){},uh={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};lh.prototype.interfaces_=function(){return[]},lh.prototype.getClass=function(){return lh},lh.toDegrees=function(t){return 180*t/Math.PI},lh.normalize=function(t){for(;t>Math.PI;)t-=lh.PI_TIMES_2;for(;t<=-Math.PI;)t+=lh.PI_TIMES_2;return t},lh.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],r=n.x-e.x,i=n.y-e.y;return Math.atan2(i,r)}},lh.isAcute=function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)>0},lh.isObtuse=function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)<0},lh.interiorAngle=function(t,e,n){var r=lh.angle(e,t),i=lh.angle(e,n);return Math.abs(i-r)},lh.normalizePositive=function(t){if(t<0){for(;t<0;)t+=lh.PI_TIMES_2;t>=lh.PI_TIMES_2&&(t=0)}else{for(;t>=lh.PI_TIMES_2;)t-=lh.PI_TIMES_2;t<0&&(t=0)}return t},lh.angleBetween=function(t,e,n){var r=lh.angle(e,t),i=lh.angle(e,n);return lh.diff(r,i)},lh.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},lh.toRadians=function(t){return t*Math.PI/180},lh.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?lh.COUNTERCLOCKWISE:n<0?lh.CLOCKWISE:lh.NONE},lh.angleBetweenOriented=function(t,e,n){var r=lh.angle(e,t),i=lh.angle(e,n)-r;return i<=-Math.PI?i+lh.PI_TIMES_2:i>Math.PI?i-lh.PI_TIMES_2:i},uh.PI_TIMES_2.get=function(){return 2*Math.PI},uh.PI_OVER_2.get=function(){return Math.PI/2},uh.PI_OVER_4.get=function(){return Math.PI/4},uh.COUNTERCLOCKWISE.get=function(){return zl.COUNTERCLOCKWISE},uh.CLOCKWISE.get=function(){return zl.CLOCKWISE},uh.NONE.get=function(){return zl.COLLINEAR},Object.defineProperties(lh,uh);var ch=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Wc,this._seg1=new Wc,this._offset0=new Wc,this._offset1=new Wc,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new Al,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===nh.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},hh={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};ch.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=zl.computeOrientation(this._s0,this._s1,this._s2),r=n===zl.CLOCKWISE&&this._side===ic.LEFT||n===zl.COUNTERCLOCKWISE&&this._side===ic.RIGHT;0===n?this.addCollinear(e):r?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},ch.prototype.addLineEndCap=function(t,e){var n=new Wc(t,e),r=new Wc;this.computeOffsetSegment(n,ic.LEFT,this._distance,r);var i=new Wc;this.computeOffsetSegment(n,ic.RIGHT,this._distance,i);var o=e.x-t.x,a=e.y-t.y,s=Math.atan2(a,o);switch(this._bufParams.getEndCapStyle()){case nh.CAP_ROUND:this._segList.addPt(r.p1),this.addFilletArc(e,s+Math.PI/2,s-Math.PI/2,zl.CLOCKWISE,this._distance),this._segList.addPt(i.p1);break;case nh.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(i.p1);break;case nh.CAP_SQUARE:var l=new nl;l.x=Math.abs(this._distance)*Math.cos(s),l.y=Math.abs(this._distance)*Math.sin(s);var u=new nl(r.p1.x+l.x,r.p1.y+l.y),c=new nl(i.p1.x+l.x,i.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}},ch.prototype.getCoordinates=function(){return this._segList.getCoordinates()},ch.prototype.addMitreJoin=function(t,e,n,r){var i=!0,o=null;try{o=Ll.intersection(e.p0,e.p1,n.p0,n.p1),(r<=0?1:o.distance(t)/Math.abs(r))>this._bufParams.getMitreLimit()&&(i=!1)}catch(t){if(!(t instanceof wl))throw t;o=new nl(0,0),i=!1}i?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,r,this._bufParams.getMitreLimit())},ch.prototype.addFilletCorner=function(t,e,n,r,i){var o=e.x-t.x,a=e.y-t.y,s=Math.atan2(a,o),l=n.x-t.x,u=n.y-t.y,c=Math.atan2(u,l);r===zl.CLOCKWISE?s<=c&&(s+=2*Math.PI):s>=c&&(s-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,s,c,r,i),this._segList.addPt(n)},ch.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*ch.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===nh.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===nh.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},ch.prototype.createSquare=function(t){this._segList.addPt(new nl(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new nl(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new nl(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new nl(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},ch.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},ch.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},ch.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},ch.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},ch.prototype.addLimitedMitreJoin=function(t,e,n,r){var i=this._seg0.p1,o=lh.angle(i,this._seg0.p0),a=lh.angleBetweenOriented(this._seg0.p0,i,this._seg1.p1)/2,s=lh.normalize(o+a),l=lh.normalize(s+Math.PI),u=r*n,c=n-u*Math.abs(Math.sin(a)),h=i.x+u*Math.cos(l),f=i.y+u*Math.sin(l),p=new nl(h,f),d=new Wc(i,p),g=d.pointAlongOffset(1,c),y=d.pointAlongOffset(1,-c);this._side===ic.LEFT?(this._segList.addPt(g),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(g))},ch.prototype.computeOffsetSegment=function(t,e,n,r){var i=e===ic.LEFT?1:-1,o=t.p1.x-t.p0.x,a=t.p1.y-t.p0.y,s=Math.sqrt(o*o+a*a),l=i*n*o/s,u=i*n*a/s;r.p0.x=t.p0.x-u,r.p0.y=t.p0.y+l,r.p1.x=t.p1.x-u,r.p1.y=t.p1.y+l},ch.prototype.addFilletArc=function(t,e,n,r,i){var o=r===zl.CLOCKWISE?-1:1,a=Math.abs(e-n),s=Math.trunc(a/this._filletAngleQuantum+.5);if(s<1)return null;for(var l=a/s,u=0,c=new nl;u<a;){var h=e+o*u;c.x=t.x+i*Math.cos(h),c.y=t.y+i*Math.sin(h),this._segList.addPt(c),u+=l}},ch.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*ch.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new nl((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var r=new nl((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},ch.prototype.createCircle=function(t){var e=new nl(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},ch.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},ch.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new ah,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*ch.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},ch.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===nh.JOIN_BEVEL||this._bufParams.getJoinStyle()===nh.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,zl.CLOCKWISE,this._distance))},ch.prototype.closeRing=function(){this._segList.closeRing()},ch.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},ch.prototype.interfaces_=function(){return[]},ch.prototype.getClass=function(){return ch},hh.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},hh.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},hh.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},hh.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(ch,hh);var fh=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};fh.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,r=Math.abs(e),i=this.getSegGen(r);t.length<=1?this.computePointCurve(t[0],i):this.computeOffsetCurve(t,n,i);var o=i.getCoordinates();return n&&ou.reverse(o),o},fh.prototype.computeSingleSidedBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var i=ih.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],ic.LEFT),n.addFirstSegment();for(var a=o-2;a>=0;a--)n.addNextSegment(i[a],!0)}else{n.addSegments(t,!1);var s=ih.simplify(t,r),l=s.length-1;n.initSideSegments(s[0],s[1],ic.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(s[u],!0)}n.addLastSegment(),n.closeRing()},fh.prototype.computeRingBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);e===ic.RIGHT&&(r=-r);var i=ih.simplify(t,r),o=i.length-1;n.initSideSegments(i[o-1],i[0],e);for(var a=1;a<=o;a++){var s=1!==a;n.addNextSegment(i[a],s)}n.closeRing()},fh.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),r=ih.simplify(t,n),i=r.length-1;e.initSideSegments(r[0],r[1],ic.LEFT);for(var o=2;o<=i;o++)e.addNextSegment(r[o],!0);e.addLastSegment(),e.addLineEndCap(r[i-1],r[i]);var a=ih.simplify(t,-n),s=a.length-1;e.initSideSegments(a[s],a[s-1],ic.LEFT);for(var l=s-2;l>=0;l--)e.addNextSegment(a[l],!0);e.addLastSegment(),e.addLineEndCap(a[1],a[0]),e.closeRing()},fh.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case nh.CAP_ROUND:e.createCircle(t);break;case nh.CAP_SQUARE:e.createSquare(t)}},fh.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),r=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],r);else if(this._bufParams.isSingleSided()){var i=e<0;this.computeSingleSidedBufferCurve(t,i,r)}else this.computeLineBufferCurve(t,r);return r.getCoordinates()},fh.prototype.getBufferParameters=function(){return this._bufParams},fh.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},fh.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return fh.copyCoordinates(t);var r=this.getSegGen(n);return this.computeRingBufferCurve(t,e,r),r.getCoordinates()},fh.prototype.computeOffsetCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){var i=ih.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],ic.LEFT),n.addFirstSegment();for(var a=o-2;a>=0;a--)n.addNextSegment(i[a],!0)}else{var s=ih.simplify(t,r),l=s.length-1;n.initSideSegments(s[0],s[1],ic.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(s[u],!0)}n.addLastSegment()},fh.prototype.getSegGen=function(t){return new ch(this._precisionModel,this._bufParams,t)},fh.prototype.interfaces_=function(){return[]},fh.prototype.getClass=function(){return fh},fh.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new nl(t[n]);return e};var ph=function(){this._subgraphs=null,this._seg=new Wc,this._cga=new zl;var t=arguments[0];this._subgraphs=t},dh={DepthSegment:{configurable:!0}};ph.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new nu,n=this._subgraphs.iterator();n.hasNext();){var r=n.next(),i=r.getEnvelope();t.y<i.getMinY()||t.y>i.getMaxY()||this.findStabbedSegments(t,r.getDirectedEdges(),e)}return e}if(3===arguments.length)if(ll(arguments[2],eu)&&arguments[0]instanceof nl&&arguments[1]instanceof wc){for(var o=arguments[0],a=arguments[1],s=arguments[2],l=a.getEdge().getCoordinates(),u=0;u<l.length-1;u++)if(this._seg.p0=l[u],this._seg.p1=l[u+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||zl.computeOrientation(this._seg.p0,this._seg.p1,o)===zl.RIGHT)){var c=a.getDepth(ic.LEFT);this._seg.p0.equals(l[u])||(c=a.getDepth(ic.RIGHT));var h=new gh(this._seg,c);s.add(h)}}else if(ll(arguments[2],eu)&&arguments[0]instanceof nl&&ll(arguments[1],eu))for(var f=arguments[0],p=arguments[1],d=arguments[2],g=p.iterator();g.hasNext();){var y=g.next();y.isForward()&&this.findStabbedSegments(f,y,d)}},ph.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Ic.min(e)._leftDepth},ph.prototype.interfaces_=function(){return[]},ph.prototype.getClass=function(){return ph},dh.DepthSegment.get=function(){return gh},Object.defineProperties(ph,dh);var gh=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new Wc(t),this._leftDepth=e};gh.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n||0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},gh.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},gh.prototype.toString=function(){return this._upwardSeg.toString()},gh.prototype.interfaces_=function(){return[$s]},gh.prototype.getClass=function(){return gh};var yh=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};yh.prototype.area=function(){return yh.area(this.p0,this.p1,this.p2)},yh.prototype.signedArea=function(){return yh.signedArea(this.p0,this.p1,this.p2)},yh.prototype.interpolateZ=function(t){if(null===t)throw new Ks("Supplied point is null.");return yh.interpolateZ(t,this.p0,this.p1,this.p2)},yh.prototype.longestSideLength=function(){return yh.longestSideLength(this.p0,this.p1,this.p2)},yh.prototype.isAcute=function(){return yh.isAcute(this.p0,this.p1,this.p2)},yh.prototype.circumcentre=function(){return yh.circumcentre(this.p0,this.p1,this.p2)},yh.prototype.area3D=function(){return yh.area3D(this.p0,this.p1,this.p2)},yh.prototype.centroid=function(){return yh.centroid(this.p0,this.p1,this.p2)},yh.prototype.inCentre=function(){return yh.inCentre(this.p0,this.p1,this.p2)},yh.prototype.interfaces_=function(){return[]},yh.prototype.getClass=function(){return yh},yh.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},yh.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},yh.det=function(t,e,n,r){return t*r-e*n},yh.interpolateZ=function(t,e,n,r){var i=e.x,o=e.y,a=n.x-i,s=r.x-i,l=n.y-o,u=r.y-o,c=a*u-s*l,h=t.x-i,f=t.y-o,p=(u*h-s*f)/c,d=(-l*h+a*f)/c;return e.z+p*(n.z-e.z)+d*(r.z-e.z)},yh.longestSideLength=function(t,e,n){var r=t.distance(e),i=e.distance(n),o=n.distance(t),a=r;return i>a&&(a=i),o>a&&(a=o),a},yh.isAcute=function(t,e,n){return!!lh.isAcute(t,e,n)&&!!lh.isAcute(e,n,t)&&!!lh.isAcute(n,t,e)},yh.circumcentre=function(t,e,n){var r=n.x,i=n.y,o=t.x-r,a=t.y-i,s=e.x-r,l=e.y-i,u=2*yh.det(o,a,s,l),c=yh.det(a,o*o+a*a,l,s*s+l*l),h=yh.det(o,o*o+a*a,s,s*s+l*l);return new nl(r-c/u,i+h/u)},yh.perpendicularBisector=function(t,e){var n=e.x-t.x,r=e.y-t.y,i=new Ll(t.x+n/2,t.y+r/2,1),o=new Ll(t.x-r+n/2,t.y+n+r/2,1);return new Ll(i,o)},yh.angleBisector=function(t,e,n){var r=e.distance(t),i=r/(r+e.distance(n)),o=n.x-t.x,a=n.y-t.y;return new nl(t.x+i*o,t.y+i*a)},yh.area3D=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=e.z-t.z,a=n.x-t.x,s=n.y-t.y,l=n.z-t.z,u=i*l-o*s,c=o*a-r*l,h=r*s-i*a,f=u*u+c*c+h*h;return Math.sqrt(f)/2},yh.centroid=function(t,e,n){var r=(t.x+e.x+n.x)/3,i=(t.y+e.y+n.y)/3;return new nl(r,i)},yh.inCentre=function(t,e,n){var r=e.distance(n),i=t.distance(n),o=t.distance(e),a=r+i+o,s=(r*t.x+i*e.x+o*n.x)/a,l=(r*t.y+i*e.y+o*n.y)/a;return new nl(s,l)};var mh=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new nu;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};mh.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,al.EXTERIOR,al.INTERIOR)},mh.prototype.addPolygon=function(t){var e=this._distance,n=ic.LEFT;this._distance<0&&(e=-this._distance,n=ic.RIGHT);var r=t.getExteriorRing(),i=ou.removeRepeatedPoints(r.getCoordinates());if(this._distance<0&&this.isErodedCompletely(r,this._distance))return null;if(this._distance<=0&&i.length<3)return null;this.addPolygonRing(i,e,n,al.EXTERIOR,al.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var a=t.getInteriorRingN(o),s=ou.removeRepeatedPoints(a.getCoordinates());this._distance>0&&this.isErodedCompletely(a,-this._distance)||this.addPolygonRing(s,e,ic.opposite(n),al.INTERIOR,al.EXTERIOR)}},mh.prototype.isTriangleErodedCompletely=function(t,e){var n=new yh(t[0],t[1],t[2]),r=n.inCentre();return zl.distancePointLine(r,n.p0,n.p1)<Math.abs(e)},mh.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=ou.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,al.EXTERIOR,al.INTERIOR)},mh.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var r=new Yc(t,new hc(0,al.BOUNDARY,e,n));this._curveList.add(r)},mh.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},mh.prototype.addPolygonRing=function(t,e,n,r,i){if(0===e&&t.length<Du.MINIMUM_VALID_SIZE)return null;var o=r,a=i;t.length>=Du.MINIMUM_VALID_SIZE&&zl.isCCW(t)&&(o=i,a=r,n=ic.opposite(n));var s=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(s,o,a)},mh.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Iu?this.addPolygon(t):t instanceof Pu?this.addLineString(t):t instanceof Tu?this.addPoint(t):(t instanceof Nu||t instanceof xu||t instanceof Ru||t instanceof wu)&&this.addCollection(t)},mh.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var r=t.getEnvelopeInternal(),i=Math.min(r.getHeight(),r.getWidth());return e<0&&2*Math.abs(e)>i},mh.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},mh.prototype.interfaces_=function(){return[]},mh.prototype.getClass=function(){return mh};var vh=function(){};vh.prototype.locate=function(t){},vh.prototype.interfaces_=function(){return[]},vh.prototype.getClass=function(){return vh};var _h=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};_h.prototype.next=function(){if(this._atStart)return this._atStart=!1,_h.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new vi;var t=this._parent.getGeometryN(this._index++);return t instanceof wu?(this._subcollectionIterator=new _h(t),this._subcollectionIterator.next()):t},_h.prototype.remove=function(){throw new Error(this.getClass().getName())},_h.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},_h.prototype.interfaces_=function(){return[tu]},_h.prototype.getClass=function(){return _h},_h.isAtomic=function(t){return!(t instanceof wu)};var bh=function(){this._geom=null;var t=arguments[0];this._geom=t};bh.prototype.locate=function(t){return bh.locate(t,this._geom)},bh.prototype.interfaces_=function(){return[vh]},bh.prototype.getClass=function(){return bh},bh.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&zl.isPointInRing(t,e.getCoordinates())},bh.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!bh.isPointInRing(t,n))return!1;for(var r=0;r<e.getNumInteriorRing();r++){var i=e.getInteriorRingN(r);if(bh.isPointInRing(t,i))return!1}return!0},bh.containsPoint=function(t,e){if(e instanceof Iu)return bh.containsPointInPolygon(t,e);if(e instanceof wu)for(var n=new _h(e);n.hasNext();){var r=n.next();if(r!==e&&bh.containsPoint(t,r))return!0}return!1},bh.locate=function(t,e){return e.isEmpty()?al.EXTERIOR:bh.containsPoint(t,e)?al.INTERIOR:al.EXTERIOR};var wh=function(){this._edgeMap=new ki,this._edgeList=null,this._ptInAreaLocation=[al.NONE,al.NONE]};wh.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},wh.prototype.propagateSideLabels=function(t){for(var e=al.NONE,n=this.iterator();n.hasNext();){var r=n.next().getLabel();r.isArea(t)&&r.getLocation(t,ic.LEFT)!==al.NONE&&(e=r.getLocation(t,ic.LEFT))}if(e===al.NONE)return null;for(var i=e,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getLabel();if(s.getLocation(t,ic.ON)===al.NONE&&s.setLocation(t,ic.ON,i),s.isArea(t)){var l=s.getLocation(t,ic.LEFT),u=s.getLocation(t,ic.RIGHT);if(u!==al.NONE){if(u!==i)throw new sc("side location conflict",a.getCoordinate());l===al.NONE&&Nl.shouldNeverReachHere("found single null side (at "+a.getCoordinate()+")"),i=l}else Nl.isTrue(s.getLocation(t,ic.LEFT)===al.NONE,"found single null side"),s.setLocation(t,ic.RIGHT,i),s.setLocation(t,ic.LEFT,i)}}},wh.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},wh.prototype.print=function(t){xl.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},wh.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},wh.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,r=e.get(n).getLabel().getLocation(t,ic.LEFT);Nl.isTrue(r!==al.NONE,"Found unlabelled area edge");for(var i=r,o=this.iterator();o.hasNext();){var a=o.next().getLabel();Nl.isTrue(a.isArea(t),"Found non-area edge");var s=a.getLocation(t,ic.LEFT),l=a.getLocation(t,ic.RIGHT);if(s===l)return!1;if(l!==i)return!1;i=s}return!0},wh.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},wh.prototype.iterator=function(){return this.getEdges().iterator()},wh.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new nu(this._edgeMap.values())),this._edgeList},wh.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===al.NONE&&(this._ptInAreaLocation[t]=bh.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},wh.prototype.toString=function(){var t=new hl;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},wh.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},wh.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var r=n.next().getLabel(),i=0;i<2;i++)r.isLine(i)&&r.getLocation(i)===al.BOUNDARY&&(e[i]=!0);for(var o=this.iterator();o.hasNext();)for(var a=o.next(),s=a.getLabel(),l=0;l<2;l++)if(s.isAnyNull(l)){var u=al.NONE;if(e[l])u=al.EXTERIOR;else{var c=a.getCoordinate();u=this.getLocation(l,c,t)}s.setAllLocationsIfNull(l,u)}},wh.prototype.getDegree=function(){return this._edgeMap.size()},wh.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},wh.prototype.interfaces_=function(){return[]},wh.prototype.getClass=function(){return wh};var xh=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,r=0;r<this._resultAreaEdgeList.size();r++){var i=this._resultAreaEdgeList.get(r),o=i.getSym();if(i.getLabel().isArea())switch(null===t&&i.isInResult()&&(t=i),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!i.isInResult())continue;e.setNext(i),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new sc("no outgoing dirEdge found",this.getCoordinate());Nl.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var r=t.get(e-1),i=n.getQuadrant(),o=r.getQuadrant();return vc.isNorthern(i)&&vc.isNorthern(o)?n:vc.isNorthern(i)||vc.isNorthern(o)?0!==n.getDy()?n:0!==r.getDy()?r:(Nl.shouldNeverReachHere("found two horizontal edges incident on node"),null):r},e.prototype.print=function(t){xl.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new nu;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var r=this._edgeList.get(n),i=r.getSym();null===e&&(e=i),null!==t&&i.setNext(t),t=r}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(ic.LEFT),r=t.getDepth(ic.RIGHT),i=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,i)!==r)throw new sc("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[0],a=arguments[1],s=arguments[2],l=o;l<a;l++){var u=this._edgeList.get(l);u.setEdgeDepths(ic.RIGHT,s),s=u.getDepth(ic.LEFT)}return s}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,r=this._SCANNING_FOR_INCOMING,i=this._resultAreaEdgeList.size()-1;i>=0;i--){var o=this._resultAreaEdgeList.get(i),a=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),r){case this._SCANNING_FOR_INCOMING:if(a.getEdgeRing()!==t)continue;n=a,r=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),r=this._SCANNING_FOR_INCOMING}}r===this._LINKING_TO_OUTGOING&&(Nl.isTrue(null!==e,"found null for first outgoing dirEdge"),Nl.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],r=0,i=this.iterator();i.hasNext();)i.next().getEdgeRing()===n&&r++;return r}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=al.NONE,e=this.iterator();e.hasNext();){var n=e.next(),r=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=al.INTERIOR;break}if(r.isInResult()){t=al.EXTERIOR;break}}}if(t===al.NONE)return null;for(var i=t,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getSym();a.isLineEdge()?a.getEdge().setCovered(i===al.INTERIOR):(a.isInResult()&&(i=al.EXTERIOR),s.isInResult()&&(i=al.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new hc(al.NONE);for(var n=this.iterator();n.hasNext();)for(var r=n.next().getEdge().getLabel(),i=0;i<2;i++){var o=r.getLocation(i);o!==al.INTERIOR&&o!==al.BOUNDARY||this._label.setLocation(i,al.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(wh),Lh=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new yc(t,new xh)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(xc),Eh=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Eh.prototype.compareTo=function(t){var e=t;return Eh.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Eh.prototype.interfaces_=function(){return[$s]},Eh.prototype.getClass=function(){return Eh},Eh.orientation=function(t){return 1===ou.increasingDirection(t)},Eh.compareOriented=function(t,e,n,r){for(var i=e?1:-1,o=r?1:-1,a=e?t.length:-1,s=r?n.length:-1,l=e?0:t.length-1,u=r?0:n.length-1;;){var c=t[l].compareTo(n[u]);if(0!==c)return c;var h=(l+=i)===a,f=(u+=o)===s;if(h&&!f)return-1;if(!h&&f)return 1;if(h&&f)return 0}};var Ch=function(){this._edges=new nu,this._ocaMap=new ki};Ch.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var r=n.getCoordinates(),i=0;i<r.length;i++)i>0&&t.print(","),t.print(r[i].x+" "+r[i].y);t.println(")")}t.print(")  ")},Ch.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Ch.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Ch.prototype.iterator=function(){return this._edges.iterator()},Ch.prototype.getEdges=function(){return this._edges},Ch.prototype.get=function(t){return this._edges.get(t)},Ch.prototype.findEqualEdge=function(t){var e=new Eh(t.getCoordinates());return this._ocaMap.get(e)},Ch.prototype.add=function(t){this._edges.add(t);var e=new Eh(t.getCoordinates());this._ocaMap.put(e,t)},Ch.prototype.interfaces_=function(){return[]},Ch.prototype.getClass=function(){return Ch};var kh=function(){};kh.prototype.processIntersections=function(t,e,n,r){},kh.prototype.isDone=function(){},kh.prototype.interfaces_=function(){return[]},kh.prototype.getClass=function(){return kh};var Sh=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Sh.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if(Sh.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var i=t.size()-1;if(0===e&&r===i||0===r&&e===i)return!0}}return!1},Sh.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Sh.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Sh.prototype.getLineIntersector=function(){return this._li},Sh.prototype.hasProperIntersection=function(){return this._hasProper},Sh.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Sh.prototype.hasIntersection=function(){return this._hasIntersection},Sh.prototype.isDone=function(){return!1},Sh.prototype.hasInteriorIntersection=function(){return this._hasInterior},Sh.prototype.interfaces_=function(){return[kh]},Sh.prototype.getClass=function(){return Sh},Sh.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Ph=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new nl(t),this.segmentIndex=e,this.dist=n};Ph.prototype.getSegmentIndex=function(){return this.segmentIndex},Ph.prototype.getCoordinate=function(){return this.coord},Ph.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Ph.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Ph.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Ph.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Ph.prototype.getDistance=function(){return this.dist},Ph.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Ph.prototype.interfaces_=function(){return[$s]},Ph.prototype.getClass=function(){return Ph};var Mh=function(){this._nodeMap=new ki,this.edge=null;var t=arguments[0];this.edge=t};Mh.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Mh.prototype.iterator=function(){return this._nodeMap.values().iterator()},Mh.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},Mh.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Mh.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this.edge.pts[e.segmentIndex],i=e.dist>0||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),a=0;o[a++]=new nl(t.coord);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)o[a++]=this.edge.pts[s];return i&&(o[a]=e.coord),new Dh(o,new hc(this.edge._label))},Mh.prototype.add=function(t,e,n){var r=new Ph(t,e,n),i=this._nodeMap.get(r);return null!==i?i:(this._nodeMap.put(r,r),r)},Mh.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Mh.prototype.interfaces_=function(){return[]},Mh.prototype.getClass=function(){return Mh};var Th=function(){};Th.prototype.getChainStartIndices=function(t){var e=0,n=new nu;n.add(new fl(e));do{var r=this.findChainEnd(t,e);n.add(new fl(r)),e=r}while(e<t.length-1);return Th.toIntArray(n)},Th.prototype.findChainEnd=function(t,e){for(var n=vc.quadrant(t[e],t[e+1]),r=e+1;r<t.length&&vc.quadrant(t[r-1],t[r])===n;)r++;return r-1},Th.prototype.interfaces_=function(){return[]},Th.prototype.getClass=function(){return Th},Th.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Oh=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new El,this.env2=new El;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Th;this.startIndex=e.getChainStartIndices(this.pts)};Oh.prototype.getCoordinates=function(){return this.pts},Oh.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},Oh.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},Oh.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],r)}else if(6===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],l=arguments[4],u=arguments[5],c=this.pts[i],h=this.pts[o],f=a.pts[s],p=a.pts[l];if(o-i==1&&l-s==1)return u.addIntersections(this.e,i,a.e,s),null;if(this.env1.init(c,h),this.env2.init(f,p),!this.env1.intersects(this.env2))return null;var d=Math.trunc((i+o)/2),g=Math.trunc((s+l)/2);i<d&&(s<g&&this.computeIntersectsForChain(i,d,a,s,g,u),g<l&&this.computeIntersectsForChain(i,d,a,g,l,u)),d<o&&(s<g&&this.computeIntersectsForChain(d,o,a,s,g,u),g<l&&this.computeIntersectsForChain(d,o,a,g,l,u))}},Oh.prototype.getStartIndexes=function(){return this.startIndex},Oh.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var r=0;r<t.startIndex.length-1;r++)this.computeIntersectsForChain(n,t,r,e)},Oh.prototype.interfaces_=function(){return[]},Oh.prototype.getClass=function(){return Oh};var Ih=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},Nh={NULL_VALUE:{configurable:!0}};Ih.prototype.getDepth=function(t,e){return this._depth[t][e]},Ih.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},Ih.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==Ih.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===Ih.NULL_VALUE}if(2===arguments.length){var r=arguments[0],i=arguments[1];return this._depth[r][i]===Ih.NULL_VALUE}},Ih.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var r=0;this._depth[t][n]>e&&(r=1),this._depth[t][n]=r}}},Ih.prototype.getDelta=function(t){return this._depth[t][ic.RIGHT]-this._depth[t][ic.LEFT]},Ih.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?al.EXTERIOR:al.INTERIOR},Ih.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},Ih.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var r=t.getLocation(e,n);r!==al.EXTERIOR&&r!==al.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=Ih.depthAtLocation(r):this._depth[e][n]+=Ih.depthAtLocation(r))}else if(3===arguments.length){var i=arguments[0],o=arguments[1];arguments[2]===al.INTERIOR&&this._depth[i][o]++}},Ih.prototype.interfaces_=function(){return[]},Ih.prototype.getClass=function(){return Ih},Ih.depthAtLocation=function(t){return t===al.EXTERIOR?0:t===al.INTERIOR?1:Ih.NULL_VALUE},Nh.NULL_VALUE.get=function(){return-1},Object.defineProperties(Ih,Nh);var Dh=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Mh(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Ih,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.pts=r,this._label=i}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,hc.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var r=!0,i=!0,o=this.pts.length,a=0;a<this.pts.length;a++)if(this.pts[a].equals2D(n.pts[a])||(r=!1),this.pts[a].equals2D(n.pts[--o])||(i=!1),!r&&!i)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Oh(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new El;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,r){var i=new nl(t.getIntersection(r)),o=e,a=t.getEdgeDistance(n,r),s=o+1;if(s<this.pts.length){var l=this.pts[s];i.equals2D(l)&&(o=s,a=0)}this.eiList.add(i,o,a)},e.prototype.toString=function(){var t=new hl;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,ic.ON),e.getLocation(1,ic.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,ic.LEFT),e.getLocation(1,ic.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,ic.RIGHT),e.getLocation(1,ic.RIGHT),2))},e}(gc),Rh=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Ch,this._bufParams=t||null};Rh.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},Rh.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new hc(t.getLabel())).flip(),n.merge(r);var i=Rh.depthDelta(r),o=e.getDepthDelta()+i;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(Rh.depthDelta(t.getLabel()))},Rh.prototype.buildSubgraphs=function(t,e){for(var n=new nu,r=t.iterator();r.hasNext();){var i=r.next(),o=i.getRightmostCoordinate(),a=new ph(n).getDepth(o);i.computeDepth(a),i.findResultEdges(),n.add(i),e.add(i.getDirectedEdges(),i.getNodes())}},Rh.prototype.createSubgraphs=function(t){for(var e=new nu,n=t.getNodes().iterator();n.hasNext();){var r=n.next();if(!r.isVisited()){var i=new uc;i.create(r),e.add(i)}}return Ic.sort(e,Ic.reverseOrder()),e},Rh.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Rh.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new th,n=new Al;return n.setPrecisionModel(t),e.setSegmentIntersector(new Sh(n)),e},Rh.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var r=new fh(n,this._bufParams),i=new mh(t,e,r).getCurves();if(i.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(i,n),this._graph=new Lc(new Lh),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),a=new Ec(this._geomFact);this.buildSubgraphs(o,a);var s=a.getPolygons();return s.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(s)},Rh.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var r=n.getNodedSubstrings().iterator();r.hasNext();){var i=r.next(),o=i.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var a=i.getData(),s=new Dh(i.getCoordinates(),new hc(a));this.insertUniqueEdge(s)}}},Rh.prototype.setNoder=function(t){this._workingNoder=t},Rh.prototype.interfaces_=function(){return[]},Rh.prototype.getClass=function(){return Rh},Rh.depthDelta=function(t){var e=t.getLocation(0,ic.LEFT),n=t.getLocation(0,ic.RIGHT);return e===al.INTERIOR&&n===al.EXTERIOR?1:e===al.EXTERIOR&&n===al.INTERIOR?-1:0},Rh.convertSegStrings=function(t){for(var e=new Ku,n=new nu;t.hasNext();){var r=t.next(),i=e.createLineString(r.getCoordinates());n.add(i)}return e.buildGeometry(n)};var Ah=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=r,this._offsetX=i,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};Ah.prototype.rescale=function(){if(ll(arguments[0],Ql))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],r=0;r<n.length;r++)n[r].x=n[r].x/this._scaleFactor+this._offsetX,n[r].y=n[r].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&xl.out.println(n)}},Ah.prototype.scale=function(){if(ll(arguments[0],Ql)){for(var t=arguments[0],e=new nu,n=t.iterator();n.hasNext();){var r=n.next();e.add(new Yc(this.scale(r.getCoordinates()),r.getData()))}return e}if(arguments[0]instanceof Array){for(var i=arguments[0],o=new Array(i.length).fill(null),a=0;a<i.length;a++)o[a]=new nl(Math.round((i[a].x-this._offsetX)*this._scaleFactor),Math.round((i[a].y-this._offsetY)*this._scaleFactor),i[a].z);return ou.removeRepeatedPoints(o)}},Ah.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},Ah.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},Ah.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},Ah.prototype.interfaces_=function(){return[Qc]},Ah.prototype.getClass=function(){return Ah};var jh=function(){this._li=new Al,this._segStrings=null;var t=arguments[0];this._segStrings=t},Bh={fact:{configurable:!0}};jh.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],r=arguments[1].iterator();r.hasNext();)for(var i=r.next().getCoordinates(),o=1;o<i.length-1;o++)if(i[o].equals(n))throw new Ol("found endpt/interior pt intersection at index "+o+" :pt "+n)},jh.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var r=n.next();this.checkInteriorIntersections(e,r)}else if(2===arguments.length)for(var i=arguments[0],o=arguments[1],a=i.getCoordinates(),s=o.getCoordinates(),l=0;l<a.length-1;l++)for(var u=0;u<s.length-1;u++)this.checkInteriorIntersections(i,l,o,u);else if(4===arguments.length){var c=arguments[0],h=arguments[1],f=arguments[2],p=arguments[3];if(c===f&&h===p)return null;var d=c.getCoordinates()[h],g=c.getCoordinates()[h+1],y=f.getCoordinates()[p],m=f.getCoordinates()[p+1];if(this._li.computeIntersection(d,g,y,m),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,d,g)||this.hasInteriorIntersection(this._li,y,m)))throw new Ol("found non-noded intersection at "+d+"-"+g+" and "+y+"-"+m)}},jh.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},jh.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),r=0;r<n.length-2;r++)this.checkCollapse(n[r],n[r+1],n[r+2])},jh.prototype.hasInteriorIntersection=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++){var i=t.getIntersection(r);if(!i.equals(e)&&!i.equals(n))return!0}return!1},jh.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new Ol("found non-noded collapse at "+jh.fact.createLineString([t,e,n]))},jh.prototype.interfaces_=function(){return[]},jh.prototype.getClass=function(){return jh},Bh.fact.get=function(){return new Ku},Object.defineProperties(jh,Bh);var zh=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new Ks("Scale factor must be non-zero");1!==e&&(this._pt=new nl(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new nl,this._p1Scaled=new nl),this.initCorners(this._pt)},Fh={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};zh.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),r=Math.max(t.x,e.x),i=Math.min(t.y,e.y),o=Math.max(t.y,e.y),a=this._maxx<n||this._minx>r||this._maxy<i||this._miny>o;if(a)return!1;var s=this.intersectsToleranceSquare(t,e);return Nl.isTrue(!(a&&s),"Found bad envelope test"),s},zh.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new nl(this._maxx,this._maxy),this._corner[1]=new nl(this._minx,this._maxy),this._corner[2]=new nl(this._minx,this._miny),this._corner[3]=new nl(this._maxx,this._miny)},zh.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},zh.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},zh.prototype.getCoordinate=function(){return this._originalPt},zh.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},zh.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=zh.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new El(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},zh.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},zh.prototype.intersectsToleranceSquare=function(t,e){var n=!1,r=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&r||t.equals(this._pt)||e.equals(this._pt)))))},zh.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),r=t.getCoordinate(e+1);return!!this.intersects(n,r)&&(t.addIntersection(this.getCoordinate(),e),!0)},zh.prototype.interfaces_=function(){return[]},zh.prototype.getClass=function(){return zh},Fh.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(zh,Fh);var Gh=function(){this.tempEnv1=new El,this.selectedSegment=new Wc};Gh.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},Gh.prototype.interfaces_=function(){return[]},Gh.prototype.getClass=function(){return Gh};var Uh=function(){this._index=null;var t=arguments[0];this._index=t},qh={HotPixelSnapAction:{configurable:!0}};Uh.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],i=e.getSafeEnvelope(),o=new Hh(e,n,r);return this._index.query(i,{interfaces_:function(){return[Pc]},visitItem:function(t){t.select(i,o)}}),o.isNodeAdded()}},Uh.prototype.interfaces_=function(){return[]},Uh.prototype.getClass=function(){return Uh},qh.HotPixelSnapAction.get=function(){return Hh},Object.defineProperties(Uh,qh);var Hh=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[0],n=arguments[1],r=e.getContext();if(null!==this._parentEdge&&r===this._parentEdge&&n===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(r,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Gh),Vh=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new nu};Vh.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];if(this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)}},Vh.prototype.isDone=function(){return!1},Vh.prototype.getInteriorIntersections=function(){return this._interiorIntersections},Vh.prototype.interfaces_=function(){return[kh]},Vh.prototype.getClass=function(){return Vh};var Yh=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new Al,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};Yh.prototype.checkCorrectness=function(t){var e=Yc.getNodedSubstrings(t),n=new jh(e);try{n.checkValid()}catch(t){if(!(t instanceof bl))throw t;t.printStackTrace()}},Yh.prototype.getNodedSubstrings=function(){return Yc.getNodedSubstrings(this._nodedSegStrings)},Yh.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},Yh.prototype.findInteriorIntersections=function(t,e){var n=new Vh(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},Yh.prototype.computeVertexSnaps=function(){if(ll(arguments[0],Ql))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof Yc)for(var n=arguments[0],r=n.getCoordinates(),i=0;i<r.length;i++){var o=new zh(r[i],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,i)&&n.addIntersection(r[i],i)}},Yh.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new th,this._pointSnapper=new Uh(this._noder.getIndex()),this.snapRound(t,this._li)},Yh.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=new zh(n,this._scaleFactor,this._li);this._pointSnapper.snap(r)}},Yh.prototype.interfaces_=function(){return[Qc]},Yh.prototype.getClass=function(){return Yh};var Wh=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new nh,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},Xh={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Wh.prototype.bufferFixedPrecision=function(t){var e=new Ah(new Yh(new Yu(1)),t.getScale()),n=new Rh(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},Wh.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=Wh.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof sc))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],r=Wh.precisionScaleFactor(this._argGeom,this._distance,n),i=new Yu(r);this.bufferFixedPrecision(i)}},Wh.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Yu.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},Wh.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},Wh.prototype.bufferOriginalPrecision=function(){try{var t=new Rh(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof Ol))throw t;this._saveException=t}},Wh.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},Wh.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},Wh.prototype.interfaces_=function(){return[]},Wh.prototype.getClass=function(){return Wh},Wh.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Wh(t).getResultGeometry(e)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Ul&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1],i=arguments[2],o=new Wh(n);return o.setQuadrantSegments(i),o.getResultGeometry(r)}if(arguments[2]instanceof nh&&arguments[0]instanceof Ul&&"number"==typeof arguments[1]){var a=arguments[0],s=arguments[1],l=arguments[2];return new Wh(a,l).getResultGeometry(s)}}else if(4===arguments.length){var u=arguments[0],c=arguments[1],h=arguments[2],f=arguments[3],p=new Wh(u);return p.setQuadrantSegments(h),p.setEndCapStyle(f),p.getResultGeometry(c)}},Wh.precisionScaleFactor=function(t,e,n){var r=t.getEnvelopeInternal(),i=ul.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(i)/Math.log(10)+1);return Math.pow(10,o)},Xh.CAP_ROUND.get=function(){return nh.CAP_ROUND},Xh.CAP_BUTT.get=function(){return nh.CAP_FLAT},Xh.CAP_FLAT.get=function(){return nh.CAP_FLAT},Xh.CAP_SQUARE.get=function(){return nh.CAP_SQUARE},Xh.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Wh,Xh);var Zh=function(){this._pt=[new nl,new nl],this._distance=Js.NaN,this._isNull=!0};Zh.prototype.getCoordinates=function(){return this._pt},Zh.prototype.getCoordinate=function(t){return this._pt[t]},Zh.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}},Zh.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=i,this._isNull=!1}},Zh.prototype.getDistance=function(){return this._distance},Zh.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}},Zh.prototype.interfaces_=function(){return[]},Zh.prototype.getClass=function(){return Zh};var Kh=function(){};Kh.prototype.interfaces_=function(){return[]},Kh.prototype.getClass=function(){return Kh},Kh.computeDistance=function(){if(arguments[2]instanceof Zh&&arguments[0]instanceof Pu&&arguments[1]instanceof nl)for(var t=arguments[0],e=arguments[1],n=arguments[2],r=t.getCoordinates(),i=new Wc,o=0;o<r.length-1;o++){i.setCoordinates(r[o],r[o+1]);var a=i.closestPoint(e);n.setMinimum(a,e)}else if(arguments[2]instanceof Zh&&arguments[0]instanceof Iu&&arguments[1]instanceof nl){var s=arguments[0],l=arguments[1],u=arguments[2];Kh.computeDistance(s.getExteriorRing(),l,u);for(var c=0;c<s.getNumInteriorRing();c++)Kh.computeDistance(s.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof Zh&&arguments[0]instanceof Ul&&arguments[1]instanceof nl){var h=arguments[0],f=arguments[1],p=arguments[2];if(h instanceof Pu)Kh.computeDistance(h,f,p);else if(h instanceof Iu)Kh.computeDistance(h,f,p);else if(h instanceof wu)for(var d=h,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);Kh.computeDistance(y,f,p)}else p.setMinimum(h.getCoordinate(),f)}else if(arguments[2]instanceof Zh&&arguments[0]instanceof Wc&&arguments[1]instanceof nl){var m=arguments[0],v=arguments[1],_=arguments[2],b=m.closestPoint(v);_.setMinimum(b,v)}};var Jh=function(t){this._maxPtDist=new Zh,this._inputGeom=t||null},Qh={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Jh.prototype.computeMaxMidpointDistance=function(t){var e=new tf(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},Jh.prototype.computeMaxVertexDistance=function(t){var e=new $h(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},Jh.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},Jh.prototype.getDistancePoints=function(){return this._maxPtDist},Jh.prototype.interfaces_=function(){return[]},Jh.prototype.getClass=function(){return Jh},Qh.MaxPointDistanceFilter.get=function(){return $h},Qh.MaxMidpointDistanceFilter.get=function(){return tf},Object.defineProperties(Jh,Qh);var $h=function(t){this._maxPtDist=new Zh,this._minPtDist=new Zh,this._geom=t||null};$h.prototype.filter=function(t){this._minPtDist.initialize(),Kh.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},$h.prototype.getMaxPointDistance=function(){return this._maxPtDist},$h.prototype.interfaces_=function(){return[Vl]},$h.prototype.getClass=function(){return $h};var tf=function(t){this._maxPtDist=new Zh,this._minPtDist=new Zh,this._geom=t||null};tf.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),r=t.getCoordinate(e),i=new nl((n.x+r.x)/2,(n.y+r.y)/2);this._minPtDist.initialize(),Kh.computeDistance(this._geom,i,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},tf.prototype.isDone=function(){return!1},tf.prototype.isGeometryChanged=function(){return!1},tf.prototype.getMaxPointDistance=function(){return this._maxPtDist},tf.prototype.interfaces_=function(){return[bu]},tf.prototype.getClass=function(){return tf};var ef=function(t){this._comps=t||null};ef.prototype.filter=function(t){t instanceof Iu&&this._comps.add(t)},ef.prototype.interfaces_=function(){return[_u]},ef.prototype.getClass=function(){return ef},ef.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return ef.getPolygons(t,new nu)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Iu?n.add(e):e instanceof wu&&e.apply(new ef(n)),n}};var nf=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};nf.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof Du){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Pu&&this._lines.add(t)},nf.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},nf.prototype.interfaces_=function(){return[Gl]},nf.prototype.getClass=function(){return nf},nf.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(nf.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(nf.getLines(e,n))}},nf.getLines=function(){if(1===arguments.length){var t=arguments[0];return nf.getLines(t,!1)}if(2===arguments.length){if(ll(arguments[0],Ql)&&ll(arguments[1],Ql)){for(var e=arguments[0],n=arguments[1],r=e.iterator();r.hasNext();){var i=r.next();nf.getLines(i,n)}return n}if(arguments[0]instanceof Ul&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1],s=new nu;return o.apply(new nf(s,a)),s}if(arguments[0]instanceof Ul&&ll(arguments[1],Ql)){var l=arguments[0],u=arguments[1];return l instanceof Pu?u.add(l):l.apply(new nf(u)),u}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&ll(arguments[0],Ql)&&ll(arguments[1],Ql)){for(var c=arguments[0],h=arguments[1],f=arguments[2],p=c.iterator();p.hasNext();){var d=p.next();nf.getLines(d,h,f)}return h}if("boolean"==typeof arguments[2]&&arguments[0]instanceof Ul&&ll(arguments[1],Ql)){var g=arguments[0],y=arguments[1],m=arguments[2];return g.apply(new nf(y,m)),y}}};var rf=function(){if(this._boundaryRule=Yl.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new Ks("Rule must be non-null");this._boundaryRule=t}};rf.prototype.locateInternal=function(){if(arguments[0]instanceof nl&&arguments[1]instanceof Iu){var t=arguments[0],e=arguments[1];if(e.isEmpty())return al.EXTERIOR;var n=e.getExteriorRing(),r=this.locateInPolygonRing(t,n);if(r===al.EXTERIOR)return al.EXTERIOR;if(r===al.BOUNDARY)return al.BOUNDARY;for(var i=0;i<e.getNumInteriorRing();i++){var o=e.getInteriorRingN(i),a=this.locateInPolygonRing(t,o);if(a===al.INTERIOR)return al.EXTERIOR;if(a===al.BOUNDARY)return al.BOUNDARY}return al.INTERIOR}if(arguments[0]instanceof nl&&arguments[1]instanceof Pu){var s=arguments[0],l=arguments[1];if(!l.getEnvelopeInternal().intersects(s))return al.EXTERIOR;var u=l.getCoordinates();return l.isClosed()||!s.equals(u[0])&&!s.equals(u[u.length-1])?zl.isOnLine(s,u)?al.INTERIOR:al.EXTERIOR:al.BOUNDARY}if(arguments[0]instanceof nl&&arguments[1]instanceof Tu){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?al.INTERIOR:al.EXTERIOR}},rf.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?zl.locatePointInRing(t,e.getCoordinates()):al.EXTERIOR},rf.prototype.intersects=function(t,e){return this.locate(t,e)!==al.EXTERIOR},rf.prototype.updateLocationInfo=function(t){t===al.INTERIOR&&(this._isIn=!0),t===al.BOUNDARY&&this._numBoundaries++},rf.prototype.computeLocation=function(t,e){if(e instanceof Tu&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Pu)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Iu)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof xu)for(var n=e,r=0;r<n.getNumGeometries();r++){var i=n.getGeometryN(r);this.updateLocationInfo(this.locateInternal(t,i))}else if(e instanceof Ru)for(var o=e,a=0;a<o.getNumGeometries();a++){var s=o.getGeometryN(a);this.updateLocationInfo(this.locateInternal(t,s))}else if(e instanceof wu)for(var l=new _h(e);l.hasNext();){var u=l.next();u!==e&&this.computeLocation(t,u)}},rf.prototype.locate=function(t,e){return e.isEmpty()?al.EXTERIOR:e instanceof Pu||e instanceof Iu?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?al.BOUNDARY:this._numBoundaries>0||this._isIn?al.INTERIOR:al.EXTERIOR)},rf.prototype.interfaces_=function(){return[]},rf.prototype.getClass=function(){return rf};var of=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var e=arguments[0],n=arguments[1];t.call(this,e,t.INSIDE_AREA,n)}else if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this._component=r,this._segIndex=i,this._pt=o}},af={INSIDE_AREA:{configurable:!0}};of.prototype.isInsideArea=function(){return this._segIndex===of.INSIDE_AREA},of.prototype.getCoordinate=function(){return this._pt},of.prototype.getGeometryComponent=function(){return this._component},of.prototype.getSegmentIndex=function(){return this._segIndex},of.prototype.interfaces_=function(){return[]},of.prototype.getClass=function(){return of},af.INSIDE_AREA.get=function(){return-1},Object.defineProperties(of,af);var sf=function(t){this._pts=t||null};sf.prototype.filter=function(t){t instanceof Tu&&this._pts.add(t)},sf.prototype.interfaces_=function(){return[_u]},sf.prototype.getClass=function(){return sf},sf.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Tu?Ic.singletonList(t):sf.getPoints(t,new nu)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Tu?n.add(e):e instanceof wu&&e.apply(new sf(n)),n}};var lf=function(){this._locations=null;var t=arguments[0];this._locations=t};lf.prototype.filter=function(t){(t instanceof Tu||t instanceof Pu||t instanceof Iu)&&this._locations.add(new of(t,0,t.getCoordinate()))},lf.prototype.interfaces_=function(){return[_u]},lf.prototype.getClass=function(){return lf},lf.getLocations=function(t){var e=new nu;return t.apply(new lf(e)),e};var uf=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new rf,this._minDistanceLocation=null,this._minDistance=Js.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=r,this._terminateDistance=i}};uf.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=1-e,i=ef.getPolygons(this._geom[e]);if(i.size()>0){var o=lf.getLocations(this._geom[r]);if(this.computeContainmentDistance(o,i,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[r]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&ll(arguments[0],eu)&&ll(arguments[1],eu)){for(var a=arguments[0],s=arguments[1],l=arguments[2],u=0;u<a.size();u++)for(var c=a.get(u),h=0;h<s.size();h++)if(this.computeContainmentDistance(c,s.get(h),l),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof of&&arguments[1]instanceof Iu){var f=arguments[0],p=arguments[1],d=arguments[2],g=f.getCoordinate();if(al.EXTERIOR!==this._ptLocator.locate(g,p))return this._minDistance=0,d[0]=f,d[1]=new of(p,g),null}},uf.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var a=e.get(o);if(this.computeMinDistance(i,a,n),this._minDistance<=this._terminateDistance)return null}},uf.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=nf.getLines(this._geom[0]),n=nf.getLines(this._geom[1]),r=sf.getPoints(this._geom[0]),i=sf.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,r,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(r,i,t),void this.updateMinDistance(t,!1))))},uf.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},uf.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},uf.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},uf.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Pu&&arguments[1]instanceof Tu){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var r=t.getCoordinates(),i=e.getCoordinate(),o=0;o<r.length-1;o++){var a=zl.distancePointLine(i,r[o],r[o+1]);if(a<this._minDistance){this._minDistance=a;var s=new Wc(r[o],r[o+1]).closestPoint(i);n[0]=new of(t,o,s),n[1]=new of(e,0,i)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Pu&&arguments[1]instanceof Pu){var l=arguments[0],u=arguments[1],c=arguments[2];if(l.getEnvelopeInternal().distance(u.getEnvelopeInternal())>this._minDistance)return null;for(var h=l.getCoordinates(),f=u.getCoordinates(),p=0;p<h.length-1;p++)for(var d=0;d<f.length-1;d++){var g=zl.distanceLineLine(h[p],h[p+1],f[d],f[d+1]);if(g<this._minDistance){this._minDistance=g;var y=new Wc(h[p],h[p+1]),m=new Wc(f[d],f[d+1]),v=y.closestPoints(m);c[0]=new of(l,p,v[0]),c[1]=new of(u,d,v[1])}if(this._minDistance<=this._terminateDistance)return null}}},uf.prototype.computeMinDistancePoints=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var a=e.get(o),s=i.getCoordinate().distance(a.getCoordinate());if(s<this._minDistance&&(this._minDistance=s,n[0]=new of(i,0,i.getCoordinate()),n[1]=new of(a,0,a.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},uf.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new Ks("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},uf.prototype.computeMinDistanceLines=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var a=e.get(o);if(this.computeMinDistance(i,a,n),this._minDistance<=this._terminateDistance)return null}},uf.prototype.interfaces_=function(){return[]},uf.prototype.getClass=function(){return uf},uf.distance=function(t,e){return new uf(t,e).distance()},uf.isWithinDistance=function(t,e,n){return new uf(t,e,n).distance()<=n},uf.nearestPoints=function(t,e){return new uf(t,e).nearestPoints()};var cf=function(){this._pt=[new nl,new nl],this._distance=Js.NaN,this._isNull=!0};cf.prototype.getCoordinates=function(){return this._pt},cf.prototype.getCoordinate=function(t){return this._pt[t]},cf.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}},cf.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=i,this._isNull=!1}},cf.prototype.toString=function(){return Tl.toLineString(this._pt[0],this._pt[1])},cf.prototype.getDistance=function(){return this._distance},cf.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}},cf.prototype.interfaces_=function(){return[]},cf.prototype.getClass=function(){return cf};var hf=function(){};hf.prototype.interfaces_=function(){return[]},hf.prototype.getClass=function(){return hf},hf.computeDistance=function(){if(arguments[2]instanceof cf&&arguments[0]instanceof Pu&&arguments[1]instanceof nl)for(var t=arguments[0],e=arguments[1],n=arguments[2],r=new Wc,i=t.getCoordinates(),o=0;o<i.length-1;o++){r.setCoordinates(i[o],i[o+1]);var a=r.closestPoint(e);n.setMinimum(a,e)}else if(arguments[2]instanceof cf&&arguments[0]instanceof Iu&&arguments[1]instanceof nl){var s=arguments[0],l=arguments[1],u=arguments[2];hf.computeDistance(s.getExteriorRing(),l,u);for(var c=0;c<s.getNumInteriorRing();c++)hf.computeDistance(s.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof cf&&arguments[0]instanceof Ul&&arguments[1]instanceof nl){var h=arguments[0],f=arguments[1],p=arguments[2];if(h instanceof Pu)hf.computeDistance(h,f,p);else if(h instanceof Iu)hf.computeDistance(h,f,p);else if(h instanceof wu)for(var d=h,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);hf.computeDistance(y,f,p)}else p.setMinimum(h.getCoordinate(),f)}else if(arguments[2]instanceof cf&&arguments[0]instanceof Wc&&arguments[1]instanceof nl){var m=arguments[0],v=arguments[1],_=arguments[2],b=m.closestPoint(v);_.setMinimum(b,v)}};var ff=function(){this._g0=null,this._g1=null,this._ptDist=new cf,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},pf={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};ff.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},ff.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new Ks("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},ff.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},ff.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},ff.prototype.computeOrientedDistance=function(t,e,n){var r=new df(e);if(t.apply(r),n.setMaximum(r.getMaxPointDistance()),this._densifyFrac>0){var i=new gf(e,this._densifyFrac);t.apply(i),n.setMaximum(i.getMaxPointDistance())}},ff.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},ff.prototype.interfaces_=function(){return[]},ff.prototype.getClass=function(){return ff},ff.distance=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new ff(t,e).distance()}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=new ff(n,r);return o.setDensifyFraction(i),o.distance()}},pf.MaxPointDistanceFilter.get=function(){return df},pf.MaxDensifiedByFractionDistanceFilter.get=function(){return gf},Object.defineProperties(ff,pf);var df=function(){this._maxPtDist=new cf,this._minPtDist=new cf,this._euclideanDist=new hf,this._geom=null;var t=arguments[0];this._geom=t};df.prototype.filter=function(t){this._minPtDist.initialize(),hf.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},df.prototype.getMaxPointDistance=function(){return this._maxPtDist},df.prototype.interfaces_=function(){return[Vl]},df.prototype.getClass=function(){return df};var gf=function(){this._maxPtDist=new cf,this._minPtDist=new cf,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};gf.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),r=t.getCoordinate(e),i=(r.x-n.x)/this._numSubSegs,o=(r.y-n.y)/this._numSubSegs,a=0;a<this._numSubSegs;a++){var s=n.x+a*i,l=n.y+a*o,u=new nl(s,l);this._minPtDist.initialize(),hf.computeDistance(this._geom,u,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},gf.prototype.isDone=function(){return!1},gf.prototype.isGeometryChanged=function(){return!1},gf.prototype.getMaxPointDistance=function(){return this._maxPtDist},gf.prototype.interfaces_=function(){return[bu]},gf.prototype.getClass=function(){return gf};var yf=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},mf={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};yf.prototype.checkMaximumDistance=function(t,e,n){var r=new ff(e,t);if(r.setDensifyFraction(.25),this._maxDistanceFound=r.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var i=r.getCoordinates();this._errorLocation=i[1],this._errorIndicator=t.getFactory().createLineString(i),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Tl.toLineString(i[0],i[1])+")"}},yf.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=yf.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),yf.VERBOSE&&xl.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},yf.prototype.checkNegativeValid=function(){if(!(this._input instanceof Iu||this._input instanceof Ru||this._input instanceof wu))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},yf.prototype.getErrorIndicator=function(){return this._errorIndicator},yf.prototype.checkMinimumDistance=function(t,e,n){var r=new uf(t,e,n);if(this._minDistanceFound=r.distance(),this._minDistanceFound<n){this._isValid=!1;var i=r.nearestPoints();this._errorLocation=r.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(i),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Tl.toLineString(i[0],i[1])+" )"}},yf.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},yf.prototype.getErrorLocation=function(){return this._errorLocation},yf.prototype.getPolygonLines=function(t){for(var e=new nu,n=new nf(e),r=ef.getPolygons(t).iterator();r.hasNext();)r.next().apply(n);return t.getFactory().buildGeometry(e)},yf.prototype.getErrorMessage=function(){return this._errMsg},yf.prototype.interfaces_=function(){return[]},yf.prototype.getClass=function(){return yf},mf.VERBOSE.get=function(){return!1},mf.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(yf,mf);var vf=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},_f={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};vf.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},vf.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*vf.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new El(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new El(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},vf.prototype.checkDistance=function(){var t=new yf(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},vf.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},vf.prototype.checkPolygonal=function(){this._result instanceof Iu||this._result instanceof Ru||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},vf.prototype.getErrorIndicator=function(){return this._errorIndicator},vf.prototype.getErrorLocation=function(){return this._errorLocation},vf.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},vf.prototype.report=function(t){if(!vf.VERBOSE)return null;xl.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},vf.prototype.getErrorMessage=function(){return this._errorMsg},vf.prototype.interfaces_=function(){return[]},vf.prototype.getClass=function(){return vf},vf.isValidMsg=function(t,e,n){var r=new vf(t,e,n);return r.isValid()?null:r.getErrorMessage()},vf.isValid=function(t,e,n){return!!new vf(t,e,n).isValid()},_f.VERBOSE.get=function(){return!1},_f.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(vf,_f);var bf=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};bf.prototype.getCoordinates=function(){return this._pts},bf.prototype.size=function(){return this._pts.length},bf.prototype.getCoordinate=function(t){return this._pts[t]},bf.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},bf.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:qc.octant(this.getCoordinate(t),this.getCoordinate(t+1))},bf.prototype.setData=function(t){this._data=t},bf.prototype.getData=function(){return this._data},bf.prototype.toString=function(){return Tl.toLineString(new Gu(this._pts))},bf.prototype.interfaces_=function(){return[Hc]},bf.prototype.getClass=function(){return bf};var wf=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new nu,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};wf.prototype.getInteriorIntersection=function(){return this._interiorIntersection},wf.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},wf.prototype.getIntersectionSegments=function(){return this._intSegments},wf.prototype.count=function(){return this._intersectionCount},wf.prototype.getIntersections=function(){return this._intersections},wf.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},wf.prototype.setKeepIntersections=function(t){this._keepIntersections=t},wf.prototype.processIntersections=function(t,e,n,r){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===r)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,r))return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=i,this._intSegments[1]=o,this._intSegments[2]=a,this._intSegments[3]=s,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},wf.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},wf.prototype.hasIntersection=function(){return null!==this._interiorIntersection},wf.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},wf.prototype.interfaces_=function(){return[kh]},wf.prototype.getClass=function(){return wf},wf.createAllIntersectionsFinder=function(t){var e=new wf(t);return e.setFindAllIntersections(!0),e},wf.createAnyIntersectionFinder=function(t){return new wf(t)},wf.createIntersectionCounter=function(t){var e=new wf(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var xf=function(){this._li=new Al,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};xf.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},xf.prototype.getIntersections=function(){return this._segInt.getIntersections()},xf.prototype.isValid=function(){return this.execute(),this._isValid},xf.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},xf.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new wf(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new th;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},xf.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new sc(this.getErrorMessage(),this._segInt.getInteriorIntersection())},xf.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Tl.toLineString(t[0],t[1])+" and "+Tl.toLineString(t[2],t[3])},xf.prototype.interfaces_=function(){return[]},xf.prototype.getClass=function(){return xf},xf.computeIntersections=function(t){var e=new xf(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Lf=function t(){this._nv=null;var e=arguments[0];this._nv=new xf(t.toSegmentStrings(e))};Lf.prototype.checkValid=function(){this._nv.checkValid()},Lf.prototype.interfaces_=function(){return[]},Lf.prototype.getClass=function(){return Lf},Lf.toSegmentStrings=function(t){for(var e=new nu,n=t.iterator();n.hasNext();){var r=n.next();e.add(new bf(r.getCoordinates(),r))}return e},Lf.checkValid=function(t){new Lf(t).checkValid()};var Ef=function(t){this._mapOp=t};Ef.prototype.map=function(t){for(var e=new nu,n=0;n<t.getNumGeometries();n++){var r=this._mapOp.map(t.getGeometryN(n));r.isEmpty()||e.add(r)}return t.getFactory().createGeometryCollection(Ku.toGeometryArray(e))},Ef.prototype.interfaces_=function(){return[]},Ef.prototype.getClass=function(){return Ef},Ef.map=function(t,e){return new Ef(e).map(t)};var Cf=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new nu,this._resultLineList=new nu;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};Cf.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Cf.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Cf.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Cf.prototype.collectLineEdge=function(t,e,n){var r=t.getLabel(),i=t.getEdge();t.isLineEdge()&&(t.isVisited()||!op.isResultOfOp(r,e)||i.isCovered()||(n.add(i),t.setVisitedEdge(!0)))},Cf.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),r=n.getEdge();if(n.isLineEdge()&&!r.isCoveredSet()){var i=this._op.isCoveredByA(n.getCoordinate());r.setCovered(i)}}},Cf.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=n.getLabel();n.isIsolated()&&(r.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Cf.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),r=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(r),n.setInResult(!0)}},Cf.prototype.collectBoundaryTouchEdge=function(t,e,n){var r=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(Nl.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(op.isResultOfOp(r,e)&&e===op.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Cf.prototype.interfaces_=function(){return[]},Cf.prototype.getClass=function(){return Cf};var kf=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new nu;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};kf.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},kf.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==op.INTERSECTION)){var r=n.getLabel();op.isResultOfOp(r,t)&&this.filterCoveredNodeToPoint(n)}}},kf.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},kf.prototype.interfaces_=function(){return[]},kf.prototype.getClass=function(){return kf};var Sf=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Sf.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Sf.prototype.transformPolygon=function(t,e){var n=!0,r=this.transformLinearRing(t.getExteriorRing(),t);null!==r&&r instanceof Du&&!r.isEmpty()||(n=!1);for(var i=new nu,o=0;o<t.getNumInteriorRing();o++){var a=this.transformLinearRing(t.getInteriorRingN(o),t);null===a||a.isEmpty()||(a instanceof Du||(n=!1),i.add(a))}if(n)return this._factory.createPolygon(r,i.toArray([]));var s=new nu;return null!==r&&s.add(r),s.addAll(i),this._factory.buildGeometry(s)},Sf.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Sf.prototype.getInputGeometry=function(){return this._inputGeom},Sf.prototype.transformMultiLineString=function(t,e){for(var n=new nu,r=0;r<t.getNumGeometries();r++){var i=this.transformLineString(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Sf.prototype.transformCoordinates=function(t,e){return this.copy(t)},Sf.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Sf.prototype.transformMultiPoint=function(t,e){for(var n=new nu,r=0;r<t.getNumGeometries();r++){var i=this.transformPoint(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Sf.prototype.transformMultiPolygon=function(t,e){for(var n=new nu,r=0;r<t.getNumGeometries();r++){var i=this.transformPolygon(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Sf.prototype.copy=function(t){return t.copy()},Sf.prototype.transformGeometryCollection=function(t,e){for(var n=new nu,r=0;r<t.getNumGeometries();r++){var i=this.transform(t.getGeometryN(r));null!==i&&(this._pruneEmptyGeometry&&i.isEmpty()||n.add(i))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Ku.toGeometryArray(n)):this._factory.buildGeometry(n)},Sf.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Tu)return this.transformPoint(t,null);if(t instanceof Nu)return this.transformMultiPoint(t,null);if(t instanceof Du)return this.transformLinearRing(t,null);if(t instanceof Pu)return this.transformLineString(t,null);if(t instanceof xu)return this.transformMultiLineString(t,null);if(t instanceof Iu)return this.transformPolygon(t,null);if(t instanceof Ru)return this.transformMultiPolygon(t,null);if(t instanceof wu)return this.transformGeometryCollection(t,null);throw new Ks("Unknown Geometry subtype: "+t.getClass().getName())},Sf.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var r=n.size();return r>0&&r<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Sf.prototype.interfaces_=function(){return[]},Sf.prototype.getClass=function(){return Sf};var Pf=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Wc,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Pu&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];t.call(this,e.getCoordinates(),n)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var r=arguments[0],i=arguments[1];this._srcPts=r,this._isClosed=t.isClosed(r),this._snapTolerance=i}};Pf.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),r=0;r<n;r++){var i=t.get(r),o=this.findSnapForVertex(i,e);null!==o&&(t.set(r,new nl(o)),0===r&&this._isClosed&&t.set(t.size()-1,new nl(o)))}},Pf.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Pf.prototype.snapTo=function(t){var e=new iu(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Pf.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var r=0;r<n;r++){var i=e[r],o=this.findSegmentIndexToSnap(i,t);o>=0&&t.add(o+1,new nl(i),!1)}},Pf.prototype.findSegmentIndexToSnap=function(t,e){for(var n=Js.MAX_VALUE,r=-1,i=0;i<e.size()-1;i++){if(this._seg.p0=e.get(i),this._seg.p1=e.get(i+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,r=i)}return r},Pf.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Pf.prototype.interfaces_=function(){return[]},Pf.prototype.getClass=function(){return Pf},Pf.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Mf=function(t){this._srcGeom=t||null},Tf={SNAP_PRECISION_FACTOR:{configurable:!0}};Mf.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new Of(e,n).transform(this._srcGeom)},Mf.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),r=new Of(t,n,!0).transform(this._srcGeom),i=r;return e&&ll(i,Ou)&&(i=r.buffer(0)),i},Mf.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Mf.prototype.extractTargetCoordinates=function(t){for(var e=new Pi,n=t.getCoordinates(),r=0;r<n.length;r++)e.add(n[r]);return e.toArray(new Array(0).fill(null))},Mf.prototype.computeMinimumSegmentLength=function(t){for(var e=Js.MAX_VALUE,n=0;n<t.length-1;n++){var r=t[n].distance(t[n+1]);r<e&&(e=r)}return e},Mf.prototype.interfaces_=function(){return[]},Mf.prototype.getClass=function(){return Mf},Mf.snap=function(t,e,n){var r=new Array(2).fill(null),i=new Mf(t);r[0]=i.snapTo(e,n);var o=new Mf(e);return r[1]=o.snapTo(r[0],n),r},Mf.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Mf.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===Yu.FIXED){var r=1/n.getScale()*2/1.415;r>e&&(e=r)}return e}if(2===arguments.length){var i=arguments[0],o=arguments[1];return Math.min(Mf.computeOverlaySnapTolerance(i),Mf.computeOverlaySnapTolerance(o))}},Mf.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Mf.SNAP_PRECISION_FACTOR},Mf.snapToSelf=function(t,e,n){return new Mf(t).snapToSelf(e,n)},Tf.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Mf,Tf);var Of=function(t){function e(e,n,r){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==r&&r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new Pf(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),r=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Sf),If=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};If.prototype.getCommon=function(){return Js.longBitsToDouble(this._commonBits)},If.prototype.add=function(t){var e=Js.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=If.signExpBits(this._commonBits),this._isFirst=!1,null):If.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=If.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=If.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},If.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=Js.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+Js.toBinaryString(t),r=n.substring(n.length-64);return r.substring(0,1)+"  "+r.substring(1,12)+"(exp) "+r.substring(12)+" [ "+e+" ]"}},If.prototype.interfaces_=function(){return[]},If.prototype.getClass=function(){return If},If.getBit=function(t,e){return 0!=(t&1<<e)?1:0},If.signExpBits=function(t){return t>>52},If.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},If.numCommonMostSigMantissaBits=function(t,e){for(var n=0,r=52;r>=0;r--){if(If.getBit(t,r)!==If.getBit(e,r))return n;n++}return 52};var Nf=function(){this._commonCoord=null,this._ccFilter=new Rf},Df={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Nf.prototype.addCommonBits=function(t){var e=new Af(this._commonCoord);t.apply(e),t.geometryChanged()},Nf.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new nl(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new Af(e);return t.apply(n),t.geometryChanged(),t},Nf.prototype.getCommonCoordinate=function(){return this._commonCoord},Nf.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Nf.prototype.interfaces_=function(){return[]},Nf.prototype.getClass=function(){return Nf},Df.CommonCoordinateFilter.get=function(){return Rf},Df.Translater.get=function(){return Af},Object.defineProperties(Nf,Df);var Rf=function(){this._commonBitsX=new If,this._commonBitsY=new If};Rf.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},Rf.prototype.getCommonCoordinate=function(){return new nl(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},Rf.prototype.interfaces_=function(){return[Vl]},Rf.prototype.getClass=function(){return Rf};var Af=function(){this.trans=null;var t=arguments[0];this.trans=t};Af.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,r=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,r)},Af.prototype.isDone=function(){return!1},Af.prototype.isGeometryChanged=function(){return!0},Af.prototype.interfaces_=function(){return[bu]},Af.prototype.getClass=function(){return Af};var jf=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};jf.prototype.selfSnap=function(t){return new Mf(t).snapTo(t,this._snapTolerance)},jf.prototype.removeCommonBits=function(t){this._cbr=new Nf,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},jf.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},jf.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=op.overlayOp(e[0],e[1],t);return this.prepareResult(n)},jf.prototype.checkValid=function(t){t.isValid()||xl.out.println("Snapped geometry is invalid")},jf.prototype.computeSnapTolerance=function(){this._snapTolerance=Mf.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},jf.prototype.snap=function(t){var e=this.removeCommonBits(t);return Mf.snap(e[0],e[1],this._snapTolerance)},jf.prototype.interfaces_=function(){return[]},jf.prototype.getClass=function(){return jf},jf.overlayOp=function(t,e,n){return new jf(t,e).getResultGeometry(n)},jf.union=function(t,e){return jf.overlayOp(t,e,op.UNION)},jf.intersection=function(t,e){return jf.overlayOp(t,e,op.INTERSECTION)},jf.symDifference=function(t,e){return jf.overlayOp(t,e,op.SYMDIFFERENCE)},jf.difference=function(t,e){return jf.overlayOp(t,e,op.DIFFERENCE)};var Bf=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};Bf.prototype.getResultGeometry=function(t){var e=null,n=!1,r=null;try{e=op.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof Ol))throw t;r=t}if(!n)try{e=jf.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof Ol?r:t}return e},Bf.prototype.interfaces_=function(){return[]},Bf.prototype.getClass=function(){return Bf},Bf.overlayOp=function(t,e,n){return new Bf(t,e).getResultGeometry(n)},Bf.union=function(t,e){return Bf.overlayOp(t,e,op.UNION)},Bf.intersection=function(t,e){return Bf.overlayOp(t,e,op.INTERSECTION)},Bf.symDifference=function(t,e){return Bf.overlayOp(t,e,op.SYMDIFFERENCE)},Bf.difference=function(t,e){return Bf.overlayOp(t,e,op.DIFFERENCE)};var zf=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};zf.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},zf.prototype.interfaces_=function(){return[]},zf.prototype.getClass=function(){return zf};var Ff=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=r,this._xValue=i,this._obj=o}},Gf={INSERT:{configurable:!0},DELETE:{configurable:!0}};Ff.prototype.isDelete=function(){return this._eventType===Ff.DELETE},Ff.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},Ff.prototype.getObject=function(){return this._obj},Ff.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},Ff.prototype.getInsertEvent=function(){return this._insertEvent},Ff.prototype.isInsert=function(){return this._eventType===Ff.INSERT},Ff.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},Ff.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},Ff.prototype.interfaces_=function(){return[$s]},Ff.prototype.getClass=function(){return Ff},Gf.INSERT.get=function(){return 1},Gf.DELETE.get=function(){return 2},Object.defineProperties(Ff,Gf);var Uf=function(){};Uf.prototype.interfaces_=function(){return[]},Uf.prototype.getClass=function(){return Uf};var qf=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};qf.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if(qf.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var i=t.getNumPoints()-1;if(0===e&&r===i||0===r&&e===i)return!0}}return!1},qf.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},qf.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},qf.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},qf.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next().getCoordinate();if(t.isIntersection(r))return!0}return!1},qf.prototype.hasProperIntersection=function(){return this._hasProper},qf.prototype.hasIntersection=function(){return this._hasIntersection},qf.prototype.isDone=function(){return this._isDone},qf.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},qf.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},qf.prototype.addIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,a,s),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},qf.prototype.interfaces_=function(){return[]},qf.prototype.getClass=function(){return qf},qf.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Hf=function(t){function e(){t.call(this),this.events=new nu,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){Ic.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof qf&&ll(arguments[0],eu)&&ll(arguments[1],eu)){var r=arguments[0],i=arguments[1],o=arguments[2];this.addEdges(r,r),this.addEdges(i,i),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&ll(arguments[0],eu)&&arguments[1]instanceof qf){var a=arguments[0],s=arguments[1];arguments[2]?this.addEdges(a,null):this.addEdges(a),this.computeIntersections(s)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),r=n.getStartIndexes(),i=0;i<r.length-1;i++){var o=new zf(n,i),a=new Ff(e,n.getMinX(i),o);this.events.add(a),this.events.add(new Ff(n.getMaxX(i),a))}},e.prototype.processOverlaps=function(t,e,n,r){for(var i=n.getObject(),o=t;o<e;o++){var a=this.events.get(o);if(a.isInsert()){var s=a.getObject();n.isSameLabel(a)||(i.computeIntersections(s,r),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[0],r=arguments[1],i=n.iterator();i.hasNext();){var o=i.next();this.addEdge(o,r)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Uf),Vf=function(){this._min=Js.POSITIVE_INFINITY,this._max=Js.NEGATIVE_INFINITY},Yf={NodeComparator:{configurable:!0}};Vf.prototype.getMin=function(){return this._min},Vf.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},Vf.prototype.getMax=function(){return this._max},Vf.prototype.toString=function(){return Tl.toLineString(new nl(this._min,0),new nl(this._max,0))},Vf.prototype.interfaces_=function(){return[]},Vf.prototype.getClass=function(){return Vf},Yf.NodeComparator.get=function(){return Wf},Object.defineProperties(Vf,Yf);var Wf=function(){};Wf.prototype.compare=function(t,e){var n=t,r=e,i=(n._min+n._max)/2,o=(r._min+r._max)/2;return i<o?-1:i>o?1:0},Wf.prototype.interfaces_=function(){return[el]},Wf.prototype.getClass=function(){return Wf};var Xf=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],r=arguments[2];this._min=e,this._max=n,this._item=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Vf),Zf=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Vf),Kf=function(){this._leaves=new nu,this._root=null,this._level=0};Kf.prototype.buildTree=function(){Ic.sort(this._leaves,new Vf.NodeComparator);for(var t=this._leaves,e=null,n=new nu;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},Kf.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Xf(t,e,n))},Kf.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},Kf.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},Kf.prototype.printNode=function(t){xl.out.println(Tl.toLineString(new nl(t._min,this._level),new nl(t._max,this._level)))},Kf.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},Kf.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var r=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(r);else{var i=new Zf(t.get(n),t.get(n+1));e.add(i)}}},Kf.prototype.interfaces_=function(){return[]},Kf.prototype.getClass=function(){return Kf};var Jf=function(){this._items=new nu};Jf.prototype.visitItem=function(t){this._items.add(t)},Jf.prototype.getItems=function(){return this._items},Jf.prototype.interfaces_=function(){return[Pc]},Jf.prototype.getClass=function(){return Jf};var Qf=function(){this._index=null;var t=arguments[0];if(!ll(t,Ou))throw new Ks("Argument must be Polygonal");this._index=new ep(t)},$f={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Qf.prototype.locate=function(t){var e=new Bl(t),n=new tp(e);return this._index.query(t.y,t.y,n),e.getLocation()},Qf.prototype.interfaces_=function(){return[vh]},Qf.prototype.getClass=function(){return Qf},$f.SegmentVisitor.get=function(){return tp},$f.IntervalIndexedGeometry.get=function(){return ep},Object.defineProperties(Qf,$f);var tp=function(){this._counter=null;var t=arguments[0];this._counter=t};tp.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},tp.prototype.interfaces_=function(){return[Pc]},tp.prototype.getClass=function(){return tp};var ep=function(){this._index=new Kf;var t=arguments[0];this.init(t)};ep.prototype.init=function(t){for(var e=nf.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},ep.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new Wc(t[e-1],t[e]),r=Math.min(n.p0.y,n.p1.y),i=Math.max(n.p0.y,n.p1.y);this._index.insert(r,i,n)}},ep.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Jf;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this._index.query(r,i,o)}},ep.prototype.interfaces_=function(){return[]},ep.prototype.getClass=function(){return ep};var np=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new Vu,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new rf,2===arguments.length){var e=arguments[0],n=arguments[1],r=Yl.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=r,null!==n&&this.add(n)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];this._argIndex=i,this._parentGeom=o,this._boundaryNodeRule=a,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var r=this._nodes.addNode(n).getLabel(),i=1;r.getLocation(t,ic.ON)===al.BOUNDARY&&i++;var o=e.determineBoundary(this._boundaryNodeRule,i);r.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=new qf(n,!0,!1);o.setIsDoneIfProperInt(i);var a=this.createEdgeSetIntersector(),s=this._parentGeom instanceof Du||this._parentGeom instanceof Iu||this._parentGeom instanceof Ru,l=r||!s;return a.computeIntersections(this._edges,o,l),this.addSelfIntersectionNodes(this._argIndex),o}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var r=new qf(e,n,!0);return r.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,r),r},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Tu){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,al.INTERIOR)}else if(arguments[0]instanceof nl){var e=arguments[0];this.insertPoint(this._argIndex,e,al.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),al.EXTERIOR,al.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,al.INTERIOR,al.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],al.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],al.BOUNDARY)},e.prototype.addLineString=function(t){var e=ou.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new Dh(e,new hc(this._argIndex,al.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),Nl.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,r=t.iterator();r.hasNext();){var i=r.next();e[n++]=i.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===al.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var r=ou.removeRepeatedPoints(t.getCoordinates());if(r.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=r[0],null;var i=e,o=n;zl.isCCW(r)&&(i=n,o=e);var a=new Dh(r,new hc(this._argIndex,al.BOUNDARY,i,o));this._lineEdgeMap.put(t,a),this.insertEdge(a),this.insertPoint(this._argIndex,r[0],al.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var r=this._nodes.addNode(e),i=r.getLabel();null===i?r._label=new hc(t,n):i.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new Hf},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),r=n.getLabel().getLocation(t),i=n.eiList.iterator();i.hasNext();){var o=i.next();this.addSelfIntersectionNode(t,o.coord,r)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof Ru&&(this._useBoundaryDeterminationRule=!1),e instanceof Iu)this.addPolygon(e);else if(e instanceof Pu)this.addLineString(e);else if(e instanceof Tu)this.addPoint(e);else if(e instanceof Nu)this.addCollection(e);else if(e instanceof xu)this.addCollection(e);else if(e instanceof Ru)this.addCollection(e);else{if(!(e instanceof wu))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return ll(this._parentGeom,Ou)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new Qf(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?al.BOUNDARY:al.INTERIOR},e}(Lc),rp=function(){if(this._li=new Al,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new np(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=Yl.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new np(0,e,r),this._arg[1]=new np(1,n,r)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];i.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new np(0,i,a),this._arg[1]=new np(1,o,a)}};rp.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},rp.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},rp.prototype.interfaces_=function(){return[]},rp.prototype.getClass=function(){return rp};var ip=function(){};ip.prototype.interfaces_=function(){return[]},ip.prototype.getClass=function(){return ip},ip.map=function(){if(arguments[0]instanceof Ul&&ll(arguments[1],ip.MapOp)){for(var t=arguments[0],e=arguments[1],n=new nu,r=0;r<t.getNumGeometries();r++){var i=e.map(t.getGeometryN(r));null!==i&&n.add(i)}return t.getFactory().buildGeometry(n)}if(ll(arguments[0],Ql)&&ll(arguments[1],ip.MapOp)){for(var o=arguments[0],a=arguments[1],s=new nu,l=o.iterator();l.hasNext();){var u=l.next(),c=a.map(u);null!==c&&s.add(c)}return s}},ip.MapOp=function(){};var op=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new rf,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Ch,this._resultPolyList=new nu,this._resultLineList=new nu,this._resultPointList=new nu,this._graph=new Lc(new Lh),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new hc(t.getLabel())).flip();var i=e.getDepth();i.isNull()&&i.add(n),i.add(r),n.merge(r)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,r,i){var o=new nu;return o.addAll(t),o.addAll(n),o.addAll(r),o.isEmpty()?e.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(this._ptLocator.locate(t,r)!==al.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new nu,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new nu;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Lf.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new Ec(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var r=new Cf(this,this._geomFact,this._ptLocator);this._resultLineList=r.build(t);var i=new kf(this,this._geomFact,this._ptLocator);this._resultPointList=i.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var r=n.next(),i=r.getLabel();i.isArea()&&!r.isInteriorAreaEdge()&&e.isResultOfOp(i.getLocation(0,ic.RIGHT),i.getLocation(1,ic.RIGHT),t)&&r.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),r=e.getDepth();if(!r.isNull()){r.normalize();for(var i=0;i<2;i++)n.isNull(i)||!n.isArea()||r.isNull(i)||(0===r.getDelta(i)?n.toLine(i):(Nl.isTrue(!r.isNull(i,ic.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(i,ic.LEFT,r.getLocation(i,ic.LEFT)),Nl.isTrue(!r.isNull(i,ic.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(i,ic.RIGHT,r.getLocation(i,ic.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(rp);op.overlayOp=function(t,e,n){return new op(t,e).getResultGeometry(n)},op.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return op.createEmptyResult(op.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Ef.map(t,{interfaces_:function(){return[ip.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Bf.overlayOp(t,e,op.INTERSECTION)},op.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return op.createEmptyResult(op.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Bf.overlayOp(t,e,op.SYMDIFFERENCE)},op.resultDimension=function(t,e,n){var r=e.getDimension(),i=n.getDimension(),o=-1;switch(t){case op.INTERSECTION:o=Math.min(r,i);break;case op.UNION:o=Math.max(r,i);break;case op.DIFFERENCE:o=r;break;case op.SYMDIFFERENCE:o=Math.max(r,i)}return o},op.createEmptyResult=function(t,e,n,r){var i=null;switch(op.resultDimension(t,e,n)){case-1:i=r.createGeometryCollection(new Array(0).fill(null));break;case 0:i=r.createPoint();break;case 1:i=r.createLineString();break;case 2:i=r.createPolygon()}return i},op.difference=function(t,e){return t.isEmpty()?op.createEmptyResult(op.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Bf.overlayOp(t,e,op.DIFFERENCE))},op.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),r=t.getLocation(1);return op.isResultOfOp(n,r,e)}if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];switch(i===al.BOUNDARY&&(i=al.INTERIOR),o===al.BOUNDARY&&(o=al.INTERIOR),a){case op.INTERSECTION:return i===al.INTERIOR&&o===al.INTERIOR;case op.UNION:return i===al.INTERIOR||o===al.INTERIOR;case op.DIFFERENCE:return i===al.INTERIOR&&o!==al.INTERIOR;case op.SYMDIFFERENCE:return i===al.INTERIOR&&o!==al.INTERIOR||i!==al.INTERIOR&&o===al.INTERIOR}return!1}},op.INTERSECTION=1,op.UNION=2,op.DIFFERENCE=3,op.SYMDIFFERENCE=4;var ap=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new rf,this._seg=new Wc;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};ap.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),r=0;r<n.size()-1;r++)if(n.getCoordinate(r,this._seg.p0),n.getCoordinate(r+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},ap.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?al.BOUNDARY:this._ptLocator.locate(t,this._g)},ap.prototype.extractLinework=function(t){var e=new sp;t.apply(e);var n=e.getLinework(),r=Ku.toLineStringArray(n);return t.getFactory().createMultiLineString(r)},ap.prototype.interfaces_=function(){return[]},ap.prototype.getClass=function(){return ap};var sp=function(){this._linework=null,this._linework=new nu};sp.prototype.getLinework=function(){return this._linework},sp.prototype.filter=function(t){if(t instanceof Iu){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},sp.prototype.interfaces_=function(){return[_u]},sp.prototype.getClass=function(){return sp};var lp=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};lp.prototype.extractPoints=function(t,e,n){for(var r=t.getCoordinates(),i=0;i<r.length-1;i++)this.computeOffsetPoints(r[i],r[i+1],e,n)},lp.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},lp.prototype.getPoints=function(t){for(var e=new nu,n=nf.getLines(this._g).iterator();n.hasNext();){var r=n.next();this.extractPoints(r,t,e)}return e},lp.prototype.computeOffsetPoints=function(t,e,n,r){var i=e.x-t.x,o=e.y-t.y,a=Math.sqrt(i*i+o*o),s=n*i/a,l=n*o/a,u=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var h=new nl(u-l,c+s);r.add(h)}if(this._doRight){var f=new nl(u+l,c-s);r.add(f)}},lp.prototype.interfaces_=function(){return[]},lp.prototype.getClass=function(){return lp};var up=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new nu;var e=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,r],this._locFinder=[new ap(this._geom[0],this._boundaryDistanceTolerance),new ap(this._geom[1],this._boundaryDistanceTolerance),new ap(this._geom[2],this._boundaryDistanceTolerance)]},cp={TOLERANCE:{configurable:!0}};up.prototype.reportResult=function(t,e,n){xl.out.println("Overlay result invalid - A:"+al.toLocationSymbol(e[0])+" B:"+al.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+al.toLocationSymbol(e[2]))},up.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},up.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var r=arguments[0],i=arguments[1];return this._location[0]=this._locFinder[0].getLocation(i),this._location[1]=this._locFinder[1].getLocation(i),this._location[2]=this._locFinder[2].getLocation(i),!!up.hasLocation(this._location,al.BOUNDARY)||this.isValidResult(r,this._location)}},up.prototype.addTestPts=function(t){var e=new lp(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},up.prototype.isValidResult=function(t,e){var n=op.isResultOfOp(e[0],e[1],t),r=!(n^e[2]===al.INTERIOR);return r||this.reportResult(t,e,n),r},up.prototype.getInvalidLocation=function(){return this._invalidLocation},up.prototype.interfaces_=function(){return[]},up.prototype.getClass=function(){return up},up.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},up.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Mf.computeSizeBasedSnapTolerance(t),Mf.computeSizeBasedSnapTolerance(e))},up.isValid=function(t,e,n,r){return new up(t,e,r).isValid(n)},cp.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(up,cp);var hp=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};hp.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);this._skipEmpty&&r.isEmpty()||e.add(r)}},hp.prototype.combine=function(){for(var t=new nu,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},hp.prototype.interfaces_=function(){return[]},hp.prototype.getClass=function(){return hp},hp.combine=function(){if(1===arguments.length){var t=arguments[0];return new hp(t).combine()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new hp(hp.createList(e,n)).combine()}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];return new hp(hp.createList(r,i,o)).combine()}},hp.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},hp.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new nu;return n.add(t),n.add(e),n}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],a=new nu;return a.add(r),a.add(i),a.add(o),a}};var fp=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new nu)},pp={STRTREE_NODE_CAPACITY:{configurable:!0}};fp.prototype.reduceToGeometries=function(t){for(var e=new nu,n=t.iterator();n.hasNext();){var r=n.next(),i=null;ll(r,eu)?i=this.unionTree(r):r instanceof Ul&&(i=r),e.add(i)}return e},fp.prototype.extractByEnvelope=function(t,e,n){for(var r=new nu,i=0;i<e.getNumGeometries();i++){var o=e.getGeometryN(i);o.getEnvelopeInternal().intersects(t)?r.add(o):n.add(o)}return this._geomFactory.buildGeometry(r)},fp.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),r=e.getEnvelopeInternal();if(!n.intersects(r))return hp.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var i=n.intersection(r);return this.unionUsingEnvelopeIntersection(t,e,i)},fp.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new Bc(fp.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var r=t.itemsTree();return this.unionTree(r)},fp.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];if(r-n<=1){var i=fp.getGeometry(e,n);return this.unionSafe(i,null)}if(r-n==2)return this.unionSafe(fp.getGeometry(e,n),fp.getGeometry(e,n+1));var o=Math.trunc((r+n)/2),a=this.binaryUnion(e,n,o),s=this.binaryUnion(e,o,r);return this.unionSafe(a,s)}},fp.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var r=n.next();e=null===e?r.copy():e.union(r)}return e},fp.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},fp.prototype.unionActual=function(t,e){return fp.restrictToPolygons(t.union(e))},fp.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},fp.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var r=new nu,i=this.extractByEnvelope(n,t,r),o=this.extractByEnvelope(n,e,r),a=this.unionActual(i,o);return r.add(a),hp.combine(r)},fp.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},fp.prototype.interfaces_=function(){return[]},fp.prototype.getClass=function(){return fp},fp.restrictToPolygons=function(t){if(ll(t,Ou))return t;var e=ef.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(Ku.toPolygonArray(e))},fp.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},fp.union=function(t){return new fp(t).union()},pp.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(fp,pp);var dp=function(){};dp.prototype.interfaces_=function(){return[]},dp.prototype.getClass=function(){return dp},dp.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return op.createEmptyResult(op.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Bf.overlayOp(t,e,op.UNION)};var gp=function(){return new Ni};Ni.prototype={constructor:Ni,reset:function(){this.s=this.t=0},add:function(t){Di(yp,t,this.t),Di(this,yp.s,this.s),this.s?this.t+=yp.t:this.s=yp.t},valueOf:function(){return this.s}};var yp=new Ni,mp=1e-6,vp=Math.PI,_p=vp/2,bp=vp/4,wp=2*vp,xp=180/vp,Lp=vp/180,Ep=Math.abs,Cp=Math.atan,kp=Math.atan2,Sp=Math.cos,Pp=Math.exp,Mp=Math.log,Tp=Math.sin,Op=Math.sqrt,Ip=Math.tan,Np={Feature:function(t,e){ji(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)ji(n[r].geometry,e)}},Dp={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){Bi(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Bi(n[r],e,0)},Polygon:function(t,e){zi(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)zi(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)ji(n[r],e)}},Rp=function(t,e){t&&Np.hasOwnProperty(t.type)?Np[t.type](t,e):ji(t,e)},Ap=(gp(),gp(),gp(),function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n});Wi.invert=Wi;var jp=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Ai,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},Bp=function(t,e,n,r,i,o){var a,s=t[0],l=t[1],u=0,c=1,h=e[0]-s,f=e[1]-l;if(a=n-s,h||!(a>0)){if(a/=h,h<0){if(a<u)return;a<c&&(c=a)}else if(h>0){if(a>c)return;a>u&&(u=a)}if(a=i-s,h||!(a<0)){if(a/=h,h<0){if(a>c)return;a>u&&(u=a)}else if(h>0){if(a<u)return;a<c&&(c=a)}if(a=r-l,f||!(a>0)){if(a/=f,f<0){if(a<u)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>u&&(u=a)}if(a=o-l,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>u&&(u=a)}else if(f>0){if(a<u)return;a<c&&(c=a)}return u>0&&(t[0]=s+u*h,t[1]=l+u*f),c<1&&(e[0]=s+c*h,e[1]=l+c*f),!0}}}}},zp=function(t,e){return Ep(t[0]-e[0])<mp&&Ep(t[1]-e[1])<mp},Fp=function(t,e,n,r,i){var o,a,s=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(zp(r,a)){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);i.lineEnd()}else s.push(n=new $i(r,t,null,!0)),l.push(n.o=new $i(r,null,n,!1)),s.push(n=new $i(a,t,null,!1)),l.push(n.o=new $i(a,null,n,!0))}})),s.length){for(l.sort(e),to(s),to(l),o=0,a=l.length;o<a;++o)l[o].e=n=!n;for(var u,c,h=s[0];;){for(var f=h,p=!0;f.v;)if((f=f.n)===h)return;u=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(o=0,a=u.length;o<a;++o)i.point((c=u[o])[0],c[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(p)for(u=f.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else r(f.x,f.p.x,-1,i);f=f.p}u=(f=f.o).z,p=!p}while(!f.v);i.lineEnd()}}},Gp=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Up=(function(t){1===t.length&&(t=function(t){return function(e,n){return Gp(t(e),n)}}(t))}(Gp),function(t){for(var e,n,r,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(n=new Array(a);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--a]=r[e];return n}),qp=1e9,Hp=-qp,Vp=gp(),Yp=(gp(),function(t){return t}),Wp=(gp(),gp(),1/0),Xp=Wp,Zp=-Wp,Kp=Zp,Jp={point:function(t,e){t<Wp&&(Wp=t),t>Zp&&(Zp=t),e<Xp&&(Xp=e),e>Kp&&(Kp=e)},lineStart:Ai,lineEnd:Ai,polygonStart:Ai,polygonEnd:Ai,result:function(){var t=[[Wp,Xp],[Zp,Kp]];return Zp=Kp=-(Xp=Wp=1/0),t}},Qp=(gp(),function(t,e,n,r){return function(i,o){function a(e,n){var r=i(e,n);t(e=r[0],n=r[1])&&o.point(e,n)}function s(t,e){var n=i(t,e);y.point(n[0],n[1])}function l(){w.point=s,y.lineStart()}function u(){w.point=a,y.lineEnd()}function c(t,e){g.push([t,e]);var n=i(t,e);_.point(n[0],n[1])}function h(){_.lineStart(),g=[]}function f(){c(g[0][0],g[0][1]),_.lineEnd();var t,e,n,r,i=_.clean(),a=v.result(),s=a.length;if(g.pop(),p.push(g),g=null,s)if(1&i){if((e=(n=a[0]).length-1)>0){for(b||(o.polygonStart(),b=!0),o.lineStart(),t=0;t<e;++t)o.point((r=n[t])[0],r[1]);o.lineEnd()}}else s>1&&2&i&&a.push(a.pop().concat(a.shift())),d.push(a.filter(no))}var p,d,g,y=e(o),m=i.invert(r[0],r[1]),v=jp(),_=e(v),b=!1,w={point:a,lineStart:l,lineEnd:u,polygonStart:function(){w.point=c,w.lineStart=h,w.lineEnd=f,d=[],p=[]},polygonEnd:function(){w.point=a,w.lineStart=l,w.lineEnd=u,d=Up(d);var t=function(t,e){var n=e[0],r=e[1],i=[Tp(n),-Sp(n),0],o=0,a=0;Vp.reset();for(var s=0,l=t.length;s<l;++s)if(c=(u=t[s]).length)for(var u,c,h=u[c-1],f=h[0],p=h[1]/2+bp,d=Tp(p),g=Sp(p),y=0;y<c;++y,f=v,d=b,g=w,h=m){var m=u[y],v=m[0],_=m[1]/2+bp,b=Tp(_),w=Sp(_),x=v-f,L=x>=0?1:-1,E=L*x,C=E>vp,k=d*b;if(Vp.add(kp(k*L*Tp(E),g*w+k*Sp(E))),o+=C?x+L*wp:x,C^f>=n^v>=n){var S=qi(Gi(h),Gi(m));Yi(S);var P=qi(i,S);Yi(P);var M=(C^x>=0?-1:1)*Ri(P[2]);(r>M||r===M&&(S[0]||S[1]))&&(a+=C^x>=0?1:-1)}}return(o<-mp||o<mp&&Vp<-mp)^1&a}(p,m);d.length?(b||(o.polygonStart(),b=!0),Fp(d,ro,t,n,o)):t&&(b||(o.polygonStart(),b=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),b&&(o.polygonEnd(),b=!1),d=p=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};return w}}),$p=Qp((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?vp:-vp,l=Ep(o-n);Ep(l-vp)<mp?(t.point(n,r=(r+a)/2>0?_p:-_p),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&l>=vp&&(Ep(n-i)<mp&&(n-=i*mp),Ep(o-s)<mp&&(o-=s*mp),r=function(t,e,n,r){var i,o,a=Tp(t-n);return Ep(a)>mp?Cp((Tp(e)*(o=Sp(r))*Tp(n)-Tp(r)*(i=Sp(e))*Tp(t))/(i*o*a)):(e+r)/2}(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*_p,r.point(-vp,i),r.point(0,i),r.point(vp,i),r.point(vp,0),r.point(vp,-i),r.point(0,-i),r.point(-vp,-i),r.point(-vp,0),r.point(-vp,i);else if(Ep(t[0]-e[0])>mp){var o=t[0]<e[0]?vp:-vp;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-vp,-_p]),td=function(t,e){function n(t,e){return Sp(t)*Sp(e)>o}function r(t,e,n){var r=[1,0,0],i=qi(Gi(t),Gi(e)),a=Ui(i,i),s=i[0],l=a-s*s;if(!l)return!n&&t;var u=o*a/l,c=-o*s/l,h=qi(r,i),f=Vi(r,u);Hi(f,Vi(i,c));var p=h,d=Ui(f,p),g=Ui(p,p),y=d*d-g*(Ui(f,f)-1);if(!(y<0)){var m=Op(y),v=Vi(p,(-d-m)/g);if(Hi(v,f),v=Fi(v),!n)return v;var _,b=t[0],w=e[0],x=t[1],L=e[1];w<b&&(_=b,b=w,w=_);var E=w-b,C=Ep(E-vp)<mp;if(!C&&L<x&&(_=x,x=L,L=_),C||E<mp?C?x+L>0^v[1]<(Ep(v[0]-b)<mp?x:L):x<=v[1]&&v[1]<=L:E>vp^(b<=v[0]&&v[0]<=w)){var k=Vi(p,(-d+m)/g);return Hi(k,f),[v,Fi(k)]}}}function i(e,n){var r=a?t:vp-t,i=0;return e<-r?i|=1:e>r&&(i|=2),n<-r?i|=4:n>r&&(i|=8),i}var o=Sp(t),a=o>0,s=Ep(o)>mp;return Qp(n,(function(t){var e,o,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,f){var p,d=[h,f],g=n(h,f),y=a?g?0:i(h,f):g?i(h+(h<0?vp:-vp),f):0;if(!e&&(u=l=g)&&t.lineStart(),g!==l&&(!(p=r(e,d))||zp(e,p)||zp(d,p))&&(d[0]+=mp,d[1]+=mp,g=n(d[0],d[1])),g!==l)c=0,g?(t.lineStart(),p=r(d,e),t.point(p[0],p[1])):(p=r(e,d),t.point(p[0],p[1]),t.lineEnd()),e=p;else if(s&&e&&a^g){var m;y&o||!(m=r(d,e,!0))||(c=0,a?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!g||e&&zp(e,d)||t.point(d[0],d[1]),e=d,l=g,o=y},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(n,r,i,o){!function(t,e,n,r,i,o){if(n){var a=Sp(e),s=Tp(e),l=r*n;null==i?(i=e+r*wp,o=e-l/2):(i=Qi(a,i),o=Qi(a,o),(r>0?i<o:i>o)&&(i+=r*wp));for(var u,c=i;r>0?c>o:c<o;c-=l)u=Fi([a,-s*Sp(c),-s*Tp(c)]),t.point(u[0],u[1])}}(o,t,e,i,n,r)}),a?[0,-t]:[-vp,t-vp])};oo.prototype={constructor:oo,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ed=Sp(30*Lp),nd=function(t,e){return+e?function(t,e){function n(r,i,o,a,s,l,u,c,h,f,p,d,g,y){var m=u-r,v=c-i,_=m*m+v*v;if(_>4*e&&g--){var b=a+f,w=s+p,x=l+d,L=Op(b*b+w*w+x*x),E=Ri(x/=L),C=Ep(Ep(x)-1)<mp||Ep(o-h)<mp?(o+h)/2:kp(w,b),k=t(C,E),S=k[0],P=k[1],M=S-r,T=P-i,O=v*M-m*T;(O*O/_>e||Ep((m*M+v*T)/_-.5)>.3||a*f+s*p+l*d<ed)&&(n(r,i,o,a,s,l,S,P,C,b/=L,w/=L,x,g,y),y.point(S,P),n(S,P,C,b,w,x,u,c,h,f,p,d,g,y))}}return function(e){function r(n,r){n=t(n,r),e.point(n[0],n[1])}function i(){m=NaN,x.point=o,e.lineStart()}function o(r,i){var o=Gi([r,i]),a=t(r,i);n(m,v,y,_,b,w,m=a[0],v=a[1],y=r,_=o[0],b=o[1],w=o[2],16,e),e.point(m,v)}function a(){x.point=r,e.lineEnd()}function s(){i(),x.point=l,x.lineEnd=u}function l(t,e){o(c=t,e),h=m,f=v,p=_,d=b,g=w,x.point=o}function u(){n(m,v,y,_,b,w,h,f,c,p,d,g,16,e),x.lineEnd=a,a()}var c,h,f,p,d,g,y,m,v,_,b,w,x={point:r,lineStart:i,lineEnd:a,polygonStart:function(){e.polygonStart(),x.lineStart=s},polygonEnd:function(){e.polygonEnd(),x.lineStart=i}};return x}}(t,e):function(t){return io({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)},rd=io({point:function(t,e){this.stream.point(t*Lp,e*Lp)}});so.invert=function(t,e){return[t,2*Cp(Pp(e))-_p]},lo.invert=function(t,e){return[-e,2*Cp(Pp(t))-_p]};var id=function(){var t=function(t){function e(){var e=vp*s(),a=o(function(t){function e(e){return(e=t(e[0]*Lp,e[1]*Lp))[0]*=xp,e[1]*=xp,e}return t=Xi(t[0]*Lp,t[1]*Lp,t.length>2?t[2]*Lp:0),e.invert=function(e){return(e=t.invert(e[0]*Lp,e[1]*Lp))[0]*=xp,e[1]*=xp,e},e}(o.rotate()).invert([0,0]));return u(null==c?[[a[0]-e,a[1]-e],[a[0]+e,a[1]+e]]:t===so?[[Math.max(a[0]-e,c),n],[Math.min(a[0]+e,r),i]]:[[c,Math.max(a[1]-e,n)],[r,Math.min(a[1]+e,i)]])}var n,r,i,o=function(t){return function(t){function e(t){return[(t=u(t[0]*Lp,t[1]*Lp))[0]*g+a,s-t[1]*g]}function n(t,e){return[(t=o(t,e))[0]*g+a,s-t[1]*g]}function r(){u=Ap(l=Xi(b,w,x),o);var t=o(v,_);return a=y-t[0]*g,s=m+t[1]*g,i()}function i(){return p=d=null,e}var o,a,s,l,u,c,h,f,p,d,g=150,y=480,m=250,v=0,_=0,b=0,w=0,x=0,L=null,E=$p,C=null,k=Yp,S=.5,P=nd(n,S);return e.stream=function(t){return p&&d===t?p:p=rd(E(l,P(k(d=t))))},e.clipAngle=function(t){return arguments.length?(E=+t?td(L=t*Lp,6*Lp):(L=null,$p),i()):L*xp},e.clipExtent=function(t){return arguments.length?(k=null==t?(C=c=h=f=null,Yp):eo(C=+t[0][0],c=+t[0][1],h=+t[1][0],f=+t[1][1]),i()):null==C?null:[[C,c],[h,f]]},e.scale=function(t){return arguments.length?(g=+t,r()):g},e.translate=function(t){return arguments.length?(y=+t[0],m=+t[1],r()):[y,m]},e.center=function(t){return arguments.length?(v=t[0]%360*Lp,_=t[1]%360*Lp,r()):[v*xp,_*xp]},e.rotate=function(t){return arguments.length?(b=t[0]%360*Lp,w=t[1]%360*Lp,x=t.length>2?t[2]%360*Lp:0,r()):[b*xp,w*xp,x*xp]},e.precision=function(t){return arguments.length?(P=nd(n,S=t*t),i()):Op(S)},e.fitExtent=function(t,n){return ao(e,t,n)},e.fitSize=function(t,n){return function(t,e,n){return ao(t,[[0,0],e],n)}(e,t,n)},function(){return o=t.apply(this,arguments),e.invert=o.invert&&function(t){return(t=u.invert((t[0]-a)/g,(s-t[1])/g))&&[t[0]*xp,t[1]*xp]},r()}}((function(){return t}))()}(t),a=o.center,s=o.scale,l=o.translate,u=o.clipExtent,c=null;return o.scale=function(t){return arguments.length?(s(t),e()):s()},o.translate=function(t){return arguments.length?(l(t),e()):l()},o.center=function(t){return arguments.length?(a(t),e()):a()},o.clipExtent=function(t){return arguments.length?(null==t?c=n=r=i=null:(c=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),e()):null==c?null:[[c,n],[r,i]]},e()}(lo),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)};t.projection=ca,t.random=Ws,t.clusters=Xs,t.helpers=ko,t.invariant=Po,t.meta=So,t.isolines=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.zProperty||"elevation",i=n.commonProperties||{},o=n.breaksProperties||[];if(X(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks must be an Array");if(!E(i))throw new Error("commonProperties must be an Object");if(!Array.isArray(o))throw new Error("breaksProperties must be an Array");var a=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",r=e.flip,i=e.flags;X(t,"Point","input must contain Points");for(var o=function(t,e){var n={};return O(t,(function(t){var e=H(t)[1];n[e]||(n[e]=[]),n[e].push(t)})),Object.keys(n).map((function(t){return n[t].sort((function(t,e){return H(t)[0]-H(e)[0]}))})).sort((function(t,n){return e?H(t[0])[1]-H(n[0])[1]:H(n[0])[1]-H(t[0])[1]}))}(t,r),a=[],s=0;s<o.length;s++){for(var l=o[s],u=[],c=0;c<l.length;c++){var h=l[c];h.properties[n]?u.push(h.properties[n]):u.push(0),!0===i&&(h.properties.matrixPosition=[s,c])}a.push(u)}return a}(t,{zProperty:r,flip:!0});return u(function(t,e,n){var r=U(n),i=r[2]-r[0],o=r[3]-r[1],a=r[0],s=r[1],l=e[0].length-1,u=e.length-1,c=i/l,h=o/u,f=function(t){t[0]=t[0]*c+a,t[1]=t[1]*h+s};return t.forEach((function(t){S(t,f)})),t}(function(t,e,n,r,i){for(var o=[],a=1;a<e.length;a++){var s=+e[a],l=Object.assign({},r,i[a]);l[n]=s;var u=c(Q(t,s),l);o.push(u)}return o}(a,e,r,i,o),a,t))},t.convex=St,t.pointsWithinPolygon=Tt,t.concave=function(t,n){if(!E(n=n||{}))throw new Error("options is invalid");if(!t)throw new Error("points is required");var r=n.maxEdge||1/0;if(!L(r))throw new Error("maxEdge is invalid");var i=Ot(function(t){var e=[],n={};return O(t,(function(t){if(t.geometry){var r=t.geometry.coordinates.join("-");n.hasOwnProperty(r)||(e.push(t),n[r]=!0)}})),u(e)}(t));if(i.features=i.features.filter((function(t){var e=t.geometry.coordinates[0][0],i=t.geometry.coordinates[0][1],o=t.geometry.coordinates[0][2],a=Rt(e,i,n),s=Rt(i,o,n),l=Rt(e,o,n);return a<=r&&s<=r&&l<=r})),i.features.length<1)return null;var o=Xt(i,n);return 1===o.coordinates.length&&(o.coordinates=o.coordinates[0],o.type="Polygon"),e(o)},t.collect=function(t,e,n,r){var i=Io(6),o=e.features.map((function(t){return{minX:t.geometry.coordinates[0],minY:t.geometry.coordinates[1],maxX:t.geometry.coordinates[0],maxY:t.geometry.coordinates[1],property:t.properties[n]}}));return i.load(o),t.features.forEach((function(t){t.properties||(t.properties={});var e=U(t),n=[];i.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}).forEach((function(e){Pt([e.minX,e.minY],t)&&n.push(e.property)})),t.properties[r]=n})),t},t.flip=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if(!t)throw new Error("geojson is required");return!1!==n&&void 0!==n||(t=At(t)),S(t,(function(t){var e=t[0],n=t[1];t[0]=n,t[1]=e})),t},t.simplify=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=void 0!==e.tolerance?e.tolerance:1,r=e.highQuality||!1,i=e.mutate||!1;if(!t)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return!0!==i&&(t=At(t)),D(t,(function(t){!function(t,e,n){var r=t.type;if("Point"===r||"MultiPoint"===r)return t;Zt(t,!0);var i=t.coordinates;switch(r){case"LineString":t.coordinates=te(i,e,n);break;case"MultiLineString":t.coordinates=i.map((function(t){return te(t,e,n)}));break;case"Polygon":t.coordinates=ee(i,e,n);break;case"MultiPolygon":t.coordinates=i.map((function(t){return ee(t,e,n)}))}}(t,n,r)})),t},t.bezierSpline=ne,t.tag=function(t,e,n,r){return t=At(t),e=At(e),O(t,(function(t){t.properties||(t.properties={}),O(e,(function(e){void 0===t.properties[r]&&Pt(t,e)&&(t.properties[r]=e.properties[n])}))})),t},t.sample=function(t,e){if(!t)throw new Error("featurecollection is required");if(null==e)throw new Error("num is required");if("number"!=typeof e)throw new Error("num must be a number");return u(function(t,e){for(var n,r,i=t.slice(0),o=t.length,a=o-e;o-- >a;)n=i[r=Math.floor((o+1)*Math.random())],i[r]=i[o],i[o]=n;return i.slice(a)}(t.features,e))},t.envelope=ie,t.square=oe,t.circle=se,t.midpoint=function(t,e){return ae(t,Rt(t,e)/2,le(t,e))},t.center=ue,t.centerOfMass=function t(e,n){switch(J(e)){case"Point":return e;case"Polygon":var i=[];S(e,(function(t){i.push(t)}));var o,a,s,l,u,c,h,f,p=ce(e,n),d=p.geometry.coordinates,g=0,y=0,m=0,v=i.map((function(t){return[t[0]-d[0],t[1]-d[1]]}));for(o=0;o<i.length-1;o++)l=(a=v[o])[0],c=a[1],u=(s=v[o+1])[0],m+=f=l*(h=s[1])-u*c,g+=(l+u)*f,y+=(c+h)*f;if(0===m)return p;var _=1/(.5*m*6);return r([d[0]+_*g,d[1]+_*y],n);default:var b=St(e);return b?t(b,n):ce(e,n)}},t.centroid=ce,t.combine=function(t){function n(t,e,n){n?r[e].coordinates=r[e].coordinates.concat(t.geometry.coordinates):r[e].coordinates.push(t.geometry.coordinates),r[e].properties.push(t.properties)}var r={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},i=Object.keys(r).reduce((function(t,e){return t[e.replace("Multi","")]=e,t}),{});return O(t,(function(t){t.geometry&&(r[t.geometry.type]?n(t,t.geometry.type,!0):i[t.geometry.type]&&n(t,i[t.geometry.type],!1))})),u(Object.keys(r).filter((function(t){return r[t].coordinates.length})).sort().map((function(t){return e({type:t,coordinates:r[t].coordinates},{collectedProperties:r[t].properties})})))},t.distance=Rt,t.explode=he,t.bbox=U,t.tesselate=function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=Se(t.geometry.coordinates):t.geometry.coordinates.forEach((function(t){e.features=e.features.concat(Se(t))})),e},t.bboxPolygon=re,t.booleanPointInPolygon=Pt,t.nearestPoint=Pe,t.nearestPointOnLine=Ze,t.nearestPointToLine=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.units,i=n.properties||{};if(!t)throw new Error("points is required");if(!(t=function(t){var e=[];switch(t.geometry?t.geometry.type:t.type){case"GeometryCollection":return D(t,(function(t){"Point"===t.type&&e.push({type:"Feature",properties:{},geometry:t})})),{type:"FeatureCollection",features:e};case"FeatureCollection":return t.features=t.features.filter((function(t){return"Point"===t.geometry.type})),t;default:throw new Error("points must be a Point Collection")}}(t)).features.length)throw new Error("points must contain features");if(!e)throw new Error("line is required");if("LineString"!==J(e))throw new Error("line must be a LineString");var o=1/0,a=null;return O(t,(function(t){var n=on(t,e,{units:r});n<o&&(o=n,a=t)})),a&&(a.properties=Object.assign({dist:o},a.properties,i)),a},t.planepoint=function(t,e){var n=q(t),r=Z(e).coordinates[0];if(r.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var i=e.properties||{},o=i.a,a=i.b,s=i.c,l=n[0],u=n[1],c=r[0][0],h=r[0][1],f=void 0!==o?o:r[0][2],p=r[1][0],d=r[1][1],g=void 0!==a?a:r[1][2],y=r[2][0],m=r[2][1],v=void 0!==s?s:r[2][2];return(v*(l-c)*(u-d)+f*(l-p)*(u-m)+g*(l-y)*(u-h)-g*(l-c)*(u-m)-v*(l-p)*(u-h)-f*(l-y)*(u-d))/((l-c)*(u-d)+(l-p)*(u-m)+(l-y)*(u-h)-(l-c)*(u-m)-(l-p)*(u-h)-(l-y)*(u-d))},t.tin=Ot,t.bearing=le,t.destination=ae,t.kinks=function(t){var e,n,i={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach((function(t){e.forEach((function(e){for(var n=0;n<t.length-1;n++)for(var o=n;o<e.length-1;o++){if(t===e){if(1===Math.abs(n-o))continue;if(0===n&&o===t.length-2&&t[n][0]===t[t.length-1][0]&&t[n][1]===t[t.length-1][1])continue}var a=function(t,e,n,r,i,o,a,s){var l,u,c,h,f={x:null,y:null,onLine1:!1,onLine2:!1};return 0==(l=(s-o)*(n-t)-(a-i)*(r-e))?null!==f.x&&null!==f.y&&f:(h=(n-t)*(u=e-o)-(r-e)*(c=t-i),u=((a-i)*u-(s-o)*c)/l,c=h/l,f.x=t+u*(n-t),f.y=e+u*(r-e),u>=0&&u<=1&&(f.onLine1=!0),c>=0&&c<=1&&(f.onLine2=!0),!(!f.onLine1||!f.onLine2)&&[f.x,f.y])}(t[n][0],t[n][1],t[n+1][0],t[n+1][1],e[o][0],e[o][1],e[o+1][0],e[o+1][1]);a&&i.features.push(r([a[0],a[1]]))}}))})),i},t.pointOnFeature=sn,t.area=un,t.along=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var i;if("Feature"===t.type)i=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");i=t.coordinates}if(!L(e))throw new Error("distance must be a number");for(var o=0,a=0;a<i.length&&!(e>=o&&a===i.length-1);a++){if(o>=e){var s=e-o;if(s){var l=le(i[a],i[a-1])-180;return ae(i[a],s,l,n)}return r(i[a])}o+=Rt(i[a],i[a+1],n)}return r(i[i.length-1])},t.length=pn,t.lineSlice=function(t,e,n){var r=H(n);if("LineString"!==J(n))throw new Error("line must be a LineString");for(var i,o=Ze(n,t),a=Ze(n,e),l=[(i=o.properties.index<=a.properties.index?[o,a]:[a,o])[0].geometry.coordinates],u=i[0].properties.index+1;u<i[1].properties.index+1;u++)l.push(r[u]);return l.push(i[1].geometry.coordinates),s(l,n.properties)},t.lineSliceAlong=dn,t.pointGrid=_n,t.truncate=bn,t.flatten=function(t){if(!t)throw new Error("geojson is required");var e=[];return A(t,(function(t){e.push(t)})),u(e)},t.lineIntersect=We,t.lineChunk=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.units,i=n.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var o=[];return A(t,(function(t){i&&(t.geometry.coordinates=t.geometry.coordinates.reverse()),function(t,e,n,r){var i=pn(t,{units:n});if(i<=e)return r(t);var o=i/e;Number.isInteger(o)||(o=Math.floor(o)+1);for(var a=0;a<o;a++)r(dn(t,e*a,e*(a+1),{units:n}))}(t,e,r,(function(t){o.push(t)}))})),u(o)},t.unkinkPolygon=function(t){var e=[];return A(t,(function(t){"Polygon"===t.geometry.type&&O(fa(t),(function(n){e.push(o(n.geometry.coordinates,t.properties))}))})),u(e)},t.greatCircle=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var r=n.properties,i=n.npoints,o=n.offset;return t=q(t),e=q(e),r=r||{},i=i||100,o=o||10,new ba({x:t[0],y:t[1]},{x:e[0],y:e[1]},r).Arc(i,{offset:o}).json()},t.lineSegment=Ye,t.lineSplit=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var n=J(t),r=J(e);if("LineString"!==n)throw new Error("line must be LineString");if("FeatureCollection"===r)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===r)throw new Error("splitter cannot be a GeometryCollection");var i=bn(e,{precision:7});switch(r){case"Point":return Cn(t,i);case"MultiPoint":return En(t,i);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return En(t,We(t,i))}},t.lineArc=Pn,t.polygonToLine=Tn,t.lineToPolygon=In,t.bboxClip=function(t,e){var n=function(t){return t.geometry?t.geometry.type:t.type}(t),r=H(t),i=t.properties;switch(n){case"LineString":case"MultiLineString":var a=[];return"LineString"===n&&(r=[r]),r.forEach((function(t){wa(t,e,a)})),1===a.length?s(a[0],i):c(a,i);case"Polygon":return o(Bn(r,e),i);case"MultiPolygon":return f(r.map((function(t){return Bn(t,e)})),i);default:throw new Error("geometry "+n+" not supported")}},t.lineOverlap=qn,t.sector=function(t,e,n,r,i){if(!E(i=i||{}))throw new Error("options is invalid");if(!t)throw new Error("center is required");if(null==n)throw new Error("bearing1 is required");if(null==r)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");if("object"!=typeof i)throw new Error("options must be an object");if(Vn(n)===Vn(r))return se(t,e,i);var a=H(t),s=[[a]];return S(Pn(t,e,n,r,i),(function(t){s[0].push(t)})),s[0].push(a),o(s)},t.rhumbBearing=Ke,t.rhumbDistance=Qe,t.rhumbDestination=Yn,t.polygonTangents=function(t,e){var n,i,o,a=H(t),s=H(e);switch(J(e)){case"Polygon":n=s[0][0],i=s[0][0],o=Xn(s[0][0],s[0][s[0].length-1],a);var l=Wn(s[0],a,o,void 0,n,i);n=l[0],i=l[1];break;case"MultiPolygon":n=s[0][0][0],i=s[0][0][0],o=Xn(s[0][0][0],s[0][0][s[0][0].length-1],a),s.forEach((function(t){var e=Wn(t[0],a,o,void 0,n,i);n=e[0],i=e[1]}))}return u([r(n),r(i)])},t.rewind=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.reverse||!1,r=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw new Error("<mutate> must be a boolean");!1===r&&(t=At(t));var i=[];switch(t.type){case"GeometryCollection":return D(t,(function(t){Kn(t,n)})),t;case"FeatureCollection":return O(t,(function(t){O(Kn(t,n),(function(t){i.push(t)}))})),u(i)}return Kn(t,n)},t.isobands=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.zProperty||"elevation",i=n.commonProperties||{},a=n.breaksProperties||[];if(X(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks is not an Array");if(!E(i))throw new Error("commonProperties is not an Object");if(!Array.isArray(a))throw new Error("breaksProperties is not an Array");var s=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",r=e.flip,i=e.flags;X(t,"Point","input must contain Points");for(var o=function(t,e){var n={};return O(t,(function(t){var e=H(t)[1];n[e]||(n[e]=[]),n[e].push(t)})),Object.keys(n).map((function(t){return n[t].sort((function(t,e){return H(t)[0]-H(e)[0]}))})).sort((function(t,n){return e?H(t[0])[1]-H(n[0])[1]:H(n[0])[1]-H(t[0])[1]}))}(t,r),a=[],s=0;s<o.length;s++){for(var l=o[s],u=[],c=0;c<l.length;c++){var h=l[c];h.properties[n]?u.push(h.properties[n]):u.push(0),!0===i&&(h.properties.matrixPosition=[s,c])}a.push(u)}return a}(t,{zProperty:r,flip:!0}),l=function(t,e,n){for(var r=[],i=1;i<e.length;i++){var a=+e[i-1],s=+e[i],l=function(t){for(var e=t.map((function(t){return{lrCoordinates:t,grouped:!1}})),n=[];!function(t){for(var e=0;e<t.length;e++)if(!1===t[e].grouped)return!1;return!0}(e);)for(var r=0;r<e.length;r++)if(!e[r].grouped){var i=[];i.push(e[r].lrCoordinates),e[r].grouped=!0;for(var a=o([e[r].lrCoordinates]),s=r+1;s<e.length;s++)e[s].grouped||function(t,e){for(var n=he(t),r=0;r<n.features.length;r++)if(!Pt(n.features[r],e))return!1;return!0}(o([e[s].lrCoordinates]),a)&&(i.push(e[s].lrCoordinates),e[s].grouped=!0);n.push(i)}return n}(function(t){var e=[],n=[];t.forEach((function(t){var r=un(o([t]));n.push(r),e.push({ring:t,area:r})})),n.sort((function(t,e){return e-t}));var r=[];return n.forEach((function(t){for(var n=0;n<e.length;n++)if(e[n].area===t){r.push(e[n].ring),e.splice(n,1);break}})),r}($n(t,a,s-a))),u={};u.groupedRings=l,u[n]=a+"-"+s,r.push(u)}return r}(s,e,r);return u((l=function(t,e,n){var r=U(n),i=r[2]-r[0],o=r[3]-r[1],a=r[0],s=r[1],l=e[0].length-1,u=e.length-1,c=i/l,h=o/u,f=function(t){t[0]=t[0]*c+a,t[1]=t[1]*h+s};return t.forEach((function(t){t.groupedRings.forEach((function(t){t.forEach((function(t){t.forEach(f)}))}))})),t}(l,s,t)).map((function(t,e){if(a[e]&&!E(a[e]))throw new Error("Each mappedProperty is required to be an Object");var n=Object.assign({},i,a[e]);return n[r]=t[r],f(t.groupedRings,n)})))},t.transformRotate=nr,t.transformScale=rr,t.transformTranslate=function(t,e,n,r){if(!E(r=r||{}))throw new Error("options is invalid");var i=r.units,o=r.zTranslation,a=r.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");if(o&&"number"!=typeof o&&isNaN(o))throw new Error("zTranslation is not a number");if(o=void 0!==o?o:0,0===e&&0===o)return t;if(null==n||isNaN(n))throw new Error("direction is required");return e<0&&(e=-e,n=-n),!1!==a&&void 0!==a||(t=At(t)),S(t,(function(t){var r=H(Yn(t,e,n,{units:i}));t[0]=r[0],t[1]=r[1],o&&3===t.length&&(t[2]+=o)})),t},t.lineOffset=function(t,e,n){if(!E(n=n||{}))throw new Error("options is invalid");var r=n.units;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");var i=J(t),o=t.properties;switch(i){case"LineString":return sr(t,e,r);case"MultiLineString":var a=[];return A(t,(function(t){a.push(sr(t,e,r).geometry.coordinates)})),c(a,o);default:throw new Error("geometry "+i+" is not supported")}},t.polygonize=function(t){var e=bs.fromGeoJson(t);e.deleteDangles(),e.deleteCutEdges();var n=[],r=[];return e.getEdgeRings().filter((function(t){return t.isValid()})).forEach((function(t){t.isHole()?n.push(t):r.push(t)})),n.forEach((function(t){vs.findEdgeRingContaining(t,r)&&r.push(t)})),u(r.map((function(t){return t.toPolygon()})))},t.booleanDisjoint=function(t,e){var n;return A(t,(function(t){A(e,(function(e){if(!1===n)return!1;n=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return!function(t,e){return t[0]===e[0]&&t[1]===e[1]}(t.coordinates,e.coordinates);case"LineString":return!cr(e,t);case"Polygon":return!Pt(t,e)}break;case"LineString":switch(e.type){case"Point":return!cr(t,e);case"LineString":return!function(t,e){return We(t,e).features.length>0}(t,e);case"Polygon":return!hr(e,t)}break;case"Polygon":switch(e.type){case"Point":return!Pt(e,t);case"LineString":return!hr(t,e);case"Polygon":return!function(t,e){for(var n=0;n<t.coordinates[0].length;n++)if(Pt(t.coordinates[0][n],e))return!0;for(var r=0;r<e.coordinates[0].length;r++)if(Pt(e.coordinates[0][r],t))return!0;return!1}(e,t)}}}(t.geometry,e.geometry)}))})),n},t.booleanContains=function(t,e){var n=J(t),r=J(e),i=Z(t),o=Z(e),a=H(t),s=H(e);switch(n){case"Point":switch(r){case"Point":return pr(a,s);default:throw new Error("feature2 "+r+" geometry not supported")}case"MultiPoint":switch(r){case"Point":return function(t,e){var n,r=!1;for(n=0;n<t.coordinates.length;n++)if(pr(t.coordinates[n],e.coordinates)){r=!0;break}return r}(i,o);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++){for(var r=!1,i=0;i<t.coordinates.length;i++)if(pr(e.coordinates[n],t.coordinates[i])){r=!0;break}if(!r)return!1}return!0}(i,o);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"Point":return gn(o,i,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var n=!1,r=0;r<e.coordinates.length;r++)if(gn({type:"Point",coordinates:e.coordinates[r]},t,{ignoreEndVertices:!0})&&(n=!0),!gn({type:"Point",coordinates:e.coordinates[r]},t,{ignoreEndVertices:!1}))return!1;return n}(i,o);case"MultiPoint":return function(t,e){for(var n=!1,r=0;r<e.coordinates.length;r++)if(gn(e.coordinates[r],t,{ignoreEndVertices:!0})&&(n=!0),!gn(e.coordinates[r],t))return!1;return!!n}(i,o);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"Point":return Pt(o,i,{ignoreBoundary:!0});case"LineString":return function(t,e){var n=!1,r=0;if(!fr(U(t),U(e)))return!1;for(;r<e.coordinates.length-1;r++)if(Pt({type:"Point",coordinates:function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}(e.coordinates[r],e.coordinates[r+1])},t,{ignoreBoundary:!0})){n=!0;break}return n}(i,o);case"Polygon":return function(t,e){if(!fr(U(t),U(e)))return!1;for(var n=0;n<e.coordinates[0].length;n++)if(!Pt(e.coordinates[0][n],t))return!1;return!0}(i,o);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++)if(!Pt(e.coordinates[n],t,{ignoreBoundary:!0}))return!1;return!0}(i,o);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},t.booleanCrosses=function(t,e){var n=J(t),r=J(e),i=Z(t),o=Z(e);switch(n){case"MultiPoint":switch(r){case"LineString":return dr(i,o);case"Polygon":return yr(i,o);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"MultiPoint":return dr(o,i);case"LineString":return function(t,e){if(We(t,e).features.length>0)for(var n=0;n<t.coordinates.length-1;n++)for(var r=0;r<e.coordinates.length-1;r++){var i=!0;if(0!==r&&r!==e.coordinates.length-2||(i=!1),mr(t.coordinates[n],t.coordinates[n+1],e.coordinates[r],i))return!0}return!1}(i,o);case"Polygon":return gr(i,o);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"MultiPoint":return yr(o,i);case"LineString":return gr(o,i);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},t.booleanClockwise=Zn,t.booleanOverlap=wr,t.booleanPointOnLine=gn,t.booleanEqual=function(t,e){if(!t)throw new Error("feature1 is required");if(!e)throw new Error("feature2 is required");return J(t)===J(e)&&new Cs({precision:6}).compare(Zt(t),Zt(e))},t.booleanWithin=yn,t.clone=At,t.cleanCoords=Zt,t.clustersDbscan=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var r=n.minPoints,i=n.units;if(X(t,"Point","Input must contain Points"),null==e)throw new Error("maxDistance is required");if(!(Math.sign(e)>0))throw new Error("Invalid maxDistance");if(!(null==r||Math.sign(r)>0))throw new Error("Invalid minPoints");t=At(t),r=r||3;var o=new Ts.DBSCAN,a=-1;return o.run(N(t),w(e,i),r,Rt).forEach((function(e){a++,e.forEach((function(e){var n=t.features[e];n.properties||(n.properties={}),n.properties.cluster=a,n.properties.dbscan="core"}))})),o.noise.forEach((function(e){var n=t.features[e];n.properties||(n.properties={}),n.properties.cluster?n.properties.dbscan="edge":n.properties.dbscan="noise"})),t},t.clustersKmeans=function(t,e){if("object"!=typeof(e=e||{}))throw new Error("options is invalid");var n=e.numberOfClusters,r=e.mutate;X(t,"Point","Input must contain Points");var i=t.features.length;(n=n||Math.round(Math.sqrt(i/2)))>i&&(n=i),!1!==r&&void 0!==r||(t=At(t));var o=N(t),a=o.slice(0,n),s=Rs(o,n,a),l={};return s.centroids.forEach((function(t,e){l[e]=t})),O(t,(function(t,e){var n=s.idxs[e];t.properties.cluster=n,t.properties.centroid=l[n]})),t},t.pointToLineDistance=on,t.booleanParallel=function(t,e){if(!t)throw new Error("line1 is required");if(!e)throw new Error("line2 is required");if("LineString"!==Lr(t,"line1"))throw new Error("line1 must be a LineString");if("LineString"!==Lr(e,"line2"))throw new Error("line2 must be a LineString");for(var n=Ye(Zt(t)).features,r=Ye(Zt(e)).features,i=0;i<n.length;i++){var o=n[i].geometry.coordinates;if(!r[i])break;if(!function(t,e){return v(Ke(t[0],t[1]))===v(Ke(e[0],e[1]))}(o,r[i].geometry.coordinates))return!1}return!0},t.shortestPath=function(t,n,i){if(!E(i=i||{}))throw new Error("options is invalid");var o=i.resolution,a=i.minDistance,l=i.obstacles||u([]);if(!t)throw new Error("start is required");if(!n)throw new Error("end is required");if(o&&!L(o)||o<=0)throw new Error("options.resolution must be a number, greater than 0");if(a)throw new Error("options.minDistance is not yet implemented");var c=q(t),h=q(n);switch(t=r(c),n=r(h),J(l)){case"FeatureCollection":if(0===l.features.length)return s([c,h]);break;case"Polygon":l=u([e(Z(l))]);break;default:throw new Error("invalid obstacles")}var f=l;f.features.push(t),f.features.push(n);var p=U(rr(re(U(f)),1.15));o||(o=Rt([p[0],p[1]],[p[2],p[1]],i)/100),f.features.pop(),f.features.pop();for(var d=p[0],g=p[1],y=p[2],m=p[3],v=o/Rt([d,g],[y,g],i)*(y-d),_=o/Rt([d,g],[d,m],i)*(m-g),b=y-d,w=m-g,x=(b-Math.floor(b/v)*v)/2,C=[],k=[],S=[],P=[],M=1/0,T=1/0,O=m-(w-Math.floor(w/_)*_)/2,I=0;O>=g;){for(var N=[],D=[],R=d+x,A=0;R<=y;){var j=r([R,O]),B=function(t,e){for(var n=0;n<e.features.length;n++)if(Pt(t,e.features[n]))return!0;return!1}(j,l);N.push(B?0:1),D.push(R+"|"+O);var z=Rt(j,t);!B&&z<M&&(M=z,S={x:A,y:I});var F=Rt(j,n);!B&&F<T&&(T=F,P={x:A,y:I}),R+=v,A++}k.push(N),C.push(D),O-=_,I++}var G=new Cr(k,{diagonal:!0}),H=G.grid[S.y][S.x],V=G.grid[P.y][P.x],Y=[c];return As.search(G,H,V).forEach((function(t){var e=C[t.x][t.y].split("|");Y.push([+e[0],+e[1]])})),Y.push(h),Zt(s(Y))},t.voronoi=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.bbox||[-180,-85,180,85];if(!t)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return X(t,"Point","points"),u(function(){function t(t){return new Qr(t.map((function(r,i){var o=[Math.round(e(r,i,t)/Vs)*Vs,Math.round(n(r,i,t)/Vs)*Vs];return o.index=i,o.data=r,o})),r)}var e=Pr,n=Mr,r=null;return t.polygons=function(e){return t(e).polygons()},t.links=function(e){return t(e).links()},t.triangles=function(e){return t(e).triangles()},t.x=function(n){return arguments.length?(e="function"==typeof n?n:js(+n),t):e},t.y=function(e){return arguments.length?(n="function"==typeof e?e:js(+e),t):n},t.extent=function(e){return arguments.length?(r=null==e?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],t):r&&[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},t.size=function(e){return arguments.length?(r=null==e?null:[[0,0],[+e[0],+e[1]]],t):r&&[r[1][0]-r[0][0],r[1][1]-r[0][1]]},t}().x((function(t){return t.geometry.coordinates[0]})).y((function(t){return t.geometry.coordinates[1]})).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(t.features).map($r))},t.ellipse=ti,t.centerMean=ni,t.centerMedian=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.counter||10;if(!L(n))throw new Error("counter must be a number");var r=e.weight,i=ni(t,{weight:e.weight}),o=u([]);return O(t,(function(t){o.features.push(ce(t,{weight:t.properties[r]}))})),o.properties={tolerance:e.tolerance,medianCandidates:[]},ri(i.geometry.coordinates,[0,0],o,n)},t.standardDeviationalEllipse=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.steps||64,r=e.weight,i=e.properties||{};if(!L(n))throw new Error("steps must be a number");if(!E(i))throw new Error("properties must be a number");var o=N(t).length,a=ni(t,{weight:r}),s=0,l=0,c=0;O(t,(function(t){var e=t.properties[r]||1,n=ii(H(t),H(a));s+=Math.pow(n.x,2)*e,l+=Math.pow(n.y,2)*e,c+=n.x*n.y*e}));var h=s-l,f=Math.sqrt(Math.pow(h,2)+4*Math.pow(c,2)),p=2*c,d=Math.atan((h+f)/p),g=180*d/Math.PI,y=0,m=0,v=0;O(t,(function(t){var e=t.properties[r]||1,n=ii(H(t),H(a));y+=Math.pow(n.x*Math.cos(d)-n.y*Math.sin(d),2)*e,m+=Math.pow(n.x*Math.sin(d)+n.y*Math.cos(d),2)*e,v+=e}));var _=Math.sqrt(2*y/v),b=Math.sqrt(2*m/v),w=ti(a,_,b,{units:"degrees",angle:g,steps:n,properties:i}),x=Tt(t,u([w])),C={meanCenterCoordinates:H(a),semiMajorAxis:_,semiMinorAxis:b,numberOfFeatures:o,angle:g,percentageWithinEllipse:100*N(x).length/o};return w.properties.standardDeviationalEllipse=C,w},t.difference=function(t,n){var r=Z(t),i=Z(n),o=t.properties||{};if(r=Ii(r),i=Ii(i),!r)return null;if(!i)return e(r,o);var a=new nc,s=a.read(r),l=a.read(i),u=op.difference(s,l);return u.isEmpty()?null:e((new rc).write(u),o)},t.buffer=function(t,e,n){var r=(n=n||{}).units,i=n.steps||64;if(!t)throw new Error("geojson is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");i=i||64,r=r||"kilometers";var o=[];switch(t.type){case"GeometryCollection":return D(t,(function(t){var n=uo(t,e,r,i);n&&o.push(n)})),u(o);case"FeatureCollection":return O(t,(function(t){var n=uo(t,e,r,i);n&&O(n,(function(t){t&&o.push(t)}))})),u(o)}return uo(t,e,r,i)},t.union=po,t.intersect=go,t.dissolve=function(t,e){if(!E(e=e||{}))throw new Error("options is invalid");var n=e.propertyName;X(t,"Polygon","dissolve");var r=At(t),i=r.features,o=[];i.forEach((function(t,e){t.properties.origIndexPosition=e}));var a=qe();for(var l in a.load(r),i){var u=i[l],c=!1;if(a.search(u).features.forEach((function(t){u=i[l];var e=t.properties.origIndexPosition;if(o.length>0&&0!==e)if(e>o[o.length-1])e-=o.length;else{var r=yo(e,o);0!==r&&(e-=r)}if(e!==+l){var h=i[e];h&&u&&(void 0!==n&&h.properties[n]!==u.properties[n]||wr(u,h)&&function(t,e){return We(s(N(t)),s(N(e))).features.length>0}(u,h)&&(i[l]=po(u,h),o.push(t.properties.origIndexPosition),o.sort((function(t,e){return t-e})),a.remove(t),i.splice(e,1),u.properties.origIndexPosition=l,a.remove(u,(function(t,e){return t.properties.origIndexPosition===e.properties.origIndexPosition})),c=!0))}})),c){if(!u)continue;u.properties.origIndexPosition=l,a.insert(u),l--}}return i.forEach((function(t){delete t.properties.origIndexPosition,delete t.bbox})),r},t.hexGrid=mo,t.mask=function(t,e){var n=function(t){return o(t&&t.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]])}(e),r=function(t){var e=[],n=[];return A(t,(function(t){var r=t.geometry.coordinates,i=r[0],a=r.slice(1);e.push(o([i])),a.forEach((function(t){n.push(o([t]))}))})),[u(e),u(n)]}(t),i=r[0],a=r[1];return function(t,e,n){var r=[];return r.push(t.geometry.coordinates[0]),A(e,(function(t){r.push(t.geometry.coordinates[0])})),A(n,(function(t){r.push(t.geometry.coordinates[0])})),o(r)}(n,i=vo(i),a=vo(a))},t.squareGrid=bo,t.triangleGrid=wo,t.interpolate=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var r=n.gridType,i=n.property,o=n.weight;if(!t)throw new Error("points is required");if(X(t,"Point","input must contain Points"),!e)throw new Error("cellSize is required");if(void 0!==o&&"number"!=typeof o)throw new Error("weight must be a number");i=i||"elevation",r=r||"square",o=o||1;var a,s=U(t);switch(r){case"point":case"points":a=_n(s,e,n);break;case"square":case"squares":a=bo(s,e,n);break;case"hex":case"hexes":a=mo(s,e,n);break;case"triangle":case"triangles":a=wo(s,e,n);break;default:throw new Error("invalid gridType")}var l=[];return O(a,(function(e){var a=0,s=0;O(t,(function(t){var l,u=Rt("point"===r?e:ce(e),t,n);if(void 0!==i&&(l=t.properties[i]),void 0===l&&(l=t.geometry.coordinates[2]),void 0===l)throw new Error("zValue is missing");0===u&&(a=l);var c=1/Math.pow(u,o);s+=c,a+=c*l}));var u=At(e);u.properties[i]=a/s,l.push(u)})),u(l)},t.pointOnSurface=sn,t.polygonToLineString=Tn,t.lineStringToPolygon=In,t.inside=Pt,t.within=Tt,t.bezier=ne,t.nearest=Pe,t.pointOnLine=Ze,t.lineDistance=pn,t.radians2degrees=_,t.degrees2radians=b,t.distanceToDegrees=m,t.distanceToRadians=y,t.radiansToDistance=g,t.bearingToAngle=v,t.convertDistance=w,t.toMercator=$e,t.toWgs84=tn,t.randomPosition=oi,t.randomPoint=ai,t.randomPolygon=si,t.randomLineString=li,t.getCluster=ci,t.clusterEach=hi,t.clusterReduce=fi,t.createBins=pi,t.applyFilter=di,t.propertiesContainsFilter=gi,t.filterProperties=yi,t.earthRadius=xo,t.factors=Lo,t.unitsFactors=Eo,t.areaFactors=Co,t.feature=e,t.geometry=n,t.point=r,t.points=i,t.polygon=o,t.polygons=a,t.lineString=s,t.lineStrings=l,t.featureCollection=u,t.multiLineString=c,t.multiPoint=h,t.multiPolygon=f,t.geometryCollection=p,t.round=d,t.radiansToLength=g,t.lengthToRadians=y,t.lengthToDegrees=m,t.bearingToAzimuth=v,t.radiansToDegrees=_,t.degreesToRadians=b,t.convertLength=w,t.convertArea=x,t.isNumber=L,t.isObject=E,t.validateBBox=C,t.validateId=k,t.getCoord=q,t.getCoords=H,t.containsNumber=V,t.geojsonType=Y,t.featureOf=W,t.collectionOf=X,t.getGeom=Z,t.getGeomType=K,t.getType=J,t.coordEach=S,t.coordReduce=P,t.propEach=M,t.propReduce=T,t.featureEach=O,t.featureReduce=I,t.coordAll=N,t.geomEach=D,t.geomReduce=R,t.flattenEach=A,t.flattenReduce=j,t.segmentEach=B,t.segmentReduce=z,t.lineEach=F,t.lineReduce=G,Object.defineProperty(t,"__esModule",{value:!0})}(e)},15:function(t,e,n){(function(t){var n;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/*! jQuery v1.12.4 | (c) jQuery Foundation | jquery.org/license */!function(e,n){"object"==r(t)&&"object"==r(t.exports)?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,(function(i,o){var a=[],s=i.document,l=a.slice,u=a.concat,c=a.push,h=a.indexOf,f={},p=f.toString,d=f.hasOwnProperty,g={},y="1.12.4",m=function t(e,n){return new t.fn.init(e,n)},v=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,_=/^-ms-/,b=/-([\da-z])/gi,w=function(t,e){return e.toUpperCase()};function x(t){var e=!!t&&"length"in t&&t.length,n=m.type(t);return"function"!==n&&!m.isWindow(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}m.fn=m.prototype={jquery:y,constructor:m,selector:"",length:0,toArray:function(){return l.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:l.call(this)},pushStack:function(t){var e=m.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return m.each(this,t)},map:function(t){return this.pushStack(m.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(l.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:a.sort,splice:a.splice},m.extend=m.fn.extend=function(){var t,e,n,i,o,a,s=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[l]||{},l++),"object"==r(s)||m.isFunction(s)||(s={}),l===u&&(s=this,l--);u>l;l++)if(null!=(o=arguments[l]))for(i in o)t=s[i],s!==(n=o[i])&&(c&&n&&(m.isPlainObject(n)||(e=m.isArray(n)))?(e?(e=!1,a=t&&m.isArray(t)?t:[]):a=t&&m.isPlainObject(t)?t:{},s[i]=m.extend(c,a,n)):void 0!==n&&(s[i]=n));return s},m.extend({expando:"jQuery"+(y+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===m.type(t)},isArray:Array.isArray||function(t){return"array"===m.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){var e=t&&t.toString();return!m.isArray(t)&&e-parseFloat(e)+1>=0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},isPlainObject:function(t){var e;if(!t||"object"!==m.type(t)||t.nodeType||m.isWindow(t))return!1;try{if(t.constructor&&!d.call(t,"constructor")&&!d.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}if(!g.ownFirst)for(e in t)return d.call(t,e);for(e in t);return void 0===e||d.call(t,e)},type:function(t){return null==t?t+"":"object"==r(t)||"function"==typeof t?f[p.call(t)]||"object":r(t)},globalEval:function(t){t&&m.trim(t)&&(i.execScript||function(t){i.eval.call(i,t)})(t)},camelCase:function(t){return t.replace(_,"ms-").replace(b,w)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var n,r=0;if(x(t))for(n=t.length;n>r&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},trim:function(t){return null==t?"":(t+"").replace(v,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(x(Object(t))?m.merge(n,"string"==typeof t?[t]:t):c.call(n,t)),n},inArray:function(t,e,n){var r;if(e){if(h)return h.call(e,t,n);for(r=e.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in e&&e[n]===t)return n}return-1},merge:function(t,e){for(var n=+e.length,r=0,i=t.length;n>r;)t[i++]=e[r++];if(n!=n)for(;void 0!==e[r];)t[i++]=e[r++];return t.length=i,t},grep:function(t,e,n){for(var r=[],i=0,o=t.length,a=!n;o>i;i++)!e(t[i],i)!==a&&r.push(t[i]);return r},map:function(t,e,n){var r,i,o=0,a=[];if(x(t))for(r=t.length;r>o;o++)null!=(i=e(t[o],o,n))&&a.push(i);else for(o in t)null!=(i=e(t[o],o,n))&&a.push(i);return u.apply([],a)},guid:1,proxy:function(t,e){var n,r,i;return"string"==typeof e&&(i=t[e],e=t,t=i),m.isFunction(t)?(n=l.call(arguments,2),(r=function(){return t.apply(e||this,n.concat(l.call(arguments)))}).guid=t.guid=t.guid||m.guid++,r):void 0},now:function(){return+new Date},support:g}),"function"==typeof Symbol&&(m.fn[Symbol.iterator]=a[Symbol.iterator]),m.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){f["[object "+e+"]"]=e.toLowerCase()}));var L=function(t){var e,n,r,i,o,a,s,l,u,c,h,f,p,d,g,y,m,v,_,b="sizzle"+1*new Date,w=t.document,x=0,L=0,E=it(),C=it(),k=it(),S=function(t,e){return t===e&&(h=!0),0},P={}.hasOwnProperty,M=[],T=M.pop,O=M.push,I=M.push,N=M.slice,D=function(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",A="[\\x20\\t\\r\\n\\f]",j="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",B="\\["+A+"*("+j+")(?:"+A+"*([*^$|!~]?=)"+A+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+j+"))|)"+A+"*\\]",z=":("+j+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",F=new RegExp(A+"+","g"),G=new RegExp("^"+A+"+|((?:^|[^\\\\])(?:\\\\.)*)"+A+"+$","g"),U=new RegExp("^"+A+"*,"+A+"*"),q=new RegExp("^"+A+"*([>+~]|"+A+")"+A+"*"),H=new RegExp("="+A+"*([^\\]'\"]*?)"+A+"*\\]","g"),V=new RegExp(z),Y=new RegExp("^"+j+"$"),W={ID:new RegExp("^#("+j+")"),CLASS:new RegExp("^\\.("+j+")"),TAG:new RegExp("^("+j+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+A+"*(even|odd|(([+-]|)(\\d*)n|)"+A+"*(?:([+-]|)"+A+"*(\\d+)|))"+A+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+A+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+A+"*((?:-\\d)?\\d*)"+A+"*\\)|)(?=[^-]|$)","i")},X=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Q=/[+~]/,$=/'|\\/g,tt=new RegExp("\\\\([\\da-f]{1,6}"+A+"?|("+A+")|.)","ig"),et=function(t,e,n){var r="0x"+e-65536;return r!=r||n?e:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},nt=function(){f()};try{I.apply(M=N.call(w.childNodes),w.childNodes),M[w.childNodes.length].nodeType}catch(t){I={apply:M.length?function(t,e){O.apply(t,N.call(e))}:function(t,e){for(var n=t.length,r=0;t[n++]=e[r++];);t.length=n-1}}}function rt(t,e,r,i){var o,s,u,c,h,d,m,v,x=e&&e.ownerDocument,L=e?e.nodeType:9;if(r=r||[],"string"!=typeof t||!t||1!==L&&9!==L&&11!==L)return r;if(!i&&((e?e.ownerDocument||e:w)!==p&&f(e),e=e||p,g)){if(11!==L&&(d=J.exec(t)))if(o=d[1]){if(9===L){if(!(u=e.getElementById(o)))return r;if(u.id===o)return r.push(u),r}else if(x&&(u=x.getElementById(o))&&_(e,u)&&u.id===o)return r.push(u),r}else{if(d[2])return I.apply(r,e.getElementsByTagName(t)),r;if((o=d[3])&&n.getElementsByClassName&&e.getElementsByClassName)return I.apply(r,e.getElementsByClassName(o)),r}if(n.qsa&&!k[t+" "]&&(!y||!y.test(t))){if(1!==L)x=e,v=t;else if("object"!==e.nodeName.toLowerCase()){for((c=e.getAttribute("id"))?c=c.replace($,"\\$&"):e.setAttribute("id",c=b),s=(m=a(t)).length,h=Y.test(c)?"#"+c:"[id='"+c+"']";s--;)m[s]=h+" "+dt(m[s]);v=m.join(","),x=Q.test(t)&&ft(e.parentNode)||e}if(v)try{return I.apply(r,x.querySelectorAll(v)),r}catch(t){}finally{c===b&&e.removeAttribute("id")}}}return l(t.replace(G,"$1"),e,r,i)}function it(){var t=[];return function e(n,i){return t.push(n+" ")>r.cacheLength&&delete e[t.shift()],e[n+" "]=i}}function ot(t){return t[b]=!0,t}function at(t){var e=p.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function st(t,e){for(var n=t.split("|"),i=n.length;i--;)r.attrHandle[n[i]]=e}function lt(t,e){var n=e&&t,r=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||1<<31)-(~t.sourceIndex||1<<31);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function ut(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ct(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function ht(t){return ot((function(e){return e=+e,ot((function(n,r){for(var i,o=t([],n.length,e),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))}))}))}function ft(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=rt.support={},o=rt.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},f=rt.setDocument=function(t){var e,i,a=t?t.ownerDocument||t:w;return a!==p&&9===a.nodeType&&a.documentElement?(d=(p=a).documentElement,g=!o(p),(i=p.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",nt,!1):i.attachEvent&&i.attachEvent("onunload",nt)),n.attributes=at((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=at((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=K.test(p.getElementsByClassName),n.getById=at((function(t){return d.appendChild(t).id=b,!p.getElementsByName||!p.getElementsByName(b).length})),n.getById?(r.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}},r.filter.ID=function(t){var e=t.replace(tt,et);return function(t){return t.getAttribute("id")===e}}):(delete r.find.ID,r.filter.ID=function(t){var e=t.replace(tt,et);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}}),r.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,r=[],i=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(t,e){return void 0!==e.getElementsByClassName&&g?e.getElementsByClassName(t):void 0},m=[],y=[],(n.qsa=K.test(p.querySelectorAll))&&(at((function(t){d.appendChild(t).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&y.push("[*^$]="+A+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||y.push("\\["+A+"*(?:value|"+R+")"),t.querySelectorAll("[id~="+b+"-]").length||y.push("~="),t.querySelectorAll(":checked").length||y.push(":checked"),t.querySelectorAll("a#"+b+"+*").length||y.push(".#.+[+~]")})),at((function(t){var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&y.push("name"+A+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||y.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),y.push(",.*:")}))),(n.matchesSelector=K.test(v=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&at((function(t){n.disconnectedMatch=v.call(t,"div"),v.call(t,"[s!='']:x"),m.push("!=",z)})),y=y.length&&new RegExp(y.join("|")),m=m.length&&new RegExp(m.join("|")),e=K.test(d.compareDocumentPosition),_=e||K.test(d.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},S=e?function(t,e){if(t===e)return h=!0,0;var r=!t.compareDocumentPosition-!e.compareDocumentPosition;return r||(1&(r=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===r?t===p||t.ownerDocument===w&&_(w,t)?-1:e===p||e.ownerDocument===w&&_(w,e)?1:c?D(c,t)-D(c,e):0:4&r?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,r=0,i=t.parentNode,o=e.parentNode,a=[t],s=[e];if(!i||!o)return t===p?-1:e===p?1:i?-1:o?1:c?D(c,t)-D(c,e):0;if(i===o)return lt(t,e);for(n=t;n=n.parentNode;)a.unshift(n);for(n=e;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?lt(a[r],s[r]):a[r]===w?-1:s[r]===w?1:0},p):p},rt.matches=function(t,e){return rt(t,null,null,e)},rt.matchesSelector=function(t,e){if((t.ownerDocument||t)!==p&&f(t),e=e.replace(H,"='$1']"),n.matchesSelector&&g&&!k[e+" "]&&(!m||!m.test(e))&&(!y||!y.test(e)))try{var r=v.call(t,e);if(r||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return r}catch(t){}return rt(e,p,null,[t]).length>0},rt.contains=function(t,e){return(t.ownerDocument||t)!==p&&f(t),_(t,e)},rt.attr=function(t,e){(t.ownerDocument||t)!==p&&f(t);var i=r.attrHandle[e.toLowerCase()],o=i&&P.call(r.attrHandle,e.toLowerCase())?i(t,e,!g):void 0;return void 0!==o?o:n.attributes||!g?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},rt.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},rt.uniqueSort=function(t){var e,r=[],i=0,o=0;if(h=!n.detectDuplicates,c=!n.sortStable&&t.slice(0),t.sort(S),h){for(;e=t[o++];)e===t[o]&&(i=r.push(o));for(;i--;)t.splice(r[i],1)}return c=null,t},i=rt.getText=function(t){var e,n="",r=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=i(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[r++];)n+=i(e);return n},(r=rt.selectors={cacheLength:50,createPseudo:ot,match:W,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(tt,et),t[3]=(t[3]||t[4]||t[5]||"").replace(tt,et),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||rt.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&rt.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return W.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&V.test(n)&&(e=a(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(tt,et).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=E[t+" "];return e||(e=new RegExp("(^|"+A+")"+t+"("+A+"|$)"))&&E(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(r){var i=rt.attr(r,t);return null==i?"!="===e:!e||(i+="","="===e?i===n:"!="===e?i!==n:"^="===e?n&&0===i.indexOf(n):"*="===e?n&&i.indexOf(n)>-1:"$="===e?n&&i.slice(-n.length)===n:"~="===e?(" "+i.replace(F," ")+" ").indexOf(n)>-1:"|="===e&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,r,i){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===r&&0===i?function(t){return!!t.parentNode}:function(e,n,l){var u,c,h,f,p,d,g=o!==a?"nextSibling":"previousSibling",y=e.parentNode,m=s&&e.nodeName.toLowerCase(),v=!l&&!s,_=!1;if(y){if(o){for(;g;){for(f=e;f=f[g];)if(s?f.nodeName.toLowerCase()===m:1===f.nodeType)return!1;d=g="only"===t&&!d&&"nextSibling"}return!0}if(d=[a?y.firstChild:y.lastChild],a&&v){for(_=(p=(u=(c=(h=(f=y)[b]||(f[b]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]||[])[0]===x&&u[1])&&u[2],f=p&&y.childNodes[p];f=++p&&f&&f[g]||(_=p=0)||d.pop();)if(1===f.nodeType&&++_&&f===e){c[t]=[x,p,_];break}}else if(v&&(_=p=(u=(c=(h=(f=e)[b]||(f[b]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]||[])[0]===x&&u[1]),!1===_)for(;(f=++p&&f&&f[g]||(_=p=0)||d.pop())&&((s?f.nodeName.toLowerCase()!==m:1!==f.nodeType)||!++_||(v&&((c=(h=f[b]||(f[b]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]=[x,_]),f!==e)););return(_-=i)===r||_%r==0&&_/r>=0}}},PSEUDO:function(t,e){var n,i=r.pseudos[t]||r.setFilters[t.toLowerCase()]||rt.error("unsupported pseudo: "+t);return i[b]?i(e):i.length>1?(n=[t,t,"",e],r.setFilters.hasOwnProperty(t.toLowerCase())?ot((function(t,n){for(var r,o=i(t,e),a=o.length;a--;)t[r=D(t,o[a])]=!(n[r]=o[a])})):function(t){return i(t,0,n)}):i}},pseudos:{not:ot((function(t){var e=[],n=[],r=s(t.replace(G,"$1"));return r[b]?ot((function(t,e,n,i){for(var o,a=r(t,null,i,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))})):function(t,i,o){return e[0]=t,r(e,null,o,n),e[0]=null,!n.pop()}})),has:ot((function(t){return function(e){return rt(t,e).length>0}})),contains:ot((function(t){return t=t.replace(tt,et),function(e){return(e.textContent||e.innerText||i(e)).indexOf(t)>-1}})),lang:ot((function(t){return Y.test(t||"")||rt.error("unsupported lang: "+t),t=t.replace(tt,et).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===d},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!r.pseudos.empty(t)},header:function(t){return Z.test(t.nodeName)},input:function(t){return X.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ht((function(){return[0]})),last:ht((function(t,e){return[e-1]})),eq:ht((function(t,e,n){return[0>n?n+e:n]})),even:ht((function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t})),odd:ht((function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t})),lt:ht((function(t,e,n){for(var r=0>n?n+e:n;--r>=0;)t.push(r);return t})),gt:ht((function(t,e,n){for(var r=0>n?n+e:n;++r<e;)t.push(r);return t}))}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[e]=ut(e);for(e in{submit:!0,reset:!0})r.pseudos[e]=ct(e);function pt(){}function dt(t){for(var e=0,n=t.length,r="";n>e;e++)r+=t[e].value;return r}function gt(t,e,n){var r=e.dir,i=n&&"parentNode"===r,o=L++;return e.first?function(e,n,o){for(;e=e[r];)if(1===e.nodeType||i)return t(e,n,o)}:function(e,n,a){var s,l,u,c=[x,o];if(a){for(;e=e[r];)if((1===e.nodeType||i)&&t(e,n,a))return!0}else for(;e=e[r];)if(1===e.nodeType||i){if((s=(l=(u=e[b]||(e[b]={}))[e.uniqueID]||(u[e.uniqueID]={}))[r])&&s[0]===x&&s[1]===o)return c[2]=s[2];if(l[r]=c,c[2]=t(e,n,a))return!0}}}function yt(t){return t.length>1?function(e,n,r){for(var i=t.length;i--;)if(!t[i](e,n,r))return!1;return!0}:t[0]}function mt(t,e,n,r,i){for(var o,a=[],s=0,l=t.length,u=null!=e;l>s;s++)(o=t[s])&&(n&&!n(o,r,i)||(a.push(o),u&&e.push(s)));return a}function vt(t,e,n,r,i,o){return r&&!r[b]&&(r=vt(r)),i&&!i[b]&&(i=vt(i,o)),ot((function(o,a,s,l){var u,c,h,f=[],p=[],d=a.length,g=o||function(t,e,n){for(var r=0,i=e.length;i>r;r++)rt(t,e[r],n);return n}(e||"*",s.nodeType?[s]:s,[]),y=!t||!o&&e?g:mt(g,f,t,s,l),m=n?i||(o?t:d||r)?[]:a:y;if(n&&n(y,m,s,l),r)for(u=mt(m,p),r(u,[],s,l),c=u.length;c--;)(h=u[c])&&(m[p[c]]=!(y[p[c]]=h));if(o){if(i||t){if(i){for(u=[],c=m.length;c--;)(h=m[c])&&u.push(y[c]=h);i(null,m=[],u,l)}for(c=m.length;c--;)(h=m[c])&&(u=i?D(o,h):f[c])>-1&&(o[u]=!(a[u]=h))}}else m=mt(m===a?m.splice(d,m.length):m),i?i(null,a,m,l):I.apply(a,m)}))}function _t(t){for(var e,n,i,o=t.length,a=r.relative[t[0].type],s=a||r.relative[" "],l=a?1:0,c=gt((function(t){return t===e}),s,!0),h=gt((function(t){return D(e,t)>-1}),s,!0),f=[function(t,n,r){var i=!a&&(r||n!==u)||((e=n).nodeType?c(t,n,r):h(t,n,r));return e=null,i}];o>l;l++)if(n=r.relative[t[l].type])f=[gt(yt(f),n)];else{if((n=r.filter[t[l].type].apply(null,t[l].matches))[b]){for(i=++l;o>i&&!r.relative[t[i].type];i++);return vt(l>1&&yt(f),l>1&&dt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(G,"$1"),n,i>l&&_t(t.slice(l,i)),o>i&&_t(t=t.slice(i)),o>i&&dt(t))}f.push(n)}return yt(f)}function bt(t,e){var n=e.length>0,i=t.length>0,o=function(o,a,s,l,c){var h,d,y,m=0,v="0",_=o&&[],b=[],w=u,L=o||i&&r.find.TAG("*",c),E=x+=null==w?1:Math.random()||.1,C=L.length;for(c&&(u=a===p||a||c);v!==C&&null!=(h=L[v]);v++){if(i&&h){for(d=0,a||h.ownerDocument===p||(f(h),s=!g);y=t[d++];)if(y(h,a||p,s)){l.push(h);break}c&&(x=E)}n&&((h=!y&&h)&&m--,o&&_.push(h))}if(m+=v,n&&v!==m){for(d=0;y=e[d++];)y(_,b,a,s);if(o){if(m>0)for(;v--;)_[v]||b[v]||(b[v]=T.call(l));b=mt(b)}I.apply(l,b),c&&!o&&b.length>0&&m+e.length>1&&rt.uniqueSort(l)}return c&&(x=E,u=w),_};return n?ot(o):o}return pt.prototype=r.filters=r.pseudos,r.setFilters=new pt,a=rt.tokenize=function(t,e){var n,i,o,a,s,l,u,c=C[t+" "];if(c)return e?0:c.slice(0);for(s=t,l=[],u=r.preFilter;s;){for(a in n&&!(i=U.exec(s))||(i&&(s=s.slice(i[0].length)||s),l.push(o=[])),n=!1,(i=q.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace(G," ")}),s=s.slice(n.length)),r.filter)!(i=W[a].exec(s))||u[a]&&!(i=u[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length));if(!n)break}return e?s.length:s?rt.error(t):C(t,l).slice(0)},s=rt.compile=function(t,e){var n,r=[],i=[],o=k[t+" "];if(!o){for(e||(e=a(t)),n=e.length;n--;)(o=_t(e[n]))[b]?r.push(o):i.push(o);(o=k(t,bt(i,r))).selector=t}return o},l=rt.select=function(t,e,i,o){var l,u,c,h,f,p="function"==typeof t&&t,d=!o&&a(t=p.selector||t);if(i=i||[],1===d.length){if((u=d[0]=d[0].slice(0)).length>2&&"ID"===(c=u[0]).type&&n.getById&&9===e.nodeType&&g&&r.relative[u[1].type]){if(!(e=(r.find.ID(c.matches[0].replace(tt,et),e)||[])[0]))return i;p&&(e=e.parentNode),t=t.slice(u.shift().value.length)}for(l=W.needsContext.test(t)?0:u.length;l--&&(c=u[l],!r.relative[h=c.type]);)if((f=r.find[h])&&(o=f(c.matches[0].replace(tt,et),Q.test(u[0].type)&&ft(e.parentNode)||e))){if(u.splice(l,1),!(t=o.length&&dt(u)))return I.apply(i,o),i;break}}return(p||s(t,d))(o,e,!g,i,!e||Q.test(t)&&ft(e.parentNode)||e),i},n.sortStable=b.split("").sort(S).join("")===b,n.detectDuplicates=!!h,f(),n.sortDetached=at((function(t){return 1&t.compareDocumentPosition(p.createElement("div"))})),at((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||st("type|href|height|width",(function(t,e,n){return n?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&at((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||st("value",(function(t,e,n){return n||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue})),at((function(t){return null==t.getAttribute("disabled")}))||st(R,(function(t,e,n){var r;return n?void 0:!0===t[e]?e.toLowerCase():(r=t.getAttributeNode(e))&&r.specified?r.value:null})),rt}(i);m.find=L,(m.expr=L.selectors)[":"]=m.expr.pseudos,m.uniqueSort=m.unique=L.uniqueSort,m.text=L.getText,m.isXMLDoc=L.isXML,m.contains=L.contains;var E=function(t,e,n){for(var r=[],i=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&m(t).is(n))break;r.push(t)}return r},C=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},k=m.expr.match.needsContext,S=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,P=/^.[^:#\[\.,]*$/;function M(t,e,n){if(m.isFunction(e))return m.grep(t,(function(t,r){return!!e.call(t,r,t)!==n}));if(e.nodeType)return m.grep(t,(function(t){return t===e!==n}));if("string"==typeof e){if(P.test(e))return m.filter(e,t,n);e=m.filter(e,t)}return m.grep(t,(function(t){return m.inArray(t,e)>-1!==n}))}m.filter=function(t,e,n){var r=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?m.find.matchesSelector(r,t)?[r]:[]:m.find.matches(t,m.grep(e,(function(t){return 1===t.nodeType})))},m.fn.extend({find:function(t){var e,n=[],r=this,i=r.length;if("string"!=typeof t)return this.pushStack(m(t).filter((function(){for(e=0;i>e;e++)if(m.contains(r[e],this))return!0})));for(e=0;i>e;e++)m.find(t,r[e],n);return(n=this.pushStack(i>1?m.unique(n):n)).selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(M(this,t||[],!1))},not:function(t){return this.pushStack(M(this,t||[],!0))},is:function(t){return!!M(this,"string"==typeof t&&k.test(t)?m(t):t||[],!1).length}});var T,O=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(m.fn.init=function(t,e,n){var r,i;if(!t)return this;if(n=n||T,"string"==typeof t){if(!(r="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:O.exec(t))||!r[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(r[1]){if(e=e instanceof m?e[0]:e,m.merge(this,m.parseHTML(r[1],e&&e.nodeType?e.ownerDocument||e:s,!0)),S.test(r[1])&&m.isPlainObject(e))for(r in e)m.isFunction(this[r])?this[r](e[r]):this.attr(r,e[r]);return this}if((i=s.getElementById(r[2]))&&i.parentNode){if(i.id!==r[2])return T.find(t);this.length=1,this[0]=i}return this.context=s,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):m.isFunction(t)?void 0!==n.ready?n.ready(t):t(m):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),m.makeArray(t,this))}).prototype=m.fn,T=m(s);var I=/^(?:parents|prev(?:Until|All))/,N={children:!0,contents:!0,next:!0,prev:!0};function D(t,e){do{t=t[e]}while(t&&1!==t.nodeType);return t}m.fn.extend({has:function(t){var e,n=m(t,this),r=n.length;return this.filter((function(){for(e=0;r>e;e++)if(m.contains(this,n[e]))return!0}))},closest:function(t,e){for(var n,r=0,i=this.length,o=[],a=k.test(t)||"string"!=typeof t?m(t,e||this.context):0;i>r;r++)for(n=this[r];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&m.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?m.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?m.inArray(this[0],m(t)):m.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(m.uniqueSort(m.merge(this.get(),m(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),m.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return E(t,"parentNode")},parentsUntil:function(t,e,n){return E(t,"parentNode",n)},next:function(t){return D(t,"nextSibling")},prev:function(t){return D(t,"previousSibling")},nextAll:function(t){return E(t,"nextSibling")},prevAll:function(t){return E(t,"previousSibling")},nextUntil:function(t,e,n){return E(t,"nextSibling",n)},prevUntil:function(t,e,n){return E(t,"previousSibling",n)},siblings:function(t){return C((t.parentNode||{}).firstChild,t)},children:function(t){return C(t.firstChild)},contents:function(t){return m.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:m.merge([],t.childNodes)}},(function(t,e){m.fn[t]=function(n,r){var i=m.map(this,e,n);return"Until"!==t.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=m.filter(r,i)),this.length>1&&(N[t]||(i=m.uniqueSort(i)),I.test(t)&&(i=i.reverse())),this.pushStack(i)}}));var R,A,j=/\S+/g;function B(){s.addEventListener?(s.removeEventListener("DOMContentLoaded",z),i.removeEventListener("load",z)):(s.detachEvent("onreadystatechange",z),i.detachEvent("onload",z))}function z(){(s.addEventListener||"load"===i.event.type||"complete"===s.readyState)&&(B(),m.ready())}for(A in m.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return m.each(t.match(j)||[],(function(t,n){e[n]=!0})),e}(t):m.extend({},t);var e,n,r,i,o=[],a=[],s=-1,l=function(){for(i=t.once,r=e=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&t.stopOnFalse&&(s=o.length,n=!1);t.memory||(n=!1),e=!1,i&&(o=n?[]:"")},u={add:function(){return o&&(n&&!e&&(s=o.length-1,a.push(n)),function e(n){m.each(n,(function(n,r){m.isFunction(r)?t.unique&&u.has(r)||o.push(r):r&&r.length&&"string"!==m.type(r)&&e(r)}))}(arguments),n&&!e&&l()),this},remove:function(){return m.each(arguments,(function(t,e){for(var n;(n=m.inArray(e,o,n))>-1;)o.splice(n,1),s>=n&&s--})),this},has:function(t){return t?m.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=!0,n||u.disable(),this},locked:function(){return!!i},fireWith:function(t,n){return i||(n=[t,(n=n||[]).slice?n.slice():n],a.push(n),e||l()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},m.extend({Deferred:function(t){var e=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var t=arguments;return m.Deferred((function(n){m.each(e,(function(e,o){var a=m.isFunction(t[e])&&t[e];i[o[1]]((function(){var t=a&&a.apply(this,arguments);t&&m.isFunction(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[o[0]+"With"](this===r?n.promise():this,a?[t]:arguments)}))})),t=null})).promise()},promise:function(t){return null!=t?m.extend(t,r):r}},i={};return r.pipe=r.then,m.each(e,(function(t,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add((function(){n=s}),e[1^t][2].disable,e[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith})),r.promise(i),t&&t.call(i,i),i},when:function(t){var e,n,r,i=0,o=l.call(arguments),a=o.length,s=1!==a||t&&m.isFunction(t.promise)?a:0,u=1===s?t:m.Deferred(),c=function(t,n,r){return function(i){n[t]=this,r[t]=arguments.length>1?l.call(arguments):i,r===e?u.notifyWith(n,r):--s||u.resolveWith(n,r)}};if(a>1)for(e=new Array(a),n=new Array(a),r=new Array(a);a>i;i++)o[i]&&m.isFunction(o[i].promise)?o[i].promise().progress(c(i,n,e)).done(c(i,r,o)).fail(u.reject):--s;return s||u.resolveWith(r,o),u.promise()}}),m.fn.ready=function(t){return m.ready.promise().done(t),this},m.extend({isReady:!1,readyWait:1,holdReady:function(t){t?m.readyWait++:m.ready(!0)},ready:function(t){(!0===t?--m.readyWait:m.isReady)||(m.isReady=!0,!0!==t&&--m.readyWait>0||(R.resolveWith(s,[m]),m.fn.triggerHandler&&(m(s).triggerHandler("ready"),m(s).off("ready"))))}}),m.ready.promise=function(t){if(!R)if(R=m.Deferred(),"complete"===s.readyState||"loading"!==s.readyState&&!s.documentElement.doScroll)i.setTimeout(m.ready);else if(s.addEventListener)s.addEventListener("DOMContentLoaded",z),i.addEventListener("load",z);else{s.attachEvent("onreadystatechange",z),i.attachEvent("onload",z);var e=!1;try{e=null==i.frameElement&&s.documentElement}catch(t){}e&&e.doScroll&&function t(){if(!m.isReady){try{e.doScroll("left")}catch(e){return i.setTimeout(t,50)}B(),m.ready()}}()}return R.promise(t)},m.ready.promise(),m(g))break;g.ownFirst="0"===A,g.inlineBlockNeedsLayout=!1,m((function(){var t,e,n,r;(n=s.getElementsByTagName("body")[0])&&n.style&&(e=s.createElement("div"),(r=s.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(e),void 0!==e.style.zoom&&(e.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",g.inlineBlockNeedsLayout=t=3===e.offsetWidth,t&&(n.style.zoom=1)),n.removeChild(r))})),function(){var t=s.createElement("div");g.deleteExpando=!0;try{delete t.test}catch(t){g.deleteExpando=!1}t=null}();var F=function(t){var e=m.noData[(t.nodeName+" ").toLowerCase()],n=+t.nodeType||1;return(1===n||9===n)&&(!e||!0!==e&&t.getAttribute("classid")===e)},G=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,U=/([A-Z])/g;function q(t,e,n){if(void 0===n&&1===t.nodeType){var r="data-"+e.replace(U,"-$1").toLowerCase();if("string"==typeof(n=t.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:G.test(n)?m.parseJSON(n):n)}catch(t){}m.data(t,e,n)}else n=void 0}return n}function H(t){var e;for(e in t)if(("data"!==e||!m.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function V(t,e,n,i){if(F(t)){var o,s,l=m.expando,u=t.nodeType,c=u?m.cache:t,h=u?t[l]:t[l]&&l;if(h&&c[h]&&(i||c[h].data)||void 0!==n||"string"!=typeof e)return h||(h=u?t[l]=a.pop()||m.guid++:l),c[h]||(c[h]=u?{}:{toJSON:m.noop}),"object"!=r(e)&&"function"!=typeof e||(i?c[h]=m.extend(c[h],e):c[h].data=m.extend(c[h].data,e)),s=c[h],i||(s.data||(s.data={}),s=s.data),void 0!==n&&(s[m.camelCase(e)]=n),"string"==typeof e?null==(o=s[e])&&(o=s[m.camelCase(e)]):o=s,o}}function Y(t,e,n){if(F(t)){var r,i,o=t.nodeType,a=o?m.cache:t,s=o?t[m.expando]:m.expando;if(a[s]){if(e&&(r=n?a[s]:a[s].data)){m.isArray(e)?e=e.concat(m.map(e,m.camelCase)):e in r?e=[e]:e=(e=m.camelCase(e))in r?[e]:e.split(" "),i=e.length;for(;i--;)delete r[e[i]];if(n?!H(r):!m.isEmptyObject(r))return}(n||(delete a[s].data,H(a[s])))&&(o?m.cleanData([t],!0):g.deleteExpando||a!=a.window?delete a[s]:a[s]=void 0)}}}m.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return!!(t=t.nodeType?m.cache[t[m.expando]]:t[m.expando])&&!H(t)},data:function(t,e,n){return V(t,e,n)},removeData:function(t,e){return Y(t,e)},_data:function(t,e,n){return V(t,e,n,!0)},_removeData:function(t,e){return Y(t,e,!0)}}),m.fn.extend({data:function(t,e){var n,i,o,a=this[0],s=a&&a.attributes;if(void 0===t){if(this.length&&(o=m.data(a),1===a.nodeType&&!m._data(a,"parsedAttrs"))){for(n=s.length;n--;)s[n]&&(0===(i=s[n].name).indexOf("data-")&&q(a,i=m.camelCase(i.slice(5)),o[i]));m._data(a,"parsedAttrs",!0)}return o}return"object"==r(t)?this.each((function(){m.data(this,t)})):arguments.length>1?this.each((function(){m.data(this,t,e)})):a?q(a,t,m.data(a,t)):void 0},removeData:function(t){return this.each((function(){m.removeData(this,t)}))}}),m.extend({queue:function(t,e,n){var r;return t?(r=m._data(t,e=(e||"fx")+"queue"),n&&(!r||m.isArray(n)?r=m._data(t,e,m.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(t,e){var n=m.queue(t,e=e||"fx"),r=n.length,i=n.shift(),o=m._queueHooks(t,e);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===e&&n.unshift("inprogress"),delete o.stop,i.call(t,(function(){m.dequeue(t,e)}),o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return m._data(t,n)||m._data(t,n,{empty:m.Callbacks("once memory").add((function(){m._removeData(t,e+"queue"),m._removeData(t,n)}))})}}),m.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?m.queue(this[0],t):void 0===e?this:this.each((function(){var n=m.queue(this,t,e);m._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&m.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){m.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,r=1,i=m.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=m._data(o[a],t+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(e)}}),function(){var t;g.shrinkWrapBlocks=function(){return null!=t?t:(t=!1,(n=s.getElementsByTagName("body")[0])&&n.style?(e=s.createElement("div"),(r=s.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(e),void 0!==e.style.zoom&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",e.appendChild(s.createElement("div")).style.width="5px",t=3!==e.offsetWidth),n.removeChild(r),t):void 0);var e,n,r}}();var W=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,X=new RegExp("^(?:([+-])=|)("+W+")([a-z%]*)$","i"),Z=["Top","Right","Bottom","Left"],K=function(t,e){return"none"===m.css(t=e||t,"display")||!m.contains(t.ownerDocument,t)};function J(t,e,n,r){var i,o=1,a=20,s=r?function(){return r.cur()}:function(){return m.css(t,e,"")},l=s(),u=n&&n[3]||(m.cssNumber[e]?"":"px"),c=(m.cssNumber[e]||"px"!==u&&+l)&&X.exec(m.css(t,e));if(c&&c[3]!==u){u=u||c[3],n=n||[],c=+l||1;do{m.style(t,e,(c/=o=o||".5")+u)}while(o!==(o=s()/l)&&1!==o&&--a)}return n&&(c=+c||+l||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=c,r.end=i)),i}var Q=function t(e,n,r,i,o,a,s){var l=0,u=e.length,c=null==r;if("object"===m.type(r))for(l in o=!0,r)t(e,n,l,r[l],!0,a,s);else if(void 0!==i&&(o=!0,m.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(t,e,n){return c.call(m(t),n)})),n))for(;u>l;l++)n(e[l],r,s?i:i.call(e[l],l,n(e[l],r)));return o?e:c?n.call(e):u?n(e[0],r):a},$=/^(?:checkbox|radio)$/i,tt=/<([\w:-]+)/,et=/^$|\/(?:java|ecma)script/i,nt=/^\s+/,rt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";function it(t){var e=rt.split("|"),n=t.createDocumentFragment();if(n.createElement)for(;e.length;)n.createElement(e.pop());return n}!function(){var t=s.createElement("div"),e=s.createDocumentFragment(),n=s.createElement("input");t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",g.leadingWhitespace=3===t.firstChild.nodeType,g.tbody=!t.getElementsByTagName("tbody").length,g.htmlSerialize=!!t.getElementsByTagName("link").length,g.html5Clone="<:nav></:nav>"!==s.createElement("nav").cloneNode(!0).outerHTML,n.type="checkbox",n.checked=!0,e.appendChild(n),g.appendChecked=n.checked,t.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,e.appendChild(t),(n=s.createElement("input")).setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),g.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,g.noCloneEvent=!!t.addEventListener,t[m.expando]=1,g.attributes=!t.getAttribute(m.expando)}();var ot={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:g.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};function at(t,e){var n,r,i=0,o=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):void 0;if(!o)for(o=[],n=t.childNodes||t;null!=(r=n[i]);i++)!e||m.nodeName(r,e)?o.push(r):m.merge(o,at(r,e));return void 0===e||e&&m.nodeName(t,e)?m.merge([t],o):o}function st(t,e){for(var n,r=0;null!=(n=t[r]);r++)m._data(n,"globalEval",!e||m._data(e[r],"globalEval"))}ot.optgroup=ot.option,ot.tbody=ot.tfoot=ot.colgroup=ot.caption=ot.thead,ot.th=ot.td;var lt=/<|&#?\w+;/,ut=/<tbody/i;function ct(t){$.test(t.type)&&(t.defaultChecked=t.checked)}function ht(t,e,n,r,i){for(var o,a,s,l,u,c,h,f=t.length,p=it(e),d=[],y=0;f>y;y++)if((a=t[y])||0===a)if("object"===m.type(a))m.merge(d,a.nodeType?[a]:a);else if(lt.test(a)){for(l=l||p.appendChild(e.createElement("div")),u=(tt.exec(a)||["",""])[1].toLowerCase(),h=ot[u]||ot._default,l.innerHTML=h[1]+m.htmlPrefilter(a)+h[2],o=h[0];o--;)l=l.lastChild;if(!g.leadingWhitespace&&nt.test(a)&&d.push(e.createTextNode(nt.exec(a)[0])),!g.tbody)for(o=(a="table"!==u||ut.test(a)?"<table>"!==h[1]||ut.test(a)?0:l:l.firstChild)&&a.childNodes.length;o--;)m.nodeName(c=a.childNodes[o],"tbody")&&!c.childNodes.length&&a.removeChild(c);for(m.merge(d,l.childNodes),l.textContent="";l.firstChild;)l.removeChild(l.firstChild);l=p.lastChild}else d.push(e.createTextNode(a));for(l&&p.removeChild(l),g.appendChecked||m.grep(at(d,"input"),ct),y=0;a=d[y++];)if(r&&m.inArray(a,r)>-1)i&&i.push(a);else if(s=m.contains(a.ownerDocument,a),l=at(p.appendChild(a),"script"),s&&st(l),n)for(o=0;a=l[o++];)et.test(a.type||"")&&n.push(a);return l=null,p}!function(){var t,e,n=s.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})e="on"+t,(g[t]=e in i)||(n.setAttribute(e,"t"),g[t]=!1===n.attributes[e].expando);n=null}();var ft=/^(?:input|select|textarea)$/i,pt=/^key/,dt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,gt=/^(?:focusinfocus|focusoutblur)$/,yt=/^([^.]*)(?:\.(.+)|)/;function mt(){return!0}function vt(){return!1}function _t(){try{return s.activeElement}catch(t){}}function bt(t,e,n,i,o,a){var s,l;if("object"==r(e)){for(l in"string"!=typeof n&&(i=i||n,n=void 0),e)bt(t,l,n,i,e[l],a);return t}if(null==i&&null==o?(o=n,i=n=void 0):null==o&&("string"==typeof n?(o=i,i=void 0):(o=i,i=n,n=void 0)),!1===o)o=vt;else if(!o)return t;return 1===a&&(s=o,(o=function(t){return m().off(t),s.apply(this,arguments)}).guid=s.guid||(s.guid=m.guid++)),t.each((function(){m.event.add(this,e,o,i,n)}))}m.event={global:{},add:function(t,e,n,r,i){var o,a,s,l,u,c,h,f,p,d,g,y=m._data(t);if(y){for(n.handler&&(n=(l=n).handler,i=l.selector),n.guid||(n.guid=m.guid++),(a=y.events)||(a=y.events={}),(c=y.handle)||((c=y.handle=function(t){return void 0===m||t&&m.event.triggered===t.type?void 0:m.event.dispatch.apply(c.elem,arguments)}).elem=t),s=(e=(e||"").match(j)||[""]).length;s--;)p=g=(o=yt.exec(e[s])||[])[1],d=(o[2]||"").split(".").sort(),p&&(u=m.event.special[p]||{},p=(i?u.delegateType:u.bindType)||p,u=m.event.special[p]||{},h=m.extend({type:p,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&m.expr.match.needsContext.test(i),namespace:d.join(".")},l),(f=a[p])||((f=a[p]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(t,r,d,c)||(t.addEventListener?t.addEventListener(p,c,!1):t.attachEvent&&t.attachEvent("on"+p,c))),u.add&&(u.add.call(t,h),h.handler.guid||(h.handler.guid=n.guid)),i?f.splice(f.delegateCount++,0,h):f.push(h),m.event.global[p]=!0);t=null}},remove:function(t,e,n,r,i){var o,a,s,l,u,c,h,f,p,d,g,y=m.hasData(t)&&m._data(t);if(y&&(c=y.events)){for(u=(e=(e||"").match(j)||[""]).length;u--;)if(p=g=(s=yt.exec(e[u])||[])[1],d=(s[2]||"").split(".").sort(),p){for(h=m.event.special[p]||{},f=c[p=(r?h.delegateType:h.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=f.length;o--;)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,h.remove&&h.remove.call(t,a));l&&!f.length&&(h.teardown&&!1!==h.teardown.call(t,d,y.handle)||m.removeEvent(t,p,y.handle),delete c[p])}else for(p in c)m.event.remove(t,p+e[u],n,r,!0);m.isEmptyObject(c)&&(delete y.handle,m._removeData(t,"events"))}},trigger:function(t,e,n,o){var a,l,u,c,h,f,p,g=[n||s],y=d.call(t,"type")?t.type:t,v=d.call(t,"namespace")?t.namespace.split("."):[];if(u=f=n=n||s,3!==n.nodeType&&8!==n.nodeType&&!gt.test(y+m.event.triggered)&&(y.indexOf(".")>-1&&(v=y.split("."),y=v.shift(),v.sort()),l=y.indexOf(":")<0&&"on"+y,(t=t[m.expando]?t:new m.Event(y,"object"==r(t)&&t)).isTrigger=o?2:3,t.namespace=v.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:m.makeArray(e,[t]),h=m.event.special[y]||{},o||!h.trigger||!1!==h.trigger.apply(n,e))){if(!o&&!h.noBubble&&!m.isWindow(n)){for(c=h.delegateType||y,gt.test(c+y)||(u=u.parentNode);u;u=u.parentNode)g.push(u),f=u;f===(n.ownerDocument||s)&&g.push(f.defaultView||f.parentWindow||i)}for(p=0;(u=g[p++])&&!t.isPropagationStopped();)t.type=p>1?c:h.bindType||y,(a=(m._data(u,"events")||{})[t.type]&&m._data(u,"handle"))&&a.apply(u,e),(a=l&&u[l])&&a.apply&&F(u)&&(t.result=a.apply(u,e),!1===t.result&&t.preventDefault());if(t.type=y,!o&&!t.isDefaultPrevented()&&(!h._default||!1===h._default.apply(g.pop(),e))&&F(n)&&l&&n[y]&&!m.isWindow(n)){(f=n[l])&&(n[l]=null),m.event.triggered=y;try{n[y]()}catch(t){}m.event.triggered=void 0,f&&(n[l]=f)}return t.result}},dispatch:function(t){t=m.event.fix(t);var e,n,r,i,o,a=[],s=l.call(arguments),u=(m._data(this,"events")||{})[t.type]||[],c=m.event.special[t.type]||{};if(s[0]=t,t.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){for(a=m.event.handlers.call(this,t,u),e=0;(i=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(o.namespace)||(t.handleObj=o,t.data=o.data,void 0!==(r=((m.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(t.result=r)&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,r,i,o,a=[],s=e.delegateCount,l=t.target;if(s&&l.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==t.type)){for(r=[],n=0;s>n;n++)void 0===r[i=(o=e[n]).selector+" "]&&(r[i]=o.needsContext?m(i,this).index(l)>-1:m.find(i,this,null,[l]).length),r[i]&&r.push(o);r.length&&a.push({elem:l,handlers:r})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},fix:function(t){if(t[m.expando])return t;var e,n,r,i=t.type,o=t,a=this.fixHooks[i];for(a||(this.fixHooks[i]=a=dt.test(i)?this.mouseHooks:pt.test(i)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,t=new m.Event(o),e=r.length;e--;)t[n=r[e]]=o[n];return t.target||(t.target=o.srcElement||s),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,a.filter?a.filter(t,o):t},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,r,i,o=e.button,a=e.fromElement;return null==t.pageX&&null!=e.clientX&&(i=(r=t.target.ownerDocument||s).documentElement,n=r.body,t.pageX=e.clientX+(i&&i.scrollLeft||n&&n.scrollLeft||0)-(i&&i.clientLeft||n&&n.clientLeft||0),t.pageY=e.clientY+(i&&i.scrollTop||n&&n.scrollTop||0)-(i&&i.clientTop||n&&n.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?e.toElement:a),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==_t()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===_t()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return m.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return m.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n){var r=m.extend(new m.Event,n,{type:t,isSimulated:!0});m.event.trigger(r,null,e),r.isDefaultPrevented()&&n.preventDefault()}},m.removeEvent=s.removeEventListener?function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)}:function(t,e,n){var r="on"+e;t.detachEvent&&(void 0===t[r]&&(t[r]=null),t.detachEvent(r,n))},(m.Event=function(t,e){return this instanceof m.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?mt:vt):this.type=t,e&&m.extend(this,e),this.timeStamp=t&&t.timeStamp||m.now(),void(this[m.expando]=!0)):new m.Event(t,e)}).prototype={constructor:m.Event,isDefaultPrevented:vt,isPropagationStopped:vt,isImmediatePropagationStopped:vt,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=mt,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=mt,t&&!this.isSimulated&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=mt,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){m.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,r=this,i=t.relatedTarget,o=t.handleObj;return i&&(i===r||m.contains(r,i))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}})),g.submit||(m.event.special.submit={setup:function(){return!m.nodeName(this,"form")&&void m.event.add(this,"click._submit keypress._submit",(function(t){var e=t.target,n=m.nodeName(e,"input")||m.nodeName(e,"button")?m.prop(e,"form"):void 0;n&&!m._data(n,"submit")&&(m.event.add(n,"submit._submit",(function(t){t._submitBubble=!0})),m._data(n,"submit",!0))}))},postDispatch:function(t){t._submitBubble&&(delete t._submitBubble,this.parentNode&&!t.isTrigger&&m.event.simulate("submit",this.parentNode,t))},teardown:function(){return!m.nodeName(this,"form")&&void m.event.remove(this,"._submit")}}),g.change||(m.event.special.change={setup:function(){return ft.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(m.event.add(this,"propertychange._change",(function(t){"checked"===t.originalEvent.propertyName&&(this._justChanged=!0)})),m.event.add(this,"click._change",(function(t){this._justChanged&&!t.isTrigger&&(this._justChanged=!1),m.event.simulate("change",this,t)}))),!1):void m.event.add(this,"beforeactivate._change",(function(t){var e=t.target;ft.test(e.nodeName)&&!m._data(e,"change")&&(m.event.add(e,"change._change",(function(t){!this.parentNode||t.isSimulated||t.isTrigger||m.event.simulate("change",this.parentNode,t)})),m._data(e,"change",!0))}))},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return m.event.remove(this,"._change"),!ft.test(this.nodeName)}}),g.focusin||m.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){m.event.simulate(e,t.target,m.event.fix(t))};m.event.special[e]={setup:function(){var r=this.ownerDocument||this,i=m._data(r,e);i||r.addEventListener(t,n,!0),m._data(r,e,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=m._data(r,e)-1;i?m._data(r,e,i):(r.removeEventListener(t,n,!0),m._removeData(r,e))}}})),m.fn.extend({on:function(t,e,n,r){return bt(this,t,e,n,r)},one:function(t,e,n,r){return bt(this,t,e,n,r,1)},off:function(t,e,n){var i,o;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,m(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==r(t)){for(o in t)this.off(o,e,t[o]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=vt),this.each((function(){m.event.remove(this,t,n,e)}))},trigger:function(t,e){return this.each((function(){m.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];return n?m.event.trigger(t,e,n,!0):void 0}});var wt=/ jQuery\d+="(?:null|\d+)"/g,xt=new RegExp("<(?:"+rt+")[\\s/>]","i"),Lt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Et=/<script|<style|<link/i,Ct=/checked\s*(?:[^=]|=\s*.checked.)/i,kt=/^true\/(.*)/,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Pt=it(s).appendChild(s.createElement("div"));function Mt(t,e){return m.nodeName(t,"table")&&m.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function Tt(t){return t.type=(null!==m.find.attr(t,"type"))+"/"+t.type,t}function Ot(t){var e=kt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function It(t,e){if(1===e.nodeType&&m.hasData(t)){var n,r,i,o=m._data(t),a=m._data(e,o),s=o.events;if(s)for(n in delete a.handle,a.events={},s)for(r=0,i=s[n].length;i>r;r++)m.event.add(e,n,s[n][r]);a.data&&(a.data=m.extend({},a.data))}}function Nt(t,e){var n,r,i;if(1===e.nodeType){if(n=e.nodeName.toLowerCase(),!g.noCloneEvent&&e[m.expando]){for(r in(i=m._data(e)).events)m.removeEvent(e,r,i.handle);e.removeAttribute(m.expando)}"script"===n&&e.text!==t.text?(Tt(e).text=t.text,Ot(e)):"object"===n?(e.parentNode&&(e.outerHTML=t.outerHTML),g.html5Clone&&t.innerHTML&&!m.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===n&&$.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===n?e.defaultSelected=e.selected=t.defaultSelected:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}}function Dt(t,e,n,r){e=u.apply([],e);var i,o,a,s,l,c,h=0,f=t.length,p=f-1,d=e[0],y=m.isFunction(d);if(y||f>1&&"string"==typeof d&&!g.checkClone&&Ct.test(d))return t.each((function(i){var o=t.eq(i);y&&(e[0]=d.call(this,i,o.html())),Dt(o,e,n,r)}));if(f&&(i=(c=ht(e,t[0].ownerDocument,!1,t,r)).firstChild,1===c.childNodes.length&&(c=i),i||r)){for(a=(s=m.map(at(c,"script"),Tt)).length;f>h;h++)o=c,h!==p&&(o=m.clone(o,!0,!0),a&&m.merge(s,at(o,"script"))),n.call(t[h],o,h);if(a)for(l=s[s.length-1].ownerDocument,m.map(s,Ot),h=0;a>h;h++)o=s[h],et.test(o.type||"")&&!m._data(o,"globalEval")&&m.contains(l,o)&&(o.src?m._evalUrl&&m._evalUrl(o.src):m.globalEval((o.text||o.textContent||o.innerHTML||"").replace(St,"")));c=i=null}return t}function Rt(t,e,n){for(var r,i=e?m.filter(e,t):t,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||m.cleanData(at(r)),r.parentNode&&(n&&m.contains(r.ownerDocument,r)&&st(at(r,"script")),r.parentNode.removeChild(r));return t}m.extend({htmlPrefilter:function(t){return t.replace(Lt,"<$1></$2>")},clone:function(t,e,n){var r,i,o,a,s,l=m.contains(t.ownerDocument,t);if(g.html5Clone||m.isXMLDoc(t)||!xt.test("<"+t.nodeName+">")?o=t.cloneNode(!0):(Pt.innerHTML=t.outerHTML,Pt.removeChild(o=Pt.firstChild)),!(g.noCloneEvent&&g.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||m.isXMLDoc(t)))for(r=at(o),s=at(t),a=0;null!=(i=s[a]);++a)r[a]&&Nt(i,r[a]);if(e)if(n)for(s=s||at(t),r=r||at(o),a=0;null!=(i=s[a]);a++)It(i,r[a]);else It(t,o);return(r=at(o,"script")).length>0&&st(r,!l&&at(t,"script")),r=s=i=null,o},cleanData:function(t,e){for(var n,r,i,o,s=0,l=m.expando,u=m.cache,c=g.attributes,h=m.event.special;null!=(n=t[s]);s++)if((e||F(n))&&(o=(i=n[l])&&u[i])){if(o.events)for(r in o.events)h[r]?m.event.remove(n,r):m.removeEvent(n,r,o.handle);u[i]&&(delete u[i],c||void 0===n.removeAttribute?n[l]=void 0:n.removeAttribute(l),a.push(i))}}}),m.fn.extend({domManip:Dt,detach:function(t){return Rt(this,t,!0)},remove:function(t){return Rt(this,t)},text:function(t){return Q(this,(function(t){return void 0===t?m.text(this):this.empty().append((this[0]&&this[0].ownerDocument||s).createTextNode(t))}),null,t,arguments.length)},append:function(){return Dt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Mt(this,t).appendChild(t)}))},prepend:function(){return Dt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Mt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Dt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Dt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&m.cleanData(at(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&m.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return m.clone(this,t,e)}))},html:function(t){return Q(this,(function(t){var e=this[0]||{},n=0,r=this.length;if(void 0===t)return 1===e.nodeType?e.innerHTML.replace(wt,""):void 0;if("string"==typeof t&&!Et.test(t)&&(g.htmlSerialize||!xt.test(t))&&(g.leadingWhitespace||!nt.test(t))&&!ot[(tt.exec(t)||["",""])[1].toLowerCase()]){t=m.htmlPrefilter(t);try{for(;r>n;n++)1===(e=this[n]||{}).nodeType&&(m.cleanData(at(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Dt(this,arguments,(function(e){var n=this.parentNode;m.inArray(this,t)<0&&(m.cleanData(at(this)),n&&n.replaceChild(e,this))}),t)}}),m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){m.fn[t]=function(t){for(var n,r=0,i=[],o=m(t),a=o.length-1;a>=r;r++)n=r===a?this:this.clone(!0),m(o[r])[e](n),c.apply(i,n.get());return this.pushStack(i)}}));var At,jt={HTML:"block",BODY:"block"};function Bt(t,e){var n=m(e.createElement(t)).appendTo(e.body),r=m.css(n[0],"display");return n.detach(),r}function zt(t){var e=s,n=jt[t];return n||("none"!==(n=Bt(t,e))&&n||((e=((At=(At||m("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentWindow||At[0].contentDocument).document).write(),e.close(),n=Bt(t,e),At.detach()),jt[t]=n),n}var Ft=/^margin/,Gt=new RegExp("^("+W+")(?!px)[a-z%]+$","i"),Ut=function(t,e,n,r){var i,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];for(o in i=n.apply(t,r||[]),e)t.style[o]=a[o];return i},qt=s.documentElement;!function(){var t,e,n,r,o,a,l=s.createElement("div"),u=s.createElement("div");if(u.style){var c=function(){var c,h,f=s.documentElement;f.appendChild(l),u.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",t=n=a=!1,e=o=!0,i.getComputedStyle&&(h=i.getComputedStyle(u),t="1%"!==(h||{}).top,a="2px"===(h||{}).marginLeft,n="4px"===(h||{width:"4px"}).width,u.style.marginRight="50%",e="4px"===(h||{marginRight:"4px"}).marginRight,(c=u.appendChild(s.createElement("div"))).style.cssText=u.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",u.style.width="1px",o=!parseFloat((i.getComputedStyle(c)||{}).marginRight),u.removeChild(c)),u.style.display="none",(r=0===u.getClientRects().length)&&(u.style.display="",u.innerHTML="<table><tr><td></td><td>t</td></tr></table>",u.childNodes[0].style.borderCollapse="separate",(c=u.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",(r=0===c[0].offsetHeight)&&(c[0].style.display="",c[1].style.display="none",r=0===c[0].offsetHeight)),f.removeChild(l)};u.style.cssText="float:left;opacity:.5",g.opacity="0.5"===u.style.opacity,g.cssFloat=!!u.style.cssFloat,u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===u.style.backgroundClip,(l=s.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",u.innerHTML="",l.appendChild(u),g.boxSizing=""===u.style.boxSizing||""===u.style.MozBoxSizing||""===u.style.WebkitBoxSizing,m.extend(g,{reliableHiddenOffsets:function(){return null==t&&c(),r},boxSizingReliable:function(){return null==t&&c(),n},pixelMarginRight:function(){return null==t&&c(),e},pixelPosition:function(){return null==t&&c(),t},reliableMarginRight:function(){return null==t&&c(),o},reliableMarginLeft:function(){return null==t&&c(),a}})}}();var Ht,Vt,Yt=/^(top|right|bottom|left)$/;function Wt(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}i.getComputedStyle?(Ht=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=i),e.getComputedStyle(t)},Vt=function(t,e,n){var r,i,o,a,s=t.style;return""!==(a=(n=n||Ht(t))?n.getPropertyValue(e)||n[e]:void 0)&&void 0!==a||m.contains(t.ownerDocument,t)||(a=m.style(t,e)),n&&!g.pixelMarginRight()&&Gt.test(a)&&Ft.test(e)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o),void 0===a?a:a+""}):qt.currentStyle&&(Ht=function(t){return t.currentStyle},Vt=function(t,e,n){var r,i,o,a,s=t.style;return null==(a=(n=n||Ht(t))?n[e]:void 0)&&s&&s[e]&&(a=s[e]),Gt.test(a)&&!Yt.test(e)&&(r=s.left,(o=(i=t.runtimeStyle)&&i.left)&&(i.left=t.currentStyle.left),s.left="fontSize"===e?"1em":a,a=s.pixelLeft+"px",s.left=r,o&&(i.left=o)),void 0===a?a:a+""||"auto"});var Xt=/alpha\([^)]*\)/i,Zt=/opacity\s*=\s*([^)]*)/i,Kt=/^(none|table(?!-c[ea]).+)/,Jt=new RegExp("^("+W+")(.*)$","i"),Qt={position:"absolute",visibility:"hidden",display:"block"},$t={letterSpacing:"0",fontWeight:"400"},te=["Webkit","O","Moz","ms"],ee=s.createElement("div").style;function ne(t){if(t in ee)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),n=te.length;n--;)if((t=te[n]+e)in ee)return t}function re(t,e){for(var n,r,i,o=[],a=0,s=t.length;s>a;a++)(r=t[a]).style&&(o[a]=m._data(r,"olddisplay"),n=r.style.display,e?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&K(r)&&(o[a]=m._data(r,"olddisplay",zt(r.nodeName)))):(i=K(r),(n&&"none"!==n||!i)&&m._data(r,"olddisplay",i?n:m.css(r,"display"))));for(a=0;s>a;a++)(r=t[a]).style&&(e&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=e?o[a]||"":"none"));return t}function ie(t,e,n){var r=Jt.exec(e);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):e}function oe(t,e,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===e?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=m.css(t,n+Z[o],!0,i)),r?("content"===n&&(a-=m.css(t,"padding"+Z[o],!0,i)),"margin"!==n&&(a-=m.css(t,"border"+Z[o]+"Width",!0,i))):(a+=m.css(t,"padding"+Z[o],!0,i),"padding"!==n&&(a+=m.css(t,"border"+Z[o]+"Width",!0,i)));return a}function ae(t,e,n){var r=!0,i="width"===e?t.offsetWidth:t.offsetHeight,o=Ht(t),a=g.boxSizing&&"border-box"===m.css(t,"boxSizing",!1,o);if(0>=i||null==i){if((0>(i=Vt(t,e,o))||null==i)&&(i=t.style[e]),Gt.test(i))return i;r=a&&(g.boxSizingReliable()||i===t.style[e]),i=parseFloat(i)||0}return i+oe(t,e,n||(a?"border":"content"),r,o)+"px"}function se(t,e,n,r,i){return new se.prototype.init(t,e,n,r,i)}m.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Vt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:g.cssFloat?"cssFloat":"styleFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,a,s,l=m.camelCase(e),u=t.style;if(e=m.cssProps[l]||(m.cssProps[l]=ne(l)||l),s=m.cssHooks[e]||m.cssHooks[l],void 0===n)return s&&"get"in s&&void 0!==(o=s.get(t,!1,i))?o:u[e];if("string"===(a=r(n))&&(o=X.exec(n))&&o[1]&&(n=J(t,e,o),a="number"),null!=n&&n==n&&("number"===a&&(n+=o&&o[3]||(m.cssNumber[l]?"":"px")),g.clearCloneStyle||""!==n||0!==e.indexOf("background")||(u[e]="inherit"),!s||!("set"in s)||void 0!==(n=s.set(t,n,i))))try{u[e]=n}catch(t){}}},css:function(t,e,n,r){var i,o,a,s=m.camelCase(e);return e=m.cssProps[s]||(m.cssProps[s]=ne(s)||s),(a=m.cssHooks[e]||m.cssHooks[s])&&"get"in a&&(o=a.get(t,!0,n)),void 0===o&&(o=Vt(t,e,r)),"normal"===o&&e in $t&&(o=$t[e]),""===n||n?(i=parseFloat(o),!0===n||isFinite(i)?i||0:o):o}}),m.each(["height","width"],(function(t,e){m.cssHooks[e]={get:function(t,n,r){return n?Kt.test(m.css(t,"display"))&&0===t.offsetWidth?Ut(t,Qt,(function(){return ae(t,e,r)})):ae(t,e,r):void 0},set:function(t,n,r){var i=r&&Ht(t);return ie(0,n,r?oe(t,e,r,g.boxSizing&&"border-box"===m.css(t,"boxSizing",!1,i),i):0)}}})),g.opacity||(m.cssHooks.opacity={get:function(t,e){return Zt.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var n=t.style,r=t.currentStyle,i=m.isNumeric(e)?"alpha(opacity="+100*e+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,(e>=1||""===e)&&""===m.trim(o.replace(Xt,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===e||r&&!r.filter)||(n.filter=Xt.test(o)?o.replace(Xt,i):o+" "+i)}}),m.cssHooks.marginRight=Wt(g.reliableMarginRight,(function(t,e){return e?Ut(t,{display:"inline-block"},Vt,[t,"marginRight"]):void 0})),m.cssHooks.marginLeft=Wt(g.reliableMarginLeft,(function(t,e){return e?(parseFloat(Vt(t,"marginLeft"))||(m.contains(t.ownerDocument,t)?t.getBoundingClientRect().left-Ut(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})):0))+"px":void 0})),m.each({margin:"",padding:"",border:"Width"},(function(t,e){m.cssHooks[t+e]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];4>r;r++)i[t+Z[r]+e]=o[r]||o[r-2]||o[0];return i}},Ft.test(t)||(m.cssHooks[t+e].set=ie)})),m.fn.extend({css:function(t,e){return Q(this,(function(t,e,n){var r,i,o={},a=0;if(m.isArray(e)){for(r=Ht(t),i=e.length;i>a;a++)o[e[a]]=m.css(t,e[a],!1,r);return o}return void 0!==n?m.style(t,e,n):m.css(t,e)}),t,e,arguments.length>1)},show:function(){return re(this,!0)},hide:function(){return re(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){K(this)?m(this).show():m(this).hide()}))}}),m.Tween=se,se.prototype={constructor:se,init:function(t,e,n,r,i,o){this.elem=t,this.prop=n,this.easing=i||m.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(m.cssNumber[n]?"":"px")},cur:function(){var t=se.propHooks[this.prop];return t&&t.get?t.get(this):se.propHooks._default.get(this)},run:function(t){var e,n=se.propHooks[this.prop];return this.options.duration?this.pos=e=m.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):se.propHooks._default.set(this),this}},se.prototype.init.prototype=se.prototype,se.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=m.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){m.fx.step[t.prop]?m.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[m.cssProps[t.prop]]&&!m.cssHooks[t.prop]?t.elem[t.prop]=t.now:m.style(t.elem,t.prop,t.now+t.unit)}}},se.propHooks.scrollTop=se.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},m.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},(m.fx=se.prototype.init).step={};var le,ue,ce=/^(?:toggle|show|hide)$/,he=/queueHooks$/;function fe(){return i.setTimeout((function(){le=void 0})),le=m.now()}function pe(t,e){var n,r={height:t},i=0;for(e=e?1:0;4>i;i+=2-e)r["margin"+(n=Z[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function de(t,e,n){for(var r,i=(ge.tweeners[e]||[]).concat(ge.tweeners["*"]),o=0,a=i.length;a>o;o++)if(r=i[o].call(n,e,t))return r}function ge(t,e,n){var r,i,o=0,a=ge.prefilters.length,s=m.Deferred().always((function(){delete l.elem})),l=function(){if(i)return!1;for(var e=le||fe(),n=Math.max(0,u.startTime+u.duration-e),r=1-(n/u.duration||0),o=0,a=u.tweens.length;a>o;o++)u.tweens[o].run(r);return s.notifyWith(t,[u,r,n]),1>r&&a?n:(s.resolveWith(t,[u]),!1)},u=s.promise({elem:t,props:m.extend({},e),opts:m.extend(!0,{specialEasing:{},easing:m.easing._default},n),originalProperties:e,originalOptions:n,startTime:le||fe(),duration:n.duration,tweens:[],createTween:function(e,n){var r=m.Tween(t,u.opts,e,n,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(r),r},stop:function(e){var n=0,r=e?u.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)u.tweens[n].run(1);return e?(s.notifyWith(t,[u,1,0]),s.resolveWith(t,[u,e])):s.rejectWith(t,[u,e]),this}}),c=u.props;for(function(t,e){var n,r,i,o,a;for(n in t)if(i=e[r=m.camelCase(n)],o=t[n],m.isArray(o)&&(i=o[1],o=t[n]=o[0]),n!==r&&(t[r]=o,delete t[n]),(a=m.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete t[r],o)n in t||(t[n]=o[n],e[n]=i);else e[r]=i}(c,u.opts.specialEasing);a>o;o++)if(r=ge.prefilters[o].call(u,t,c,u.opts))return m.isFunction(r.stop)&&(m._queueHooks(u.elem,u.opts.queue).stop=m.proxy(r.stop,r)),r;return m.map(c,de,u),m.isFunction(u.opts.start)&&u.opts.start.call(t,u),m.fx.timer(m.extend(l,{elem:t,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}m.Animation=m.extend(ge,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return J(n.elem,t,X.exec(e),n),n}]},tweener:function(t,e){m.isFunction(t)?(e=t,t=["*"]):t=t.match(j);for(var n,r=0,i=t.length;i>r;r++)n=t[r],ge.tweeners[n]=ge.tweeners[n]||[],ge.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var r,i,o,a,s,l,u,c=this,h={},f=t.style,p=t.nodeType&&K(t),d=m._data(t,"fxshow");for(r in n.queue||(null==(s=m._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,c.always((function(){c.always((function(){s.unqueued--,m.queue(t,"fx").length||s.empty.fire()}))}))),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===("none"===(u=m.css(t,"display"))?m._data(t,"olddisplay")||zt(t.nodeName):u)&&"none"===m.css(t,"float")&&(g.inlineBlockNeedsLayout&&"inline"!==zt(t.nodeName)?f.zoom=1:f.display="inline-block")),n.overflow&&(f.overflow="hidden",g.shrinkWrapBlocks()||c.always((function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}))),e)if(i=e[r],ce.exec(i)){if(delete e[r],o=o||"toggle"===i,i===(p?"hide":"show")){if("show"!==i||!d||void 0===d[r])continue;p=!0}h[r]=d&&d[r]||m.style(t,r)}else u=void 0;if(m.isEmptyObject(h))"inline"===("none"===u?zt(t.nodeName):u)&&(f.display=u);else for(r in d?"hidden"in d&&(p=d.hidden):d=m._data(t,"fxshow",{}),o&&(d.hidden=!p),p?m(t).show():c.done((function(){m(t).hide()})),c.done((function(){var e;for(e in m._removeData(t,"fxshow"),h)m.style(t,e,h[e])})),h)a=de(p?d[r]:0,r,c),r in d||(d[r]=a.start,p&&(a.end=a.start,a.start="width"===r||"height"===r?1:0))}],prefilter:function(t,e){e?ge.prefilters.unshift(t):ge.prefilters.push(t)}}),m.speed=function(t,e,n){var i=t&&"object"==r(t)?m.extend({},t):{complete:n||!n&&e||m.isFunction(t)&&t,duration:t,easing:n&&e||e&&!m.isFunction(e)&&e};return i.duration=m.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in m.fx.speeds?m.fx.speeds[i.duration]:m.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){m.isFunction(i.old)&&i.old.call(this),i.queue&&m.dequeue(this,i.queue)},i},m.fn.extend({fadeTo:function(t,e,n,r){return this.filter(K).css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(t,e,n,r){var i=m.isEmptyObject(t),o=m.speed(e,n,r),a=function(){var e=ge(this,m.extend({},t),o);(i||m._data(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(t,e,n){var r=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each((function(){var e=!0,i=null!=t&&t+"queueHooks",o=m.timers,a=m._data(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&he.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=t&&o[i].queue!==t||(o[i].anim.stop(n),e=!1,o.splice(i,1));!e&&n||m.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=m._data(this),r=n[t+"queue"],i=n[t+"queueHooks"],o=m.timers,a=r?r.length:0;for(n.finish=!0,m.queue(this,t,[]),i&&i.stop&&i.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;a>e;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete n.finish}))}}),m.each(["toggle","show","hide"],(function(t,e){var n=m.fn[e];m.fn[e]=function(t,r,i){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(pe(e,!0),t,r,i)}})),m.each({slideDown:pe("show"),slideUp:pe("hide"),slideToggle:pe("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){m.fn[t]=function(t,n,r){return this.animate(e,t,n,r)}})),m.timers=[],m.fx.tick=function(){var t,e=m.timers,n=0;for(le=m.now();n<e.length;n++)(t=e[n])()||e[n]!==t||e.splice(n--,1);e.length||m.fx.stop(),le=void 0},m.fx.timer=function(t){m.timers.push(t),t()?m.fx.start():m.timers.pop()},m.fx.interval=13,m.fx.start=function(){ue||(ue=i.setInterval(m.fx.tick,m.fx.interval))},m.fx.stop=function(){i.clearInterval(ue),ue=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(t,e){return t=m.fx&&m.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,n){var r=i.setTimeout(e,t);n.stop=function(){i.clearTimeout(r)}}))},function(){var t,e=s.createElement("input"),n=s.createElement("div"),r=s.createElement("select"),i=r.appendChild(s.createElement("option"));(n=s.createElement("div")).setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",t=n.getElementsByTagName("a")[0],e.setAttribute("type","checkbox"),n.appendChild(e),(t=n.getElementsByTagName("a")[0]).style.cssText="top:1px",g.getSetAttribute="t"!==n.className,g.style=/top/.test(t.getAttribute("style")),g.hrefNormalized="/a"===t.getAttribute("href"),g.checkOn=!!e.value,g.optSelected=i.selected,g.enctype=!!s.createElement("form").enctype,r.disabled=!0,g.optDisabled=!i.disabled,(e=s.createElement("input")).setAttribute("value",""),g.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),g.radioValue="t"===e.value}();var ye=/\r/g,me=/[\x20\t\r\n\f]+/g;m.fn.extend({val:function(t){var e,n,r,i=this[0];return arguments.length?(r=m.isFunction(t),this.each((function(n){var i;1===this.nodeType&&(null==(i=r?t.call(this,n,m(this).val()):t)?i="":"number"==typeof i?i+="":m.isArray(i)&&(i=m.map(i,(function(t){return null==t?"":t+""}))),(e=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,i,"value")||(this.value=i))}))):i?(e=m.valHooks[i.type]||m.valHooks[i.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(ye,""):null==n?"":n:void 0}}),m.extend({valHooks:{option:{get:function(t){var e=m.find.attr(t,"value");return null!=e?e:m.trim(m.text(t)).replace(me," ")}},select:{get:function(t){for(var e,n,r=t.options,i=t.selectedIndex,o="select-one"===t.type||0>i,a=o?null:[],s=o?i+1:r.length,l=0>i?s:o?i:0;s>l;l++)if(((n=r[l]).selected||l===i)&&(g.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!m.nodeName(n.parentNode,"optgroup"))){if(e=m(n).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var n,r,i=t.options,o=m.makeArray(e),a=i.length;a--;)if(r=i[a],m.inArray(m.valHooks.option.get(r),o)>-1)try{r.selected=n=!0}catch(t){r.scrollHeight}else r.selected=!1;return n||(t.selectedIndex=-1),i}}}}),m.each(["radio","checkbox"],(function(){m.valHooks[this]={set:function(t,e){return m.isArray(e)?t.checked=m.inArray(m(t).val(),e)>-1:void 0}},g.checkOn||(m.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}));var ve,_e,be=m.expr.attrHandle,we=/^(?:checked|selected)$/i,xe=g.getSetAttribute,Le=g.input;m.fn.extend({attr:function(t,e){return Q(this,m.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){m.removeAttr(this,t)}))}}),m.extend({attr:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?m.prop(t,e,n):(1===o&&m.isXMLDoc(t)||(e=e.toLowerCase(),i=m.attrHooks[e]||(m.expr.match.bool.test(e)?_e:ve)),void 0!==n?null===n?void m.removeAttr(t,e):i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:(t.setAttribute(e,n+""),n):i&&"get"in i&&null!==(r=i.get(t,e))?r:null==(r=m.find.attr(t,e))?void 0:r)},attrHooks:{type:{set:function(t,e){if(!g.radioValue&&"radio"===e&&m.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,r,i=0,o=e&&e.match(j);if(o&&1===t.nodeType)for(;n=o[i++];)r=m.propFix[n]||n,m.expr.match.bool.test(n)?Le&&xe||!we.test(n)?t[r]=!1:t[m.camelCase("default-"+n)]=t[r]=!1:m.attr(t,n,""),t.removeAttribute(xe?n:r)}}),_e={set:function(t,e,n){return!1===e?m.removeAttr(t,n):Le&&xe||!we.test(n)?t.setAttribute(!xe&&m.propFix[n]||n,n):t[m.camelCase("default-"+n)]=t[n]=!0,n}},m.each(m.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=be[e]||m.find.attr;Le&&xe||!we.test(e)?be[e]=function(t,e,r){var i,o;return r||(o=be[e],be[e]=i,i=null!=n(t,e,r)?e.toLowerCase():null,be[e]=o),i}:be[e]=function(t,e,n){return n?void 0:t[m.camelCase("default-"+e)]?e.toLowerCase():null}})),Le&&xe||(m.attrHooks.value={set:function(t,e,n){return m.nodeName(t,"input")?void(t.defaultValue=e):ve&&ve.set(t,e,n)}}),xe||(ve={set:function(t,e,n){var r=t.getAttributeNode(n);return r||t.setAttributeNode(r=t.ownerDocument.createAttribute(n)),r.value=e+="","value"===n||e===t.getAttribute(n)?e:void 0}},be.id=be.name=be.coords=function(t,e,n){var r;return n?void 0:(r=t.getAttributeNode(e))&&""!==r.value?r.value:null},m.valHooks.button={get:function(t,e){var n=t.getAttributeNode(e);return n&&n.specified?n.value:void 0},set:ve.set},m.attrHooks.contenteditable={set:function(t,e,n){ve.set(t,""!==e&&e,n)}},m.each(["width","height"],(function(t,e){m.attrHooks[e]={set:function(t,n){return""===n?(t.setAttribute(e,"auto"),n):void 0}}}))),g.style||(m.attrHooks.style={get:function(t){return t.style.cssText||void 0},set:function(t,e){return t.style.cssText=e+""}});var Ee=/^(?:input|select|textarea|button|object)$/i,Ce=/^(?:a|area)$/i;m.fn.extend({prop:function(t,e){return Q(this,m.prop,t,e,arguments.length>1)},removeProp:function(t){return t=m.propFix[t]||t,this.each((function(){try{this[t]=void 0,delete this[t]}catch(t){}}))}}),m.extend({prop:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&m.isXMLDoc(t)||(e=m.propFix[e]||e,i=m.propHooks[e]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:t[e]=n:i&&"get"in i&&null!==(r=i.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){var e=m.find.attr(t,"tabindex");return e?parseInt(e,10):Ee.test(t.nodeName)||Ce.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.hrefNormalized||m.each(["href","src"],(function(t,e){m.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}})),g.optSelected||(m.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),m.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){m.propFix[this.toLowerCase()]=this})),g.enctype||(m.propFix.enctype="encoding");var ke=/[\t\r\n\f]/g;function Se(t){return m.attr(t,"class")||""}m.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,l=0;if(m.isFunction(t))return this.each((function(e){m(this).addClass(t.call(this,e,Se(this)))}));if("string"==typeof t&&t)for(e=t.match(j)||[];n=this[l++];)if(i=Se(n),r=1===n.nodeType&&(" "+i+" ").replace(ke," ")){for(a=0;o=e[a++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=m.trim(r))&&m.attr(n,"class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,l=0;if(m.isFunction(t))return this.each((function(e){m(this).removeClass(t.call(this,e,Se(this)))}));if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(j)||[];n=this[l++];)if(i=Se(n),r=1===n.nodeType&&(" "+i+" ").replace(ke," ")){for(a=0;o=e[a++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");i!==(s=m.trim(r))&&m.attr(n,"class",s)}return this},toggleClass:function(t,e){var n=r(t);return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):m.isFunction(t)?this.each((function(n){m(this).toggleClass(t.call(this,n,Se(this),e),e)})):this.each((function(){var e,r,i,o;if("string"===n)for(r=0,i=m(this),o=t.match(j)||[];e=o[r++];)i.hasClass(e)?i.removeClass(e):i.addClass(e);else void 0!==t&&"boolean"!==n||((e=Se(this))&&m._data(this,"__className__",e),m.attr(this,"class",e||!1===t?"":m._data(this,"__className__")||""))}))},hasClass:function(t){var e,n,r=0;for(e=" "+t+" ";n=this[r++];)if(1===n.nodeType&&(" "+Se(n)+" ").replace(ke," ").indexOf(e)>-1)return!0;return!1}}),m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),(function(t,e){m.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}})),m.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}});var Pe=i.location,Me=m.now(),Te=/\?/,Oe=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;m.parseJSON=function(t){if(i.JSON&&i.JSON.parse)return i.JSON.parse(t+"");var e,n=null,r=m.trim(t+"");return r&&!m.trim(r.replace(Oe,(function(t,r,i,o){return e&&r&&(n=0),0===n?t:(e=i||r,n+=!o-!i,"")})))?Function("return "+r)():m.error("Invalid JSON: "+t)},m.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{i.DOMParser?e=(new i.DOMParser).parseFromString(t,"text/xml"):((e=new i.ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t))}catch(t){e=void 0}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+t),e};var Ie=/#.*$/,Ne=/([?&])_=[^&]*/,De=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Re=/^(?:GET|HEAD)$/,Ae=/^\/\//,je=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Be={},ze={},Fe="*/".concat("*"),Ge=Pe.href,Ue=je.exec(Ge.toLowerCase())||[];function qe(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var r,i=0,o=e.toLowerCase().match(j)||[];if(m.isFunction(n))for(;r=o[i++];)"+"===r.charAt(0)?(r=r.slice(1)||"*",(t[r]=t[r]||[]).unshift(n)):(t[r]=t[r]||[]).push(n)}}function He(t,e,n,r){var i={},o=t===ze;function a(s){var l;return i[s]=!0,m.each(t[s]||[],(function(t,s){var u=s(e,n,r);return"string"!=typeof u||o||i[u]?o?!(l=u):void 0:(e.dataTypes.unshift(u),a(u),!1)})),l}return a(e.dataTypes[0])||!i["*"]&&a("*")}function Ve(t,e){var n,r,i=m.ajaxSettings.flatOptions||{};for(r in e)void 0!==e[r]&&((i[r]?t:n||(n={}))[r]=e[r]);return n&&m.extend(!0,t,n),t}function Ye(t){return t.style&&t.style.display||m.css(t,"display")}m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ge,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ue[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Fe,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Ve(Ve(t,m.ajaxSettings),e):Ve(m.ajaxSettings,t)},ajaxPrefilter:qe(Be),ajaxTransport:qe(ze),ajax:function(t,e){"object"==r(t)&&(e=t,t=void 0);var n,o,a,s,l,u,c,h,f=m.ajaxSetup({},e=e||{}),p=f.context||f,d=f.context&&(p.nodeType||p.jquery)?m(p):m.event,g=m.Deferred(),y=m.Callbacks("once memory"),v=f.statusCode||{},_={},b={},w=0,x="canceled",L={readyState:0,getResponseHeader:function(t){var e;if(2===w){if(!h)for(h={};e=De.exec(s);)h[e[1].toLowerCase()]=e[2];e=h[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===w?s:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return w||(t=b[n]=b[n]||t,_[t]=e),this},overrideMimeType:function(t){return w||(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>w)for(e in t)v[e]=[v[e],t[e]];else L.always(t[L.status]);return this},abort:function(t){var e=t||x;return c&&c.abort(e),E(0,e),this}};if(g.promise(L).complete=y.add,L.success=L.done,L.error=L.fail,f.url=((t||f.url||Ge)+"").replace(Ie,"").replace(Ae,Ue[1]+"//"),f.type=e.method||e.type||f.method||f.type,f.dataTypes=m.trim(f.dataType||"*").toLowerCase().match(j)||[""],null==f.crossDomain&&(n=je.exec(f.url.toLowerCase()),f.crossDomain=!(!n||n[1]===Ue[1]&&n[2]===Ue[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(Ue[3]||("http:"===Ue[1]?"80":"443")))),f.data&&f.processData&&"string"!=typeof f.data&&(f.data=m.param(f.data,f.traditional)),He(Be,f,e,L),2===w)return L;for(o in(u=m.event&&f.global)&&0==m.active++&&m.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Re.test(f.type),a=f.url,f.hasContent||(f.data&&(a=f.url+=(Te.test(a)?"&":"?")+f.data,delete f.data),!1===f.cache&&(f.url=Ne.test(a)?a.replace(Ne,"$1_="+Me++):a+(Te.test(a)?"&":"?")+"_="+Me++)),f.ifModified&&(m.lastModified[a]&&L.setRequestHeader("If-Modified-Since",m.lastModified[a]),m.etag[a]&&L.setRequestHeader("If-None-Match",m.etag[a])),(f.data&&f.hasContent&&!1!==f.contentType||e.contentType)&&L.setRequestHeader("Content-Type",f.contentType),L.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Fe+"; q=0.01":""):f.accepts["*"]),f.headers)L.setRequestHeader(o,f.headers[o]);if(f.beforeSend&&(!1===f.beforeSend.call(p,L,f)||2===w))return L.abort();for(o in x="abort",{success:1,error:1,complete:1})L[o](f[o]);if(c=He(ze,f,e,L)){if(L.readyState=1,u&&d.trigger("ajaxSend",[L,f]),2===w)return L;f.async&&f.timeout>0&&(l=i.setTimeout((function(){L.abort("timeout")}),f.timeout));try{w=1,c.send(_,E)}catch(t){if(!(2>w))throw t;E(-1,t)}}else E(-1,"No Transport");function E(t,e,n,r){var o,h,_,b,x,E=e;2!==w&&(w=2,l&&i.clearTimeout(l),c=void 0,s=r||"",L.readyState=t>0?4:0,o=t>=200&&300>t||304===t,n&&(b=function(t,e,n){for(var r,i,o,a,s=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(a in s)if(s[a]&&s[a].test(i)){l.unshift(a);break}if(l[0]in n)o=l[0];else{for(a in n){if(!l[0]||t.converters[a+" "+l[0]]){o=a;break}r||(r=a)}o=o||r}return o?(o!==l[0]&&l.unshift(o),n[o]):void 0}(f,L,n)),b=function(t,e,n,r){var i,o,a,s,l,u={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)u[a.toLowerCase()]=t.converters[a];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!l&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(a=u[l+" "+o]||u["* "+o]))for(i in u)if((s=i.split(" "))[1]===o&&(a=u[l+" "+s[0]]||u["* "+s[0]])){!0===a?a=u[i]:!0!==u[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}(f,b,L,o),o?(f.ifModified&&((x=L.getResponseHeader("Last-Modified"))&&(m.lastModified[a]=x),(x=L.getResponseHeader("etag"))&&(m.etag[a]=x)),204===t||"HEAD"===f.type?E="nocontent":304===t?E="notmodified":(E=b.state,h=b.data,o=!(_=b.error))):(_=E,!t&&E||(E="error",0>t&&(t=0))),L.status=t,L.statusText=(e||E)+"",o?g.resolveWith(p,[h,E,L]):g.rejectWith(p,[L,E,_]),L.statusCode(v),v=void 0,u&&d.trigger(o?"ajaxSuccess":"ajaxError",[L,f,o?h:_]),y.fireWith(p,[L,E]),u&&(d.trigger("ajaxComplete",[L,f]),--m.active||m.event.trigger("ajaxStop")))}return L},getJSON:function(t,e,n){return m.get(t,e,n,"json")},getScript:function(t,e){return m.get(t,void 0,e,"script")}}),m.each(["get","post"],(function(t,e){m[e]=function(t,n,r,i){return m.isFunction(n)&&(i=i||r,r=n,n=void 0),m.ajax(m.extend({url:t,type:e,dataType:i,data:n,success:r},m.isPlainObject(t)&&t))}})),m._evalUrl=function(t){return m.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},m.fn.extend({wrapAll:function(t){if(m.isFunction(t))return this.each((function(e){m(this).wrapAll(t.call(this,e))}));if(this[0]){var e=m(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t})).append(this)}return this},wrapInner:function(t){return m.isFunction(t)?this.each((function(e){m(this).wrapInner(t.call(this,e))})):this.each((function(){var e=m(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=m.isFunction(t);return this.each((function(n){m(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(){return this.parent().each((function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)})).end()}}),m.expr.filters.hidden=function(t){return g.reliableHiddenOffsets()?t.offsetWidth<=0&&t.offsetHeight<=0&&!t.getClientRects().length:function(t){if(!m.contains(t.ownerDocument||s,t))return!0;for(;t&&1===t.nodeType;){if("none"===Ye(t)||"hidden"===t.type)return!0;t=t.parentNode}return!1}(t)},m.expr.filters.visible=function(t){return!m.expr.filters.hidden(t)};var We=/%20/g,Xe=/\[\]$/,Ze=/\r?\n/g,Ke=/^(?:submit|button|image|reset|file)$/i,Je=/^(?:input|select|textarea|keygen)/i;function Qe(t,e,n,i){var o;if(m.isArray(e))m.each(e,(function(e,o){n||Xe.test(t)?i(t,o):Qe(t+"["+("object"==r(o)&&null!=o?e:"")+"]",o,n,i)}));else if(n||"object"!==m.type(e))i(t,e);else for(o in e)Qe(t+"["+o+"]",e[o],n,i)}m.param=function(t,e){var n,r=[],i=function(t,e){e=m.isFunction(e)?e():null==e?"":e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=m.ajaxSettings&&m.ajaxSettings.traditional),m.isArray(t)||t.jquery&&!m.isPlainObject(t))m.each(t,(function(){i(this.name,this.value)}));else for(n in t)Qe(n,t[n],e,i);return r.join("&").replace(We,"+")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=m.prop(this,"elements");return t?m.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!m(this).is(":disabled")&&Je.test(this.nodeName)&&!Ke.test(t)&&(this.checked||!$.test(t))})).map((function(t,e){var n=m(this).val();return null==n?null:m.isArray(n)?m.map(n,(function(t){return{name:e.name,value:t.replace(Ze,"\r\n")}})):{name:e.name,value:n.replace(Ze,"\r\n")}})).get()}}),m.ajaxSettings.xhr=void 0!==i.ActiveXObject?function(){return this.isLocal?rn():s.documentMode>8?nn():/^(get|post|head|put|delete|options)$/i.test(this.type)&&nn()||rn()}:nn;var $e=0,tn={},en=m.ajaxSettings.xhr();function nn(){try{return new i.XMLHttpRequest}catch(t){}}function rn(){try{return new i.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}i.attachEvent&&i.attachEvent("onunload",(function(){for(var t in tn)tn[t](void 0,!0)})),g.cors=!!en&&"withCredentials"in en,(en=g.ajax=!!en)&&m.ajaxTransport((function(t){var e;if(!t.crossDomain||g.cors)return{send:function(n,r){var o,a=t.xhr(),s=++$e;if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)a[o]=t.xhrFields[o];for(o in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)void 0!==n[o]&&a.setRequestHeader(o,n[o]+"");a.send(t.hasContent&&t.data||null),e=function(n,i){var o,l,u;if(e&&(i||4===a.readyState))if(delete tn[s],e=void 0,a.onreadystatechange=m.noop,i)4!==a.readyState&&a.abort();else{u={},o=a.status,"string"==typeof a.responseText&&(u.text=a.responseText);try{l=a.statusText}catch(t){l=""}o||!t.isLocal||t.crossDomain?1223===o&&(o=204):o=u.text?200:404}u&&r(o,l,u,a.getAllResponseHeaders())},t.async?4===a.readyState?i.setTimeout(e):a.onreadystatechange=tn[s]=e:e()},abort:function(){e&&e(void 0,!0)}}})),m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return m.globalEval(t),t}}}),m.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)})),m.ajaxTransport("script",(function(t){if(t.crossDomain){var e,n=s.head||m("head")[0]||s.documentElement;return{send:function(r,i){(e=s.createElement("script")).async=!0,t.scriptCharset&&(e.charset=t.scriptCharset),e.src=t.url,e.onload=e.onreadystatechange=function(t,n){(n||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),e=null,n||i(200,"success"))},n.insertBefore(e,n.firstChild)},abort:function(){e&&e.onload(void 0,!0)}}}}));var on=[],an=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=on.pop()||m.expando+"_"+Me++;return this[t]=!0,t}}),m.ajaxPrefilter("json jsonp",(function(t,e,n){var r,o,a,s=!1!==t.jsonp&&(an.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&an.test(t.data)&&"data");return s||"jsonp"===t.dataTypes[0]?(r=t.jsonpCallback=m.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(an,"$1"+r):!1!==t.jsonp&&(t.url+=(Te.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return a||m.error(r+" was not called"),a[0]},t.dataTypes[0]="json",o=i[r],i[r]=function(){a=arguments},n.always((function(){void 0===o?m(i).removeProp(r):i[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,on.push(r)),a&&m.isFunction(o)&&o(a[0]),a=o=void 0})),"script"):void 0})),m.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||s;var r=S.exec(t),i=!n&&[];return r?[e.createElement(r[1])]:(r=ht([t],e,i),i&&i.length&&m(i).remove(),m.merge([],r.childNodes))};var sn=m.fn.load;function ln(t){return m.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}m.fn.load=function(t,e,n){if("string"!=typeof t&&sn)return sn.apply(this,arguments);var i,o,a,s=this,l=t.indexOf(" ");return l>-1&&(i=m.trim(t.slice(l,t.length)),t=t.slice(0,l)),m.isFunction(e)?(n=e,e=void 0):e&&"object"==r(e)&&(o="POST"),s.length>0&&m.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done((function(t){a=arguments,s.html(i?m("<div>").append(m.parseHTML(t)).find(i):t)})).always(n&&function(t,e){s.each((function(){n.apply(this,a||[t.responseText,e,t])}))}),this},m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){m.fn[e]=function(t){return this.on(e,t)}})),m.expr.filters.animated=function(t){return m.grep(m.timers,(function(e){return t===e.elem})).length},m.offset={setOffset:function(t,e,n){var r,i,o,a,s,l,u=m.css(t,"position"),c=m(t),h={};"static"===u&&(t.style.position="relative"),s=c.offset(),o=m.css(t,"top"),l=m.css(t,"left"),("absolute"===u||"fixed"===u)&&m.inArray("auto",[o,l])>-1?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(l)||0),m.isFunction(e)&&(e=e.call(t,n,m.extend({},s))),null!=e.top&&(h.top=e.top-s.top+a),null!=e.left&&(h.left=e.left-s.left+i),"using"in e?e.using.call(t,h):c.css(h)}},m.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){m.offset.setOffset(this,t,e)}));var e,n,r={top:0,left:0},i=this[0],o=i&&i.ownerDocument;return o?(e=o.documentElement,m.contains(e,i)?(void 0!==i.getBoundingClientRect&&(r=i.getBoundingClientRect()),n=ln(o),{top:r.top+(n.pageYOffset||e.scrollTop)-(e.clientTop||0),left:r.left+(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):r):void 0},position:function(){if(this[0]){var t,e,n={top:0,left:0},r=this[0];return"fixed"===m.css(r,"position")?e=r.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),m.nodeName(t[0],"html")||(n=t.offset()),n.top+=m.css(t[0],"borderTopWidth",!0),n.left+=m.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-m.css(r,"marginTop",!0),left:e.left-n.left-m.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&!m.nodeName(t,"html")&&"static"===m.css(t,"position");)t=t.offsetParent;return t||qt}))}}),m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n=/Y/.test(e);m.fn[t]=function(r){return Q(this,(function(t,r,i){var o=ln(t);return void 0===i?o?e in o?o[e]:o.document.documentElement[r]:t[r]:void(o?o.scrollTo(n?m(o).scrollLeft():i,n?i:m(o).scrollTop()):t[r]=i)}),t,r,arguments.length,null)}})),m.each(["top","left"],(function(t,e){m.cssHooks[e]=Wt(g.pixelPosition,(function(t,n){return n?(n=Vt(t,e),Gt.test(n)?m(t).position()[e]+"px":n):void 0}))})),m.each({Height:"height",Width:"width"},(function(t,e){m.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,r){m.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===i?"margin":"border");return Q(this,(function(e,n,r){var i;return m.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(i=e.documentElement,Math.max(e.body["scroll"+t],i["scroll"+t],e.body["offset"+t],i["offset"+t],i["client"+t])):void 0===r?m.css(e,n,a):m.style(e,n,r,a)}),e,o?r:void 0,o,null)}}))})),m.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),m.fn.size=function(){return this.length},m.fn.andSelf=m.fn.addBack,void 0===(n=function(){return m}.apply(e,[]))||(t.exports=n);var un=i.jQuery,cn=i._$;return m.noConflict=function(t){return i._$===m&&(i._$=cn),t&&i.jQuery===m&&(i.jQuery=un),m},o||(i.jQuery=i._$=m),m}))}).call(this,n(32)(t))},22:function(t,e,n){
/*!
 * clipboard.js v2.0.6
 * https://clipboardjs.com/
 * 
 * Licensed MIT  Zeno Rocha
 */
var r;r=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e){t.exports=function(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var n=t.hasAttribute("readonly");n||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),n||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var r=window.getSelection(),i=document.createRange();i.selectNodeContents(t),r.removeAllRanges(),r.addRange(i),e=r.toString()}return e}},function(t,e){function n(){}n.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var r=this;function i(){r.off(t,i),e.apply(n,arguments)}return i._=e,this.on(t,i,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,i=n.length;r<i;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],i=[];if(r&&e)for(var o=0,a=r.length;o<a;o++)r[o].fn!==e&&r[o].fn._!==e&&i.push(r[o]);return i.length?n[t]=i:delete n[t],this}},t.exports=n,t.exports.TinyEmitter=n},function(t,e,n){var r=n(3),i=n(4);t.exports=function(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!r.string(e))throw new TypeError("Second argument must be a String");if(!r.fn(n))throw new TypeError("Third argument must be a Function");if(r.node(t))return function(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}(t,e,n);if(r.nodeList(t))return function(t,e,n){return Array.prototype.forEach.call(t,(function(t){t.addEventListener(e,n)})),{destroy:function(){Array.prototype.forEach.call(t,(function(t){t.removeEventListener(e,n)}))}}}(t,e,n);if(r.string(t))return function(t,e,n){return i(document.body,t,e,n)}(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},function(t,e){e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var n=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"==typeof t||t instanceof String},e.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},function(t,e,n){var r=n(5);function i(t,e,n,r,i){var a=o.apply(this,arguments);return t.addEventListener(n,a,i),{destroy:function(){t.removeEventListener(n,a,i)}}}function o(t,e,n,i){return function(n){n.delegateTarget=r(n.target,e),n.delegateTarget&&i.call(t,n)}}t.exports=function(t,e,n,r,o){return"function"==typeof t.addEventListener?i.apply(null,arguments):"function"==typeof n?i.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,(function(t){return i(t,e,n,r,o)})))}},function(t,e){if("undefined"!=typeof Element&&!Element.prototype.matches){var n=Element.prototype;n.matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}t.exports=function(t,e){for(;t&&9!==t.nodeType;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}},function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.resolveOptions(e),this.initSelection()}return a(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=i()(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=i()(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),document.activeElement.blur(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":o(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}(),l=n(1),u=n.n(l),c=n(2),h=n.n(c),f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),d=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.resolveOptions(n),r.listenClick(t),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),p(e,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===f(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=h()(t,"click",(function(t){return e.onClick(t)}))}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new s({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return g("action",t)}},{key:"defaultTarget",value:function(t){var e=g("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return g("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,n=!!document.queryCommandSupported;return e.forEach((function(t){n=n&&!!document.queryCommandSupported(t)})),n}}]),e}(u.a);function g(t,e){var n="data-clipboard-"+t;if(e.hasAttribute(n))return e.getAttribute(n)}e.default=d}]).default},t.exports=r()},246:function(t,e){},254:function(t,e){},256:function(t,e){},258:function(t,e){},264:function(t,e){},269:function(t,e){},32:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},33:function(t,e){var n;n=jQuery,function(){var t,e,r,i=0,o="error",a="info",s="success",l="warning",u="loading",c=n.fn.toastr={clear:function(e,r){var i=g();t||h(i),f(e,i,r)||function(e){for(var r=t.children(),i=r.length-1;i>=0;i--)f(n(r[i]),e)}(i)},remove:function(e){var r=g();t||h(r),e&&0===n(":focus",e).length?y(e):t.children().length&&t.remove()},error:function(t,e,n){return d({type:o,iconClass:g().iconClasses.error,message:t,optionsOverride:n,title:e})},getContainer:h,info:function(t,e,n){return d({type:a,iconClass:g().iconClasses.info,message:t,optionsOverride:n,title:e})},loading:function(t,e,n){return d({type:u,iconClass:g().iconClasses.loading,message:t,optionsOverride:n,title:e})},options:{},subscribe:function(t){e=t},success:function(t,e,n){return d({type:s,iconClass:g().iconClasses.success,message:t,optionsOverride:n,title:e})},version:"2.1.4",warning:function(t,e,n){return d({type:l,iconClass:g().iconClasses.warning,message:t,optionsOverride:n,title:e})}};function h(e,r){return e||(e=g()),(t=n("#"+e.containerId)).length||r&&(t=function(e){return(t=n("<div/>").attr("id",e.containerId).addClass(e.positionClass)).appendTo(n(e.target)),t}(e)),t}function f(t,e,r){var i=!(!r||!r.force)&&r.force;return!(!t||!i&&0!==n(":focus",t).length||(t[e.hideMethod]({duration:e.hideDuration,easing:e.hideEasing,complete:function(){y(t)}}),0))}function p(t){e&&e(t)}function d(e){var o=g(),a=e.iconClass||o.iconClass;if(void 0!==e.optionsOverride&&(o=n.extend(o,e.optionsOverride),a=e.optionsOverride.iconClass||a),!function(t,e){if(t.preventDuplicates){if(e.message===r)return!0;r=e.message}return!1}(o,e)){i++,t=h(o,!0);var s=null,l=n("<div/>"),u=n("<div/>"),c=n("<div/>"),f=n("<div/>"),d=n(o.closeHtml),m={intervalId:null,hideEta:null,maxHideTime:null},v={toastId:i,state:"visible",startTime:new Date,options:o,map:e};e.iconClass&&l.addClass(o.toastClass).addClass(a),function(){if(e.title){var t=e.title;o.escapeHtml&&(t=b(e.title)),u.append(t).addClass(o.titleClass),l.append(u)}}(),function(){if(e.message){var t=e.message;o.escapeHtml&&(t=b(e.message)),c.append(t).addClass(o.messageClass),l.append(c)}}(),o.closeButton&&(d.addClass(o.closeClass).attr("role","button"),l.prepend(d)),o.progressBar&&(f.addClass(o.progressClass),l.prepend(f)),o.rtl&&l.addClass("rtl"),o.newestOnTop?t.prepend(l):t.append(l),function(){var t="";switch(e.iconClass){case"toast-success":case"toast-info":t="polite";break;default:t="assertive"}l.attr("aria-live",t)}(),l.hide(),l[o.showMethod]({duration:o.showDuration,easing:o.showEasing,complete:o.onShown}),o.timeOut>0&&(s=setTimeout(w,o.timeOut),m.maxHideTime=parseFloat(o.timeOut),m.hideEta=(new Date).getTime()+m.maxHideTime,o.progressBar&&(m.intervalId=setInterval(E,10))),o.closeOnHover&&l.hover(L,x),!o.onclick&&o.tapToDismiss&&l.click(w),o.closeButton&&d&&d.click((function(t){t.stopPropagation?t.stopPropagation():void 0!==t.cancelBubble&&!0!==t.cancelBubble&&(t.cancelBubble=!0),o.onCloseClick&&o.onCloseClick(t),w(!0)})),o.onclick&&l.click((function(t){o.onclick(t),w()})),p(v),o.debug&&console&&console.log(v);var _=l[0];return _._ux_remove=function(){x()},_}function b(t){return null==t&&(t=""),t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function w(t){var e=t&&!1!==o.closeMethod?o.closeMethod:o.hideMethod,r=t&&!1!==o.closeDuration?o.closeDuration:o.hideDuration,i=t&&!1!==o.closeEasing?o.closeEasing:o.hideEasing;if(!n(":focus",l).length||t)return clearTimeout(m.intervalId),l[e]({duration:r,easing:i,complete:function(){y(l),clearTimeout(s),o.onHidden&&"hidden"!==v.state&&o.onHidden(),v.state="hidden",v.endTime=new Date,p(v)}})}function x(){(o.timeOut>0||o.extendedTimeOut>0)&&(s=setTimeout(w,o.extendedTimeOut),m.maxHideTime=parseFloat(o.extendedTimeOut),m.hideEta=(new Date).getTime()+m.maxHideTime)}function L(){clearTimeout(s),m.hideEta=0,l.stop(!0,!0)[o.showMethod]({duration:o.showDuration,easing:o.showEasing})}function E(){var t=(m.hideEta-(new Date).getTime())/m.maxHideTime*100;f.width(t+"%")}}function g(){return n.extend({},{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:void 0,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:void 0,closeMethod:!1,closeDuration:!1,closeEasing:!1,closeOnHover:!0,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning",loading:"toast-loading"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",escapeHtml:!1,target:"body",closeHtml:'<button type="button">&times;</button>',closeClass:"toast-close-button",newestOnTop:!0,preventDuplicates:!1,progressBar:!1,progressClass:"toast-progress",rtl:!1},c.options)}function y(e){t||(t=h()),e.is(":visible")||(e.remove(),e=null,0===t.children().length&&(t.remove(),r=void 0))}}()},34:function(t,e){!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=58)}([function(t,e,n){var r=n(126);t.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}},function(t,e,n){"use strict";function r(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return 0!==n.id&&!n.id||(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function i(t,e,n){return void 0===n&&(n={}),r({type:"Point",coordinates:t},e,n)}function o(t,e,n){void 0===n&&(n={});for(var i=0,o=t;i<o.length;i++){var a=o[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:t},e,n)}function a(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:t},e,n)}function s(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function l(t,e,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:t},e,n)}function u(t,e,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:t},e,n)}function c(t,e,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:t},e,n)}function h(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t*r}function f(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t/r}function p(t){return t%(2*Math.PI)*180/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)&&!/^\s*$/.test(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius/1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1/1.0936},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=r,e.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return i(e).geometry;case"LineString":return a(e).geometry;case"Polygon":return o(e).geometry;case"MultiPoint":return u(e).geometry;case"MultiLineString":return l(e).geometry;case"MultiPolygon":return c(e).geometry;default:throw new Error(t+" is invalid")}},e.point=i,e.points=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return i(t,e)})),n)},e.polygon=o,e.polygons=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return o(t,e)})),n)},e.lineString=a,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return a(t,e)})),n)},e.featureCollection=s,e.multiLineString=l,e.multiPoint=u,e.multiPolygon=c,e.geometryCollection=function(t,e,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:t},e,n)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(0<=e))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=h,e.lengthToRadians=f,e.lengthToDegrees=function(t,e){return p(f(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=p,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(0<=t))throw new Error("length must be a positive number");return h(f(t,e),n)},e.convertArea=function(t,n,r){if(void 0===n&&(n="meters"),void 0===r&&(r="kilometers"),!(0<=t))throw new Error("area must be a positive number");var i=e.areaFactors[n];if(!i)throw new Error("invalid original units");var o=e.areaFactors[r];if(!o)throw new Error("invalid final units");return t/i*o},e.isNumber=d,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!d(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")},e.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},e.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},e.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},e.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},e.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},e.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},e.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,n){var r=n(28),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);function i(t,e,n,r,i,o,a,s){var l,u,c,h,f={x:null,y:null,onLine1:!1,onLine2:!1};return 0==(l=(s-o)*(n-t)-(a-i)*(r-e))?null!==f.x&&null!==f.y&&f:(h=(n-t)*(u=e-o)-(r-e)*(c=t-i),u=((a-i)*u-(s-o)*c)/l,c=h/l,f.x=t+u*(n-t),f.y=e+u*(r-e),0<=u&&u<=1&&(f.onLine1=!0),0<=c&&c<=1&&(f.onLine2=!0),!(!f.onLine1||!f.onLine2)&&[f.x,f.y])}e.default=function(t){var e,n,o={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach((function(t){e.forEach((function(e){for(var n=0;n<t.length-1;n++)for(var a=n;a<e.length-1;a++){if(t===e){if(1===Math.abs(n-a))continue;if(0===n&&a===t.length-2&&t[n][0]===t[t.length-1][0]&&t[n][1]===t[t.length-1][1])continue}var s=i(t[n][0],t[n][1],t[n+1][0],t[n+1][1],e[a][0],e[a][1],e[a+1][0],e[a+1][1]);s&&o.features.push(r.point([s[0],s[1]]))}}))})),o}},function(t,e,n){var r=n(16),i=n(74),o=n(75),a=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?i(t):o(t)}},function(t,e,n){var r=n(62),i=n(63),o=n(64),a=n(65),s=n(66);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,t.exports=l},function(t,e,n){var r=n(10);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(14)(Object,"create");t.exports=r},function(t,e,n){var r=n(88);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&2<=t.length&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(1<e.length&&r.isNumber(e[0])&&r.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,i=t.features;r<i.length;r++){var o=i[r];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+o.geometry.type)}},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},function(t,e,n){var r=n(72),i=n(79);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},function(t,e,n){var r=n(7),i=n(2);t.exports=function(t){if(!i(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,n){var r=n(3).Symbol;t.exports=r},function(t,e,n){var r=n(31);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){var r=n(103),i=n(4),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(t){return i(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=l},function(t,e,n){var r=n(15),i=n(21);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},function(t,e){t.exports=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}},function(t,e){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&n.test(t))&&-1<t&&t%1==0&&t<e}},function(t,e,n){var r=n(7),i=n(4);t.exports=function(t){return"symbol"==typeof t||i(t)&&"[object Symbol]"==r(t)}},function(t,e,n){!function(t){"use strict";function e(t,e){return e<t?1:t<e?-1:0}var n=function(t,n){void 0===t&&(t=e),void 0===n&&(n=!1),this._compare=t,this._root=null,this._size=0,this._noDuplicates=!!n},r={size:{configurable:!0}};function i(t,e,n){null===e?(t.inOut=!1,t.otherInOut=!0):(t.isSubject===e.isSubject?(t.inOut=!e.inOut,t.otherInOut=e.otherInOut):(t.inOut=!e.otherInOut,t.otherInOut=e.isVertical()?!e.inOut:e.inOut),e&&(t.prevInResult=!o(e,n)||e.isVertical()?e.prevInResult:e)),t.inResult=o(t,n)}function o(t,e){switch(t.type){case 0:switch(e){case 0:return!t.otherInOut;case 1:return t.otherInOut;case 2:return t.isSubject&&t.otherInOut||!t.isSubject&&!t.otherInOut;case 3:return!0}break;case 2:return 0===e||1===e;case 3:return 2===e;case 1:return!1}return!1}n.prototype.rotateLeft=function(t){var e=t.right;e&&(t.right=e.left,e.left&&(e.left.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.left=t),t.parent=e},n.prototype.rotateRight=function(t){var e=t.left;e&&(t.left=e.right,e.right&&(e.right.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.right=t),t.parent=e},n.prototype._splay=function(t){for(var e=this;t.parent;){var n=t.parent;n.parent?n.left===t&&n.parent.left===n?(e.rotateRight(n.parent),e.rotateRight(n)):n.right===t&&n.parent.right===n?(e.rotateLeft(n.parent),e.rotateLeft(n)):n.left===t&&n.parent.right===n?(e.rotateRight(n),e.rotateLeft(n)):(e.rotateLeft(n),e.rotateRight(n)):n.left===t?e.rotateRight(n):e.rotateLeft(n)}},n.prototype.splay=function(t){for(var e,n,r,i,o;t.parent;)(n=(e=t.parent).parent)&&n.parent?((r=n.parent).left===n?r.left=t:r.right=t,t.parent=r):(t.parent=null,this._root=t),i=t.left,o=t.right,t===e.left?(n&&(n.left===e?(e.right?(n.left=e.right,n.left.parent=n):n.left=null,(e.right=n).parent=e):(i?(n.right=i).parent=n:n.right=null,(t.left=n).parent=t)),o?(e.left=o).parent=e:e.left=null,(t.right=e).parent=t):(n&&(n.right===e?(e.left?(n.right=e.left,n.right.parent=n):n.right=null,(e.left=n).parent=e):(o?(n.left=o).parent=n:n.left=null,(t.right=n).parent=t)),i?(e.right=i).parent=e:e.right=null,(t.left=e).parent=t)},n.prototype.replace=function(t,e){t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.parent=t.parent)},n.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},n.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},n.prototype.insert=function(t,e){var n=this._root,r=null,i=this._compare;if(this._noDuplicates)for(;n;){if(0===i((r=n).key,t))return;n=i(n.key,t)<0?n.right:n.left}else for(;n;)n=i((r=n).key,t)<0?n.right:n.left;return n={key:t,data:e,left:null,right:null,parent:r},r?i(r.key,n.key)<0?r.right=n:r.left=n:this._root=n,this.splay(n),this._size++,n},n.prototype.find=function(t){for(var e=this._root,n=this._compare;e;){var r=n(e.key,t);if(r<0)e=e.right;else{if(!(0<r))return e;e=e.left}}return null},n.prototype.contains=function(t){for(var e=this._root,n=this._compare;e;){var r=n(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1},n.prototype.remove=function(t){var e=this.find(t);if(!e)return!1;if(this.splay(e),e.left)if(e.right){var n=this.minNode(e.right);n.parent!==e&&(this.replace(n,n.right),n.right=e.right,n.right.parent=n),this.replace(e,n),n.left=e.left,n.left.parent=n}else this.replace(e,e.left);else this.replace(e,e.right);return this._size--,!0},n.prototype.removeNode=function(t){if(!t)return!1;if(this.splay(t),t.left)if(t.right){var e=this.minNode(t.right);e.parent!==t&&(this.replace(e,e.right),e.right=t.right,e.right.parent=e),this.replace(t,e),e.left=t.left,e.left.parent=e}else this.replace(t,t.left);else this.replace(t,t.right);return this._size--,!0},n.prototype.erase=function(t){var e=this.find(t);if(e){this.splay(e);var n=e.left,r=e.right,i=null;n&&(n.parent=null,i=this.maxNode(n),this.splay(i),this._root=i),r&&(n?i.right=r:this._root=r,r.parent=i),this._size--}},n.prototype.pop=function(){var t=this._root,e=null;if(t){for(;t.left;)t=t.left;e={key:t.key,data:t.data},this.remove(t.key)}return e},n.prototype.next=function(t){var e=t;if(e)if(e.right)for(e=e.right;e&&e.left;)e=e.left;else for(e=t.parent;e&&e.right===t;)e=(t=e).parent;return e},n.prototype.prev=function(t){var e=t;if(e)if(e.left)for(e=e.left;e&&e.right;)e=e.right;else for(e=t.parent;e&&e.left===t;)e=(t=e).parent;return e},n.prototype.forEach=function(t){for(var e=this._root,n=[],r=!1,i=0;!r;)e?(n.push(e),e=e.left):0<n.length?(t(e=n.pop(),i++),e=e.right):r=!0;return this},n.prototype.range=function(t,e,n,r){for(var i=[],o=this._compare,a=this._root;0!==i.length||a;)if(a)i.push(a),a=a.left;else{if(0<o((a=i.pop()).key,e))break;if(0<=o(a.key,t)&&n.call(r,a))return this;a=a.right}return this},n.prototype.keys=function(){for(var t=this._root,e=[],n=[],r=!1;!r;)t?(e.push(t),t=t.left):0<e.length?(t=e.pop(),n.push(t.key),t=t.right):r=!0;return n},n.prototype.values=function(){for(var t=this._root,e=[],n=[],r=!1;!r;)t?(e.push(t),t=t.left):0<e.length?(t=e.pop(),n.push(t.data),t=t.right):r=!0;return n},n.prototype.at=function(t){for(var e=this._root,n=[],r=!1,i=0;!r;)if(e)n.push(e),e=e.left;else if(0<n.length){if(e=n.pop(),i===t)return e;i++,e=e.right}else r=!0;return null},n.prototype.load=function(t,e,n){if(void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===n&&(n=!1),0!==this._size)throw new Error("bulk-load: tree is not empty");var r=t.length;return n&&function t(e,n,r,i,o){if(!(i<=r)){for(var a=e[r+i>>1],s=r-1,l=i+1;;){for(;o(e[++s],a)<0;);for(;0<o(e[--l],a););if(l<=s)break;var u=e[s];e[s]=e[l],e[l]=u,u=n[s],n[s]=n[l],n[l]=u}t(e,n,r,l,o),t(e,n,l+1,i,o)}}(t,e,0,r-1,this._compare),this._root=function t(e,n,r,i,o){var a=o-i;if(0<a){var s=i+Math.floor(a/2),l={key:n[s],data:r[s],parent:e};return l.left=t(l,n,r,i,s),l.right=t(l,n,r,s+1,o),l}return null}(null,t,e,0,r),this._size=r,this},n.prototype.min=function(){var t=this.minNode(this._root);return t?t.key:null},n.prototype.max=function(){var t=this.maxNode(this._root);return t?t.key:null},n.prototype.isEmpty=function(){return null===this._root},r.size.get=function(){return this._size},n.createTree=function(t,e,r,i,o){return new n(r,o).load(t,e,i)},Object.defineProperties(n.prototype,r);var a=function(t,e,n,r,i){this.left=e,this.point=t,this.otherEvent=n,this.isSubject=r,this.type=i||0,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.inResult=!1,this.resultInOut=!1,this.isExteriorRing=!0};function s(t,e){return t[0]===e[0]&&t[1]===e[1]}function l(t,e,n){return(t[0]-n[0])*(e[1]-n[1])-(e[0]-n[0])*(t[1]-n[1])}function u(t,e){var n=t.point,r=e.point;return n[0]>r[0]?1:n[0]<r[0]?-1:n[1]!==r[1]?n[1]>r[1]?1:-1:function(t,e,n,r){return t.left===e.left?0===l(n,t.otherEvent.point,e.otherEvent.point)?!t.isSubject&&e.isSubject?1:-1:t.isBelow(e.otherEvent.point)?-1:1:t.left?1:-1}(t,e,n)}function c(t,e,n){var r=new a(e,!1,t,t.isSubject),i=new a(e,!0,t.otherEvent,t.isSubject);return s(t.point,t.otherEvent.point)&&console.warn("what is that, a collapsed segment?",t),r.contourId=i.contourId=t.contourId,0<u(i,t.otherEvent)&&(t.otherEvent.left=!0,i.left=!1),t.otherEvent.otherEvent=i,t.otherEvent=r,n.push(i),n.push(r),n}function h(t,e){return t[0]*e[1]-t[1]*e[0]}function f(t,e){return t[0]*e[0]+t[1]*e[1]}function p(t,e,n){var r=function(t,e,n,r,i){var o=[e[0]-t[0],e[1]-t[1]],a=[r[0]-n[0],r[1]-n[1]];function s(t,e,n){return[t[0]+e*n[0],t[1]+e*n[1]]}var l=[n[0]-t[0],n[1]-t[1]],u=h(o,a),c=u*u,p=f(o,o);if(0<c){var d=h(l,a)/u;if(d<0||1<d)return null;var g=h(l,o)/u;return g<0||1<g?null:0==d||1==d?[s(t,d,o)]:0==g||1==g?[s(n,g,a)]:[s(t,d,o)]}if(0<(c=(u=h(l,o))*u))return null;var y=f(o,l)/p,m=y+f(o,a)/p,v=Math.min(y,m),_=Math.max(y,m);return v<=1&&0<=_?1===v?[s(t,0<v?v:0,o)]:0===_?[s(t,_<1?_:1,o)]:[s(t,0<v?v:0,o),s(t,_<1?_:1,o)]:null}(t.point,t.otherEvent.point,e.point,e.otherEvent.point),i=r?r.length:0;if(0===i)return 0;if(1===i&&(s(t.point,e.point)||s(t.otherEvent.point,e.otherEvent.point)))return 0;if(2===i&&t.isSubject===e.isSubject)return 0;if(1===i)return s(t.point,r[0])||s(t.otherEvent.point,r[0])||c(t,r[0],n),s(e.point,r[0])||s(e.otherEvent.point,r[0])||c(e,r[0],n),1;var o=[],a=!1,l=!1;return s(t.point,e.point)?a=!0:1===u(t,e)?o.push(e,t):o.push(t,e),s(t.otherEvent.point,e.otherEvent.point)?l=!0:1===u(t.otherEvent,e.otherEvent)?o.push(e.otherEvent,t.otherEvent):o.push(t.otherEvent,e.otherEvent),a&&l||a?(e.type=1,t.type=e.inOut===t.inOut?2:3,a&&!l&&c(o[1].otherEvent,o[0].point,n),2):(l?c(o[0],o[1].point,n):o[0]!==o[3].otherEvent?(c(o[0],o[1].point,n),c(o[1],o[2].point,n)):(c(o[0],o[1].point,n),c(o[3].otherEvent,o[2].point,n)),3)}function d(t,e){if(t===e)return 0;if(0!==l(t.point,t.otherEvent.point,e.point)||0!==l(t.point,t.otherEvent.point,e.otherEvent.point))return s(t.point,e.point)?t.isBelow(e.otherEvent.point)?-1:1:t.point[0]===e.point[0]?t.point[1]<e.point[1]?-1:1:1===u(t,e)?e.isAbove(t.point)?-1:1:t.isBelow(e.point)?-1:1;if(t.isSubject!==e.isSubject)return t.isSubject?-1:1;var n=t.point,r=e.point;return n[0]===r[0]&&n[1]===r[1]?(n=t.otherEvent.point,r=e.otherEvent.point,n[0]===r[0]&&n[1]===r[1]?0:t.contourId>e.contourId?1:-1):1===u(t,e)?1:-1}function g(t,e,n,r){var i=t+1,o=e.length;if(o-1<i)return t-1;for(var a=e[t].point,s=e[i].point;i<o&&s[0]===a[0]&&s[1]===a[1];){if(!n[i])return i;s=e[++i].point}for(i=t-1;n[i]&&r<=i;)i--;return i}a.prototype.isBelow=function(t){var e=this.point,n=this.otherEvent.point;return this.left?0<(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1]):0<(n[0]-t[0])*(e[1]-t[1])-(e[0]-t[0])*(n[1]-t[1])},a.prototype.isAbove=function(t){return!this.isBelow(t)},a.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},a.prototype.clone=function(){var t=new a(this.point,this.left,this.otherEvent,this.isSubject,this.type);return t.inResult=this.inResult,t.prevInResult=this.prevInResult,t.isExteriorRing=this.isExteriorRing,t.inOut=this.inOut,t.otherInOut=this.otherInOut,t};var y=v,m=v;function v(t,e){if(!(this instanceof v))return new v(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||_,0<this.length)for(var n=(this.length>>1)-1;0<=n;n--)this._down(n)}function _(t,e){return t<e?-1:e<t?1:0}v.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,0<this.length&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,r=e[t];0<t;){var i=t-1>>1,o=e[i];if(0<=n(r,o))break;e[t]=o,t=i}e[t]=r},_down:function(t){for(var e=this.data,n=this.compare,r=this.length>>1,i=e[t];t<r;){var o=1+(t<<1),a=o+1,s=e[o];if(a<this.length&&n(e[a],s)<0&&(s=e[o=a]),0<=n(s,i))break;e[t]=s,t=o}e[t]=i}},y.default=m;var b=Math.max,w=Math.min,x=0;function L(t,e,n,r,i,o){var s,l,c,h,f,p;for(s=0,l=t.length-1;s<l;s++)if(c=t[s],h=t[s+1],f=new a(c,!1,void 0,e),p=new a(h,!1,f,e),f.otherEvent=p,c[0]!==h[0]||c[1]!==h[1]){f.contourId=p.contourId=n,o||(f.isExteriorRing=!1,p.isExteriorRing=!1),0<u(f,p)?p.left=!0:f.left=!0;var d=c[0],g=c[1];i[0]=w(i[0],d),i[1]=w(i[1],g),i[2]=b(i[2],d),i[3]=b(i[3],g),r.push(f),r.push(p)}}var E=[];function C(t,e,r){"number"==typeof t[0][0][0]&&(t=[t]),"number"==typeof e[0][0][0]&&(e=[e]);var o=function(t,e,n){var r=null;return t.length*e.length==0&&(0===n?r=E:2===n?r=t:1!==n&&3!==n||(r=0===t.length?e:t)),r}(t,e,r);if(o)return o===E?null:o;var a=[1/0,1/0,-1/0,-1/0],s=[1/0,1/0,-1/0,-1/0],l=function(t,e,n,r,i){var o,a,s,l,c,h,f=new y(null,u);for(s=0,l=t.length;s<l;s++)for(c=0,h=(o=t[s]).length;c<h;c++)(a=0===c)&&x++,L(o[c],!0,x,f,n,a);for(s=0,l=e.length;s<l;s++)for(c=0,h=(o=e[s]).length;c<h;c++)a=0===c,2===i&&(a=!1),a&&x++,L(o[c],!1,x,f,r,a);return f}(t,e,a,s,r);return(o=function(t,e,n,r,i){var o=null;return(n[0]>r[2]||r[0]>n[2]||n[1]>r[3]||r[1]>n[3])&&(0===i?o=E:2===i?o=t:1!==i&&3!==i||(o=t.concat(e))),o}(t,e,a,s,r))?o===E?null:o:function(t,e){var n,r,i,o=function(t){var e,n,r,i,o=[];for(n=0,r=t.length;n<r;n++)((e=t[n]).left&&e.inResult||!e.left&&e.otherEvent.inResult)&&o.push(e);for(var a=!1;!a;)for(a=!0,n=0,r=o.length;n<r;n++)n+1<r&&1===u(o[n],o[n+1])&&(i=o[n],o[n]=o[n+1],o[n+1]=i,a=!1);for(n=0,r=o.length;n<r;n++)(e=o[n]).pos=n;for(n=0,r=o.length;n<r;n++)(e=o[n]).left||(i=e.pos,e.pos=e.otherEvent.pos,e.otherEvent.pos=i);return o}(t),a={},s=[];for(n=0,r=o.length;n<r;n++)if(!a[n]){var l=[[]];o[n].isExteriorRing?2===e&&!o[n].isSubject&&1<s.length?s[s.length-1].push(l[0]):s.push(l):2!==e||o[n].isSubject||0!==s.length?0===s.length?s.push([[l]]):s[s.length-1].push(l[0]):s.push(l);var c=s.length-1,h=n,f=o[n].point;for(l[0].push(f);n<=h;)i=o[h],a[h]=!0,i.left?(i.resultInOut=!1,i.contourId=c):(i.otherEvent.resultInOut=!0,i.otherEvent.contourId=c),a[h=i.pos]=!0,l[0].push(o[h].point),h=g(h,o,a,n);i=o[h=-1===h?n:h],a[h]=a[i.pos]=!0,i.otherEvent.resultInOut=!0,i.otherEvent.contourId=c}return s}(function(t,e,r,o,a,s){for(var l,u,c,h=new n(d),f=[],g=Math.min(o[2],a[2]);0!==t.length;){var y=t.pop();if(f.push(y),0===s&&y.point[0]>g||2===s&&y.point[0]>o[2])break;if(y.left){u=l=h.insert(y),l=l!==(c=h.minNode())?h.prev(l):null,u=h.next(u);var m=l?l.key:null;if(i(y,m,s),u&&2===p(y,u.key,t)&&(i(y,m,s),i(y,u.key,s)),l&&2===p(l.key,y,t)){var v=l;i(m,(v=v!==c?h.prev(v):null)?v.key:null,s),i(y,m,s)}}else y=y.otherEvent,u=l=h.find(y),l&&u&&(l=l!==c?h.prev(l):null,u=h.next(u),h.remove(y),u&&l&&p(l.key,u.key,t))}return f}(l,0,0,a,s,r),r)}t.union=function(t,e){return C(t,e,1)},t.diff=function(t,e){return C(t,e,2)},t.xor=function(t,e){return C(t,e,3)},t.intersection=function(t,e){return C(t,e,0)},t.operations={UNION:1,DIFFERENCE:2,INTERSECTION:0,XOR:3},Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);function i(t,e,n){if(null!==t)for(var r,o,a,s,l,u,c,h,f=0,p=0,d=t.type,g="FeatureCollection"===d,y="Feature"===d,m=g?t.features.length:1,v=0;v<m;v++){l=(h=!!(c=g?t.features[v].geometry:y?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var _=0;_<l;_++){var b=0,w=0;if(null!==(s=h?c.geometries[_]:c)){u=s.coordinates;var x=s.type;switch(f=!n||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(u,p,v,b,w))return!1;p++,b++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(!1===e(u[r],p,v,b,w))return!1;p++,"MultiPoint"===x&&b++}"LineString"===x&&b++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(o=0;o<u[r].length-f;o++){if(!1===e(u[r][o],p,v,b,w))return!1;p++}"MultiLineString"===x&&b++,"Polygon"===x&&w++}"Polygon"===x&&b++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(o=w=0;o<u[r].length;o++){for(a=0;a<u[r][o].length-f;a++){if(!1===e(u[r][o][a],p,v,b,w))return!1;p++}w++}b++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===i(s.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function a(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function s(t,e){var n,r,i,o,a,s,l,u,c,h,f=0,p="FeatureCollection"===t.type,d="Feature"===t.type,g=p?t.features.length:1;for(n=0;n<g;n++){for(s=p?t.features[n].geometry:d?t.geometry:t,u=p?t.features[n].properties:d?t.properties:{},c=p?t.features[n].bbox:d?t.bbox:void 0,h=p?t.features[n].id:d?t.id:void 0,a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=l?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,u,c,h))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],f,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,u,c,h))return!1;f++}}function l(t,e){s(t,(function(t,n,i,o,a){var s,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(r.feature(t,i,{bbox:o,id:a}),n,0)&&void 0}switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c={type:s,coordinates:t.coordinates[u]};if(!1===e(r.feature(c,i),n,u))return!1}}))}function u(t,e){l(t,(function(t,n,o){var a=0;if(t.geometry){var s=t.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var l,u=0,c=0,h=0;return!1!==i(t,(function(i,s,f,p,d){if(void 0===l||u<n||c<p||h<d)return l=i,u=n,c=p,h=d,void(a=0);var g=r.lineString([l,i],t.properties);if(!1===e(g,n,o,d,a))return!1;a++,l=i}))&&void 0}}}))}function c(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,n,i){if(null!==t.geometry){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,i,0,0))return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(!1===e(r.lineString(a[s],t.properties),n,i,s))return!1}}}))}e.coordEach=i,e.coordReduce=function(t,e,n,r){var o=n;return i(t,(function(t,r,i,a,s){o=0===r&&void 0===n?t:e(o,t,r,i,a,s)}),r),o},e.propEach=o,e.propReduce=function(t,e,n){var r=n;return o(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.featureEach=a,e.featureReduce=function(t,e,n){var r=n;return a(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.coordAll=function(t){var e=[];return i(t,(function(t){e.push(t)})),e},e.geomEach=s,e.geomReduce=function(t,e,n){var r=n;return s(t,(function(t,i,o,a,s){r=0===i&&void 0===n?t:e(r,t,i,o,a,s)})),r},e.flattenEach=l,e.flattenReduce=function(t,e,n){var r=n;return l(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r},e.segmentEach=u,e.segmentReduce=function(t,e,n){var r=n,i=!1;return u(t,(function(t,o,a,s,l){r=!1===i&&void 0===n?t:e(r,t,o,a,s,l),i=!0})),r},e.lineEach=c,e.lineReduce=function(t,e,n){var r=n;return c(t,(function(t,i,o,a){r=0===i&&void 0===n?t:e(r,t,i,o,a)})),r},e.findSegment=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,a=e.geometryIndex||0,s=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=u.length+s-1),r.lineString([u[s],u[s+1]],l,e);case"Polygon":return a<0&&(a=u.length+a),s<0&&(s=u[a].length+s-1),r.lineString([u[a][s],u[a][s+1]],l,e);case"MultiLineString":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s-1),r.lineString([u[o][s],u[o][s+1]],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),s<0&&(s=u[o][a].length-s-1),r.lineString([u[o][a][s],u[o][a][s+1]],l,e)}throw new Error("geojson is invalid")},e.findPoint=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,a=e.geometryIndex||0,s=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return r.point(u,l,e);case"MultiPoint":return o<0&&(o=u.length+o),r.point(u[o],l,e);case"LineString":return s<0&&(s=u.length+s),r.point(u[s],l,e);case"Polygon":return a<0&&(a=u.length+a),s<0&&(s=u[a].length+s),r.point(u[a][s],l,e);case"MultiLineString":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),r.point(u[o][s],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),s<0&&(s=u[o][a].length-s),r.point(u[o][a][s],l,e)}throw new Error("geojson is invalid")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(25),i=6378137;function o(t){var e=0;if(t&&0<t.length){e+=Math.abs(a(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(a(t[n]))}return e}function a(t){var e,n,r,o,a,l,u=0,c=t.length;if(2<c){for(l=0;l<c;l++)a=l===c-2?(r=c-2,o=c-1,0):l===c-1?(r=c-1,o=0,1):(o=(r=l)+1,l+2),e=t[r],n=t[o],u+=(s(t[a][0])-s(e[0]))*Math.sin(s(n[1]));u=u*i*i/2}return u}function s(t){return t*Math.PI/180}e.default=function(t){return r.geomReduce(t,(function(t,e){return t+function(t){var e,n=0;switch(t.type){case"Polygon":return o(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=o(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}},function(t,e,n){var r=n(14)(n(3),"Map");t.exports=r},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(73))},function(t,e,n){var r=n(80),i=n(87),o=n(89),a=n(90),s=n(91);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,t.exports=l},function(t,e,n){var r=n(17),i=n(10);t.exports=function(t,e,n){(void 0===n||i(t[e],n))&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e,n){var r=n(14),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},function(t,e,n){var r=n(102)(Object.getPrototypeOf,Object);t.exports=r},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){(function(t){var r=n(3),i=n(105),o=e&&!e.nodeType&&e,a=o&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===o?r.Buffer:void 0,l=(s?s.isBuffer:void 0)||i;t.exports=l}).call(this,n(18)(t))},function(t,e,n){var r=n(107),i=n(108),o=n(109),a=o&&o.isTypedArray,s=a?i(a):r;t.exports=s},function(t,e){t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},function(t,e,n){var r=n(113),i=n(115),o=n(20);t.exports=function(t){return o(t)?r(t,!0):i(t)}},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r=n(5),i=n(127),o=n(128),a=n(131);t.exports=function(t,e){return r(t)?t:i(t,e)?[t]:o(a(t))}},function(t,e,n){var r=n(23);t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},function(t){t.exports=JSON.parse('{"a":"2.5.0"}')},function(t,e,n){var r=n(60),i=n(117)((function(t,e,n){r(t,e,n)}));t.exports=i},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Click to place marker","firstVertex":"Click to place first vertex","continueLine":"Click to continue drawing","finishLine":"Click any existing marker to finish","finishPoly":"Click first marker to finish","finishRect":"Click to finish","startCircle":"Click to place circle center","finishCircle":"Click to finish circle","placeCircleMarker":"Click to place circle marker"},"actions":{"finish":"Finish","cancel":"Cancel","removeLastVertex":"Remove Last Vertex"},"buttonTitles":{"drawMarkerButton":"Draw Marker","drawPolyButton":"Draw Polygons","drawLineButton":"Draw Polyline","drawCircleButton":"Draw Circle","drawRectButton":"Draw Rectangle","editButton":"Edit Layers","dragButton":"Drag Layers","cutButton":"Cut Layers","deleteButton":"Remove Layers","drawCircleMarkerButton":"Draw Circle Marker","snappingButton":"Snap dragged marker to other layers and vertices","pinningButton":"Pin shared vertices together"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Platziere den Marker mit Klick","firstVertex":"Platziere den ersten Marker mit Klick","continueLine":"Klicke, um weiter zu zeichnen","finishLine":"Beende mit Klick auf existierenden Marker","finishPoly":"Beende mit Klick auf ersten Marker","finishRect":"Beende mit Klick","startCircle":"Platziere das Kreiszentrum mit Klick","finishCircle":"Beende den Kreis mit Klick","placeCircleMarker":"Platziere den Kreismarker mit Klick"},"actions":{"finish":"Beenden","cancel":"Abbrechen","removeLastVertex":"Letzten Vertex lschen"},"buttonTitles":{"drawMarkerButton":"Marker zeichnen","drawPolyButton":"Polygon zeichnen","drawLineButton":"Polyline zeichnen","drawCircleButton":"Kreis zeichnen","drawRectButton":"Rechteck zeichnen","editButton":"Layer editieren","dragButton":"Layer bewegen","cutButton":"Layer schneiden","deleteButton":"Layer lschen","drawCircleMarkerButton":"Kreismarker zeichnen"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Clicca per posizionare un Marker","firstVertex":"Clicca per posizionare il primo vertice","continueLine":"Clicca per continuare a disegnare","finishLine":"Clicca qualsiasi marker esistente per terminare","finishPoly":"Clicca il primo marker per terminare","finishRect":"Clicca per terminare","startCircle":"Clicca per posizionare il punto centrale del cerchio","finishCircle":"Clicca per terminare il cerchio","placeCircleMarker":"Clicca per posizionare un Marker del cherchio"},"actions":{"finish":"Termina","cancel":"Annulla","removeLastVertex":"Rimuovi l\'ultimo vertice"},"buttonTitles":{"drawMarkerButton":"Disegna Marker","drawPolyButton":"Disegna Poligoni","drawLineButton":"Disegna Polilinea","drawCircleButton":"Disegna Cerchio","drawRectButton":"Disegna Rettangolo","editButton":"Modifica Livelli","dragButton":"Sposta Livelli","cutButton":"Ritaglia Livelli","deleteButton":"Elimina Livelli","drawCircleMarkerButton":"Disegna Marker del Cherchio"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Klik untuk menempatkan marker","firstVertex":"Klik untuk menempatkan vertex pertama","continueLine":"Klik untuk meneruskan digitasi","finishLine":"Klik pada sembarang marker yang ada untuk mengakhiri","finishPoly":"Klik marker pertama untuk mengakhiri","finishRect":"Klik untuk mengakhiri","startCircle":"Klik untuk menempatkan titik pusat lingkaran","finishCircle":"Klik untuk mengakhiri lingkaran"},"actions":{"finish":"Selesai","cancel":"Batal","removeLastVertex":"Hilangkan Vertex Terakhir"},"buttonTitles":{"drawMarkerButton":"Digitasi Marker","drawPolyButton":"Digitasi Polygon","drawLineButton":"Digitasi Polyline","drawCircleButton":"Digitasi Lingkaran","drawRectButton":"Digitasi Segi Empat","editButton":"Edit Layer","dragButton":"Geser Layer","cutButton":"Potong Layer","deleteButton":"Hilangkan Layer"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Adaug un punct","firstVertex":"Apas aici pentru a aduga primul Vertex","continueLine":"Apas aici pentru a continua desenul","finishLine":"Apas pe orice obiect pentru a finisa desenul","finishPoly":"Apas pe primul obiect pentru a finisa","finishRect":"Apas pentru a finisa","startCircle":"Apas pentru a desena un cerc","finishCircle":"Apas pentru a finisa un cerc","placeCircleMarker":"Adaug un punct"},"actions":{"finish":"Termin","cancel":"Anuleaz","removeLastVertex":"terge ultimul Vertex"},"buttonTitles":{"drawMarkerButton":"Adaug o bulin","drawPolyButton":"Deseneaz un poligon","drawLineButton":"Deseneaz o linie","drawCircleButton":"Deseneaz un cerc","drawRectButton":"Deseneaz un dreptunghi","editButton":"Editeaz straturile","dragButton":"Mut straturile","cutButton":"Taie straturile","deleteButton":"terge straturile","placeCircleMarker":"Adaug o bulin"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":",   ","firstVertex":",    ","continueLine":",   ","finishLine":"     ","finishPoly":"  ,  ","finishRect":",  ","startCircle":"   ","finishCircle":"   ","placeCircleMarker":"Click to place circle marker"},"actions":{"finish":"","cancel":"","removeLastVertex":"    "},"buttonTitles":{"drawMarkerButton":" ","drawPolyButton":" ","drawLineButton":" ","drawCircleButton":" ","drawRectButton":" ","editButton":" ","dragButton":" ","cutButton":" ","deleteButton":" ","placeCircleMarker":",   "}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Presiona para colocar un marcador","firstVertex":"Presiona para colocar el primer vrtice","continueLine":"Presiona para continuar dibujando","finishLine":"Presiona cualquier marcador existente para finalizar","finishPoly":"Presiona el primer marcador para finalizar","finishRect":"Presiona para finalizar","startCircle":"Presiona para colocar el centro del circulo","finishCircle":"Presiona para finalizar el circulo","placeCircleMarker":"Presiona para colocar un marcador de circulo"},"actions":{"finish":"Finalizar","cancel":"Cancelar","removeLastVertex":"Remover ultimo vrtice"},"buttonTitles":{"drawMarkerButton":"Dibujar Marcador","drawPolyButton":"Dibujar Polgono","drawLineButton":"Dibujar Lnea","drawCircleButton":"Dibujar Circulo","drawRectButton":"Dibujar Rectngulo","editButton":"Editar Capas","dragButton":"Arrastrar Capas","cutButton":"Cortar Capas","deleteButton":"Remover Capas","drawCircleMarkerButton":"Dibujar Marcador de Circulo"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Klik om een marker te plaatsen","firstVertex":"Klik om het eerste punt te plaatsen","continueLine":"Klik om te blijven tekenen","finishLine":"Klik op een bestaand punt om te beindigen","finishPoly":"Klik op het eerst punt om te beindigen","finishRect":"Klik om te beindigen","startCircle":"Klik om het middelpunt te plaatsen","finishCircle":"Klik om de cirkel te beindigen","placeCircleMarker":"Klik om een marker te plaatsen"},"actions":{"finish":"Bewaar","cancel":"Annuleer","removeLastVertex":"Verwijder laatste punt"},"buttonTitles":{"drawMarkerButton":"Plaats Marker","drawPolyButton":"Teken een vlak","drawLineButton":"Teken een lijn","drawCircleButton":"Teken een cirkel","drawRectButton":"Teken een vierkant","editButton":"Bewerk","dragButton":"Verplaats","cutButton":"Knip","deleteButton":"Verwijder","drawCircleMarkerButton":"Plaats Marker"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Cliquez pour placer un marqueur","firstVertex":"Cliquez pour placer le premier sommet","continueLine":"Cliquez pour continuer  dessiner","finishLine":"Cliquez sur n\'importe quel marqueur pour terminer","finishPoly":"Cliquez sur le premier marqueur pour terminer","finishRect":"Cliquez pour terminer","startCircle":"Cliquez pour placer le centre du cercle","finishCircle":"Cliquez pour finir le cercle"},"actions":{"finish":"Terminer","cancel":"Annuler","removeLastVertex":"Retirer le dernier sommet"},"buttonTitles":{"drawMarkerButton":"Placer des marqueurs","drawPolyButton":"Dessiner des polygones","drawLineButton":"Dessiner des polylignes","drawCircleButton":"Dessiner un cercle","drawRectButton":"Dessiner un rectangle","editButton":"diter des calques","dragButton":"Dplacer des calques","cutButton":"Couper des calques","deleteButton":"Supprimer des calques"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"","firstVertex":"","continueLine":"","finishLine":"","finishPoly":"","finishRect":"","startCircle":"","finishCircle":""},"actions":{"finish":"","cancel":"","removeLastVertex":""},"buttonTitles":{"drawMarkerButton":"","drawPolyButton":"","drawLineButton":"","drawCircleButton":"","drawRectButton":"","editButton":"","dragButton":"","cutButton":"","deleteButton":""}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Clique para posicionar o marcador","firstVertex":"Clique para posicionar o primeiro vrtice","continueLine":"Clique para continuar desenhando","finishLine":"Clique em qualquer marcador existente para finalizar","finishPoly":"Clique no primeiro ponto para fechar o polgono","finishRect":"Clique para finalizar","startCircle":"Clique para posicionar o centro do crculo","finishCircle":"Clique para fechar o crculo"},"actions":{"finish":"Finalizar","cancel":"Cancelar","removeLastVertex":"Remover ltimo vrtice"},"buttonTitles":{"drawMarkerButton":"Desenhar um marcador","drawPolyButton":"Desenhar um polgono","drawLineButton":"Desenhar uma polilinha","drawCircleButton":"Desenhar um crculo","drawRectButton":"Desenhar um retngulo","editButton":"Editar camada(s)","dragButton":"Mover camada(s)","cutButton":"Recortar camada(s)","deleteButton":"Remover camada(s)"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Kliknij, aby ustawi znacznik","firstVertex":"Kliknij, aby ustawi pierwszy punkt","continueLine":"Kliknij, aby kontynuowa rysowanie","finishLine":"Kliknij dowolny punkt, aby zakoczy","finishPoly":"Kliknij pierwszy punkt, aby zakoczy","finishRect":"Kliknij, aby zakoczy","startCircle":"Kliknij, aby ustawi rodek koa","finishCircle":"Kliknij, aby zakoczy rysowanie koa","placeCircleMarker":"Kliknij, aby ustawi okrgy znacznik"},"actions":{"finish":"Zakocz","cancel":"Anuluj","removeLastVertex":"Usu ostatni punkt"},"buttonTitles":{"drawMarkerButton":"Narysuj znacznik","drawPolyButton":"Narysuj wielokt","drawLineButton":"Narysuj ciek","drawCircleButton":"Narysuj koo","drawRectButton":"Narysuj prostokt","editButton":"Edytuj","dragButton":"Przesu","cutButton":"Wytnij","deleteButton":"Usu","drawCircleMarkerButton":"Narysuj okrgy znacznik"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Klicka fr att placera punkt","firstVertex":"Klicka fr att placera frsta vertex","continueLine":"Klicka fr att fortstta rita","finishLine":"Klicka p en existerande punkt fr att slutfra","finishPoly":"Klicka p den frsta punkten fr att slutfra","finishRect":"Klicka fr att slutfra","startCircle":"Klicka fr att placera cirkelns centrum","finishCircle":"Klicka fr att slutfra cirkeln","placeCircleMarker":"Klicka fr att placera cirkelmakr"},"actions":{"finish":"Slutfr","cancel":"Avbryt","removeLastVertex":"Ta bort sista vertex"},"buttonTitles":{"drawMarkerButton":"Rita Punkt","drawPolyButton":"Rita Rolygoner","drawLineButton":"Rita Polyline","drawCircleButton":"Rta Cirkel","drawRectButton":"Rita Rectangle","editButton":"Redigera Lager","dragButton":"Dra Lager","cutButton":"Klipp i Lager","deleteButton":"Ta bort Lager","drawCircleMarkerButton":"Rita Cirkelmakr"}}')},function(t,e,n){var r=n(134),i=n(135);t.exports=function(t,e){return null!=t&&i(t,e,r)}},function(t,e,n){"use strict";var r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(13),a=r(n(24));e.default=function t(e,n,r){void 0===r&&(r={});var s=o.getGeom(e),l=o.getGeom(n);if("Polygon"===s.type&&"Polygon"===l.type){var u=a.intersection(s.coordinates,l.coordinates);if(null===u||0===u.length)return null;if(1!==u.length)return i.multiPolygon(u,r.properties);var c=u[0][0][0],h=u[0][0][u[0][0].length-1];return c[0]===h[0]&&c[1]===h[1]?i.polygon(u[0],r.properties):null}if("MultiPolygon"===s.type){for(var f=[],p=0,d=s.coordinates;p<d.length;p++){var g=d[p],y=t(o.getGeom(i.polygon(g)),l);if(y){var m=o.getGeom(y);if("Polygon"===m.type)f.push(m.coordinates);else{if("MultiPolygon"!==m.type)throw new Error("intersection is invalid");f=f.concat(m.coordinates)}}}return 0===f.length?null:1===f.length?i.polygon(f[0],r.properties):i.multiPolygon(f,r.properties)}if("MultiPolygon"===l.type)return t(l,s);throw new Error("poly1 and poly2 must be either polygons or multiPolygons")}},function(t,e,n){t.exports=n(138)},function(t,e){Array.prototype.findIndex=Array.prototype.findIndex||function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),n=e.length>>>0,r=arguments[1],i=0;i<n;i++)if(t.call(r,e[i],i,e))return i;return-1},Array.prototype.find=Array.prototype.find||function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),n=e.length>>>0,r=arguments[1],i=0;i<n;i++){var o=e[i];if(t.call(r,o,i,e))return o}},"function"!=typeof Object.assign&&(Object.assign=function(t){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var n=arguments[e];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0==r)return!1;for(var i,o,a=0|e,s=Math.max(0<=a?a:r-Math.abs(a),0);s<r;){if((i=n[s])===(o=t)||"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))return!0;s++}return!1}})},function(t,e,n){var r=n(61),i=n(30),o=n(92),a=n(94),s=n(2),l=n(37),u=n(36);t.exports=function t(e,n,c,h,f){e!==n&&o(n,(function(o,l){if(f=f||new r,s(o))a(e,n,l,c,t,h,f);else{var p=h?h(u(e,l),o,l+"",e,n,f):void 0;void 0===p&&(p=o),i(e,l,p)}}),l)}},function(t,e,n){var r=n(8),i=n(67),o=n(68),a=n(69),s=n(70),l=n(71);function u(t){var e=this.__data__=new r(t);this.size=e.size}u.prototype.clear=i,u.prototype.delete=o,u.prototype.get=a,u.prototype.has=s,u.prototype.set=l,t.exports=u},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(9),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():i.call(e,n,1),--this.size,0))}},function(t,e,n){var r=n(9);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(9);t.exports=function(t){return-1<r(this.__data__,t)}},function(t,e,n){var r=n(9);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},function(t,e,n){var r=n(8);t.exports=function(){this.__data__=new r,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var r=n(8),i=n(27),o=n(29);t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!i||a.length<199)return a.push([t,e]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var r=n(15),i=n(76),o=n(2),a=n(78),s=/^\[object .+?Constructor\]$/,l=Function.prototype,u=Object.prototype,c=l.toString,h=u.hasOwnProperty,f=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||i(t))&&(r(t)?f:s).test(a(t))}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(16),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=a.call(t);return r&&(e?t[s]=n:delete t[s]),i}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var r,i=n(77),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!o&&o in t}},function(t,e,n){var r=n(3)["__core-js_shared__"];t.exports=r},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var r=n(81),i=n(8),o=n(27);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},function(t,e,n){var r=n(82),i=n(83),o=n(84),a=n(85),s=n(86);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,t.exports=l},function(t,e,n){var r=n(11);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var r=n(11),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(11),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},function(t,e,n){var r=n(11);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,n){var r=n(12);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(12);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(12);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var r=n(12);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},function(t,e,n){var r=n(93)();t.exports=r},function(t,e){t.exports=function(t){return function(e,n,r){for(var i=-1,o=Object(e),a=r(e),s=a.length;s--;){var l=a[t?s:++i];if(!1===n(o[l],l,o))break}return e}}},function(t,e,n){var r=n(30),i=n(95),o=n(96),a=n(99),s=n(100),l=n(19),u=n(5),c=n(104),h=n(34),f=n(15),p=n(2),d=n(106),g=n(35),y=n(36),m=n(110);t.exports=function(t,e,n,v,_,b,w){var x=y(t,n),L=y(e,n),E=w.get(L);if(E)r(t,n,E);else{var C=b?b(x,L,n+"",t,e,w):void 0,k=void 0===C;if(k){var S=u(L),P=!S&&h(L),M=!S&&!P&&g(L);C=L,S||P||M?C=u(x)?x:c(x)?a(x):P?i(L,!(k=!1)):M?o(L,!(k=!1)):[]:d(L)||l(L)?l(C=x)?C=m(x):p(x)&&!f(x)||(C=s(L)):k=!1}k&&(w.set(L,C),_(C,L,v,b,w),w.delete(L)),r(t,n,C)}}},function(t,e,n){(function(t){var r=n(3),i=e&&!e.nodeType&&e,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=s?s(n):new t.constructor(n);return t.copy(r),r}}).call(this,n(18)(t))},function(t,e,n){var r=n(97);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},function(t,e,n){var r=n(98);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},function(t,e,n){var r=n(3).Uint8Array;t.exports=r},function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e=e||Array(r);++n<r;)e[n]=t[n];return e}},function(t,e,n){var r=n(101),i=n(32),o=n(33);t.exports=function(t){return"function"!=typeof t.constructor||o(t)?{}:r(i(t))}},function(t,e,n){var r=n(2),i=Object.create;function o(){}t.exports=function(t){if(!r(t))return{};if(i)return i(t);o.prototype=t;var e=new o;return o.prototype=void 0,e}},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){var r=n(7),i=n(4);t.exports=function(t){return i(t)&&"[object Arguments]"==r(t)}},function(t,e,n){var r=n(20),i=n(4);t.exports=function(t){return i(t)&&r(t)}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var r=n(7),i=n(32),o=n(4),a=Function.prototype,s=Object.prototype,l=a.toString,u=s.hasOwnProperty,c=l.call(Object);t.exports=function(t){if(!o(t)||"[object Object]"!=r(t))return!1;var e=i(t);if(null===e)return!0;var n=u.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==c}},function(t,e,n){var r=n(7),i=n(21),o=n(4),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&i(t.length)&&!!a[r(t)]}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){(function(t){var r=n(28),i=e&&!e.nodeType&&e,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i&&r.process,s=function(){try{return o&&o.require&&o.require("util").types||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s}).call(this,n(18)(t))},function(t,e,n){var r=n(111),i=n(37);t.exports=function(t){return r(t,i(t))}},function(t,e,n){var r=n(112),i=n(17);t.exports=function(t,e,n,o){var a=!n;n=n||{};for(var s=-1,l=e.length;++s<l;){var u=e[s],c=o?o(n[u],t[u],u,n,t):void 0;void 0===c&&(c=t[u]),a?i(n,u,c):r(n,u,c)}return n}},function(t,e,n){var r=n(17),i=n(10),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var a=t[e];o.call(t,e)&&i(a,n)&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e,n){var r=n(114),i=n(19),o=n(5),a=n(34),s=n(22),l=n(35),u=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=o(t),c=!n&&i(t),h=!n&&!c&&a(t),f=!n&&!c&&!h&&l(t),p=n||c||h||f,d=p?r(t.length,String):[],g=d.length;for(var y in t)!e&&!u.call(t,y)||p&&("length"==y||h&&("offset"==y||"parent"==y)||f&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||s(y,g))||d.push(y);return d}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(2),i=n(33),o=n(116),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return o(t);var e=i(t),n=[];for(var s in t)("constructor"!=s||!e&&a.call(t,s))&&n.push(s);return n}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){var r=n(118),i=n(125);t.exports=function(t){return r((function(e,n){var r=-1,o=n.length,a=1<o?n[o-1]:void 0,s=2<o?n[2]:void 0;for(a=3<t.length&&"function"==typeof a?(o--,a):void 0,s&&i(n[0],n[1],s)&&(a=o<3?void 0:a,o=1),e=Object(e);++r<o;){var l=n[r];l&&t(e,l,r,a)}return e}))}},function(t,e,n){var r=n(38),i=n(119),o=n(121);t.exports=function(t,e){return o(i(t,e,r),t+"")}},function(t,e,n){var r=n(120),i=Math.max;t.exports=function(t,e,n){return e=i(void 0===e?t.length-1:e,0),function(){for(var o=arguments,a=-1,s=i(o.length-e,0),l=Array(s);++a<s;)l[a]=o[e+a];a=-1;for(var u=Array(e+1);++a<e;)u[a]=o[a];return u[e]=n(l),r(t,this,u)}}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){var r=n(122),i=n(124)(r);t.exports=i},function(t,e,n){var r=n(123),i=n(31),o=n(38),a=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:o;t.exports=a},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var n=Date.now;t.exports=function(t){var e=0,r=0;return function(){var i=n(),o=16-(i-r);if(r=i,0<o){if(800<=++e)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,n){var r=n(10),i=n(20),o=n(22),a=n(2);t.exports=function(t,e,n){if(!a(n))return!1;var s=typeof e;return!!("number"==s?i(n)&&o(e,n.length):"string"==s&&e in n)&&r(n[e],t)}},function(t,e,n){var r=n(39),i=n(40);t.exports=function(t,e){for(var n=0,o=(e=r(e,t)).length;null!=t&&n<o;)t=t[i(e[n++])];return n&&n==o?t:void 0}},function(t,e,n){var r=n(5),i=n(23),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!i(t))||a.test(t)||!o.test(t)||null!=e&&t in Object(e)}},function(t,e,n){var r=n(129),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=r((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(i,(function(t,n,r,i){e.push(r?i.replace(o,"$1"):n||t)})),e}));t.exports=a},function(t,e,n){var r=n(130);t.exports=function(t){var e=r(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},function(t,e,n){var r=n(29);function i(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(i.Cache||r),n}i.Cache=r,t.exports=i},function(t,e,n){var r=n(132);t.exports=function(t){return null==t?"":r(t)}},function(t,e,n){var r=n(16),i=n(133),o=n(5),a=n(23),s=r?r.prototype:void 0,l=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(o(e))return i(e,t)+"";if(a(e))return l?l.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t,e){return null!=t&&n.call(t,e)}},function(t,e,n){var r=n(39),i=n(19),o=n(5),a=n(22),s=n(21),l=n(40);t.exports=function(t,e,n){for(var u=-1,c=(e=r(e,t)).length,h=!1;++u<c;){var f=l(e[u]);if(!(h=null!=t&&n(t,f)))break;t=t[f]}return h||++u!=c?h:!!(c=null==t?0:t.length)&&s(c)&&a(f,c)&&(o(t)||i(t))}},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e),n(59);var r=n(41),i=n(42),o=n.n(i),a=n(43),s=n(44),l=n(45),u=n(46),c=n(47),h=n(48),f=n(49),p=n(50),d=n(51),g=n(52),y={en:a,de:s,it:l,id:u,ro:c,ru:h,es:f,nl:p,fr:d,pt_br:n(53),zh:g,pl:n(54),sv:n(55)},m=function(t,e,n){var r=t.project(e),i=t.project(n);return t.unproject(r._add(i)._divideBy(2))},v=function(t){var e=[];return t.eachLayer((function(t){(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.Circle||t instanceof L.CircleMarker)&&e.push(t)})),e=(e=e.filter((function(t){return!!t.pm}))).filter((function(t){return!t._pmTempLayer}))};function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){w(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function w(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var x=v,E={_globalEditMode:!1,globalEditEnabled:function(){return this._globalEditMode},setGlobalEditStatus:function(t){this._globalEditMode=t,this._fireEditModeEvent(this._globalEditMode)},enableGlobalEditMode:function(t){var e=b({snappable:this._globalSnappingEnabled},t);this.Toolbar.toggleButton("editMode",!0),x(this.map).forEach((function(t){t.pm.enable(e)})),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this.map.on("layeradd",this.throttledReInitEdit,this),this.setGlobalEditStatus(!0)},disableGlobalEditMode:function(){x(this.map).forEach((function(t){t.pm.disable()})),this.map.off("layeroff",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",!1),this.setGlobalEditStatus(!1)},toggleGlobalEditMode:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.globalOptions;this.globalEditEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(t)},handleLayerAdditionInGlobalEditMode:function(t){var e=t.layer;!e.pm||e._pmTempLayer||!this.globalEditEnabled()||e.pm.enable(b({},this.globalOptions,{snappable:this._globalSnappingEnabled}))},_fireEditModeEvent:function(t){this.map.fire("pm:globaleditmodetoggled",{enabled:t,map:this.map})}},C=v,k={globalDragModeEnabled:function(){return!!this._globalDragMode},enableGlobalDragMode:function(){var t=C(this.map);this._globalDragMode=!0,t.forEach((function(t){t.pm.enableLayerDrag()})),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this._globalDragMode),this._fireDragModeEvent(!0)},disableGlobalDragMode:function(){var t=C(this.map);this._globalDragMode=!1,t.forEach((function(t){t.pm.disableLayerDrag()})),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this._globalDragMode),this._fireDragModeEvent(!1)},_fireDragModeEvent:function(t){this.map.fire("pm:globaldragmodetoggled",{enabled:t,map:this.map})},toggleGlobalDragMode:function(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode:function(t){var e=t.layer;!e.pm||e._pmTempLayer||!this.globalDragModeEnabled()||(this.disableGlobalDragMode(),this.enableGlobalDragMode())}},S={disableGlobalRemovalMode:function(){var t=this;this._globalRemovalMode=!1,this.map.eachLayer((function(e){e.off("click",t.removeLayer,t)})),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("deleteLayer",this._globalRemovalMode),this._fireRemovalModeEvent(!1)},enableGlobalRemovalMode:function(){var t=this;this._globalRemovalMode=!0,this.map.eachLayer((function(e){(function(t){return t.pm&&!(t.pm.options&&t.pm.options.preventMarkerRemoval)&&!(t instanceof L.LayerGroup)})(e)&&e.on("click",t.removeLayer,t)})),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.reinitGlobalRemovalMode,100,this)),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("deleteLayer",this._globalRemovalMode),this._fireRemovalModeEvent(!0)},_fireRemovalModeEvent:function(t){this.map.fire("pm:globalremovalmodetoggled",{enabled:t,map:this.map})},toggleGlobalRemovalMode:function(){this.globalRemovalEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},globalRemovalEnabled:function(){return!!this._globalRemovalMode},removeLayer:function(t){var e=t.target;e._pmTempLayer||e.pm&&e.pm.dragging()||(e.remove(),this.map.fire("pm:remove",{layer:e}))},reinitGlobalRemovalMode:function(t){var e=t.layer;!e.pm||e._pmTempLayer||!this.globalRemovalEnabled()||(this.disableGlobalRemovalMode(),this.enableGlobalRemovalMode())}};function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function M(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var T=v,O=L.Class.extend({includes:[E,k,S],initialize:function(t){this.map=t,this.Draw=new L.PM.Draw(t),this.Toolbar=new L.PM.Toolbar(t),this._globalRemovalMode=!1,this.globalOptions={snappable:!0}},setLang:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"en",e=1<arguments.length?arguments[1]:void 0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"en";e&&(y[t]=o()(y[n],e)),L.PM.activeLang=t,this.map.pm.Toolbar.reinit()},addControls:function(t){this.Toolbar.addControls(t)},removeControls:function(){this.Toolbar.removeControls()},toggleControls:function(){this.Toolbar.toggleControls()},controlsVisible:function(){return this.Toolbar.isVisible},enableDraw:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Polygon",e=1<arguments.length?arguments[1]:void 0;"Poly"===t&&(t="Polygon"),this.Draw.enable(t,e)},disableDraw:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Polygon";"Poly"===t&&(t="Polygon"),this.Draw.disable(t)},setPathOptions:function(t){this.Draw.setPathOptions(t)},getGlobalOptions:function(){return this.globalOptions},setGlobalOptions:function(t){var e=this,n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){M(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},this.globalOptions,{},t);this.map.pm.Draw.shapes.forEach((function(t){e.map.pm.Draw[t].setOptions(n)})),T(this.map).forEach((function(t){t.pm.setOptions(n)})),this.applyGlobalOptions(),this.globalOptions=n},applyGlobalOptions:function(){T(this.map).forEach((function(t){t.pm.enabled()&&t.pm.applyOptions()}))}}),I=n(0),N=n.n(I),D=n(56),R=n.n(D);function A(t){var e=L.PM.activeLang;return R()(y,e)||(e="en"),N()(y[e],t)}var j=L.Control.extend({options:{position:"topleft"},initialize:function(t){this._button=Object.assign({},this.options,t)},onAdd:function(t){return this._map=t,"edit"===this._button.tool?this._container=this._map.pm.Toolbar.editContainer:"options"===this._button.tool?this._container=this._map.pm.Toolbar.optionsContainer:this._container=this._map.pm.Toolbar.drawContainer,this.buttonsDomNode=this._makeButton(this._button),this._container.appendChild(this.buttonsDomNode),this._container},onRemove:function(){return this.buttonsDomNode.remove(),this._container},getText:function(){return this._button.text},getIconUrl:function(){return this._button.iconUrl},destroy:function(){this._button={},this._update()},toggle:function(t){return this._button.toggleStatus="boolean"==typeof t?t:!this._button.toggleStatus,this._applyStyleClasses(),this._button.toggleStatus},toggled:function(){return this._button.toggleStatus},onCreate:function(){this.toggle(!1)},_triggerClick:function(t){this._button.onClick(t),this._clicked(t),this._button.afterClick(t)},_makeButton:function(t){var e=this,n=L.DomUtil.create("div","button-container",this._container),r=L.DomUtil.create("a","leaflet-buttons-control-button",n),i=L.DomUtil.create("div","leaflet-pm-actions-container",n),o=t.actions,a={cancel:{text:A("actions.cancel"),onClick:function(){this._triggerClick()}},finishMode:{text:A("actions.finish"),onClick:function(){this._triggerClick()}},removeLastVertex:{text:A("actions.removeLastVertex"),onClick:function(){this._map.pm.Draw[t.jsClass]._removeLastVertex()}},finish:{text:A("actions.finish"),onClick:function(e){this._map.pm.Draw[t.jsClass]._finishShape(e)}}};o.forEach((function(t){var n=a[t],r=L.DomUtil.create("a","leaflet-pm-action action-".concat(t),i);r.innerHTML=n.text,L.DomEvent.addListener(r,"click",n.onClick,e),L.DomEvent.disableClickPropagation(r)})),t.toggleStatus&&L.DomUtil.addClass(n,"active");var s=L.DomUtil.create("div","control-icon",r);return t.title&&s.setAttribute("title",t.title),t.iconUrl&&s.setAttribute("src",t.iconUrl),t.className&&L.DomUtil.addClass(s,t.className),L.DomEvent.addListener(r,"click",(function(){e._button.disableOtherButtons&&e._map.pm.Toolbar.triggerClickOnToggledButtons(e)})),L.DomEvent.addListener(r,"click",this._triggerClick,this),L.DomEvent.disableClickPropagation(r),n},_applyStyleClasses:function(){this._container&&(this._button.toggleStatus?L.DomUtil.addClass(this.buttonsDomNode,"active"):L.DomUtil.removeClass(this.buttonsDomNode,"active"))},_clicked:function(){this._button.doToggle&&this.toggle()}});L.Control.PMButton=j;var B=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,snappingOption:!0,position:"topleft"},initialize:function(t){this.init(t)},reinit:function(){var t=this.isVisible;this.removeControls(),this._defineButtons(),t&&this.addControls()},init:function(t){this.map=t,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this._defineButtons()},getButtons:function(){return this.buttons},addControls:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options;void 0!==t.editPolygon&&(t.editMode=t.editPolygon),void 0!==t.deleteLayer&&(t.removalMode=t.deleteLayer),L.Util.setOptions(this,t),this.applyIconStyle(),this._showHideButtons(),this.isVisible=!0},applyIconStyle:function(){var t=this.getButtons(),e={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete"}};for(var n in t){var r=t[n];L.Util.setOptions(r,{className:e.geomanIcons[n]})}},removeControls:function(){var t=this.getButtons();for(var e in t)t[e].remove();this.isVisible=!1},toggleControls:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options;this.isVisible?this.removeControls():this.addControls(t)},_addButton:function(t,e){return this.buttons[t]=e,this.options[t]=this.options[t]||!1,this.buttons[t]},triggerClickOnToggledButtons:function(t){var e=["snappingOption"];for(var n in this.buttons)!e.includes(n)&&this.buttons[n]!==t&&this.buttons[n].toggled()&&this.buttons[n]._triggerClick()},toggleButton:function(t,e){return"editPolygon"===t&&(t="editMode"),"deleteLayer"===t&&(t="removalMode"),(!(2<arguments.length&&void 0!==arguments[2])||arguments[2])&&this.triggerClickOnToggledButtons(this.buttons[t]),this.buttons[t].toggle(e)},_defineButtons:function(){var t=this,e={className:"control-icon leaflet-pm-icon-marker",title:A("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:function(){},afterClick:function(){t.map.pm.Draw.Marker.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},n={title:A("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:function(){},afterClick:function(){t.map.pm.Draw.Polygon.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},r={className:"control-icon leaflet-pm-icon-polyline",title:A("buttonTitles.drawLineButton"),jsClass:"Line",onClick:function(){},afterClick:function(){t.map.pm.Draw.Line.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},i={title:A("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:function(){},afterClick:function(){t.map.pm.Draw.Circle.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},o={title:A("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:function(){},afterClick:function(){t.map.pm.Draw.CircleMarker.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},a={title:A("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:function(){},afterClick:function(){t.map.pm.Draw.Rectangle.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},s={title:A("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},l={title:A("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},u={title:A("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:function(){},afterClick:function(){t.map.pm.Draw.Cut.toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},c={title:A("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]};this._addButton("drawMarker",new L.Control.PMButton(e)),this._addButton("drawPolyline",new L.Control.PMButton(r)),this._addButton("drawRectangle",new L.Control.PMButton(a)),this._addButton("drawPolygon",new L.Control.PMButton(n)),this._addButton("drawCircle",new L.Control.PMButton(i)),this._addButton("drawCircleMarker",new L.Control.PMButton(o)),this._addButton("editMode",new L.Control.PMButton(s)),this._addButton("dragMode",new L.Control.PMButton(l)),this._addButton("cutPolygon",new L.Control.PMButton(u)),this._addButton("removalMode",new L.Control.PMButton(c))},_showHideButtons:function(){this.removeControls();var t=this.getButtons();for(var e in t)this.options[e]&&(t[e].setPosition(this.options.position),t[e].addTo(this.map))}}),z={_initSnappableMarkers:function(){this.options.snapDistance=this.options.snapDistance||30,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents:function(t){var e=this;t.forEach((function(t){Array.isArray(t)?e._assignEvents(t):(t.off("drag",e._handleSnapping,e),t.on("drag",e._handleSnapping,e),t.off("dragend",e._cleanupSnapping,e),t.on("dragend",e._cleanupSnapping,e))}))},_unsnap:function(){delete this._snapLatLng},_cleanupSnapping:function(){delete this._snapList,this._map.off("pm:remove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach((function(t){t.remove()}))},_handleSnapLayerRemoval:function(t){var e=t.layer,n=this._snapList.findIndex((function(t){return t._leaflet_id===e._leaflet_id}));this._snapList.splice(n,1)},_handleSnapping:function(t){function e(){return L.Util.throttle(this._createSnapList,100,this)}if(t.originalEvent.altKey)return!1;if(void 0===this._snapList&&(this._createSnapList(),this._map.off("layeradd",e,this),this._map.on("layeradd",e,this)),this._snapList.length<=0)return!1;var n,r=t.target,i=this._calcClosestLayer(r.getLatLng(),this._snapList);n=i.layer instanceof L.Marker||i.layer instanceof L.CircleMarker?i.latlng:this._checkPrioritiySnapping(i);var o=this.options.snapDistance,a={marker:r,snapLatLng:n,segment:i.segment,layer:this._layer,layerInteractedWith:i.layer,distance:i.distance};if(a.marker.fire("pm:snapdrag",a),this._layer.fire("pm:snapdrag",a),i.distance<o){r.setLatLng(n),r._snapped=!0;var s=this._snapLatLng||{},l=n||{};s.lat===l.lat&&s.lng===l.lng||(this._snapLatLng=n,r.fire("pm:snap",a),this._layer.fire("pm:snap",a))}else this._snapLatLng&&(this._unsnap(a),r._snapped=!1,a.marker.fire("pm:unsnap",a),this._layer.fire("pm:unsnap",a));return!0},_checkPrioritiySnapping:function(t){var e,n=this._map,r=t.segment[0],i=t.segment[1],o=t.latlng,a=this._getDistance(n,r,o),s=this._getDistance(n,i,o),l=a<s?r:i,u=a<s?a:s;if(this.options.snapMiddle){var c=m(n,r,i),h=this._getDistance(n,c,o);h<a&&h<s&&(l=c,u=h)}return e=u<this.options.snapDistance?l:o,Object.assign({},e)},_createSnapList:function(){var t=this,e=[],n=[],r=this._map;r.off("pm:remove",this._handleSnapLayerRemoval,this),r.on("pm:remove",this._handleSnapLayerRemoval,this),r.eachLayer((function(t){if((t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.CircleMarker)&&!0!==t.options.snapIgnore){e.push(t);var r=L.polyline([],{color:"red",pmIgnore:!0});r._pmTempLayer=!0,n.push(r)}})),e=(e=(e=e.filter((function(e){return t._layer!==e}))).filter((function(t){return t._latlng||t._latlngs&&0<t._latlngs.length}))).filter((function(t){return!t._pmTempLayer})),this._otherSnapLayers?this._snapList=e.concat(this._otherSnapLayers):this._snapList=e,this.debugIndicatorLines=n},_calcClosestLayer:function(t,e){var n=this,r={};return e.forEach((function(e,i){var o=n._calcLayerDistances(t,e);n.debugIndicatorLines[i].setLatLngs([t,o.latlng]),(void 0===r.distance||o.distance<r.distance)&&((r=o).layer=e)})),r},_calcLayerDistances:function(t,e){var n,r,i=this,o=this._map,a=e instanceof L.Marker||e instanceof L.CircleMarker,s=e instanceof L.Polygon,l=t,u=a?e.getLatLng():e.getLatLngs();if(a)return{latlng:Object.assign({},u),distance:this._getDistance(o,u,l)};!function t(e){e.forEach((function(a,u){if(Array.isArray(a))t(a);else{var c,h=a;c=s?u+1===e.length?0:u+1:u+1===e.length?void 0:u+1;var f=e[c];if(f){var p=i._getDistanceToSegment(o,l,h,f);(void 0===r||p<r)&&(r=p,n=[h,f])}}}))}(u);var c=this._getClosestPointOnSegment(o,t,n[0],n[1]);return{latlng:Object.assign({},c),segment:n,distance:r}},_getClosestPointOnSegment:function(t,e,n,r){var i=t.getMaxZoom();i===1/0&&(i=t.getZoom());var o=t.project(e,i),a=t.project(n,i),s=t.project(r,i),l=L.LineUtil.closestPointOnSegment(o,a,s);return t.unproject(l,i)},_getDistanceToSegment:function(t,e,n,r){var i=t.latLngToLayerPoint(e),o=t.latLngToLayerPoint(n),a=t.latLngToLayerPoint(r);return L.LineUtil.pointToSegmentDistance(i,o,a)},_getDistance:function(t,e,n){return t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(n))}},F=L.Class.extend({includes:[z],options:{snappable:!0,snapDistance:20,tooltips:!0,cursorMarker:!0,finishOnDoubleClick:!1,finishOn:null,allowSelfIntersection:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},markerStyle:{draggable:!0}},setOptions:function(t){L.Util.setOptions(this,t)},initialize:function(t){var e=this;this._map=t,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut"],this.shapes.forEach((function(t){e[t]=new L.PM.Draw[t](e._map)}))},setPathOptions:function(t){this.options.pathOptions=t},getShapes:function(){return this.shapes},enable:function(t,e){if(!t)throw new Error("Error: Please pass a shape as a parameter. Possible shapes are: ".concat(this.getShapes().join(",")));this.disable(),this[t].enable(e)},disable:function(){var t=this;this.shapes.forEach((function(e){t[e].disable()}))},addControls:function(){var t=this;this.shapes.forEach((function(e){t[e].addButton()}))}});F.Marker=F.extend({initialize:function(t){this._map=t,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable:function(t){var e=this;L.Util.setOptions(this,t),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker([0,0],this.options.markerStyle),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(A("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.eachLayer((function(t){e.isRelevantMarker(t)&&t.pm.enable()}))},disable:function(){var t=this;this._enabled&&(this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer((function(e){t.isRelevantMarker(e)&&e.pm.disable()})),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._enabled=!1)},isRelevantMarker:function(t){return t instanceof L.Marker&&t.pm&&!t._pmTempLayer},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_createMarker:function(t){if(t.latlng){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),n=new L.Marker(e,this.options.markerStyle);n.addTo(this._map),n.pm.enable(),this._map.fire("pm:create",{shape:this._shape,marker:n,layer:n}),this._cleanupSnapping()}},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}}});var G=n(6),U=n.n(G);F.Line=F.extend({initialize:function(t){this._map=t,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable:function(t){L.Util.setOptions(this,t),this.options.finishOnDoubleClick&&!this.options.finishOn&&(this.options.finishOn="dblclick"),this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],this.options.templineStyle),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(A("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map._container.style.cursor="crosshair",this._map.on("click",this._createVertex,this),this.options.finishOn&&this._map.on(this.options.finishOn,this._finishShape,this),"dblclick"===this.options.finishOn&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[]},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},hasSelfIntersection:function(){return 0<U()(this._layer.toGeoJSON(15)).features.length},_syncHintLine:function(){var t=this._layer.getLatLngs();if(0<t.length){var e=t[t.length-1];this._hintline.setLatLngs([e,this._hintMarker.getLatLng()])}},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,t.latlng)},_handleSelfIntersection:function(t,e){var n=L.polyline(this._layer.getLatLngs());t&&(e=e||this._hintMarker.getLatLng(),n.addLatLng(e));var r=U()(n.toGeoJSON(15));this._doesSelfIntersect=0<r.features.length,this._doesSelfIntersect?this._hintline.setStyle({color:"red"}):this._hintline.isEmpty()||this._hintline.setStyle(this.options.hintlineStyle)},_removeLastVertex:function(){var t=this._layer.getLatLngs(),e=t.pop();if(t.length<1)this.disable();else{var n=this._layerGroup.getLayers().filter((function(t){return t instanceof L.Marker})).filter((function(t){return!L.DomUtil.hasClass(t._icon,"cursor-marker")})).find((function(t){return t.getLatLng()===e}));this._layerGroup.removeLayer(n),this._layer.setLatLngs(t),this._syncHintLine()}},_createVertex:function(t){if(this.options.allowSelfIntersection||(this._handleSelfIntersection(!0,t.latlng),!this._doesSelfIntersect)){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();if(e.equals(this._layer.getLatLngs()[0]))this._finishShape(t);else{var n=0===this._layer.getLatLngs().length;this._layer.addLatLng(e);var r=this._createMarker(e,n);this._hintline.setLatLngs([e,e]),this._layer.fire("pm:vertexadded",{shape:this._shape,workingLayer:this._layer,marker:r,latlng:e})}}},_finishShape:function(){if(this.options.allowSelfIntersection||(this._handleSelfIntersection(!1),!this._doesSelfIntersect)){var t=this._layer.getLatLngs();if(!(t.length<=1)){var e=L.polyline(t,this.options.pathOptions).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:e}),this.options.snappable&&this._cleanupSnapping()}}},_createMarker:function(t,e){var n=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return n._pmTempLayer=!0,this._layerGroup.addLayer(n),n.on("click",this._finishShape,this),e&&this._hintMarker.setTooltipContent(A("tooltips.continueLine")),2===this._layer.getLatLngs().length&&this._hintMarker.setTooltipContent(A("tooltips.finishLine")),n}}),F.Polygon=F.Line.extend({initialize:function(t){this._map=t,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},_finishShape:function(t){if(this.options.allowSelfIntersection||(this._handleSelfIntersection(!1),!this._doesSelfIntersect)){var e=this._layer.getLatLngs();if(!(e.length<=2)){t&&"dblclick"===t.type&&e.splice(e.length-1,1);var n=L.polygon(e,this.options.pathOptions).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:n}),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex}}},_createMarker:function(t,e){var n=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return n._pmTempLayer=!0,this._layerGroup.addLayer(n),e&&(n.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(n)-1,this.options.snappable&&this._cleanupSnapping()),e&&this._hintMarker.setTooltipContent(A("tooltips.continueLine")),3===this._layer.getLatLngs().length&&this._hintMarker.setTooltipContent(A("tooltips.finishPoly")),n}}),F.Rectangle=F.extend({initialize:function(t){this._map=t,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable:function(t){if(L.Util.setOptions(this,t),this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._layer._pmTempLayer=!0,this._startMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:100,opacity:this.options.cursorMarker?1:0}),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.tooltips&&this._hintMarker.bindTooltip(A("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){L.DomUtil.addClass(this._hintMarker._icon,"visible"),this._styleMarkers=[];for(var e=0;e<2;e+=1){var n=L.marker([0,0],{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});n._pmTempLayer=!0,this._layerGroup.addLayer(n),this._styleMarkers.push(n)}}this._map._container.style.cursor="crosshair",this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[]},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_placeStartingMarkers:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(e),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach((function(t){L.DomUtil.addClass(t._icon,"visible"),t.setLatLng(e)})),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(A("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin:function(){var t=this._startMarker.getLatLng();t&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([t,t]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}},_syncRectangleSize:function(){var t=this,e=this._startMarker.getLatLng(),n=this._hintMarker.getLatLng();if(this._layer.setBounds([e,n]),this.options.cursorMarker&&this._styleMarkers){var r=this._findCorners(),i=[];r.forEach((function(e){e.equals(t._startMarker.getLatLng())||e.equals(t._hintMarker.getLatLng())||i.push(e)})),i.forEach((function(e,n){t._styleMarkers[n].setLatLng(e)}))}},_finishShape:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),n=this._startMarker.getLatLng(),r=L.rectangle([n,e],this.options.pathOptions).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:r})},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}}),F.Circle=F.extend({initialize:function(t){this._map=t,this._shape="Circle",this.toolbarButtonName="drawCircle"},enable:function(t){L.Util.setOptions(this,t),this.options.radius=0,this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.circle([0,0],this.options.templineStyle),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._centerMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._centerMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._centerMarker),this._hintMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(A("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map._container.style.cursor="crosshair",this._map.on("click",this._placeCenterMarker,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[]},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine:function(){var t=this._centerMarker.getLatLng();this._hintline.setLatLngs([t,this._hintMarker.getLatLng()])},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),n=t.distanceTo(e);this._layer.setRadius(n)},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}},_placeCenterMarker:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();this._centerMarker.setLatLng(e),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter:function(){var t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(A("tooltips.finishCircle")),this._layer.fire("pm:centerplaced",{shape:this._shape,workingLayer:this._layer,latlng:t}))},_finishShape:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._centerMarker.getLatLng(),n=this._hintMarker.getLatLng(),r=e.distanceTo(n),i=Object.assign({},this.options.pathOptions,{radius:r}),o=L.circle(e,i).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:o})},_createMarker:function(t){var e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return e._pmTempLayer=!0,this._layerGroup.addLayer(e),e}}),F.CircleMarker=F.Marker.extend({initialize:function(t){this._map=t,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker"},enable:function(t){var e=this;L.Util.setOptions(this,t),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.circleMarker([0,0],this.options.templineStyle),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(A("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.eachLayer((function(t){e.isRelevantMarker(t)&&t.pm.enable()}))},isRelevantMarker:function(t){return t instanceof L.CircleMarker&&!(t instanceof L.Circle)&&t.pm&&!t._pmTempLayer},_createMarker:function(t){if(t.latlng){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),n=L.circleMarker(e,this.options.pathOptions);n.addTo(this._map),n.pm.enable(),this._map.fire("pm:create",{shape:this._shape,marker:n,layer:n}),this._cleanupSnapping()}}});var q=n(57),H=n.n(q),V=n(24),Y=n(26),W=n.n(Y),X=n(1),Z=n(13),K=n(25);function J(t){switch(t.type){case"Polygon":return 1<W()(t)?t:null;case"MultiPolygon":var e=[];if(Object(K.flattenEach)(t,(function(t){1<W()(t)&&e.push(t.geometry.coordinates)})),e.length)return{type:"MultiPolygon",coordinates:e}}}F.Cut=F.Polygon.extend({initialize:function(t){this._map=t,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_cut:function(t){var e=this,n=this._map._layers;Object.keys(n).map((function(t){return n[t]})).filter((function(t){return t.pm})).filter((function(t){return t instanceof L.Polygon})).filter((function(e){return e!==t})).filter((function(e){try{return!!H()(t.toGeoJSON(15),e.toGeoJSON(15))}catch(t){return console.error("You cant cut polygons with self-intersections"),!1}})).forEach((function(n){var r=function(t,e){var n=Object(Z.getGeom)(t),r=Object(Z.getGeom)(e),i=t.properties||{};if(n=J(n),r=J(r),!n)return null;if(!r)return Object(X.feature)(n,i);var o=V.diff(n.coordinates,r.coordinates);return 0===o.length?null:1===o.length?Object(X.polygon)(o[0],i):Object(X.multiPolygon)(o,i)}(n.toGeoJSON(15),t.toGeoJSON(15)),i=L.geoJSON(r,n.options).addTo(e._map);i.pm.enable(e.options),i.pm.disable(),n._pmTempLayer=!0,t._pmTempLayer=!0,n.remove(),t.remove(),0===i.getLayers().length&&e._map.pm.removeLayer({target:i}),n.fire("pm:cut",{shape:e._shape,layer:i,originalLayer:n}),e._map.fire("pm:cut",{shape:e._shape,layer:i,originalLayer:n})}))},_finishShape:function(){if(this.options.allowSelfIntersection||(this._handleSelfIntersection(!1),!this._doesSelfIntersect)){var t=this._layer.getLatLngs(),e=L.polygon(t,this.options.pathOptions);this._cut(e),this.disable(),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex}}});var Q={enableLayerDrag:function(){if(this.disable(),this._layer instanceof L.Marker)this._layer.dragging.enable();else{this._tempDragCoord=null;var t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.addClass(t,"leaflet-pm-draggable"),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0,this._layer.on("mousedown",this._dragMixinOnMouseDown,this)}},disableLayerDrag:function(){if(this._layer instanceof L.Marker)this._layer.dragging.disable();else{var t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(t,"leaflet-pm-draggable"),this._safeToCacheDragState=!1,this._layer.off("mousedown",this._dragMixinOnMouseDown,this)}},_dragMixinOnMouseUp:function(){var t=this,e=this._layer._path?this._layer._path:this._layer._renderer._container;return this._originalMapDragState&&this._layer._map.dragging.enable(),this._safeToCacheDragState=!0,this._layer._map.off("mousemove",this._dragMixinOnMouseMove,this),this._layer._map.off("mouseup",this._dragMixinOnMouseUp,this),!!this._dragging&&(window.setTimeout((function(){t._dragging=!1,L.DomUtil.removeClass(e,"leaflet-pm-dragging"),t._layer.fire("pm:dragend"),t._fireEdit()}),10),!0)},_dragMixinOnMouseMove:function(t){var e=this._layer._path?this._layer._path:this._layer._renderer._container;this._dragging||(this._dragging=!0,L.DomUtil.addClass(e,"leaflet-pm-dragging"),this._layer.bringToFront(),this._originalMapDragState&&this._layer._map.dragging.disable(),this._layer.fire("pm:dragstart")),this._onLayerDrag(t)},_dragMixinOnMouseDown:function(t){0<t.originalEvent.button||(this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=t.latlng,this._layer._map.on("mouseup",this._dragMixinOnMouseUp,this),this._layer._map.on("mousemove",this._dragMixinOnMouseMove,this))},dragging:function(){return this._dragging},_onLayerDrag:function(t){var e=t.latlng,n=e.lat-this._tempDragCoord.lat,r=e.lng-this._tempDragCoord.lng;if(this._layer instanceof L.CircleMarker)this._layer.setLatLng(e);else{var i=function t(e){return e.map((function(e){return Array.isArray(e)?t(e):{lat:e.lat+n,lng:e.lng+r}}))}(this._layer.getLatLngs());this._layer.setLatLngs(i)}this._tempDragCoord=e,this._layer.fire("pm:drag",t)}},$=L.Class.extend({includes:[Q,z],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,draggable:!0,limitMarkersToCount:-1},setOptions:function(t){L.Util.setOptions(this,t)},applyOptions:function(){},isPolygon:function(){return this._layer instanceof L.Polygon}});function tt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}$.LayerGroup=L.Class.extend({initialize:function(t){var e=this;this._layerGroup=t,this._layers=this.findLayers(),this._layers.forEach((function(t){return e._initLayer(t)})),this._layerGroup.on("layeradd",(function(t){t.target._pmTempLayer||(e._layers=e.findLayers(),t.layer.pm&&e._initLayer(t.layer),t.target.pm.enabled()&&e.enable(e.getOptions()))})),this._layerGroup.on("layerremove",(function(t){t.target._pmTempLayer||(e._layers=e.findLayers())}))},findLayers:function(){var t=this._layerGroup.getLayers();return(t=(t=t.filter((function(t){return!(t instanceof L.LayerGroup)}))).filter((function(t){return!!t.pm}))).filter((function(t){return!t._pmTempLayer}))},_initLayer:function(t){var e=this;["pm:edit","pm:update","pm:remove","pm:dragstart","pm:drag","pm:dragend","pm:snap","pm:unsnap","pm:cut","pm:intersect","pm:raiseMarkers","pm:markerdragend","pm:markerdragstart","pm:vertexadded","pm:vertexremoved","pm:centerplaced"].forEach((function(n){t.on(n,e._fireEvent,e)})),t.pm._layerGroup=this._layerGroup},_fireEvent:function(t){this._layerGroup.fireEvent(t.type,t)},toggleEdit:function(t){this._options=t,this._layers.forEach((function(e){e.pm.toggleEdit(t)}))},enable:function(t){this._options=t,this._layers.forEach((function(e){e.pm.enable(t)}))},disable:function(){this._layers.forEach((function(t){t.pm.disable()}))},enabled:function(){return!!this._layers.find((function(t){return t.pm.enabled()}))},dragging:function(){return!!this._layers.find((function(t){return t.pm.dragging()}))},getOptions:function(){return this._options}}),$.Marker=$.extend({initialize:function(t){this._layer=t,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable&&this._layer.dragging.enable(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{draggable:!0};L.Util.setOptions(this,t),this._map=this._layer._map,this.enabled()||(this._enabled=!0,this.applyOptions())},enabled:function(){return this._enabled},disable:function(){this._enabled=!1,this._layer.dragging&&this._layer.dragging.disable(),this._layer.off("contextmenu",this._removeMarker,this),this._layer.off("dragstart",this._onPinnedMarkerDragStart,this),this._layer.fire("pm:disable"),this._layerEdited&&this._layer.fire("pm:update",{}),this._layerEdited=!1},_removeMarker:function(t){var e=t.target;e.remove(),e.fire("pm:remove")},_onDragEnd:function(t){t.target.fire("pm:edit"),this._layerEdited=!0},_initSnappableMarkers:function(){var t=this._layer;this.options.snapDistance=this.options.snapDistance||30,t.off("drag",this._handleSnapping,this),t.on("drag",this._handleSnapping,this),t.off("dragend",this._cleanupSnapping,this),t.on("dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){var t=this._layer;t.off("drag",this._handleSnapping,this),t.off("dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)}});var et={filterMarkerGroup:function(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),-1<this.options.limitMarkersToCount&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.applyLimitFilters,this))},_removeMarkerLimitEvents:function(){this._map.off("mousemove",this.applyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache:function(){var t=[].concat(tt(this._markerGroup.getLayers()),tt(this.markerCache));this.markerCache=t.filter((function(t,e,n){return n.indexOf(t)===e}))},renderLimits:function(t){var e=this;this.markerCache.forEach((function(n){t.includes(n)?e._markerGroup.addLayer(n):e._markerGroup.removeLayer(n)}))},applyLimitFilters:function(t){var e=t.latlng,n=void 0===e?{lat:0,lng:0}:e,r=tt(this._filterClosestMarkers(n));this.renderLimits(r)},_filterClosestMarkers:function(t){var e=tt(this.markerCache),n=this.options.limitMarkersToCount;return e.sort((function(e,n){return e._latlng.distanceTo(t)-n._latlng.distanceTo(t)})),e.filter((function(t,e){return!(-1<n)||e<n}))}};$.Line=$.extend({includes:[et],initialize:function(t){this._layer=t,this._enabled=!1},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},toggleEdit:function(t){return this.enabled()?this.disable():this.enable(t),this.enabled()},enable:function(t){L.Util.setOptions(this,t),this._map=this._layer._map,this._map&&(this.enabled()||this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this._onLayerRemove,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection||(this.cachedColor=this._layer.options.color,this.isRed=!1,this._handleLayerStyle()))},_onLayerRemove:function(t){this.disable(t.target)},enabled:function(){return this._enabled},disable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._layer;if(!this.enabled())return!1;if(t.pm._dragging)return!1;t.pm._enabled=!1,t.pm._markerGroup.clearLayers(),t.off("mousedown"),t.off("mouseup"),this._layer.off("remove",this._onLayerRemove,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval);var e=t._path?t._path:this._layer._renderer._container;return L.DomUtil.removeClass(e,"leaflet-pm-draggable"),this.hasSelfIntersection()&&L.DomUtil.removeClass(e,"leaflet-pm-invalid"),this._layer.fire("pm:disable"),this._layerEdited&&this._layer.fire("pm:update",{}),!(this._layerEdited=!1)},hasSelfIntersection:function(){return 0<U()(this._layer.toGeoJSON(15)).features.length},_handleSelfIntersectionOnVertexRemoval:function(){this._handleLayerStyle(!0),this.hasSelfIntersection()&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle:function(t){var e=this,n=this._layer;if(this.hasSelfIntersection()){if(this.isRed)return;t?(n.setStyle({color:"red"}),this.isRed=!0,window.setTimeout((function(){n.setStyle({color:e.cachedColor}),e.isRed=!1}),200)):(n.setStyle({color:"red"}),this.isRed=!0),this._layer.fire("pm:intersect",{intersection:U()(this._layer.toGeoJSON(15))})}else n.setStyle({color:this.cachedColor}),this.isRed=!1},_initMarkers:function(){var t=this,e=this._map,n=this._layer.getLatLngs();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.LayerGroup,this._markerGroup._pmTempLayer=!0,this._markers=function e(n){if(Array.isArray(n[0]))return n.map(e,t);var r=n.map(t._createMarker,t);return n.map((function(e,i){var o=t.isPolygon()?(i+1)%n.length:i+1;return t._createMiddleMarker(r[i],r[o])})),r}(n),this.filterMarkerGroup(),e.addLayer(this._markerGroup)},_createMarker:function(t){var e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("move",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||e.on("contextmenu",this._removeMarker,this),this._markerGroup.addLayer(e),e},_createMiddleMarker:function(t,e){var n=this;if(!t||!e)return!1;var r=m(this._map,t.getLatLng(),e.getLatLng()),i=this._createMarker(r),o=L.divIcon({className:"marker-icon marker-icon-middle"});return i.setIcon(o),t._middleMarkerNext=i,(e._middleMarkerPrev=i).on("click",(function(){var r=L.divIcon({className:"marker-icon"});i.setIcon(r),n._addMarker(i,t,e)})),i.on("movestart",(function(){i.on("moveend",(function(){var t=L.divIcon({className:"marker-icon"});i.setIcon(t),i.off("moveend")})),n._addMarker(i,t,e)})),i},_addMarker:function(t,e,n){t.off("movestart"),t.off("click");var r=t.getLatLng(),i=this._layer._latlngs,o=this.findDeepMarkerIndex(this._markers,e),a=o.indexPath,s=o.index,l=o.parentPath,u=1<a.length?N()(i,l):i,c=1<a.length?N()(this._markers,l):this._markers;u.splice(s+1,0,r),c.splice(s+1,0,t),this._layer.setLatLngs(i),this._createMiddleMarker(e,t),this._createMiddleMarker(t,n),this._fireEdit(),this._layer.fire("pm:vertexadded",{layer:this._layer,marker:t,indexPath:this.findDeepMarkerIndex(this._markers,t).indexPath,latlng:r}),this.options.snappable&&this._initSnappableMarkers()},_removeMarker:function(t){if(!this.options.allowSelfIntersection){var e=this._layer.getLatLngs();this._coordsBeforeEdit=JSON.parse(JSON.stringify(e))}var n=t.target,r=this._layer.getLatLngs(),i=this.findDeepMarkerIndex(this._markers,n),o=i.indexPath,a=i.index,s=i.parentPath;if(o){var l,u,c=1<o.length?N()(r,s):r,h=1<o.length?N()(this._markers,s):this._markers;if(c.splice(a,1),this._layer.setLatLngs(r),c.length<=1&&(c.splice(0,c.length),this._layer.setLatLngs(r),this.disable(),this.enable(this.options)),function(t){return!function t(e){return e.filter((function(t){return![null,"",void 0].includes(t)})).reduce((function(e,n){return e.concat(Array.isArray(n)?t(n):n)}),[])}(t).length}(r)&&this._layer.remove(),n._middleMarkerPrev&&this._markerGroup.removeLayer(n._middleMarkerPrev),n._middleMarkerNext&&this._markerGroup.removeLayer(n._middleMarkerNext),this._markerGroup.removeLayer(n),this.isPolygon()?(l=(a+1)%h.length,u=(a+(h.length-1))%h.length):(u=a-1<0?void 0:a-1,l=a+1>=h.length?void 0:a+1),l!==u){var f=h[u],p=h[l];this._createMiddleMarker(f,p)}h.splice(a,1),this._fireEdit(),this._layer.fire("pm:vertexremoved",{layer:this._layer,marker:n,indexPath:o})}},findDeepMarkerIndex:function(t,e){var n;t.some(function t(r){return function(i,o){var a=r.concat(o);return i._leaflet_id===e._leaflet_id?(n=a,!0):Array.isArray(i)&&i.some(t(a))}}([]));var r={};return n&&(r={indexPath:n,index:n[n.length-1],parentPath:n.slice(0,n.length-1)}),r},updatePolygonCoordsFromMarkerDrag:function(t){var e=this._layer.getLatLngs(),n=t.getLatLng(),r=this.findDeepMarkerIndex(this._markers,t),i=r.indexPath,o=r.index,a=r.parentPath;(1<i.length?N()(e,a):e).splice(o,1,n),this._layer.setLatLngs(e)},_onMarkerDrag:function(t){var e=t.target,n=this.findDeepMarkerIndex(this._markers,e),r=n.indexPath,i=n.index,o=n.parentPath;if(r){this.updatePolygonCoordsFromMarkerDrag(e);var a=1<r.length?N()(this._markers,o):this._markers,s=(i+1)%a.length,l=(i+(a.length-1))%a.length,u=e.getLatLng(),c=a[l].getLatLng(),h=a[s].getLatLng();if(e._middleMarkerNext){var f=m(this._map,u,h);e._middleMarkerNext.setLatLng(f)}if(e._middleMarkerPrev){var p=m(this._map,u,c);e._middleMarkerPrev.setLatLng(p)}this.options.allowSelfIntersection||this._handleLayerStyle()}},_onMarkerDragEnd:function(t){var e=t.target,n=this.findDeepMarkerIndex(this._markers,e).indexPath;if(!this.options.allowSelfIntersection&&this.hasSelfIntersection())return this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),void this._handleLayerStyle();this._layer.fire("pm:markerdragend",{markerEvent:t,indexPath:n}),this._fireEdit()},_onMarkerDragStart:function(t){var e=t.target,n=this.findDeepMarkerIndex(this._markers,e).indexPath;this._layer.fire("pm:markerdragstart",{markerEvent:t,indexPath:n}),this.options.allowSelfIntersection||(this._coordsBeforeEdit=this._layer.getLatLngs()),this.cachedColor=this._layer.options.color},_fireEdit:function(){this._layerEdited=!0,this._layer.fire("pm:edit")}}),$.Polygon=$.Line.extend({}),$.Rectangle=$.Polygon.extend({_initMarkers:function(){var t=this._map,e=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.LayerGroup,this._markerGroup._pmTempLayer=!0,t.addLayer(this._markerGroup),this._markers=[],this._markers[0]=e.map(this._createMarker,this);var n=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),1!==n.length);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(this._markers);this._cornerMarkers=n[0],this.options.snappable&&this._initSnappableMarkers()},_createMarker:function(t,e){var n=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return n._origLatLng=t,n._index=e,n._pmTempLayer=!0,n.on("dragstart",this._onMarkerDragStart,this),n.on("drag",this._onMarkerDrag,this),n.on("dragend",this._onMarkerDragEnd,this),n.on("pm:snap",this._adjustRectangleForMarkerSnap,this),this.options.preventMarkerRemoval||n.on("contextmenu",this._removeMarker,this),this._markerGroup.addLayer(n),n},_removeMarker:function(){return null},_onMarkerDragStart:function(t){var e=t.target,n=this._findCorners();e._oppositeCornerLatLng=n[(e._index+2)%4],e._snapped=!1,this._layer.fire("pm:markerdragstart",{markerEvent:t})},_onMarkerDrag:function(t){var e=t.target;void 0!==e._index&&(e._snapped||this._adjustRectangleForMarkerMove(e))},_onMarkerDragEnd:function(t){var e=this._findCorners();this._adjustAllMarkers(e),this._cornerMarkers.forEach((function(t){delete t._oppositeCornerLatLng})),this._layer.setLatLngs(e),this._layer.fire("pm:markerdragend",{markerEvent:t}),this._fireEdit()},_adjustRectangleForMarkerMove:function(t){L.extend(t._origLatLng,t._latlng);var e=t.getLatLng();this._layer.setBounds(L.latLngBounds(e,t._oppositeCornerLatLng)),this._adjustAdjacentMarkers(t),this._layer.redraw()},_adjustRectangleForMarkerSnap:function(t){if(this.options.snappable){var e=t.target;this._adjustRectangleForMarkerMove(e)}},_adjustAllMarkers:function(t){t.length&&4===t.length?this._cornerMarkers.forEach((function(e,n){e.setLatLng(t[n])})):console.error("_adjustAllMarkers() requires an array of EXACTLY 4 LatLng coordinates")},_adjustAdjacentMarkers:function(t){if(t&&t.getLatLng&&t._oppositeCornerLatLng){var e=t.getLatLng(),n=t._oppositeCornerLatLng,r=[];this._findCorners().forEach((function(t){t.equals(e)||t.equals(n)||r.push(t)}));var i=0;2===r.length&&this._cornerMarkers.forEach((function(t){var o=t.getLatLng();o.equals(e)||o.equals(n)||(t.setLatLng(r[i]),i+=1)}))}else console.error("_adjustAdjacentMarkers() requires a valid Marker object")},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}}),$.Circle=$.extend({initialize:function(t){this._layer=t,this._enabled=!1},applyOptions:function(){this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this),this._centerMarker.on("move",this._moveCircle,this)):this._disableSnapping()},_disableSnapping:function(){var t=this;this._markers.forEach((function(e){e.off("move",t._syncHintLine,t),e.off("move",t._syncCircleRadius,t),e.off("drag",t._handleSnapping,t),e.off("dragend",t._cleanupSnapping,t)})),this._layer.off("pm:dragstart",this._unsnap,this)},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enabled:function(){return this._enabled},enable:function(t){var e=this;L.Util.setOptions(this,t),this._map=this._layer._map,this.enabled()||this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",(function(t){e.disable(t.target)}))},disable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._layer;if(!this.enabled())return!1;if(t.pm._dragging)return!1;t.pm._enabled=!1,t.pm._helperLayers.clearLayers(),t.off("mousedown"),t.off("mouseup");var e=t._path?t._path:this._layer._renderer._container;return L.DomUtil.removeClass(e,"leaflet-pm-draggable"),this._layer.fire("pm:disable"),this._layerEdited&&this._layer.fire("pm:update",{}),!(this._layerEdited=!1)},_initMarkers:function(){var t=this._map;this._helperLayers&&this._helperLayers.clearLayers(),this._helperLayers=new L.LayerGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(t);var e=this._layer.getLatLng(),n=this._layer._radius,r=this._getLatLngOnCircle(e,n);this._centerMarker=this._createCenterMarker(e),this._outerMarker=this._createOuterMarker(r),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle:function(t,e){var n=this._map.project(t),r=L.point(n.x+e,n.y);return this._map.unproject(r)},_resizeCircle:function(){this._syncHintLine(),this._syncCircleRadius()},_moveCircle:function(t){var e=t.latlng;this._layer.setLatLng(e);var n=this._layer._radius,r=this._getLatLngOnCircle(e,n);this._outerMarker.setLatLng(r),this._syncHintLine(),this._layer.fire("pm:centerplaced",{layer:this._layer,latlng:e})},_onMarkerDragStart:function(t){this._layer.fire("pm:markerdragstart",{markerEvent:t})},_onMarkerDragEnd:function(t){this._fireEdit(),this._layer.fire("pm:markerdragend",{markerEvent:t})},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),n=t.distanceTo(e);this._layer.setRadius(n)},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_createHintLine:function(t,e){var n=t.getLatLng(),r=e.getLatLng();this._hintline=L.polyline([n,r],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker:function(t){var e=this._createMarker(t);return L.DomUtil.addClass(e._icon,"leaflet-pm-draggable"),e.on("drag",this._moveCircle,this),e},_createOuterMarker:function(t){var e=this._createMarker(t);return e.on("drag",this._resizeCircle,this),e},_createMarker:function(t){var e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("dragend",this._onMarkerDragEnd,this),this._helperLayers.addLayer(e),e},_fireEdit:function(){this._layer.fire("pm:edit"),this._layerEdited=!0}}),$.CircleMarker=$.extend({initialize:function(t){this._layer=t,this._enabled=!1},applyOptions:function(){this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enabled:function(){return this._enabled},enable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{draggable:!0,snappable:!0};L.Util.setOptions(this,t),this._map=this._layer._map,this._map&&(this.enabled()||this.disable(),this.applyOptions(),this._enabled=!0,this._layer.on("pm:dragend",this._onMarkerDragEnd,this))},disable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._layer;return!(t.pm._dragging||(this.disableLayerDrag(),this.enabled()||(this._layer.fire("pm:disable"),this._layerEdited&&this._layer.fire("pm:update",{}),this._layerEdited=!1),t.pm._enabled=!1))},_moveMarker:function(t){var e=t.latlng;this._layer.setLatLng(e).redraw()},_removeMarker:function(){this._layer.fire("pm:remove"),this._layer.remove()},_fireEdit:function(){this._layer.fire("pm:edit"),this._layerEdited=!0},_onMarkerDragEnd:function(t){this._layer.fire("pm:markerdragend",{markerEvent:t}),this._fireEdit()},_initSnappableMarkers:function(){var t=this._layer;this.options.snapDistance=this.options.snapDistance||30,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){var t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)}}),n(136),n(137),L.PM=L.PM||{version:r.a,Map:O,Toolbar:B,Draw:F,Edit:$,activeLang:"en",initialize:function(t){this.addInitHooks(t)},addInitHooks:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};L.Map.addInitHook((function(){this.pm=void 0,t.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this))})),L.LayerGroup.addInitHook((function(){this.pm=new L.PM.Edit.LayerGroup(this)})),L.Marker.addInitHook((function(){this.pm=void 0,t.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Marker(this))})),L.CircleMarker.addInitHook((function(){this.pm=void 0,t.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))})),L.Polyline.addInitHook((function(){this.pm=void 0,t.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))})),L.Polygon.addInitHook((function(){this.pm=void 0,t.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))})),L.Rectangle.addInitHook((function(){this.pm=void 0,t.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))})),L.Circle.addInitHook((function(){this.pm=void 0,t.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}))}},L.PM.initialize()}])},35:function(module,exports){function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(_$){var settings={},roots={},caches={},_consts={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch",NAME:"node_name"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_setting={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{isParent:"isParent",children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",headers:{},xhrFields:{},url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},_initRoot=function(t){var e=data.getRoot(t);e||(e={},data.setRoot(t,e)),data.nodeChildren(t,e,[]),e.expandTriggerFlag=!1,e.curSelectedList=[],e.noSelection=!0,e.createdNodes=[],e.zId=0,e._ver=(new Date).getTime()},_initCache=function(t){var e=data.getCache(t);e||(e={},data.setCache(t,e)),e.nodes=[],e.doms=[]},_bindEvent=function(t){var e=t.treeObj,n=consts.event;e.bind(n.NODECREATED,(function(e,n,r){tools.apply(t.callback.onNodeCreated,[e,n,r])})),e.bind(n.CLICK,(function(e,n,r,i,o){tools.apply(t.callback.onClick,[n,r,i,o])})),e.bind(n.EXPAND,(function(e,n,r){tools.apply(t.callback.onExpand,[e,n,r])})),e.bind(n.COLLAPSE,(function(e,n,r){tools.apply(t.callback.onCollapse,[e,n,r])})),e.bind(n.ASYNC_SUCCESS,(function(e,n,r,i){tools.apply(t.callback.onAsyncSuccess,[e,n,r,i])})),e.bind(n.ASYNC_ERROR,(function(e,n,r,i,o,a){tools.apply(t.callback.onAsyncError,[e,n,r,i,o,a])})),e.bind(n.REMOVE,(function(e,n,r){tools.apply(t.callback.onRemove,[e,n,r])})),e.bind(n.SELECTED,(function(e,n,r){tools.apply(t.callback.onSelected,[n,r])})),e.bind(n.UNSELECTED,(function(e,n,r){tools.apply(t.callback.onUnSelected,[n,r])}))},_unbindEvent=function(t){var e=t.treeObj,n=consts.event;e.unbind(n.NODECREATED).unbind(n.CLICK).unbind(n.EXPAND).unbind(n.COLLAPSE).unbind(n.ASYNC_SUCCESS).unbind(n.ASYNC_ERROR).unbind(n.REMOVE).unbind(n.SELECTED).unbind(n.UNSELECTED)},_eventProxy=function(t){var e=t.target,n=data.getSetting(t.data.treeId),r="",i=null,o="",a="",s=null,l=null,u=null;if(tools.eqs(t.type,"mousedown")?a="mousedown":tools.eqs(t.type,"mouseup")?a="mouseup":tools.eqs(t.type,"contextmenu")?a="contextmenu":tools.eqs(t.type,"click")?tools.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+consts.id.SWITCH)?(r=tools.getNodeMainDom(e).id,o="switchNode"):(u=tools.getMDom(n,e,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(r=tools.getNodeMainDom(u).id,o="clickNode"):tools.eqs(t.type,"dblclick")&&(a="dblclick",(u=tools.getMDom(n,e,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(r=tools.getNodeMainDom(u).id,o="switchNode")),a.length>0&&0==r.length&&(u=tools.getMDom(n,e,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(r=tools.getNodeMainDom(u).id),r.length>0)switch(i=data.getNodeCache(n,r),o){case"switchNode":data.nodeIsParent(n,i)&&(tools.eqs(t.type,"click")||tools.eqs(t.type,"dblclick")&&tools.apply(n.view.dblClickExpand,[n.treeId,i],n.view.dblClickExpand))?s=handler.onSwitchNode:o="";break;case"clickNode":s=handler.onClickNode}switch(a){case"mousedown":l=handler.onZTreeMousedown;break;case"mouseup":l=handler.onZTreeMouseup;break;case"dblclick":l=handler.onZTreeDblclick;break;case"contextmenu":l=handler.onZTreeContextmenu}return{stop:!1,node:i,nodeEventType:o,nodeEventCallback:s,treeEventType:a,treeEventCallback:l}},_initNode=function(t,e,n,r,i,o,a){if(n){var s=data.getRoot(t),l=data.nodeChildren(t,n);n.level=e,n.tId=t.treeId+"_"+ ++s.zId,n.parentTId=r?r.tId:null,n.open="string"==typeof n.open?tools.eqs(n.open,"true"):!!n.open;var u=data.nodeIsParent(t,n);tools.isArray(l)?(data.nodeIsParent(t,n,!0),n.zAsync=!0):(u=data.nodeIsParent(t,n,u),n.open=!(!u||t.async.enable)&&n.open,n.zAsync=!u),n.isFirstNode=i,n.isLastNode=o,n.getParentNode=function(){return data.getNodeCache(t,n.parentTId)},n.getPreNode=function(){return data.getPreNode(t,n)},n.getNextNode=function(){return data.getNextNode(t,n)},n.getIndex=function(){return data.getNodeIndex(t,n)},n.getPath=function(){return data.getNodePath(t,n)},n.isAjaxing=!1,data.fixPIdKeyValue(t,n)}},_init={bind:[_bindEvent],unbind:[_unbindEvent],caches:[_initCache],nodes:[_initNode],proxys:[_eventProxy],roots:[_initRoot],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(t,e){data.getCache(t).nodes[data.getNodeCacheId(e.tId)]=e},getNodeCacheId:function(t){return t.substring(t.lastIndexOf("_")+1)},addAfterA:function(t){_init.afterA.push(t)},addBeforeA:function(t){_init.beforeA.push(t)},addInnerAfterA:function(t){_init.innerAfterA.push(t)},addInnerBeforeA:function(t){_init.innerBeforeA.push(t)},addInitBind:function(t){_init.bind.push(t)},addInitUnBind:function(t){_init.unbind.push(t)},addInitCache:function(t){_init.caches.push(t)},addInitNode:function(t){_init.nodes.push(t)},addInitProxy:function(t,e){e?_init.proxys.splice(0,0,t):_init.proxys.push(t)},addInitRoot:function(t){_init.roots.push(t)},addNodesData:function(t,e,n,r){var i,o=data.nodeChildren(t,e);o?n>=o.length&&(n=-1):(o=data.nodeChildren(t,e,[]),n=-1),o.length>0&&0===n?(o[0].isFirstNode=!1,view.setNodeLineIcos(t,o[0])):o.length>0&&n<0&&(o[o.length-1].isLastNode=!1,view.setNodeLineIcos(t,o[o.length-1])),data.nodeIsParent(t,e,!0),n<0?data.nodeChildren(t,e,o.concat(r)):(i=[n,0].concat(r),o.splice.apply(o,i))},addSelectedNode:function(t,e){var n=data.getRoot(t);data.isSelectedNode(t,e)||n.curSelectedList.push(e)},addCreatedNode:function(t,e){(t.callback.onNodeCreated||t.view.addDiyDom)&&data.getRoot(t).createdNodes.push(e)},addZTreeTools:function(t){_init.zTreeTools.push(t)},exSetting:function(t){_$.extend(!0,_setting,t)},fixPIdKeyValue:function(t,e){t.data.simpleData.enable&&(e[t.data.simpleData.pIdKey]=e.parentTId?e.getParentNode()[t.data.simpleData.idKey]:t.data.simpleData.rootPId)},getAfterA:function(t,e,n){for(var r=0,i=_init.afterA.length;r<i;r++)_init.afterA[r].apply(this,arguments)},getBeforeA:function(t,e,n){for(var r=0,i=_init.beforeA.length;r<i;r++)_init.beforeA[r].apply(this,arguments)},getInnerAfterA:function(t,e,n){for(var r=0,i=_init.innerAfterA.length;r<i;r++)_init.innerAfterA[r].apply(this,arguments)},getInnerBeforeA:function(t,e,n){for(var r=0,i=_init.innerBeforeA.length;r<i;r++)_init.innerBeforeA[r].apply(this,arguments)},getCache:function(t){return caches[t.treeId]},getNodeIndex:function(t,e){if(!e)return null;for(var n=e.parentTId?e.getParentNode():data.getRoot(t),r=data.nodeChildren(t,n),i=0,o=r.length-1;i<=o;i++)if(r[i]===e)return i;return-1},getNextNode:function(t,e){if(!e)return null;for(var n=e.parentTId?e.getParentNode():data.getRoot(t),r=data.nodeChildren(t,n),i=0,o=r.length-1;i<=o;i++)if(r[i]===e)return i==o?null:r[i+1];return null},getNodeByParam:function(t,e,n,r){if(!e||!n)return null;for(var i=0,o=e.length;i<o;i++){var a=e[i];if(a[n]==r)return e[i];var s=data.nodeChildren(t,a),l=data.getNodeByParam(t,s,n,r);if(l)return l}return null},getNodeCache:function(t,e){if(!e)return null;var n=caches[t.treeId].nodes[data.getNodeCacheId(e)];return n||null},getNodePath:function(t,e){return e?((n=e.parentTId?e.getParentNode().getPath():[])&&n.push(e),n):null;var n},getNodes:function(t){return data.nodeChildren(t,data.getRoot(t))},getNodesByParam:function(t,e,n,r){if(!e||!n)return[];for(var i=[],o=0,a=e.length;o<a;o++){var s=e[o];s[n]==r&&i.push(s);var l=data.nodeChildren(t,s);i=i.concat(data.getNodesByParam(t,l,n,r))}return i},getNodesByParamFuzzy:function(t,e,n,r){if(!e||!n)return[];var i=[];r=r.toLowerCase();for(var o=0,a=e.length;o<a;o++){var s=e[o];"string"==typeof s[n]&&e[o][n].toLowerCase().indexOf(r)>-1&&i.push(s);var l=data.nodeChildren(t,s);i=i.concat(data.getNodesByParamFuzzy(t,l,n,r))}return i},getNodesByFilter:function(t,e,n,r,i){if(!e)return r?null:[];for(var o=r?null:[],a=0,s=e.length;a<s;a++){var l=e[a];if(tools.apply(n,[l,i],!1)){if(r)return l;o.push(l)}var u=data.nodeChildren(t,l),c=data.getNodesByFilter(t,u,n,r,i);if(r&&c)return c;o=r?c:o.concat(c)}return o},getPreNode:function(t,e){if(!e)return null;for(var n=e.parentTId?e.getParentNode():data.getRoot(t),r=data.nodeChildren(t,n),i=0,o=r.length;i<o;i++)if(r[i]===e)return 0==i?null:r[i-1];return null},getRoot:function(t){return t?roots[t.treeId]:null},getRoots:function(){return roots},getSetting:function(t){return settings[t]},getSettings:function(){return settings},getZTreeTools:function(t){var e=this.getRoot(this.getSetting(t));return e?e.treeTools:null},initCache:function(t){for(var e=0,n=_init.caches.length;e<n;e++)_init.caches[e].apply(this,arguments)},initNode:function(t,e,n,r,i,o){for(var a=0,s=_init.nodes.length;a<s;a++)_init.nodes[a].apply(this,arguments)},initRoot:function(t){for(var e=0,n=_init.roots.length;e<n;e++)_init.roots[e].apply(this,arguments)},isSelectedNode:function(t,e){for(var n=data.getRoot(t),r=0,i=n.curSelectedList.length;r<i;r++)if(e===n.curSelectedList[r])return!0;return!1},nodeChildren:function(t,e,n){if(!e)return null;var r=t.data.key.children;return void 0!==n&&(e[r]=n),e[r]},nodeIsParent:function(t,e,n){if(!e)return!1;var r=t.data.key.isParent;return void 0!==n?("string"==typeof n&&(n=tools.eqs(n,"true")),n=!!n,e[r]=n):"string"==typeof e[r]?e[r]=tools.eqs(e[r],"true"):e[r]=!!e[r],e[r]},nodeName:function(t,e,n){var r=t.data.key.name;return void 0!==n&&(e[r]=n),""+e[r]},nodeTitle:function(t,e){return""+e[""===t.data.key.title?t.data.key.name:t.data.key.title]},removeNodeCache:function(t,e){var n=data.nodeChildren(t,e);if(n)for(var r=0,i=n.length;r<i;r++)data.removeNodeCache(t,n[r]);data.getCache(t).nodes[data.getNodeCacheId(e.tId)]=null},removeSelectedNode:function(t,e){for(var n=data.getRoot(t),r=0,i=n.curSelectedList.length;r<i;r++)e!==n.curSelectedList[r]&&data.getNodeCache(t,n.curSelectedList[r].tId)||(n.curSelectedList.splice(r,1),t.treeObj.trigger(consts.event.UNSELECTED,[t.treeId,e]),r--,i--)},setCache:function(t,e){caches[t.treeId]=e},setRoot:function(t,e){roots[t.treeId]=e},setZTreeTools:function(t,e){for(var n=0,r=_init.zTreeTools.length;n<r;n++)_init.zTreeTools[n].apply(this,arguments)},transformToArrayFormat:function(t,e){if(!e)return[];var n=[];if(tools.isArray(e))for(var r=0,i=e.length;r<i;r++){o(e[r])}else o(e);return n;function o(e){n.push(e);var r=data.nodeChildren(t,e);r&&(n=n.concat(data.transformToArrayFormat(t,r)))}},transformTozTreeFormat:function(t,e){var n,r,i=t.data.simpleData.idKey,o=t.data.simpleData.pIdKey;if(!i||""==i||!e)return[];if(tools.isArray(e)){var a=[],s={};for(n=0,r=e.length;n<r;n++)s[e[n][i]]=e[n];for(n=0,r=e.length;n<r;n++){var l=s[e[n][o]];if(l&&e[n][i]!=e[n][o]){var u=data.nodeChildren(t,l);u||(u=data.nodeChildren(t,l,[])),u.push(e[n])}else a.push(e[n])}return a}return[e]}},event={bindEvent:function(t){for(var e=0,n=_init.bind.length;e<n;e++)_init.bind[e].apply(this,arguments)},unbindEvent:function(t){for(var e=0,n=_init.unbind.length;e<n;e++)_init.unbind[e].apply(this,arguments)},bindTree:function(t){var e={treeId:t.treeId},n=t.treeObj;t.view.txtSelectedEnable||n.bind("selectstart",handler.onSelectStart).css({"-moz-user-select":"-moz-none"}),n.bind("click",e,event.proxy),n.bind("dblclick",e,event.proxy),n.bind("mouseover",e,event.proxy),n.bind("mouseout",e,event.proxy),n.bind("mousedown",e,event.proxy),n.bind("mouseup",e,event.proxy),n.bind("contextmenu",e,event.proxy)},unbindTree:function(t){t.treeObj.unbind("selectstart",handler.onSelectStart).unbind("click",event.proxy).unbind("dblclick",event.proxy).unbind("mouseover",event.proxy).unbind("mouseout",event.proxy).unbind("mousedown",event.proxy).unbind("mouseup",event.proxy).unbind("contextmenu",event.proxy)},doProxy:function(t){for(var e=[],n=0,r=_init.proxys.length;n<r;n++){var i=_init.proxys[n].apply(this,arguments);if(e.push(i),i.stop)break}return e},proxy:function(t){var e=data.getSetting(t.data.treeId);if(!tools.uCanDo(e,t))return!0;for(var n=event.doProxy(t),r=!0,i=0,o=n.length;i<o;i++){var a=n[i];a.nodeEventCallback&&(!0,r=a.nodeEventCallback.apply(a,[t,a.node])&&r),a.treeEventCallback&&(!0,r=a.treeEventCallback.apply(a,[t,a.node])&&r)}return r}},handler={onSwitchNode:function(t,e){var n=data.getSetting(t.data.treeId);if(e.open){if(0==tools.apply(n.callback.beforeCollapse,[n.treeId,e],!0))return!0;data.getRoot(n).expandTriggerFlag=!0,view.switchNode(n,e)}else{if(0==tools.apply(n.callback.beforeExpand,[n.treeId,e],!0))return!0;data.getRoot(n).expandTriggerFlag=!0,view.switchNode(n,e)}return!0},onClickNode:function(t,e){var n=data.getSetting(t.data.treeId),r=n.view.autoCancelSelected&&(t.ctrlKey||t.metaKey)&&data.isSelectedNode(n,e)?0:n.view.autoCancelSelected&&(t.ctrlKey||t.metaKey)&&n.view.selectedMulti?2:1;return 0==tools.apply(n.callback.beforeClick,[n.treeId,e,r],!0)||(0===r?view.cancelPreSelectedNode(n,e):view.selectNode(n,e,2===r),n.treeObj.trigger(consts.event.CLICK,[t,n.treeId,e,r])),!0},onZTreeMousedown:function(t,e){var n=data.getSetting(t.data.treeId);return tools.apply(n.callback.beforeMouseDown,[n.treeId,e],!0)&&tools.apply(n.callback.onMouseDown,[t,n.treeId,e]),!0},onZTreeMouseup:function(t,e){var n=data.getSetting(t.data.treeId);return tools.apply(n.callback.beforeMouseUp,[n.treeId,e],!0)&&tools.apply(n.callback.onMouseUp,[t,n.treeId,e]),!0},onZTreeDblclick:function(t,e){var n=data.getSetting(t.data.treeId);return tools.apply(n.callback.beforeDblClick,[n.treeId,e],!0)&&tools.apply(n.callback.onDblClick,[t,n.treeId,e]),!0},onZTreeContextmenu:function(t,e){var n=data.getSetting(t.data.treeId);return tools.apply(n.callback.beforeRightClick,[n.treeId,e],!0)&&tools.apply(n.callback.onRightClick,[t,n.treeId,e]),"function"!=typeof n.callback.onRightClick},onSelectStart:function(t){var e=t.originalEvent.srcElement.nodeName.toLowerCase();return"input"===e||"textarea"===e}},tools={apply:function(t,e,n){return"function"==typeof t?t.apply(zt,e||[]):n},canAsync:function(t,e){var n=data.nodeChildren(t,e),r=data.nodeIsParent(t,e);return t.async.enable&&e&&r&&!(e.zAsync||n&&n.length>0)},clone:function(t){if(null===t)return null;var e=tools.isArray(t)?[]:{};for(var n in t)e[n]=t[n]instanceof Date?new Date(t[n].getTime()):"object"===_typeof(t[n])?tools.clone(t[n]):t[n];return e},eqs:function(t,e){return t.toLowerCase()===e.toLowerCase()},isArray:function(t){return"[object Array]"===Object.prototype.toString.apply(t)},isElement:function(t){return"object"===("undefined"==typeof HTMLElement?"undefined":_typeof(HTMLElement))?t instanceof HTMLElement:t&&"object"===_typeof(t)&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName},$:function(t,e,n){return e&&"string"!=typeof e&&(n=e,e=""),"string"==typeof t?_$(t,n?n.treeObj.get(0).ownerDocument:null):_$("#"+t.tId+e,n?n.treeObj:null)},getMDom:function(t,e,n){if(!e)return null;for(;e&&e.id!==t.treeId;){for(var r=0,i=n.length;e.tagName&&r<i;r++)if(tools.eqs(e.tagName,n[r].tagName)&&null!==e.getAttribute(n[r].attrName))return e;e=e.parentNode}return null},getNodeMainDom:function(t){return _$(t).parent("li").get(0)||_$(t).parentsUntil("li").parent().get(0)},isChildOrSelf:function(t,e){return _$(t).closest("#"+e).length>0},uCanDo:function(t,e){return!0}},view={addNodes:function(t,e,n,r,i){var o=data.nodeIsParent(t,e);if(!t.data.keep.leaf||!e||o)if(tools.isArray(r)||(r=[r]),t.data.simpleData.enable&&(r=data.transformTozTreeFormat(t,r)),e){var a=$$(e,consts.id.SWITCH,t),s=$$(e,consts.id.ICON,t),l=$$(e,consts.id.UL,t);e.open||(view.replaceSwitchClass(e,a,consts.folder.CLOSE),view.replaceIcoClass(e,s,consts.folder.CLOSE),e.open=!1,l.css({display:"none"})),data.addNodesData(t,e,n,r),view.createNodes(t,e.level+1,r,e,n),i||view.expandCollapseParentNode(t,e,!0)}else data.addNodesData(t,data.getRoot(t),n,r),view.createNodes(t,0,r,null,n)},appendNodes:function(t,e,n,r,i,o,a){if(!n)return[];var s,l,u=[],c=r||data.getRoot(t),h=data.nodeChildren(t,c);(!h||i>=h.length-n.length)&&(i=-1);for(var f=0,p=n.length;f<p;f++){var d=n[f];o&&(s=(0===i||h.length==n.length)&&0==f,l=i<0&&f==n.length-1,data.initNode(t,e,d,r,s,l,a),data.addNodeCache(t,d));var g=data.nodeIsParent(t,d),y=[],m=data.nodeChildren(t,d);m&&m.length>0&&(y=view.appendNodes(t,e+1,m,d,-1,o,a&&d.open)),a&&(view.makeDOMNodeMainBefore(u,t,d),view.makeDOMNodeLine(u,t,d),data.getBeforeA(t,d,u),view.makeDOMNodeNameBefore(u,t,d),data.getInnerBeforeA(t,d,u),view.makeDOMNodeIcon(u,t,d),data.getInnerAfterA(t,d,u),view.makeDOMNodeNameAfter(u,t,d),data.getAfterA(t,d,u),g&&d.open&&view.makeUlHtml(t,d,u,y.join("")),view.makeDOMNodeMainAfter(u,t,d),data.addCreatedNode(t,d))}return u},appendParentULDom:function(t,e){var n=[],r=$$(e,t);!r.get(0)&&e.parentTId&&(view.appendParentULDom(t,e.getParentNode()),r=$$(e,t));var i=$$(e,consts.id.UL,t);i.get(0)&&i.remove();var o=data.nodeChildren(t,e),a=view.appendNodes(t,e.level+1,o,e,-1,!1,!0);view.makeUlHtml(t,e,n,a.join("")),r.append(n.join(""))},asyncNode:function asyncNode(setting,node,isSilent,callback){var i,l,isParent=data.nodeIsParent(setting,node);if(node&&!isParent)return tools.apply(callback),!1;if(node&&node.isAjaxing)return!1;if(0==tools.apply(setting.callback.beforeAsync,[setting.treeId,node],!0))return tools.apply(callback),!1;if(node){node.isAjaxing=!0;var icoObj=$$(node,consts.id.ICON,setting);icoObj.attr({style:"",class:consts.className.BUTTON+" "+consts.className.ICO_LOADING})}var tmpParam={},autoParam=tools.apply(setting.async.autoParam,[setting.treeId,node],setting.async.autoParam);for(i=0,l=autoParam.length;node&&i<l;i++){var pKey=autoParam[i].split("="),spKey=pKey;pKey.length>1&&(spKey=pKey[1],pKey=pKey[0]),tmpParam[spKey]=node[pKey]}var otherParam=tools.apply(setting.async.otherParam,[setting.treeId,node],setting.async.otherParam);if(tools.isArray(otherParam))for(i=0,l=otherParam.length;i<l;i+=2)tmpParam[otherParam[i]]=otherParam[i+1];else for(var p in otherParam)tmpParam[p]=otherParam[p];var _tmpV=data.getRoot(setting)._ver;return _$.ajax({contentType:setting.async.contentType,cache:!1,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:setting.async.contentType.indexOf("application/json")>-1?JSON.stringify(tmpParam):tmpParam,dataType:setting.async.dataType,headers:setting.async.headers,xhrFields:setting.async.xhrFields,success:function success(msg){if(_tmpV==data.getRoot(setting)._ver){var newNodes=[];try{newNodes=msg&&0!=msg.length?"string"==typeof msg?eval("("+msg+")"):msg:[]}catch(t){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0),view.setNodeLineIcos(setting,node),newNodes&&""!==newNodes?(newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes),view.addNodes(setting,node,-1,newNodes?tools.clone(newNodes):[],!!isSilent)):view.addNodes(setting,node,-1,[],!!isSilent),setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]),tools.apply(callback)}},error:function(t,e,n){_tmpV==data.getRoot(setting)._ver&&(node&&(node.isAjaxing=null),view.setNodeLineIcos(setting,node),setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,t,e,n]))}}),!0},cancelPreSelectedNode:function(t,e,n){var r,i,o=data.getRoot(t).curSelectedList;for(r=o.length-1;r>=0;r--)if(e===(i=o[r])||!e&&(!n||n!==i)){if($$(i,consts.id.A,t).removeClass(consts.node.CURSELECTED),e){data.removeSelectedNode(t,e);break}o.splice(r,1),t.treeObj.trigger(consts.event.UNSELECTED,[t.treeId,i])}},createNodeCallback:function(t){if(t.callback.onNodeCreated||t.view.addDiyDom)for(var e=data.getRoot(t);e.createdNodes.length>0;){var n=e.createdNodes.shift();tools.apply(t.view.addDiyDom,[t.treeId,n]),t.callback.onNodeCreated&&t.treeObj.trigger(consts.event.NODECREATED,[t.treeId,n])}},createNodes:function(t,e,n,r,i){if(n&&0!=n.length){var o=data.getRoot(t),a=!r||r.open||!!$$(data.nodeChildren(t,r)[0],t).get(0);o.createdNodes=[];var s,l,u=view.appendNodes(t,e,n,r,i,!0,a);if(r){var c=$$(r,consts.id.UL,t);c.get(0)&&(s=c)}else s=t.treeObj;s&&(i>=0&&(l=s.children()[i]),i>=0&&l?_$(l).before(u.join("")):s.append(u.join(""))),view.createNodeCallback(t)}},destroy:function(t){t&&(data.initCache(t),data.initRoot(t),event.unbindTree(t),event.unbindEvent(t),t.treeObj.empty(),delete settings[t.treeId])},expandCollapseNode:function(t,e,n,r,i){var o,a=data.getRoot(t);if(e){var s=data.nodeChildren(t,e),l=data.nodeIsParent(t,e);if(a.expandTriggerFlag&&(o=i,i=function(){o&&o(),e.open?t.treeObj.trigger(consts.event.EXPAND,[t.treeId,e]):t.treeObj.trigger(consts.event.COLLAPSE,[t.treeId,e])},a.expandTriggerFlag=!1),!e.open&&l&&(!$$(e,consts.id.UL,t).get(0)||s&&s.length>0&&!$$(s[0],t).get(0))&&(view.appendParentULDom(t,e),view.createNodeCallback(t)),e.open!=n){var u=$$(e,consts.id.UL,t),c=$$(e,consts.id.SWITCH,t),h=$$(e,consts.id.ICON,t);l?(e.open=!e.open,e.iconOpen&&e.iconClose&&h.attr("style",view.makeNodeIcoStyle(t,e)),e.open?(view.replaceSwitchClass(e,c,consts.folder.OPEN),view.replaceIcoClass(e,h,consts.folder.OPEN),0==r||""==t.view.expandSpeed?(u.show(),tools.apply(i,[])):s&&s.length>0?u.slideDown(t.view.expandSpeed,i):(u.show(),tools.apply(i,[]))):(view.replaceSwitchClass(e,c,consts.folder.CLOSE),view.replaceIcoClass(e,h,consts.folder.CLOSE),0!=r&&""!=t.view.expandSpeed&&s&&s.length>0?u.slideUp(t.view.expandSpeed,i):(u.hide(),tools.apply(i,[])))):tools.apply(i,[])}else tools.apply(i,[])}else tools.apply(i,[])},expandCollapseParentNode:function(t,e,n,r,i){e&&(e.parentTId?(view.expandCollapseNode(t,e,n,r),e.parentTId&&view.expandCollapseParentNode(t,e.getParentNode(),n,r,i)):view.expandCollapseNode(t,e,n,r,i))},expandCollapseSonNode:function(t,e,n,r,i){var o=data.getRoot(t),a=e?data.nodeChildren(t,e):data.nodeChildren(t,o),s=!e&&r,l=data.getRoot(t).expandTriggerFlag;if(data.getRoot(t).expandTriggerFlag=!1,a)for(var u=0,c=a.length;u<c;u++)a[u]&&view.expandCollapseSonNode(t,a[u],n,s);data.getRoot(t).expandTriggerFlag=l,view.expandCollapseNode(t,e,n,r,i)},isSelectedNode:function(t,e){if(!e)return!1;var n,r=data.getRoot(t).curSelectedList;for(n=r.length-1;n>=0;n--)if(e===r[n])return!0;return!1},makeDOMNodeIcon:function(t,e,n){var r=data.nodeName(e,n),i=e.view.nameIsHTML?r:r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");t.push("<span id='",n.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(e,n),"' style='",view.makeNodeIcoStyle(e,n),"'></span><span id='",n.tId,consts.id.SPAN,"' class='",consts.className.NAME,"'>",i,"</span>")},makeDOMNodeLine:function(t,e,n){t.push("<span id='",n.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(e,n),"' treeNode",consts.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(t,e,n){t.push("</li>")},makeDOMNodeMainBefore:function(t,e,n){t.push("<li id='",n.tId,"' class='",consts.className.LEVEL,n.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(t,e,n){t.push("</a>")},makeDOMNodeNameBefore:function(t,e,n){var r=data.nodeTitle(e,n),i=view.makeNodeUrl(e,n),o=view.makeNodeFontCss(e,n),a=[];for(var s in o)a.push(s,":",o[s],";");t.push("<a id='",n.tId,consts.id.A,"' class='",consts.className.LEVEL,n.level,"' treeNode",consts.id.A,' onclick="',n.click||"",'" ',null!=i&&i.length>0?"href='"+i+"'":""," target='",view.makeNodeTarget(n),"' style='",a.join(""),"'"),tools.apply(e.view.showTitle,[e.treeId,n],e.view.showTitle)&&r&&t.push("title='",r.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),t.push(">")},makeNodeFontCss:function(t,e){var n=tools.apply(t.view.fontCss,[t.treeId,e],t.view.fontCss);return n&&"function"!=typeof n?n:{}},makeNodeIcoClass:function(t,e){var n=["ico"];if(!e.isAjaxing){var r=data.nodeIsParent(t,e);n[0]=(e.iconSkin?e.iconSkin+"_":"")+n[0],r?n.push(e.open?consts.folder.OPEN:consts.folder.CLOSE):n.push(consts.folder.DOCU)}return consts.className.BUTTON+" "+n.join("_")},makeNodeIcoStyle:function(t,e){var n=[];if(!e.isAjaxing){var r=data.nodeIsParent(t,e)&&e.iconOpen&&e.iconClose?e.open?e.iconOpen:e.iconClose:e[t.data.key.icon];r&&n.push("background:url(",r,") 0 0 no-repeat;"),0!=t.view.showIcon&&tools.apply(t.view.showIcon,[t.treeId,e],!0)||n.push("display:none;")}return n.join("")},makeNodeLineClass:function(t,e){var n=[];return t.view.showLine?0==e.level&&e.isFirstNode&&e.isLastNode?n.push(consts.line.ROOT):0==e.level&&e.isFirstNode?n.push(consts.line.ROOTS):e.isLastNode?n.push(consts.line.BOTTOM):n.push(consts.line.CENTER):n.push(consts.line.NOLINE),data.nodeIsParent(t,e)?n.push(e.open?consts.folder.OPEN:consts.folder.CLOSE):n.push(consts.folder.DOCU),view.makeNodeLineClassEx(e)+n.join("_")},makeNodeLineClassEx:function(t){return consts.className.BUTTON+" "+consts.className.LEVEL+t.level+" "+consts.className.SWITCH+" "},makeNodeTarget:function(t){return t.target||"_blank"},makeNodeUrl:function(t,e){var n=t.data.key.url;return e[n]?e[n]:null},makeUlHtml:function(t,e,n,r){n.push("<ul id='",e.tId,consts.id.UL,"' class='",consts.className.LEVEL,e.level," ",view.makeUlLineClass(t,e),"' style='display:",e.open?"block":"none","'>"),n.push(r),n.push("</ul>")},makeUlLineClass:function(t,e){return t.view.showLine&&!e.isLastNode?consts.line.LINE:""},removeChildNodes:function(t,e){if(e){var n=data.nodeChildren(t,e);if(n){for(var r=0,i=n.length;r<i;r++)data.removeNodeCache(t,n[r]);if(data.removeSelectedNode(t),delete e[t.data.key.children],t.data.keep.parent)$$(e,consts.id.UL,t).empty();else{data.nodeIsParent(t,e,!1),e.open=!1;var o=$$(e,consts.id.SWITCH,t),a=$$(e,consts.id.ICON,t);view.replaceSwitchClass(e,o,consts.folder.DOCU),view.replaceIcoClass(e,a,consts.folder.DOCU),$$(e,consts.id.UL,t).remove()}}}},scrollIntoView:function(t,e){if(e)if("undefined"!=typeof Element&&"undefined"!=typeof HTMLElement)Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(t){"use strict";function e(t,e){return{start:t,length:e,end:t+e}}function n(e,n){return!1===t||n.start<e.end&&e.start<n.end?Math.max(e.end-n.length,Math.min(n.start,e.start)):(e.start+e.end-n.length)/2}function r(t,e){return{x:t,y:e,translate:function(n,i){return r(t+n,e+i)}}}function i(t,e){for(;t;)e=e.translate(t.offsetLeft,t.offsetTop),t=t.offsetParent;return e}for(var o,a=i(this,r(0,0)),s=r(this.offsetWidth,this.offsetHeight),l=this.parentNode;l instanceof HTMLElement;)o=i(l,r(l.clientLeft,l.clientTop)),l.scrollLeft=n(e(a.x-o.x,s.x),e(l.scrollLeft,l.clientWidth)),l.scrollTop=n(e(a.y-o.y,s.y),e(l.scrollTop,l.clientHeight)),a=a.translate(-l.scrollLeft,-l.scrollTop),l=l.parentNode}),e.scrollIntoViewIfNeeded();else{var n=t.treeObj.get(0).getBoundingClientRect(),r=e.getBoundingClientRect();(r.top<n.top||r.bottom>n.bottom||r.right>n.right||r.left<n.left)&&e.scrollIntoView()}},setFirstNode:function(t,e){var n=data.nodeChildren(t,e);n.length>0&&(n[0].isFirstNode=!0)},setLastNode:function(t,e){var n=data.nodeChildren(t,e);n.length>0&&(n[n.length-1].isLastNode=!0)},removeNode:function(t,e){var n=data.getRoot(t),r=e.parentTId?e.getParentNode():n;if(e.isFirstNode=!1,e.isLastNode=!1,e.getPreNode=function(){return null},e.getNextNode=function(){return null},data.getNodeCache(t,e.tId)){$$(e,t).remove(),data.removeNodeCache(t,e),data.removeSelectedNode(t,e);for(var i=data.nodeChildren(t,r),o=0,a=i.length;o<a;o++)if(i[o].tId==e.tId){i.splice(o,1);break}view.setFirstNode(t,r),view.setLastNode(t,r);var s,l,u,c=i.length;if(t.data.keep.parent||0!=c){if(t.view.showLine&&c>0){var h=i[c-1];if(s=$$(h,consts.id.UL,t),l=$$(h,consts.id.SWITCH,t),u=$$(h,consts.id.ICON,t),r==n)if(1==i.length)view.replaceSwitchClass(h,l,consts.line.ROOT);else{var f=$$(i[0],consts.id.SWITCH,t);view.replaceSwitchClass(i[0],f,consts.line.ROOTS),view.replaceSwitchClass(h,l,consts.line.BOTTOM)}else view.replaceSwitchClass(h,l,consts.line.BOTTOM);s.removeClass(consts.line.LINE)}}else data.nodeIsParent(t,r,!1),r.open=!1,delete r[t.data.key.children],s=$$(r,consts.id.UL,t),l=$$(r,consts.id.SWITCH,t),u=$$(r,consts.id.ICON,t),view.replaceSwitchClass(r,l,consts.folder.DOCU),view.replaceIcoClass(r,u,consts.folder.DOCU),s.css("display","none")}},replaceIcoClass:function(t,e,n){if(e&&!t.isAjaxing){var r=e.attr("class");if(null!=r){var i=r.split("_");switch(n){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:i[i.length-1]=n}e.attr("class",i.join("_"))}}},replaceSwitchClass:function(t,e,n){if(e){var r=e.attr("class");if(null!=r){var i=r.split("_");switch(n){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:i[0]=view.makeNodeLineClassEx(t)+n;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:i[1]=n}e.attr("class",i.join("_")),n!==consts.folder.DOCU?e.removeAttr("disabled"):e.attr("disabled","disabled")}}},selectNode:function(t,e,n){n||view.cancelPreSelectedNode(t,null,e),$$(e,consts.id.A,t).addClass(consts.node.CURSELECTED),data.addSelectedNode(t,e),t.treeObj.trigger(consts.event.SELECTED,[t.treeId,e])},setNodeFontCss:function(t,e){var n=$$(e,consts.id.A,t),r=view.makeNodeFontCss(t,e);r&&n.css(r)},setNodeLineIcos:function(t,e){if(e){var n=$$(e,consts.id.SWITCH,t),r=$$(e,consts.id.UL,t),i=$$(e,consts.id.ICON,t),o=view.makeUlLineClass(t,e);0==o.length?r.removeClass(consts.line.LINE):r.addClass(o),n.attr("class",view.makeNodeLineClass(t,e)),data.nodeIsParent(t,e)?n.removeAttr("disabled"):n.attr("disabled","disabled"),i.removeAttr("style"),i.attr("style",view.makeNodeIcoStyle(t,e)),i.attr("class",view.makeNodeIcoClass(t,e))}},setNodeName:function(t,e){var n=data.nodeTitle(t,e),r=$$(e,consts.id.SPAN,t);(r.empty(),t.view.nameIsHTML?r.html(data.nodeName(t,e)):r.text(data.nodeName(t,e)),tools.apply(t.view.showTitle,[t.treeId,e],t.view.showTitle))&&$$(e,consts.id.A,t).attr("title",n||"")},setNodeTarget:function(t,e){$$(e,consts.id.A,t).attr("target",view.makeNodeTarget(e))},setNodeUrl:function(t,e){var n=$$(e,consts.id.A,t),r=view.makeNodeUrl(t,e);null==r||0==r.length?n.removeAttr("href"):n.attr("href",r)},switchNode:function(t,e){if(e.open||!tools.canAsync(t,e))view.expandCollapseNode(t,e,!e.open);else if(t.async.enable){if(!view.asyncNode(t,e))return void view.expandCollapseNode(t,e,!e.open)}else e&&view.expandCollapseNode(t,e,!e.open)}};_$.fn.zTree={consts:_consts,_z:{tools:tools,view:view,event:event,data:data},getZTreeObj:function(t){var e=data.getZTreeTools(t);return e||null},destroy:function(t){if(t&&t.length>0)view.destroy(data.getSetting(t));else for(var e in settings)view.destroy(settings[e])},init:function(t,e,n){var r=tools.clone(_setting);_$.extend(!0,r,e),r.treeId=t.attr("id"),r.treeObj=t,r.treeObj.empty(),settings[r.treeId]=r,void 0===document.body.style.maxHeight&&(r.view.expandSpeed=""),data.initRoot(r);var i=data.getRoot(r);n=n?tools.clone(tools.isArray(n)?n:[n]):[],r.data.simpleData.enable?data.nodeChildren(r,i,data.transformTozTreeFormat(r,n)):data.nodeChildren(r,i,n),data.initCache(r),event.unbindTree(r),event.bindTree(r),event.unbindEvent(r),event.bindEvent(r);var o={setting:r,addNodes:function(t,e,n,i){t||(t=null);var o=data.nodeIsParent(r,t);if(t&&!o&&r.data.keep.leaf)return null;var a=parseInt(e,10);if(isNaN(a)?(i=!!n,n=e,e=-1):e=a,!n)return null;var s=tools.clone(tools.isArray(n)?n:[n]);function l(){view.addNodes(r,t,e,s,1==i)}return tools.canAsync(r,t)?view.asyncNode(r,t,i,l):l(),s},cancelSelectedNode:function(t){view.cancelPreSelectedNode(r,t)},destroy:function(){view.destroy(r)},expandAll:function(t){return t=!!t,view.expandCollapseSonNode(r,null,t,!0),t},expandNode:function(t,e,n,i,o){return t&&data.nodeIsParent(r,t)?(!0!==e&&!1!==e&&(e=!t.open),(o=!!o)&&e&&0==tools.apply(r.callback.beforeExpand,[r.treeId,t],!0)||o&&!e&&0==tools.apply(r.callback.beforeCollapse,[r.treeId,t],!0)?null:(e&&t.parentTId&&view.expandCollapseParentNode(r,t.getParentNode(),e,!1),e!==t.open||n?(data.getRoot(r).expandTriggerFlag=o,!tools.canAsync(r,t)&&n?view.expandCollapseSonNode(r,t,e,!0,a):(t.open=!e,view.switchNode(this.setting,t),a()),e):null)):null;function a(){var e=$$(t,r).get(0);e&&!1!==i&&view.scrollIntoView(r,e)}},getNodes:function(){return data.getNodes(r)},getNodeByParam:function(t,e,n){return t?data.getNodeByParam(r,n?data.nodeChildren(r,n):data.getNodes(r),t,e):null},getNodeByTId:function(t){return data.getNodeCache(r,t)},getNodesByParam:function(t,e,n){return t?data.getNodesByParam(r,n?data.nodeChildren(r,n):data.getNodes(r),t,e):null},getNodesByParamFuzzy:function(t,e,n){return t?data.getNodesByParamFuzzy(r,n?data.nodeChildren(r,n):data.getNodes(r),t,e):null},getNodesByFilter:function(t,e,n,i){return e=!!e,t&&"function"==typeof t?data.getNodesByFilter(r,n?data.nodeChildren(r,n):data.getNodes(r),t,e,i):e?null:[]},getNodeIndex:function(t){if(!t)return null;for(var e=t.parentTId?t.getParentNode():data.getRoot(r),n=data.nodeChildren(r,e),i=0,o=n.length;i<o;i++)if(n[i]==t)return i;return-1},getSelectedNodes:function(){for(var t=[],e=data.getRoot(r).curSelectedList,n=0,i=e.length;n<i;n++)t.push(e[n]);return t},isSelectedNode:function(t){return data.isSelectedNode(r,t)},reAsyncChildNodesPromise:function(t,e,n){return new Promise((function(r,i){try{o.reAsyncChildNodes(t,e,n,(function(){r(t)}))}catch(t){i(t)}}))},reAsyncChildNodes:function(t,e,n,i){if(this.setting.async.enable){var o=!t;if(o&&(t=data.getRoot(r)),"refresh"==e){for(var a=data.nodeChildren(r,t),s=0,l=a?a.length:0;s<l;s++)data.removeNodeCache(r,a[s]);if(data.removeSelectedNode(r),data.nodeChildren(r,t,[]),o)this.setting.treeObj.empty();else $$(t,consts.id.UL,r).empty()}view.asyncNode(this.setting,o?null:t,!!n,i)}},refresh:function(){this.setting.treeObj.empty();var t=data.getRoot(r),e=data.nodeChildren(r,t);data.initRoot(r),data.nodeChildren(r,t,e),data.initCache(r),view.createNodes(r,0,data.nodeChildren(r,t),null,-1)},removeChildNodes:function(t){if(!t)return null;var e=data.nodeChildren(r,t);return view.removeChildNodes(r,t),e||null},removeNode:function(t,e){t&&((e=!!e)&&0==tools.apply(r.callback.beforeRemove,[r.treeId,t],!0)||(view.removeNode(r,t),e&&this.setting.treeObj.trigger(consts.event.REMOVE,[r.treeId,t])))},selectNode:function(t,e,n){if(t&&tools.uCanDo(r)){if(e=r.view.selectedMulti&&e,t.parentTId)view.expandCollapseParentNode(r,t.getParentNode(),!0,!1,(function(){if(n)return;var e=$$(t,r).get(0);view.scrollIntoView(r,e)}));else if(!n)try{$$(t,r).focus().blur()}catch(t){}view.selectNode(r,t,e)}},transformTozTreeNodes:function(t){return data.transformTozTreeFormat(r,t)},transformToArray:function(t){return data.transformToArrayFormat(r,t)},updateNode:function(t,e){t&&($$(t,r).get(0)&&tools.uCanDo(r)&&(view.setNodeName(r,t),view.setNodeTarget(r,t),view.setNodeUrl(r,t),view.setNodeLineIcos(r,t),view.setNodeFontCss(r,t)))}};i.treeTools=o,data.setZTreeTools(r,o);var a=data.nodeChildren(r,i);return a&&a.length>0?view.createNodes(r,0,a,null,-1):r.async.enable&&r.async.url&&""!==r.async.url&&view.asyncNode(r),o}};var zt=_$.fn.zTree,$$=tools.$,consts=zt.consts}(jQuery),function(t){var e={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},n={check:{enable:!1,autoCheckTrigger:!1,chkStyle:e.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:e.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},r={onCheckNode:function(t,e){if(!0===e.chkDisabled)return!1;var n=u.getSetting(t.data.treeId);if(0==a.apply(n.callback.beforeCheck,[n.treeId,e],!0))return!0;var r=u.nodeChecked(n,e);u.nodeChecked(n,e,!r),l.checkNodeRelation(n,e);var i=c(e,s.id.CHECK,n);return l.setChkClass(n,i,e),l.repairParentChkClassWithSelf(n,e),n.treeObj.trigger(s.event.CHECK,[t,n.treeId,e]),!0},onMouseoverCheck:function(t,e){if(!0===e.chkDisabled)return!1;var n=u.getSetting(t.data.treeId),r=c(e,s.id.CHECK,n);return e.check_Focus=!0,l.setChkClass(n,r,e),!0},onMouseoutCheck:function(t,e){if(!0===e.chkDisabled)return!1;var n=u.getSetting(t.data.treeId),r=c(e,s.id.CHECK,n);return e.check_Focus=!1,l.setChkClass(n,r,e),!0}},i={tools:{},view:{checkNodeRelation:function(t,e){var n,r,i,o=s.radio,a=u.nodeChecked(t,e);if(t.check.chkStyle==o.STYLE){var h=u.getRadioCheckedList(t);if(a)if(t.check.radioType==o.TYPE_ALL){for(r=h.length-1;r>=0;r--){n=h[r],u.nodeChecked(t,n)&&n!=e&&(u.nodeChecked(t,n,!1),h.splice(r,1),l.setChkClass(t,c(n,s.id.CHECK,t),n),n.parentTId!=e.parentTId&&l.repairParentChkClassWithSelf(t,n))}h.push(e)}else{var f=e.parentTId?e.getParentNode():u.getRoot(t);for(r=0,i=(p=u.nodeChildren(t,f)).length;r<i;r++){n=p[r],u.nodeChecked(t,n)&&n!=e&&(u.nodeChecked(t,n,!1),l.setChkClass(t,c(n,s.id.CHECK,t),n))}}else if(t.check.radioType==o.TYPE_ALL)for(r=0,i=h.length;r<i;r++)if(e==h[r]){h.splice(r,1);break}}else{var p=u.nodeChildren(t,e);a&&(!p||0==p.length||t.check.chkboxType.Y.indexOf("s")>-1)&&l.setSonNodeCheckBox(t,e,!0),a||p&&0!=p.length&&!(t.check.chkboxType.N.indexOf("s")>-1)||l.setSonNodeCheckBox(t,e,!1),a&&t.check.chkboxType.Y.indexOf("p")>-1&&l.setParentNodeCheckBox(t,e,!0),!a&&t.check.chkboxType.N.indexOf("p")>-1&&l.setParentNodeCheckBox(t,e,!1)}},makeChkClass:function(t,e){var n=s.checkbox,r=s.radio,i="",o=u.nodeChecked(t,e);i=!0===e.chkDisabled?n.DISABLED:e.halfCheck?n.PART:t.check.chkStyle==r.STYLE?e.check_Child_State<1?n.FULL:n.PART:o?2===e.check_Child_State||-1===e.check_Child_State?n.FULL:n.PART:e.check_Child_State<1?n.FULL:n.PART;var a=t.check.chkStyle+"_"+(o?n.TRUE:n.FALSE)+"_"+i;return a=e.check_Focus&&!0!==e.chkDisabled?a+"_"+n.FOCUS:a,s.className.BUTTON+" "+n.DEFAULT+" "+a},repairAllChk:function(t,e){if(t.check.enable&&t.check.chkStyle===s.checkbox.STYLE)for(var n=u.getRoot(t),r=u.nodeChildren(t,n),i=0,o=r.length;i<o;i++){var a=r[i];!0!==a.nocheck&&!0!==a.chkDisabled&&u.nodeChecked(t,a,e),l.setSonNodeCheckBox(t,a,e)}},repairChkClass:function(t,e){if(e&&(u.makeChkFlag(t,e),!0!==e.nocheck)){var n=c(e,s.id.CHECK,t);l.setChkClass(t,n,e)}},repairParentChkClass:function(t,e){if(e&&e.parentTId){var n=e.getParentNode();l.repairChkClass(t,n),l.repairParentChkClass(t,n)}},repairParentChkClassWithSelf:function(t,e){if(e){var n=u.nodeChildren(t,e);n&&n.length>0?l.repairParentChkClass(t,n[0]):l.repairParentChkClass(t,e)}},repairSonChkDisabled:function(t,e,n,r){if(e){e.chkDisabled!=n&&(e.chkDisabled=n),l.repairChkClass(t,e);var i=u.nodeChildren(t,e);if(i&&r)for(var o=0,a=i.length;o<a;o++){var s=i[o];l.repairSonChkDisabled(t,s,n,r)}}},repairParentChkDisabled:function(t,e,n,r){e&&(e.chkDisabled!=n&&r&&(e.chkDisabled=n),l.repairChkClass(t,e),l.repairParentChkDisabled(t,e.getParentNode(),n,r))},setChkClass:function(t,e,n){e&&(!0===n.nocheck?e.hide():e.show(),e.attr("class",l.makeChkClass(t,n)))},setParentNodeCheckBox:function(t,e,n,r){var i=c(e,s.id.CHECK,t);if(r||(r=e),u.makeChkFlag(t,e),!0!==e.nocheck&&!0!==e.chkDisabled&&(u.nodeChecked(t,e,n),l.setChkClass(t,i,e),t.check.autoCheckTrigger&&e!=r&&t.treeObj.trigger(s.event.CHECK,[null,t.treeId,e])),e.parentTId){var o=!0;if(!n)for(var a=u.nodeChildren(t,e.getParentNode()),h=0,f=a.length;h<f;h++){var p=a[h],d=u.nodeChecked(t,p);if(!0!==p.nocheck&&!0!==p.chkDisabled&&d||(!0===p.nocheck||!0===p.chkDisabled)&&p.check_Child_State>0){o=!1;break}}o&&l.setParentNodeCheckBox(t,e.getParentNode(),n,r)}},setSonNodeCheckBox:function(t,e,n,r){if(e){var i=c(e,s.id.CHECK,t);r||(r=e);var o=!1,a=u.nodeChildren(t,e);if(a)for(var h=0,f=a.length;h<f;h++){var p=a[h];l.setSonNodeCheckBox(t,p,n,r),!0===p.chkDisabled&&(o=!0)}e!=u.getRoot(t)&&!0!==e.chkDisabled&&(o&&!0!==e.nocheck&&u.makeChkFlag(t,e),!0!==e.nocheck&&!0!==e.chkDisabled?(u.nodeChecked(t,e,n),o||(e.check_Child_State=a&&a.length>0?n?2:0:-1)):e.check_Child_State=-1,l.setChkClass(t,i,e),t.check.autoCheckTrigger&&e!=r&&!0!==e.nocheck&&!0!==e.chkDisabled&&t.treeObj.trigger(s.event.CHECK,[null,t.treeId,e]))}}},event:{},data:{getRadioCheckedList:function(t){for(var e=u.getRoot(t).radioCheckedList,n=0,r=e.length;n<r;n++)u.getNodeCache(t,e[n].tId)||(e.splice(n,1),n--,r--);return e},getCheckStatus:function(t,e){if(!t.check.enable||e.nocheck||e.chkDisabled)return null;var n=u.nodeChecked(t,e);return{checked:n,half:e.halfCheck?e.halfCheck:t.check.chkStyle==s.radio.STYLE?2===e.check_Child_State:n?e.check_Child_State>-1&&e.check_Child_State<2:e.check_Child_State>0}},getTreeCheckedNodes:function(t,e,n,r){if(!e)return[];var i=n&&t.check.chkStyle==s.radio.STYLE&&t.check.radioType==s.radio.TYPE_ALL;r=r||[];for(var o=0,a=e.length;o<a;o++){var l=e[o],c=u.nodeChildren(t,l),h=u.nodeChecked(t,l);if(!0!==l.nocheck&&!0!==l.chkDisabled&&h==n&&(r.push(l),i))break;if(u.getTreeCheckedNodes(t,c,n,r),i&&r.length>0)break}return r},getTreeChangeCheckedNodes:function(t,e,n){if(!e)return[];n=n||[];for(var r=0,i=e.length;r<i;r++){var o=e[r],a=u.nodeChildren(t,o),s=u.nodeChecked(t,o);!0!==o.nocheck&&!0!==o.chkDisabled&&s!=o.checkedOld&&n.push(o),u.getTreeChangeCheckedNodes(t,a,n)}return n},makeChkFlag:function(t,e){if(e){var n=-1,r=u.nodeChildren(t,e);if(r)for(var i=0,o=r.length;i<o;i++){var a=r[i],l=u.nodeChecked(t,a),c=-1;if(t.check.chkStyle==s.radio.STYLE){if(2==(c=!0===a.nocheck||!0===a.chkDisabled?a.check_Child_State:!0===a.halfCheck||l||a.check_Child_State>0?2:0)){n=2;break}0==c&&(n=0)}else if(t.check.chkStyle==s.checkbox.STYLE){if(1===(c=!0===a.nocheck||!0===a.chkDisabled?a.check_Child_State:!0===a.halfCheck?1:l?-1===a.check_Child_State||2===a.check_Child_State?2:1:a.check_Child_State>0?1:0)){n=1;break}if(2===c&&n>-1&&i>0&&c!==n){n=1;break}if(2===n&&c>-1&&c<2){n=1;break}c>-1&&(n=c)}}e.check_Child_State=n}}}};t.extend(!0,t.fn.zTree.consts,e),t.extend(!0,t.fn.zTree._z,i);var o=t.fn.zTree,a=o._z.tools,s=o.consts,l=o._z.view,u=o._z.data,c=(o._z.event,a.$);u.nodeChecked=function(t,e,n){if(!e)return!1;var r=t.data.key.checked;return void 0!==n?("string"==typeof n&&(n=a.eqs(n,"true")),n=!!n,e[r]=n):"string"==typeof e[r]?e[r]=a.eqs(e[r],"true"):e[r]=!!e[r],e[r]},u.exSetting(n),u.addInitBind((function(t){var e=t.treeObj,n=s.event;e.bind(n.CHECK,(function(e,n,r,i){e.srcEvent=n,a.apply(t.callback.onCheck,[e,r,i])}))})),u.addInitUnBind((function(t){var e=t.treeObj,n=s.event;e.unbind(n.CHECK)})),u.addInitCache((function(t){})),u.addInitNode((function(t,e,n,r,i,o,l){if(n){var c=u.nodeChecked(t,n);if(n.checkedOld=c,"string"==typeof n.nocheck&&(n.nocheck=a.eqs(n.nocheck,"true")),n.nocheck=!!n.nocheck||t.check.nocheckInherit&&r&&!!r.nocheck,"string"==typeof n.chkDisabled&&(n.chkDisabled=a.eqs(n.chkDisabled,"true")),n.chkDisabled=!!n.chkDisabled||t.check.chkDisabledInherit&&r&&!!r.chkDisabled,"string"==typeof n.halfCheck&&(n.halfCheck=a.eqs(n.halfCheck,"true")),n.halfCheck=!!n.halfCheck,n.check_Child_State=-1,n.check_Focus=!1,n.getCheckStatus=function(){return u.getCheckStatus(t,n)},t.check.chkStyle==s.radio.STYLE&&t.check.radioType==s.radio.TYPE_ALL&&c)u.getRoot(t).radioCheckedList.push(n)}})),u.addInitProxy((function(t){var e=t.target,n=u.getSetting(t.data.treeId),i="",o=null,l="",c=null;if(a.eqs(t.type,"mouseover")?n.check.enable&&a.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+s.id.CHECK)&&(i=a.getNodeMainDom(e).id,l="mouseoverCheck"):a.eqs(t.type,"mouseout")?n.check.enable&&a.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+s.id.CHECK)&&(i=a.getNodeMainDom(e).id,l="mouseoutCheck"):a.eqs(t.type,"click")&&n.check.enable&&a.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+s.id.CHECK)&&(i=a.getNodeMainDom(e).id,l="checkNode"),i.length>0)switch(o=u.getNodeCache(n,i),l){case"checkNode":c=r.onCheckNode;break;case"mouseoverCheck":c=r.onMouseoverCheck;break;case"mouseoutCheck":c=r.onMouseoutCheck}return{stop:"checkNode"===l,node:o,nodeEventType:l,nodeEventCallback:c,treeEventType:"",treeEventCallback:null}}),!0),u.addInitRoot((function(t){u.getRoot(t).radioCheckedList=[]})),u.addBeforeA((function(t,e,n){t.check.enable&&(u.makeChkFlag(t,e),n.push("<span ID='",e.tId,s.id.CHECK,"' class='",l.makeChkClass(t,e),"' treeNode",s.id.CHECK,!0===e.nocheck?" style='display:none;'":"","></span>"))})),u.addZTreeTools((function(t,e){e.checkNode=function(e,n,r,i){var o=u.nodeChecked(t,e);if(!0!==e.chkDisabled&&(!0!==n&&!1!==n&&(n=!o),i=!!i,(o!==n||r)&&(!i||0!=a.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],!0))&&a.uCanDo(this.setting)&&this.setting.check.enable&&!0!==e.nocheck)){u.nodeChecked(t,e,n);var h=c(e,s.id.CHECK,this.setting);(r||this.setting.check.chkStyle===s.radio.STYLE)&&l.checkNodeRelation(this.setting,e),l.setChkClass(this.setting,h,e),l.repairParentChkClassWithSelf(this.setting,e),i&&this.setting.treeObj.trigger(s.event.CHECK,[null,this.setting.treeId,e])}},e.checkAllNodes=function(t){l.repairAllChk(this.setting,!!t)},e.getCheckedNodes=function(e){e=!1!==e;var n=u.nodeChildren(t,u.getRoot(this.setting));return u.getTreeCheckedNodes(this.setting,n,e)},e.getChangeCheckedNodes=function(){var e=u.nodeChildren(t,u.getRoot(this.setting));return u.getTreeChangeCheckedNodes(this.setting,e)},e.setChkDisabled=function(t,e,n,r){e=!!e,n=!!n,r=!!r,l.repairSonChkDisabled(this.setting,t,e,r),l.repairParentChkDisabled(this.setting,t.getParentNode(),e,n)};var n=e.updateNode;e.updateNode=function(t,r){if(n&&n.apply(e,arguments),t&&this.setting.check.enable){var i=c(t,this.setting);if(i.get(0)&&a.uCanDo(this.setting)){var o=c(t,s.id.CHECK,this.setting);1!=r&&this.setting.check.chkStyle!==s.radio.STYLE||l.checkNodeRelation(this.setting,t),l.setChkClass(this.setting,o,t),l.repairParentChkClassWithSelf(this.setting,t)}}}}));var h=l.createNodes;l.createNodes=function(t,e,n,r,i){h&&h.apply(l,arguments),n&&l.repairParentChkClassWithSelf(t,r)};var f=l.removeNode;l.removeNode=function(t,e){var n=e.getParentNode();f&&f.apply(l,arguments),e&&n&&(l.repairChkClass(t,n),l.repairParentChkClass(t,n))};var p=l.appendNodes;l.appendNodes=function(t,e,n,r,i,o,a){var s="";return p&&(s=p.apply(l,arguments)),r&&u.makeChkFlag(t,r),s}}(jQuery),function(t){var e={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},n={onHoverOverNode:function(t,e){var r=l.getSetting(t.data.treeId),i=l.getRoot(r);i.curHoverNode!=e&&n.onHoverOutNode(t),i.curHoverNode=e,s.addHoverDom(r,e)},onHoverOutNode:function(t,e){var n=l.getSetting(t.data.treeId),r=l.getRoot(n);r.curHoverNode&&!l.isSelectedNode(n,r.curHoverNode)&&(s.removeTreeDom(n,r.curHoverNode),r.curHoverNode=null)},onMousedownNode:function(n,r){var i,c,h=l.getSetting(n.data.treeId),f=l.getRoot(h),p=l.getRoots();if(2==n.button||!h.edit.enable||!h.edit.drag.isCopy&&!h.edit.drag.isMove)return!0;var d=n.target,g=l.getRoot(h).curSelectedList,y=[];if(l.isSelectedNode(h,r))for(i=0,c=g.length;i<c;i++){if(g[i].editNameFlag&&o.eqs(d.tagName,"input")&&null!==d.getAttribute("treeNode"+a.id.INPUT))return!0;if(y.push(g[i]),y[0].parentTId!==g[i].parentTId){y=[r];break}}else y=[r];s.editNodeBlur=!0,s.cancelCurEditNode(h);var m,v,_,b,w,x=t(h.treeObj.get(0).ownerDocument),L=t(h.treeObj.get(0).ownerDocument.body),E=!1,C=h,k=h,S=null,P=null,M=null,T=a.move.TYPE_INNER,O=n.clientX,I=n.clientY,N=(new Date).getTime();function D(n){if(0==f.dragFlag&&Math.abs(O-n.clientX)<h.edit.drag.minMoveSize&&Math.abs(I-n.clientY)<h.edit.drag.minMoveSize)return!0;var r,i,c,d,g;if(L.css("cursor","pointer"),0==f.dragFlag){if(0==o.apply(h.callback.beforeDrag,[h.treeId,y],!0))return R(n),!0;for(r=0,i=y.length;r<i;r++)0==r&&(f.dragNodeShowBefore=[]),c=y[r],l.nodeIsParent(h,c)&&c.open?(s.expandCollapseNode(h,c,!c.open),f.dragNodeShowBefore[c.tId]=!0):f.dragNodeShowBefore[c.tId]=!1;f.dragFlag=1,p.showHoverDom=!1,o.showIfameMask(h,!0);var k=!0,D=-1;if(y.length>1){var A=y[0].parentTId?l.nodeChildren(h,y[0].getParentNode()):l.getNodes(h);for(g=[],r=0,i=A.length;r<i;r++)if(void 0!==f.dragNodeShowBefore[A[r].tId]&&(k&&D>-1&&D+1!==r&&(k=!1),g.push(A[r]),D=r),y.length===g.length){y=g;break}}for(k&&(b=y[0].getPreNode(),w=y[y.length-1].getNextNode()),m=u("<ul class='zTreeDragUL'></ul>",h),r=0,i=y.length;r<i;r++)(c=y[r]).editNameFlag=!1,s.selectNode(h,c,r>0),s.removeTreeDom(h,c),r>h.edit.drag.maxShowNodeNum-1||((d=u("<li id='"+c.tId+"_tmp'></li>",h)).append(u(c,a.id.A,h).clone()),d.css("padding","0"),d.children("#"+c.tId+a.id.A).removeClass(a.node.CURSELECTED),m.append(d),r==h.edit.drag.maxShowNodeNum-1&&(d=u("<li id='"+c.tId+"_moretmp'><a>  ...  </a></li>",h),m.append(d)));m.attr("id",y[0].tId+a.id.UL+"_tmp"),m.addClass(h.treeObj.attr("class")),m.appendTo(L),(v=u("<span class='tmpzTreeMove_arrow'></span>",h)).attr("id","zTreeMove_arrow_tmp"),v.appendTo(L),h.treeObj.trigger(a.event.DRAG,[n,h.treeId,y])}if(1==f.dragFlag){if(_&&v.attr("id")==n.target.id&&M&&n.clientX+x.scrollLeft()+2>t("#"+M+a.id.A,_).offset().left){var j=t("#"+M+a.id.A,_);n.target=j.length>0?j.get(0):n.target}else _&&(_.removeClass(a.node.TMPTARGET_TREE),M&&t("#"+M+a.id.A,_).removeClass(a.node.TMPTARGET_NODE+"_"+a.move.TYPE_PREV).removeClass(a.node.TMPTARGET_NODE+"_"+e.move.TYPE_NEXT).removeClass(a.node.TMPTARGET_NODE+"_"+e.move.TYPE_INNER));_=null,M=null,E=!1,C=h;var B=l.getSettings();for(var z in B)B[z].treeId&&B[z].edit.enable&&B[z].treeId!=h.treeId&&(n.target.id==B[z].treeId||t(n.target).parents("#"+B[z].treeId).length>0)&&(E=!0,C=B[z]);var F=x.scrollTop(),G=x.scrollLeft(),U=C.treeObj.offset(),q=C.treeObj.get(0).scrollHeight,H=C.treeObj.get(0).scrollWidth,V=n.clientY+F-U.top,Y=C.treeObj.height()+U.top-n.clientY-F,W=n.clientX+G-U.left,X=C.treeObj.width()+U.left-n.clientX-G,Z=V<h.edit.drag.borderMax&&V>h.edit.drag.borderMin,K=Y<h.edit.drag.borderMax&&Y>h.edit.drag.borderMin,J=W<h.edit.drag.borderMax&&W>h.edit.drag.borderMin,Q=X<h.edit.drag.borderMax&&X>h.edit.drag.borderMin,$=V>h.edit.drag.borderMin&&Y>h.edit.drag.borderMin&&W>h.edit.drag.borderMin&&X>h.edit.drag.borderMin,tt=Z&&C.treeObj.scrollTop()<=0,et=K&&C.treeObj.scrollTop()+C.treeObj.height()+10>=q,nt=J&&C.treeObj.scrollLeft()<=0,rt=Q&&C.treeObj.scrollLeft()+C.treeObj.width()+10>=H;if(n.target&&o.isChildOrSelf(n.target,C.treeId)){for(var it=n.target;it&&it.tagName&&!o.eqs(it.tagName,"li")&&it.id!=C.treeId;)it=it.parentNode;var ot=!0;for(r=0,i=y.length;r<i;r++){if(c=y[r],it.id===c.tId){ot=!1;break}if(u(c,h).find("#"+it.id).length>0){ot=!1;break}}ot&&n.target&&o.isChildOrSelf(n.target,it.id+a.id.A)&&(_=t(it),M=it.id)}c=y[0],$&&o.isChildOrSelf(n.target,C.treeId)&&(!_&&(n.target.id==C.treeId||tt||et||nt||rt)&&(E||!E&&c.parentTId)&&(_=C.treeObj),Z?C.treeObj.scrollTop(C.treeObj.scrollTop()-10):K&&C.treeObj.scrollTop(C.treeObj.scrollTop()+10),J?C.treeObj.scrollLeft(C.treeObj.scrollLeft()-10):Q&&C.treeObj.scrollLeft(C.treeObj.scrollLeft()+10),_&&_!=C.treeObj&&_.offset().left<C.treeObj.offset().left&&C.treeObj.scrollLeft(C.treeObj.scrollLeft()+_.offset().left-C.treeObj.offset().left)),m.css({top:n.clientY+F+3+"px",left:n.clientX+G+3+"px"});var at=0,st=0;if(_&&_.attr("id")!=C.treeId){var lt=function(){_=null,M="",T=a.move.TYPE_INNER,v.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)},ut=null==M?null:l.getNodeCache(C,M),ct=(n.ctrlKey||n.metaKey)&&h.edit.drag.isMove&&h.edit.drag.isCopy||!h.edit.drag.isMove&&h.edit.drag.isCopy,ht=!(!b||M!==b.tId),ft=!(!w||M!==w.tId),pt=c.parentTId&&c.parentTId==M,dt=(ct||!ft)&&o.apply(C.edit.drag.prev,[C.treeId,y,ut],!!C.edit.drag.prev),gt=(ct||!ht)&&o.apply(C.edit.drag.next,[C.treeId,y,ut],!!C.edit.drag.next),yt=(ct||!pt)&&!(C.data.keep.leaf&&!l.nodeIsParent(h,ut))&&o.apply(C.edit.drag.inner,[C.treeId,y,ut],!!C.edit.drag.inner);if(dt||gt||yt){var mt=t("#"+M+a.id.A,_),vt=ut.isLastNode?null:t("#"+ut.getNextNode().tId+a.id.A,_.next()),_t=mt.offset().top,bt=mt.offset().left,wt=dt?yt?.25:gt?.5:1:-1,xt=gt?yt?.75:dt?.5:0:-1,Lt=(n.clientY+F-_t)/mt.height();if((1==wt||Lt<=wt&&Lt>=-.2)&&dt?(at=1-v.width(),st=_t-v.height()/2,T=a.move.TYPE_PREV):(0==xt||Lt>=xt&&Lt<=1.2)&&gt?(at=1-v.width(),st=null==vt||l.nodeIsParent(h,ut)&&ut.open?_t+mt.height()-v.height()/2:vt.offset().top-v.height()/2,T=a.move.TYPE_NEXT):yt?(at=5-v.width(),st=_t,T=a.move.TYPE_INNER):lt(),_&&(v.css({display:"block",top:st+"px",left:bt+at+"px"}),mt.addClass(a.node.TMPTARGET_NODE+"_"+T),S==M&&P==T||(N=(new Date).getTime()),ut&&l.nodeIsParent(h,ut)&&T==a.move.TYPE_INNER)){var Et=!0;window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==ut.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===ut.tId&&(Et=!1),Et&&(window.zTreeMoveTimer=setTimeout((function(){T==a.move.TYPE_INNER&&ut&&l.nodeIsParent(h,ut)&&!ut.open&&(new Date).getTime()-N>C.edit.drag.autoOpenTime&&o.apply(C.callback.beforeDragOpen,[C.treeId,ut],!0)&&(s.switchNode(C,ut),C.edit.drag.autoExpandTrigger&&C.treeObj.trigger(a.event.EXPAND,[C.treeId,ut]))}),C.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=ut.tId)}}else lt()}else T=a.move.TYPE_INNER,_&&o.apply(C.edit.drag.inner,[C.treeId,y,null],!!C.edit.drag.inner)?_.addClass(a.node.TMPTARGET_TREE):_=null,v.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);S=M,P=T,h.treeObj.trigger(a.event.DRAGMOVE,[n,h.treeId,y])}return!1}function R(n){if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),S=null,P=null,x.unbind("mousemove",D),x.unbind("mouseup",R),x.unbind("selectstart",A),L.css("cursor",""),_&&(_.removeClass(a.node.TMPTARGET_TREE),M&&t("#"+M+a.id.A,_).removeClass(a.node.TMPTARGET_NODE+"_"+a.move.TYPE_PREV).removeClass(a.node.TMPTARGET_NODE+"_"+e.move.TYPE_NEXT).removeClass(a.node.TMPTARGET_NODE+"_"+e.move.TYPE_INNER)),o.showIfameMask(h,!1),p.showHoverDom=!0,0!=f.dragFlag){var r,i,c;for(f.dragFlag=0,r=0,i=y.length;r<i;r++)c=y[r],l.nodeIsParent(h,c)&&f.dragNodeShowBefore[c.tId]&&!c.open&&(s.expandCollapseNode(h,c,!c.open),delete f.dragNodeShowBefore[c.tId]);m&&m.remove(),v&&v.remove();var d=(n.ctrlKey||n.metaKey)&&h.edit.drag.isMove&&h.edit.drag.isCopy||!h.edit.drag.isMove&&h.edit.drag.isCopy;if(!d&&_&&M&&y[0].parentTId&&M==y[0].parentTId&&T==a.move.TYPE_INNER&&(_=null),_){var g=function(){if(E){if(!d)for(var t=0,e=y.length;t<e;t++)s.removeNode(h,y[t]);T==a.move.TYPE_INNER?s.addNodes(C,b,-1,w):s.addNodes(C,b.getParentNode(),T==a.move.TYPE_PREV?b.getIndex():b.getIndex()+1,w)}else if(d&&T==a.move.TYPE_INNER)s.addNodes(C,b,-1,w);else if(d)s.addNodes(C,b.getParentNode(),T==a.move.TYPE_PREV?b.getIndex():b.getIndex()+1,w);else if(T!=a.move.TYPE_NEXT)for(t=0,e=w.length;t<e;t++)s.moveNode(C,b,w[t],T,!1);else for(t=-1,e=w.length-1;t<e;e--)s.moveNode(C,b,w[e],T,!1);s.selectNodes(C,w);var r=u(w[0],h).get(0);s.scrollIntoView(h,r),h.treeObj.trigger(a.event.DROP,[n,C.treeId,w,b,T,d])},b=null==M?null:l.getNodeCache(C,M);if(0==o.apply(h.callback.beforeDrop,[C.treeId,y,b,T,d],!0))return void s.selectNodes(k,y);var w=d?o.clone(y):y;T==a.move.TYPE_INNER&&o.canAsync(C,b)?s.asyncNode(C,b,!1,g):g()}else s.selectNodes(k,y),h.treeObj.trigger(a.event.DROP,[n,h.treeId,y,null,null,null])}}function A(){return!1}return o.uCanDo(h)&&x.bind("mousemove",D),x.bind("mouseup",R),x.bind("selectstart",A),!0}},r={tools:{getAbs:function(t){var e=t.getBoundingClientRect(),n=document.body.scrollTop+document.documentElement.scrollTop,r=document.body.scrollLeft+document.documentElement.scrollLeft;return[e.left+r,e.top+n]},inputFocus:function(t){t.get(0)&&(t.focus(),o.setCursorPosition(t.get(0),t.val().length))},inputSelect:function(t){t.get(0)&&(t.focus(),t.select())},setCursorPosition:function(t,e){if(t.setSelectionRange)t.focus(),t.setSelectionRange(e,e);else if(t.createTextRange){var n=t.createTextRange();n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",e),n.select()}},showIfameMask:function(t,e){for(var n=l.getRoot(t);n.dragMaskList.length>0;)n.dragMaskList[0].remove(),n.dragMaskList.shift();if(e)for(var r=u("iframe",t),i=0,a=r.length;i<a;i++){var s=r.get(i),c=o.getAbs(s),h=u("<div id='zTreeMask_"+i+"' class='zTreeMask' style='top:"+c[1]+"px; left:"+c[0]+"px; width:"+s.offsetWidth+"px; height:"+s.offsetHeight+"px;'></div>",t);h.appendTo(u("body",t)),n.dragMaskList.push(h)}}},view:{addEditBtn:function(t,e){if(!(e.editNameFlag||u(e,a.id.EDIT,t).length>0)&&o.apply(t.edit.showRenameBtn,[t.treeId,e],t.edit.showRenameBtn)){var n=u(e,a.id.A,t),r="<span class='"+a.className.BUTTON+" edit' id='"+e.tId+a.id.EDIT+"' title='"+o.apply(t.edit.renameTitle,[t.treeId,e],t.edit.renameTitle)+"' treeNode"+a.id.EDIT+" style='display:none;'></span>";n.append(r),u(e,a.id.EDIT,t).bind("click",(function(){return!(!o.uCanDo(t)||0==o.apply(t.callback.beforeEditName,[t.treeId,e],!0))&&(s.editNode(t,e),!1)})).show()}},addRemoveBtn:function(t,e){if(!(e.editNameFlag||u(e,a.id.REMOVE,t).length>0)&&o.apply(t.edit.showRemoveBtn,[t.treeId,e],t.edit.showRemoveBtn)){var n=u(e,a.id.A,t),r="<span class='"+a.className.BUTTON+" remove' id='"+e.tId+a.id.REMOVE+"' title='"+o.apply(t.edit.removeTitle,[t.treeId,e],t.edit.removeTitle)+"' treeNode"+a.id.REMOVE+" style='display:none;'></span>";n.append(r),u(e,a.id.REMOVE,t).bind("click",(function(){return!(!o.uCanDo(t)||0==o.apply(t.callback.beforeRemove,[t.treeId,e],!0))&&(s.removeNode(t,e),t.treeObj.trigger(a.event.REMOVE,[t.treeId,e]),!1)})).bind("mousedown",(function(t){return!0})).show()}},addHoverDom:function(t,e){l.getRoots().showHoverDom&&(e.isHover=!0,t.edit.enable&&(s.addEditBtn(t,e),s.addRemoveBtn(t,e)),o.apply(t.view.addHoverDom,[t.treeId,e]))},cancelCurEditNode:function(t,e,n){var r=l.getRoot(t),i=r.curEditNode;if(i){var c=r.curEditInput,h=e||(n?l.nodeName(t,i):c.val());if(!1===o.apply(t.callback.beforeRename,[t.treeId,i,h,n],!0))return!1;l.nodeName(t,i,h),u(i,a.id.A,t).removeClass(a.node.CURSELECTED_EDIT),c.unbind(),s.setNodeName(t,i),i.editNameFlag=!1,r.curEditNode=null,r.curEditInput=null,s.selectNode(t,i,!1),t.treeObj.trigger(a.event.RENAME,[t.treeId,i,n])}return r.noSelection=!0,!0},editNode:function(t,e){var n=l.getRoot(t);if(s.editNodeBlur=!1,l.isSelectedNode(t,e)&&n.curEditNode==e&&e.editNameFlag)setTimeout((function(){o.inputFocus(n.curEditInput)}),0);else{e.editNameFlag=!0,s.removeTreeDom(t,e),s.cancelCurEditNode(t),s.selectNode(t,e,!1),u(e,a.id.SPAN,t).html("<input type=text class='rename' id='"+e.tId+a.id.INPUT+"' treeNode"+a.id.INPUT+" >");var r=u(e,a.id.INPUT,t);r.attr("value",l.nodeName(t,e)),t.edit.editNameSelectAll?o.inputSelect(r):o.inputFocus(r),r.bind("blur",(function(e){s.editNodeBlur||s.cancelCurEditNode(t)})).bind("keydown",(function(e){"13"==e.keyCode?(s.editNodeBlur=!0,s.cancelCurEditNode(t)):"27"==e.keyCode&&s.cancelCurEditNode(t,null,!0)})).bind("click",(function(t){return!1})).bind("dblclick",(function(t){return!1})),u(e,a.id.A,t).addClass(a.node.CURSELECTED_EDIT),n.curEditInput=r,n.noSelection=!1,n.curEditNode=e}},moveNode:function(t,e,n,r,i,o){var c=l.getRoot(t);if(e!=n&&(!t.data.keep.leaf||!e||l.nodeIsParent(t,e)||r!=a.move.TYPE_INNER)){var h=n.parentTId?n.getParentNode():c,f=null===e||e==c;f&&null===e&&(e=c),f&&(r=a.move.TYPE_INNER);var p,d,g=e.parentTId?e.getParentNode():c;if(r!=a.move.TYPE_PREV&&r!=a.move.TYPE_NEXT&&(r=a.move.TYPE_INNER),r==a.move.TYPE_INNER&&(f?n.parentTId=null:(l.nodeIsParent(t,e)||(l.nodeIsParent(t,e,!0),e.open=!!e.open,s.setNodeLineIcos(t,e)),n.parentTId=e.tId)),f)d=p=t.treeObj;else{if(o||r!=a.move.TYPE_INNER?o||s.expandCollapseNode(t,e.getParentNode(),!0,!1):s.expandCollapseNode(t,e,!0,!1),p=u(e,t),d=u(e,a.id.UL,t),p.get(0)&&!d.get(0)){var y=[];s.makeUlHtml(t,e,y,""),p.append(y.join(""))}d=u(e,a.id.UL,t)}var m=u(n,t);m.get(0)?p.get(0)||m.remove():m=s.appendNodes(t,n.level,[n],null,-1,!1,!0).join(""),d.get(0)&&r==a.move.TYPE_INNER?d.append(m):p.get(0)&&r==a.move.TYPE_PREV?p.before(m):p.get(0)&&r==a.move.TYPE_NEXT&&p.after(m);var v,_,b=-1,w=0,x=null,L=null,E=n.level,C=l.nodeChildren(t,h),k=l.nodeChildren(t,g),S=l.nodeChildren(t,e);if(n.isFirstNode)b=0,C.length>1&&((x=C[1]).isFirstNode=!0);else if(n.isLastNode)(x=C[(b=C.length-1)-1]).isLastNode=!0;else for(v=0,_=C.length;v<_;v++)if(C[v].tId==n.tId){b=v;break}if(b>=0&&C.splice(b,1),r!=a.move.TYPE_INNER)for(v=0,_=k.length;v<_;v++)k[v].tId==e.tId&&(w=v);if(r==a.move.TYPE_INNER?(S||(S=l.nodeChildren(t,e,[])),S.length>0&&((L=S[S.length-1]).isLastNode=!1),S.splice(S.length,0,n),n.isLastNode=!0,n.isFirstNode=1==S.length):e.isFirstNode&&r==a.move.TYPE_PREV?(k.splice(w,0,n),(L=e).isFirstNode=!1,n.parentTId=e.parentTId,n.isFirstNode=!0,n.isLastNode=!1):e.isLastNode&&r==a.move.TYPE_NEXT?(k.splice(w+1,0,n),(L=e).isLastNode=!1,n.parentTId=e.parentTId,n.isFirstNode=!1,n.isLastNode=!0):(r==a.move.TYPE_PREV?k.splice(w,0,n):k.splice(w+1,0,n),n.parentTId=e.parentTId,n.isFirstNode=!1,n.isLastNode=!1),l.fixPIdKeyValue(t,n),l.setSonNodeLevel(t,n.getParentNode(),n),s.setNodeLineIcos(t,n),s.repairNodeLevelClass(t,n,E),!t.data.keep.parent&&C.length<1){l.nodeIsParent(t,h,!1),h.open=!1;var P=u(h,a.id.UL,t),M=u(h,a.id.SWITCH,t),T=u(h,a.id.ICON,t);s.replaceSwitchClass(h,M,a.folder.DOCU),s.replaceIcoClass(h,T,a.folder.DOCU),P.css("display","none")}else x&&s.setNodeLineIcos(t,x);L&&s.setNodeLineIcos(t,L),t.check&&t.check.enable&&s.repairChkClass&&(s.repairChkClass(t,h),s.repairParentChkClassWithSelf(t,h),h!=n.parent&&s.repairParentChkClassWithSelf(t,n)),o||s.expandCollapseParentNode(t,n.getParentNode(),!0,i)}},removeEditBtn:function(t,e){u(e,a.id.EDIT,t).unbind().remove()},removeRemoveBtn:function(t,e){u(e,a.id.REMOVE,t).unbind().remove()},removeTreeDom:function(t,e){e.isHover=!1,s.removeEditBtn(t,e),s.removeRemoveBtn(t,e),o.apply(t.view.removeHoverDom,[t.treeId,e])},repairNodeLevelClass:function(t,e,n){if(n!==e.level){var r=u(e,t),i=u(e,a.id.A,t),o=u(e,a.id.UL,t),s=a.className.LEVEL+n,l=a.className.LEVEL+e.level;r.removeClass(s),r.addClass(l),i.removeClass(s),i.addClass(l),o.removeClass(s),o.addClass(l)}},selectNodes:function(t,e){for(var n=0,r=e.length;n<r;n++)s.selectNode(t,e[n],n>0)}},event:{},data:{setSonNodeLevel:function(t,e,n){if(n){var r=l.nodeChildren(t,n);if(n.level=e?e.level+1:0,r)for(var i=0,o=r.length;i<o;i++)r[i]&&l.setSonNodeLevel(t,n,r[i])}}}};t.extend(!0,t.fn.zTree.consts,e),t.extend(!0,t.fn.zTree._z,r);var i=t.fn.zTree,o=i._z.tools,a=i.consts,s=i._z.view,l=i._z.data,u=(i._z.event,o.$);l.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}}),l.addInitBind((function(t){var e=t.treeObj,n=a.event;e.bind(n.RENAME,(function(e,n,r,i){o.apply(t.callback.onRename,[e,n,r,i])})),e.bind(n.DRAG,(function(e,n,r,i){o.apply(t.callback.onDrag,[n,r,i])})),e.bind(n.DRAGMOVE,(function(e,n,r,i){o.apply(t.callback.onDragMove,[n,r,i])})),e.bind(n.DROP,(function(e,n,r,i,a,s,l){o.apply(t.callback.onDrop,[n,r,i,a,s,l])}))})),l.addInitUnBind((function(t){var e=t.treeObj,n=a.event;e.unbind(n.RENAME),e.unbind(n.DRAG),e.unbind(n.DRAGMOVE),e.unbind(n.DROP)})),l.addInitCache((function(t){})),l.addInitNode((function(t,e,n,r,i,o,a){n&&(n.isHover=!1,n.editNameFlag=!1)})),l.addInitProxy((function(t){var e=t.target,r=l.getSetting(t.data.treeId),i=t.relatedTarget,s="",u=null,c="",h=null,f=null;if(o.eqs(t.type,"mouseover")?(f=o.getMDom(r,e,[{tagName:"a",attrName:"treeNode"+a.id.A}]))&&(s=o.getNodeMainDom(f).id,c="hoverOverNode"):o.eqs(t.type,"mouseout")?(f=o.getMDom(r,i,[{tagName:"a",attrName:"treeNode"+a.id.A}]))||(s="remove",c="hoverOutNode"):o.eqs(t.type,"mousedown")&&(f=o.getMDom(r,e,[{tagName:"a",attrName:"treeNode"+a.id.A}]))&&(s=o.getNodeMainDom(f).id,c="mousedownNode"),s.length>0)switch(u=l.getNodeCache(r,s),c){case"mousedownNode":h=n.onMousedownNode;break;case"hoverOverNode":h=n.onHoverOverNode;break;case"hoverOutNode":h=n.onHoverOutNode}return{stop:!1,node:u,nodeEventType:c,nodeEventCallback:h,treeEventType:"",treeEventCallback:null}})),l.addInitRoot((function(t){var e=l.getRoot(t),n=l.getRoots();e.curEditNode=null,e.curEditInput=null,e.curHoverNode=null,e.dragFlag=0,e.dragNodeShowBefore=[],e.dragMaskList=new Array,n.showHoverDom=!0})),l.addZTreeTools((function(t,e){e.cancelEditName=function(t){l.getRoot(this.setting).curEditNode&&s.cancelCurEditNode(this.setting,t||null,!0)},e.copyNode=function(e,n,r,i){if(!n)return null;var u=l.nodeIsParent(t,e);if(e&&!u&&this.setting.data.keep.leaf&&r===a.move.TYPE_INNER)return null;var c=this,h=o.clone(n);if(e||(e=null,r=a.move.TYPE_INNER),r==a.move.TYPE_INNER){var f=function(){s.addNodes(c.setting,e,-1,[h],i)};o.canAsync(this.setting,e)?s.asyncNode(this.setting,e,i,f):f()}else s.addNodes(this.setting,e.parentNode,-1,[h],i),s.moveNode(this.setting,e,h,r,!1,i);return h},e.editName=function(t){t&&t.tId&&t===l.getNodeCache(this.setting,t.tId)&&(t.parentTId&&s.expandCollapseParentNode(this.setting,t.getParentNode(),!0),s.editNode(this.setting,t))},e.moveNode=function(e,n,r,i){if(!n)return n;var c=l.nodeIsParent(t,e);if(e&&!c&&this.setting.data.keep.leaf&&r===a.move.TYPE_INNER)return null;if(e&&(n.parentTId==e.tId&&r==a.move.TYPE_INNER||u(n,this.setting).find("#"+e.tId).length>0))return null;e||(e=null);var h=this;function f(){s.moveNode(h.setting,e,n,r,!1,i)}return o.canAsync(this.setting,e)&&r===a.move.TYPE_INNER?s.asyncNode(this.setting,e,i,f):f(),n},e.setEditable=function(t){return this.setting.edit.enable=t,this.refresh()}}));var c=s.cancelPreSelectedNode;s.cancelPreSelectedNode=function(t,e){for(var n=l.getRoot(t).curSelectedList,r=0,i=n.length;r<i&&(e&&e!==n[r]||(s.removeTreeDom(t,n[r]),!e));r++);c&&c.apply(s,arguments)};var h=s.createNodes;s.createNodes=function(t,e,n,r,i){h&&h.apply(s,arguments),n&&s.repairParentChkClassWithSelf&&s.repairParentChkClassWithSelf(t,r)};var f=s.makeNodeUrl;s.makeNodeUrl=function(t,e){return t.edit.enable?null:f.apply(s,arguments)};var p=s.removeNode;s.removeNode=function(t,e){var n=l.getRoot(t);n.curEditNode===e&&(n.curEditNode=null),p&&p.apply(s,arguments)};var d=s.selectNode;s.selectNode=function(t,e,n){var r=l.getRoot(t);return(!l.isSelectedNode(t,e)||r.curEditNode!=e||!e.editNameFlag)&&(d&&d.apply(s,arguments),s.addHoverDom(t,e),!0)};var g=o.uCanDo;o.uCanDo=function(t,e){var n=l.getRoot(t);return!(!e||!(o.eqs(e.type,"mouseover")||o.eqs(e.type,"mouseout")||o.eqs(e.type,"mousedown")||o.eqs(e.type,"mouseup")))||(n.curEditNode&&(s.editNodeBlur=!1,n.curEditInput.focus()),!n.curEditNode&&(!g||g.apply(s,arguments)))}}(jQuery)},36:function(t,e){var n,r;n=window,r=document,L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e);var n=L.version.split(".");1===parseInt(n[0],10)&&parseInt(n[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire(L.Draw.Event.CREATED,{layer:t,layerType:this.type})},_cancelDrawing:function(t){27===t.keyCode&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(t,e){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var t=this._markers.pop(),e=this._poly,n=e.getLatLngs(),r=n.splice(-1,1)[0];this._poly.setLatLngs(n),this._markerGroup.removeLayer(t),e.getLatLngs().length<2&&this._map.removeLayer(e),this._vertexChanged(r,!1)}},addVertex:function(t){this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(t,!0))},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var t=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),e=this._poly.newLatLngIntersects(t[t.length-1]);!this.options.allowIntersection&&e||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),n=this._map.layerPointToLatLng(e);this._currentLatLng=n,this._updateTooltip(n),this._updateGuide(e),this._mouseMarker.setLatLng(n),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(t),this._clickHandled=!0,this._disableNewMarkers();var e=t.originalEvent,n=e.clientX,r=e.clientY;this._startPoint.call(this,n,r)}},_startPoint:function(t,e){this._mouseDownOrigin=L.point(t,e)},_onMouseUp:function(t){var e=t.originalEvent,n=e.clientX,r=e.clientY;this._endPoint.call(this,n,r,t),this._clickHandled=null},_endPoint:function(t,e,r){if(this._mouseDownOrigin){var i=L.point(t,e).distanceTo(this._mouseDownOrigin),o=this._calculateFinishDistance(r.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(r.latlng),this._finishShape()):o<10&&L.Browser.touch?this._finishShape():Math.abs(i)<9*(n.devicePixelRatio||1)&&this.addVertex(r.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(t){var e,n,r=t.originalEvent;!r.touches||!r.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(e=r.touches[0].clientX,n=r.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,e,n),this._endPoint.call(this,e,n,t),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(t){var e;if(this._markers.length>0){var n;if(this.type===L.Draw.Polyline.TYPE)n=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;n=this._markers[0]}var r=this._map.latLngToContainerPoint(n.getLatLng()),i=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),o=this._map.latLngToContainerPoint(i.getLatLng());e=r.distanceTo(o)}else e=1/0;return e},_updateFinishHandler:function(){var t=this._markers.length;t>1&&this._markers[t-1].on("click",this._finishShape,this),t>2&&this._markers[t-2].off("click",this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers?this._markers.length:0;e>0&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var n,r,i,o=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),a=this.options.guidelineDistance,s=this.options.maxGuideLineLength,l=o>s?o-s:a;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));l<o;l+=this.options.guidelineDistance)n=l/o,r={x:Math.floor(t.x*(1-n)+n*e.x),y:Math.floor(t.y*(1-n)+n*e.y)},(i=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer)).style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(i,r)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,n=this._guidesContainer.childNodes.length;e<n;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t,e,n=this.options.showLength;return 0===this._markers.length?t={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(e=n?this._getMeasurementString():"",t=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:e}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:e}),t},_updateRunningMeasure:function(t,e){var n,r,i=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(n=i-(e?2:1),r=L.GeometryUtil.isVersion07x()?t.distanceTo(this._markers[n].getLatLng())*(this.options.factor||1):this._map.distance(t,this._markers[n].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=r*(e?1:-1))},_getMeasurementString:function(){var t,e=this._currentLatLng,n=this._markers[this._markers.length-1].getLatLng();return t=L.GeometryUtil.isVersion07x()?n&&e&&e.distanceTo?this._measurementRunningTotal+e.distanceTo(n)*(this.options.factor||1):this._measurementRunningTotal||0:n&&e?this._measurementRunningTotal+this._map.distance(e,n)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(t,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on("click",this._finishShape,this),t>2&&(this._markers[t-1].on("dblclick",this._finishShape,this),t>3&&this._markers[t-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(t=L.drawLocal.draw.handlers.polygon.tooltip.cont,e=this._getMeasurementString()):(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area,e="";return t||this.options.showLength?(this.options.showLength&&(e=L.Draw.Polyline.prototype._getMeasurementString.call(this)),t&&(e+="<br>"+L.GeometryUtil.readableArea(t,this.options.metric,this.options.precision)),e):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(t,e){var n;!this.options.allowIntersection&&this.options.showArea&&(n=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(n)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,e)},_cleanUpShape:function(){var t=this._markers.length;t>0&&(this._markers[0].off("click",this._finishShape,this),t>2&&this._markers[t-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),r.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(r,"mouseup",this._onMouseUp,this),L.DomEvent.off(r,"touchend",this._onMouseUp,this),r.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(r,"mouseup",this._onMouseUp,this).on(r,"touchend",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(e))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(t){this._shape||this._isCurrentlyTwoClickDrawing?this._isCurrentlyTwoClickDrawing&&!function(t,e){for(;(t=t.parentElement)&&!t.classList.contains(e););return t}(t.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this):this._isCurrentlyTwoClickDrawing=!0},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_getTooltipText:function(){var t,e,n,r=L.Draw.SimpleShape.prototype._getTooltipText.call(this),i=this._shape,o=this.options.showArea;return i&&(t=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),e=L.GeometryUtil.geodesicArea(t),n=o?L.GeometryUtil.readableArea(e,this.options.metric):""),{text:r.text,subtext:n}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?(e=this._mouseMarker.getLatLng(),this._marker.setLatLng(e)):(this._marker=this._createMarker(e),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(t){return new L.Marker(t,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(t){this._onMouseMove(t),this._onClick()},_fireCreatedEvent:function(){var t=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},_fireCreatedEvent:function(){var t=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)},_createMarker:function(t){return new L.CircleMarker(t,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){if(L.GeometryUtil.isVersion07x())var e=this._startLatLng.distanceTo(t);else e=this._map.distance(this._startLatLng,t);this._shape?this._shape.setRadius(e):(this._shape=new L.Circle(this._startLatLng,e,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,n=t.latlng,r=this.options.showRadius,i=this.options.metric;if(this._tooltip.updatePosition(n),this._isDrawing){this._drawShape(n),e=this._shape.getRadius().toFixed(1);var o="";r&&(o=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(e,i,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:o})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(t,e){this._marker=t,L.setOptions(this,e)},addHooks:function(){var t=this._marker;t.dragging.enable(),t.on("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},removeHooks:function(){var t=this._marker;t.dragging.disable(),t.off("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},_onDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_toggleMarkerHighlight:function(){var t=this._marker._icon;t&&(t.style.display="none",L.DomUtil.hasClass(t,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,-4)):(L.DomUtil.addClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,4)),t.style.display="")},_offsetMarker:function(t,e){var n=parseInt(t.style.marginTop,10)-e,r=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=n+"px",t.style.marginLeft=r+"px"}}),L.Marker.addInitHook((function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())})),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(t){this.latlngs=[t._latlngs],t._holes&&(this.latlngs=this.latlngs.concat(t._holes)),this._poly=t,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(t){for(var e=0;e<this._verticesHandlers.length;e++)t(this._verticesHandlers[e])},addHooks:function(){this._initHandlers(),this._eachVertexHandler((function(t){t.addHooks()}))},removeHooks:function(){this._eachVertexHandler((function(t){t.removeHooks()}))},updateMarkers:function(){this._eachVertexHandler((function(t){t.updateMarkers()}))},_initHandlers:function(){this._verticesHandlers=[];for(var t=0;t<this.latlngs.length;t++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[t],this._poly.options.poly))},_updateLatLngs:function(t){this.latlngs=[t.layer._latlngs],t.layer._holes&&(this.latlngs=this.latlngs.concat(t.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(t,e,n){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=t,n&&n.drawError&&(n.drawError=L.Util.extend({},this.options.drawError,n.drawError)),this._latlngs=e,L.setOptions(this,n)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var t=this._poly,e=t._path;t instanceof L.Polygon||(t.options.fill=!1,t.options.editing&&(t.options.editing.fill=!1)),e&&t.options.editing&&t.options.editing.className&&(t.options.original.className&&t.options.original.className.split(" ").forEach((function(t){L.DomUtil.removeClass(e,t)})),t.options.editing.className.split(" ").forEach((function(t){L.DomUtil.addClass(e,t)}))),t.setStyle(t.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var t=this._poly,e=t._path;e&&t.options.editing&&t.options.editing.className&&(t.options.editing.className.split(" ").forEach((function(t){L.DomUtil.removeClass(e,t)})),t.options.original.className&&t.options.original.className.split(" ").forEach((function(t){L.DomUtil.addClass(e,t)}))),t.setStyle(t.options.original),t._map&&(t._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,n,r,i,o,a=this._defaultShape();for(t=0,n=a.length;t<n;t++)(r=this._createMarker(a[t],t)).on("click",this._onMarkerClick,this),r.on("contextmenu",this._onContextMenu,this),this._markers.push(r);for(t=0,e=n-1;t<n;e=t++)(0!==t||L.Polygon&&this._poly instanceof L.Polygon)&&(i=this._markers[e],o=this._markers[t],this._createMiddleMarker(i,o),this._updatePrevNext(i,o))},_createMarker:function(t,e){var n=new L.Marker.Touch(t,{draggable:!0,icon:this.options.icon});return n._origLatLng=t,n._index=e,n.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(n),n},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var t=this._defaultShape(),e=[].splice.apply(t,arguments);return this._poly._convertLatLngs(t,!0),this._poly.redraw(),e},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(t){var e=t.target,n=this._poly,r=L.LatLngUtil.cloneLatLng(e._origLatLng);if(L.extend(e._origLatLng,e._latlng),n.options.poly){var i=n._map._editTooltip;if(!n.options.poly.allowIntersection&&n.intersects()){L.extend(e._origLatLng,r),e.setLatLng(r);var o=n.options.color;n.setStyle({color:this.options.drawError.color}),i&&i.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout((function(){n.setStyle({color:o}),i&&i.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})}),1e3)}}e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var a=this._poly.getLatLngs();this._poly._convertLatLngs(a,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,n=t.target;this._defaultShape().length<e||(this._removeMarker(n),this._updatePrevNext(n._prev,n._next),n._middleLeft&&this._markerGroup.removeLayer(n._middleLeft),n._middleRight&&this._markerGroup.removeLayer(n._middleRight),n._prev&&n._next?this._createMiddleMarker(n._prev,n._next):n._prev?n._next||(n._prev._middleRight=null):n._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(t){var e=t.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:e,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),n=this._map.layerPointToLatLng(e),r=t.target;L.extend(r._origLatLng,n),r._middleLeft&&r._middleLeft.setLatLng(this._getMiddleLatLng(r._prev,r)),r._middleRight&&r._middleRight.setLatLng(this._getMiddleLatLng(r,r._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(t,e){this._markerGroup.eachLayer((function(n){n._index>t&&(n._index+=e)}))},_createMiddleMarker:function(t,e){var n,r,i,o=this._getMiddleLatLng(t,e),a=this._createMarker(o);a.setOpacity(.6),t._middleRight=e._middleLeft=a,r=function(){a.off("touchmove",r,this);var i=e._index;a._index=i,a.off("click",n,this).on("click",this._onMarkerClick,this),o.lat=a.getLatLng().lat,o.lng=a.getLatLng().lng,this._spliceLatLngs(i,0,o),this._markers.splice(i,0,a),a.setOpacity(1),this._updateIndexes(i,1),e._index++,this._updatePrevNext(t,a),this._updatePrevNext(a,e),this._poly.fire("editstart")},i=function(){a.off("dragstart",r,this),a.off("dragend",i,this),a.off("touchmove",r,this),this._createMiddleMarker(t,a),this._createMiddleMarker(a,e)},n=function(){r.call(this),i.call(this),this._fireEdit()},a.on("click",n,this).on("dragstart",r,this).on("dragend",i,this).on("touchmove",r,this),this._markerGroup.addLayer(a)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var n=this._poly._map,r=n.project(t.getLatLng()),i=n.project(e.getLatLng());return n.unproject(r._add(i)._divideBy(2))}}),L.Polyline.addInitHook((function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",(function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()})),this.on("remove",(function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})))})),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(t,e){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){var t=this._shape;this._shape._map&&(this._map=this._shape._map,t.setStyle(t.options.editing),t._map&&(this._map=t._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var t=this._shape;if(t.setStyle(t.options.original),t._map){this._unbindMarker(this._moveMarker);for(var e=0,n=this._resizeMarkers.length;e<n;e++)this._unbindMarker(this._resizeMarkers[e]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var n=new L.Marker.Touch(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(n),this._markerGroup.addLayer(n),n},_bindMarker:function(t){t.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(t){t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(t){t.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(t){var e=t.target,n=e.getLatLng();e===this._moveMarker?this._move(n):this._resize(n),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(t){t.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(t){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t),"function"==typeof this._getCorners){var e=this._getCorners(),n=t.target,r=n._cornerIndex;n.setOpacity(0),this._oppositeCorner=e[(r+2)%4],this._toggleCornerMarkers(0,r)}this._shape.fire("editstart")},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),n=this._map.layerPointToLatLng(e);return t.target===this._moveMarker?this._move(n):this._resize(n),this._shape.redraw(),!1},_onTouchEnd:function(t){t.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,n=t.length;e<n;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),n=t.target._cornerIndex;this._oppositeCorner=e[(n+2)%4],this._toggleCornerMarkers(0,n)},_onMarkerDragEnd:function(t){var e,n=t.target;n===this._moveMarker&&(e=this._shape.getBounds().getCenter(),n.setLatLng(e)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,n=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),r=this._shape.getBounds().getCenter(),i=[],o=0,a=n.length;o<a;o++)e=[n[o].lat-r.lat,n[o].lng-r.lng],i.push([t.lat+e[0],t.lng+e[1]]);this._shape.setLatLngs(i),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var t=this._shape.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_toggleCornerMarkers:function(t){for(var e=0,n=this._resizeMarkers.length;e<n;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,n=this._resizeMarkers.length;e<n;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook((function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())})),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(t){if(this._resizeMarkers.length){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e)}this._shape.setLatLng(t),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook((function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",(function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()})),this.on("remove",(function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))})),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),n=this._map.project(t);return this._map.unproject([n.x+e,n.y-e])},_resize:function(t){var e=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=e.distanceTo(t):radius=this._map.distance(e,t),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook((function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())})),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(t,e){var n={};if(void 0!==t.touches){if(!t.touches.length)return;n=t.touches[0]}else{if("touch"!==t.pointerType)return;if(n=t,!this._filterClick(t))return}var r=this._map.mouseEventToContainerPoint(n),i=this._map.mouseEventToLayerPoint(n),o=this._map.layerPointToLatLng(i);this._map.fire(e,{latlng:o,layerPoint:i,containerPoint:r,pageX:n.pageX,pageY:n.pageY,originalEvent:t})},_filterClick:function(t){var e=t.timeStamp||t.originalEvent.timeStamp,n=L.DomEvent._lastClick&&e-L.DomEvent._lastClick;return n&&n>100&&n<500||t.target._simulatedClick&&!t._simulated?(L.DomEvent.stop(t),!1):(L.DomEvent._lastClick=e,!0)},_onTouchStart:function(t){this._map._loaded&&this._touchEvent(t,"touchstart")},_onTouchEnd:function(t){this._map._loaded&&this._touchEvent(t,"touchend")},_onTouchCancel:function(t){if(this._map._loaded){var e="touchcancel";this._detectIE()&&(e="pointercancel"),this._touchEvent(t,e)}},_onTouchLeave:function(t){this._map._loaded&&this._touchEvent(t,"touchleave")},_onTouchMove:function(t){this._map._loaded&&this._touchEvent(t,"touchmove")},_detectIE:function(){var t=n.navigator.userAgent,e=t.indexOf("MSIE ");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(t.indexOf("Trident/")>0){var r=t.indexOf("rv:");return parseInt(t.substring(r+3,t.indexOf(".",r)),10)}var i=t.indexOf("Edge/");return i>0&&parseInt(t.substring(i+5,t.indexOf(".",i)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?e.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):e.concat(["touchcancel"]),L.DomUtil.addClass(t,"leaflet-clickable"),L.DomEvent.on(t,"click",this._onMouseClick,this),L.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var n=0;n<e.length;n++)L.DomEvent.on(t,e[n],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var t=n.navigator.userAgent,e=t.indexOf("MSIE ");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(t.indexOf("Trident/")>0){var r=t.indexOf("rv:");return parseInt(t.substring(r+3,t.indexOf(".",r)),10)}var i=t.indexOf("Edge/");return i>0&&parseInt(t.substring(i+5,t.indexOf(".",i)),10)}}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],n=0,r=t.length;n<r;n++)Array.isArray(t[n])?e.push(L.LatLngUtil.cloneLatLngs(t[n])):e.push(this.cloneLatLng(t[n]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},function(){var t={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,n,r=t.length,i=0,o=Math.PI/180;if(r>2){for(var a=0;a<r;a++)e=t[a],i+=((n=t[(a+1)%r]).lng-e.lng)*o*(2+Math.sin(e.lat*o)+Math.sin(n.lat*o));i=6378137*i*6378137/2}return Math.abs(i)},formattedNumber:function(t,e){var n=parseFloat(t).toFixed(e),r=L.drawLocal.format&&L.drawLocal.format.numeric,i=r&&r.delimiters,o=i&&i.thousands,a=i&&i.decimal;if(o||a){var s=n.split(".");n=o?s[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+o):s[0],a=a||".",s.length>1&&(n=n+a+s[1])}return n},readableArea:function(e,n,r){var i,o;return r=L.Util.extend({},t,r),n?(o=["ha","m"],type=typeof n,"string"===type?o=[n]:"boolean"!==type&&(o=n),i=e>=1e6&&-1!==o.indexOf("km")?L.GeometryUtil.formattedNumber(1e-6*e,r.km)+" km":e>=1e4&&-1!==o.indexOf("ha")?L.GeometryUtil.formattedNumber(1e-4*e,r.ha)+" ha":L.GeometryUtil.formattedNumber(e,r.m)+" m"):i=(e/=.836127)>=3097600?L.GeometryUtil.formattedNumber(e/3097600,r.mi)+" mi":e>=4840?L.GeometryUtil.formattedNumber(e/4840,r.ac)+" acres":L.GeometryUtil.formattedNumber(e,r.yd)+" yd",i},readableDistance:function(e,n,r,i,o){var a;switch(o=L.Util.extend({},t,o),n?"string"==typeof n?n:"metric":r?"feet":i?"nauticalMile":"yards"){case"metric":a=e>1e3?L.GeometryUtil.formattedNumber(e/1e3,o.km)+" km":L.GeometryUtil.formattedNumber(e,o.m)+" m";break;case"feet":e*=3.28083,a=L.GeometryUtil.formattedNumber(e,o.ft)+" ft";break;case"nauticalMile":e*=.53996,a=L.GeometryUtil.formattedNumber(e/1e3,o.nm)+" nm";break;case"yards":default:a=(e*=1.09361)>1760?L.GeometryUtil.formattedNumber(e/1760,o.mi)+" miles":L.GeometryUtil.formattedNumber(e,o.yd)+" yd"}return a},isVersion07x:function(){var t=L.version.split(".");return 0===parseInt(t[0],10)&&7===parseInt(t[1],10)}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,n,r){return this._checkCounterclockwise(t,n,r)!==this._checkCounterclockwise(e,n,r)&&this._checkCounterclockwise(t,e,n)!==this._checkCounterclockwise(t,e,r)},_checkCounterclockwise:function(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e,n,r=this._getProjectedPoints(),i=r?r.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=i-1;t>=3;t--)if(e=r[t-1],n=r[t],this._lineSegmentsIntersectsRange(e,n,t-2))return!0;return!1},newLatLngIntersects:function(t,e){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(t),e)},newPointIntersects:function(t,e){var n=this._getProjectedPoints(),r=n?n.length:0,i=n?n[r-1]:null,o=r-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(i,t,o,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._getProjectedPoints(),n=e?e.length:0;return!e||(n+=t||0)<=3},_lineSegmentsIntersectsRange:function(t,e,n,r){var i,o,a=this._getProjectedPoints();r=r||0;for(var s=n;s>r;s--)if(i=a[s-1],o=a[s],L.LineUtil.segmentsIntersect(t,e,i,o))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var t=[],e=this._defaultShape(),n=0;n<e.length;n++)t.push(this._map.latLngToLayerPoint(e[n]));return t}}),L.Polygon.include({intersects:function(){var t,e,n,r,i=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(t=i.length,e=i[0],n=i[t-1],r=t-2,this._lineSegmentsIntersectsRange(n,e,r,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(t){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");var e;L.Control.prototype.initialize.call(this,t),this._toolbars={},L.DrawToolbar&&this.options.draw&&(e=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=e,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(e=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=e,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(t){var e,n=L.DomUtil.create("div","leaflet-draw"),r=!1;for(var i in this._toolbars)this._toolbars.hasOwnProperty(i)&&(e=this._toolbars[i].addToolbar(t))&&(r||(L.DomUtil.hasClass(e,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(e.childNodes[0],"leaflet-draw-toolbar-top"),r=!0),n.appendChild(e));return n},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=t.target;for(var n in this._toolbars)this._toolbars[n]!==e&&this._toolbars[n].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook((function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))})),L.Toolbar=L.Class.extend({initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null;var e=L.version.split(".");1===parseInt(e[0],10)&&parseInt(e[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(t){var e,n=L.DomUtil.create("div","leaflet-draw-section"),r=0,i=this._toolbarClass||"",o=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=t,e=0;e<o.length;e++)o[e].enabled&&this._initModeHandler(o[e].handler,this._toolbarContainer,r++,i,o[e].title);if(r)return this._lastButtonIndex=--r,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),n.appendChild(this._toolbarContainer),n.appendChild(this._actionsContainer),n},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var e=0,n=this._actionButtons.length;e<n;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,n,r,i){var o=t.type;this._modes[o]={},this._modes[o].handler=t,this._modes[o].button=this._createButton({type:o,title:i,className:r+"-"+o,container:e,callback:this._modes[o].handler.enable,context:this._modes[o].handler}),this._modes[o].buttonIndex=n,this._modes[o].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!n.MSStream},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container),n=L.DomUtil.create("span","sr-only",t.container);e.href="#",e.appendChild(n),t.title&&(e.title=t.title,n.innerHTML=t.title),t.text&&(e.innerHTML=t.text,n.innerHTML=t.text);var r=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"touchstart",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,r,t.callback,t.context),e},_disposeButton:function(t,e){var n=this._detectIOS()?"touchstart":"click";L.DomEvent.off(t,"click",L.DomEvent.stopPropagation).off(t,"mousedown",L.DomEvent.stopPropagation).off(t,"dblclick",L.DomEvent.stopPropagation).off(t,"touchstart",L.DomEvent.stopPropagation).off(t,"click",L.DomEvent.preventDefault).off(t,n,e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(t){var e,n,r,i,o=this._actionsContainer,a=this.getActions(t),s=a.length;for(n=0,r=this._actionButtons.length;n<r;n++)this._disposeButton(this._actionButtons[n].button,this._actionButtons[n].callback);for(this._actionButtons=[];o.firstChild;)o.removeChild(o.firstChild);for(var l=0;l<s;l++)"enabled"in a[l]&&!a[l].enabled||(e=L.DomUtil.create("li","",o),i=this._createButton({title:a[l].title,text:a[l].text,container:e,callback:a[l].callback,context:a[l].context}),this._actionButtons.push({button:i,callback:a[l].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,n=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=n+"px",0===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._visible=!1,this._container=t.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container?(t.subtext=t.subtext||"",0!==t.subtext.length||this._singleLineLabel?t.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(t.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+"</span><br />":"")+"<span>"+t.text+"</span>",t.text||t.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),n=this._container;return this._container&&(this._visible&&(n.style.visibility="inherit"),L.DomUtil.setPosition(n,e)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(t,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(t){return[{enabled:t.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:t.completeShape,context:t},{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){for(var e in L.setOptions(this,t),this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(t){t.edit&&(void 0===t.edit.selectedPathOptions&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,t.edit.selectedPathOptions)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),t.poly&&(t.poly=L.extend({},this.options.poly,t.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(t){var e=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return t.removeAllLayers&&e.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),e},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),e},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=0!==this.options.featureGroup.getLayers().length;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.setOptions(this,e),this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var n=L.version.split(".");1===parseInt(n[0],10)&&parseInt(n[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),t._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer((function(t){this._revertLayer(t)}),this)},save:function(){var t=new L.LayerGroup;this._featureGroup.eachLayer((function(e){e.edited&&(t.addLayer(e),e.edited=!1)})),this._map.fire(L.Draw.Event.EDITED,{layers:t})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:(t instanceof L.Marker||t instanceof L.CircleMarker)&&(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):(t instanceof L.Marker||t instanceof L.CircleMarker)&&t.setLatLng(this._uneditedLayerProps[e].latlng),t.fire("revert-edited",{layer:t}))},_enableLayerEdit:function(t){var e,n,r=t.layer||t.target||t;this._backupLayer(r),this.options.poly&&(n=L.Util.extend({},this.options.poly),r.options.poly=n),this.options.selectedPathOptions&&((e=L.Util.extend({},this.options.selectedPathOptions)).maintainColor&&(e.color=r.options.color,e.fillColor=r.options.fillColor),r.options.original=L.extend({},r.options),r.options.editing=e),r instanceof L.Marker?(r.editing&&r.editing.enable(),r.dragging.enable(),r.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):r.editing.enable()},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,e.editing&&e.editing.disable(),delete e.options.editing,delete e.options.original,this._selectedPathOptions&&(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):e.editing.disable()},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_onMarkerDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_onTouchMove:function(t){var e=t.originalEvent.changedTouches[0],n=this._map.mouseEventToLayerPoint(e),r=this._map.layerPointToLatLng(n);t.target.setLatLng(r)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var n=L.version.split(".");1===parseInt(n[0],10)&&parseInt(n[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer((function(t){this._deletableLayers.addLayer(t),t.fire("revert-deleted",{layer:t})}),this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer((function(t){this._removeLayer({layer:t})}),this),this.save()},_enableLayerDelete:function(t){(t.layer||t.target||t).on("click",this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e),e.fire("deleted")},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})},37:function(t,e,n){"use strict";n.r(e);var r=n(0);n(246);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=(Object.freeze||Object)({eventKey:"_dom_events",on:function(t,e,n,r){if("object"===i(e))for(var o in e)this.addOne(t,o,e[o],n);else for(var a=0,l=(e=s.splitWords(e)).length;a<l;a++)this.addOne(t,e[a],n,r);return this},off:function(t,e,n,r){if("object"===i(e))for(var o in e)this.removeOne(t,o,e[o],n);else if(e)for(var a=0,l=(e=s.splitWords(e)).length;a<l;a++)this.removeOne(t,e[a],n,r);else{for(var u in t[this.eventsKey])this.removeOne(t,u,t[this.eventsKey][u]);delete t[this.eventsKey]}return this},addOne:function(t,e,n,r){var i=e+s.stamp(n)+(r?"_"+s.stamp(r):"");if(t[this.eventsKey]&&t[this.eventsKey][i])return this;var a=function(e){return n.call(r||t,e||window.event)},l=a;"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",a,!1):"mouseenter"===e||"mouseleave"===e?(a=function(e){e=e||window.event,o.isExternalTarget(t,e)&&l(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",a,!1)):("click"===e&&(a=function(t){l(t)}),t.addEventListener(e,a,!1)):"attachEvent"in t&&t.attachEvent("on"+e,a),t[this.eventsKey]=t[this.eventsKey]||{},t[this.eventsKey][i]=a},removeOne:function(t,e,n,r){var i=e+s.stamp(n)+(r?"_"+s.stamp(r):""),o=t[this.eventsKey]&&t[this.eventsKey][i];if(!o)return this;"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",o,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,o,!1):"detachEvent"in t&&t.detachEvent("on"+e,o),t[this.eventsKey][i]=null},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this},disableScrollPropagation:function(t){return this.addOne(t,"mousewheel",this.stopPropagation),this},disableClickPropagation:function(t){return this.on(t,"click mousedown touchstart dblclick",this.stopPropagation),this},disableMousePropagation:function(t){return this.on(t,"mousemove",this.stopPropagation),this},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return this.preventDefault(t),this.stopPropagation(t),this},getMousePosition:function(t,e){if(!e)return[t.clientX,t.clientY];var n=s.getScale(e),r=n.boundingClientRect;return[(t.clientX-r.left)/n.x-e.clientLeft,(t.clientY-r.top)/n.y-e.clientTop]},getWheelDelta:function(t){return"msLaunchUri"in navigator&&!("documentMode"in document)?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0},skipEvents:{},fakeStop:function(t){this.skipEvents[t.type]=!0},skipped:function(t){var e=this.skipEvents[t.type];return this.skipEvents[t.type]=!1,e},isExternalTarget:function(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t}}),a=0,s=(Object.freeze||Object)({TRANSFORM:"transform",lastId:0,stamp:function(t){return t._fm_id=t._fm_id||++a,t._fm_id},get:function(t){return"string"==typeof t?document.getElementById(t):t},bind:function(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var r=n.call(arguments,2);return function(){return t.apply(e,r.length?r.concat(n.call(arguments)):arguments)}},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return this.trim(t).split(/\s+/)},getStyle:function(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var r=document.defaultView.getComputedStyle(t,null);n=r?r[e]:null}return"auto"===n?null:n},create:function(t,e,n,r){var i=r?document.createElementNS(r,t):document.createElement(t);return i.setAttribute("class",e||""),n&&n.appendChild(i),i},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},toFront:function(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)},toBack:function(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)},hasClass:function(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=this.getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(void 0!==t.classList)for(var n=this.splitWords(e),r=0,i=n.length;r<i;r++)t.classList.add(n[r]);else if(!this.hasClass(t,e)){var o=this.getClass(t);this.setClass(t,(o?o+" ":"")+e)}},removeClass:function(t,e){void 0!==t.classList?t.classList.remove(e):this.setClass(t,this.trim((" "+this.getClass(t)+" ").replace(" "+e+" "," ")))},setClass:function(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e},getClass:function(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal},setOpacity:function(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&this._setOpacityIE(t,e)},_setOpacityIE:function(t,e){var n=!1,r="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(r)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+r+"(opacity="+e+")"},setTransform:function(t,e,n,r){var i=e,o="ActiveXObject"in window&&"transition"in document.documentElement.style;t.style[this.TRANSFORM]=(o?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")+(void 0!==r?" rotate("+r+"deg)":"")},setPosition:function(t,e,n,r){t._leaflet_pos=e,this.setTransform(t,e,n,r)},getSizedParentNode:function(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t},getScale:function(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}},getOffsetPosition:function(t,e){if(t instanceof HTMLElement&&e instanceof HTMLElement){var n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return{x:r.x-n.x,y:r.y-n.y}}},moveInContainer:function(t,e){}});function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(){return!1}var h=function(){function t(){var e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=[],(n="events")in(e=this)?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r}var e,n,r;return e=t,(n=[{key:"on",value:function(t,e,n){if("object"===l(t))for(var r in t)this._on(r,t[r],e);else for(var i=0,o=(t=t.trim().split(/\s+/)).length;i<o;i++)this._on(t[i],e,n);return this}},{key:"off",value:function(t,e,n){if(t)if("object"===l(t))for(var r in t)this._off(r,t[r],e);else for(var i=0,o=(t=t.trim().split(/\s+/)).length;i<o;i++)this._off(t[i],e,n);else delete this._events;return this}},{key:"_on",value:function(t,e,n){this._events=this._events||{};var r=this._events[t];r||(r=[],this._events[t]=r),n===this&&(n=void 0);for(var i={fn:e,ctx:n},o=r,a=0,s=o.length;a<s;a++)if(o[a].fn===e&&o[a].ctx===n)return;o.push(i)}},{key:"_off",value:function(t,e,n){var r,i,o;if(this._events&&(r=this._events[t]))if(e){if(n===this&&(n=void 0),r)for(i=0,o=r.length;i<o;i++){var a=r[i];if(a.ctx===n&&a.fn===e)return a.fn=c,this._firingCount&&(this._events[t]=r=r.slice()),void r.splice(i,1)}}else{for(i=0,o=r.length;i<o;i++)r[i].fn=c;delete this._events[t]}}},{key:"fire",value:function(t,e,n){if(!this.listens(t,n))return this;var r=Object.assign({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var i=this._events[t];if(i){this._firingCount=this._firingCount+1||1;for(var o=0,a=i.length;o<a;o++){var s=i[o];s.fn.call(s.ctx||this,r)}this._firingCount--}}return n&&this._propagateEvent(r),this}},{key:"listens",value:function(t,e){var n=this._events&&this._events[t];if(n&&n.length)return!0;if(e)for(var r in this._eventParents)if(this._eventParents[r].listens(t,e))return!0;return!1}},{key:"once",value:function(t,e,n){if("object"===l(t)){for(var r in t)this.once(r,t[r],e);return this}var i=function(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var r=n.call(arguments,2);return function(){return t.apply(e,r.length?r.concat(n.call(arguments)):arguments)}}((function(){this.off(t,e,n).off(t,i,n)}),this);return this.on(t,e,n).on(t,i,n)}},{key:"addEventParent",value:function(t){return this._eventParents=this._eventParents||{},this._eventParents[s.stamp(t)]=t,this}},{key:"removeEventParent",value:function(t){return this._eventParents&&delete this._eventParents[s.stamp(t)],this}},{key:"_propagateEvent",value:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,Object.assign({layer:t.target,propagatedFrom:t.target},t),!0)}}])&&u(e.prototype,n),r&&u(e,r),t}(),f=n(15),p=n.n(f);window._$=p.a,window.jQuery=p.a;var d=p.a;n(254),n(33);function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e){return!e||"object"!==g(e)&&"function"!=typeof e?v(t):e}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=b(e);if(_()){var r=b(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return m(this,t)});function a(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),x(v(n=o.call(this,t,e)),"version","2.3.1"),x(v(n),"events",["baselayerchange","crschange"]),x(v(n),"_notifications",[]),x(v(n),"controls",{}),x(v(n),"layers",{}),x(v(n),"mapEl",void 0),x(v(n),"moving",!1),x(v(n),"grabing",!1),x(v(n),"useWebGl",!0),x(v(n),"webGlLimit",64),x(v(n),"lastMoveTrigger",0),x(v(n),"moveEventInterval",40);var r=document.createElement("canvas");return n.useWebGl=void 0!==(r.getContext("experimental-webgl",{antialias:!0})||r.getContext("webgl",{antialias:!0})),n.useWebGl||console.warn("warning, map build on low performance mode"),n.mapEl=document.getElementById(t),n.options=Object.assign({},{attributionControl:!1,zoomControl:!1,contextmenu:!1,tilelayer:!1,scalecontrol:!1,zoomcontrol:!1,toolbar:!1,baselayer:!1,legend:!1,overlay:!1,overlaysex:!1,scrollmsg:!1,measure:!1,draw:!1,locate:!1,coordpicker:!1,notifyLimit:5},e),n}return n=a,(r=[{key:"create",value:function(){var t={items:[{type:"button",title:locales.toolbar.layers,text:locales.toolbar.layers,toggle:!0,iconCls:"fm-icon-toolbar-layer",onclick:function(t,e){this.mapWrapper.controls.overlaysex.setVisible(e),e&&this.mapWrapper.controls.overlaysex.once("hide",(function(e){t.pressed&&t.click()}))}},"|",{type:"button",title:locales.toolbar.tiles,text:locales.toolbar.tiles,iconCls:"fm-icon-toolbar-map",toggle:!0,onclick:function(t,e){this.mapWrapper.controls.layers&&(this.mapWrapper.controls.layers.setVisible(e),this.mapWrapper.controls.layers.trigger=t)}},"|",{type:"button",title:locales.toolbar.toolkits,text:locales.toolbar.toolkits,iconCls:"fm-icon-toolbar-toolkit",onclick:function(){},menu:[{type:"button",title:locales.toolbar.legend,text:locales.toolbar.legend,iconCls:"fm-icon-toolbar-legend",onclick:function(t){this.mapWrapper.controls.legend.setVisible(t.checked),t.checked&&this.mapWrapper.controls.legend.once("hide",(function(){t.setChecked(!1)}))}},{type:"button",title:locales.toolbar.measure,text:locales.toolbar.measure,iconCls:"fm-icon-toolbar-measure",onclick:function(t){t.checked?(this.mapWrapper.controls.measure.show(),this.mapWrapper.controls.measure.once("hide",(function(){t.setChecked(!1)}))):this.mapWrapper.controls.measure.hide()}},{type:"button",title:locales.toolbar.draw,text:locales.toolbar.draw,iconCls:"fm-icon-toolbar-draw",onclick:function(t){t.checked?this.mapWrapper.controls.draw.show():this.mapWrapper.controls.draw.hide()}},{type:"button",title:locales.toolbar.locate,text:locales.toolbar.locate,iconCls:"fm-icon-toolbar-locate",onclick:function(t){this.mapWrapper.controls.locate.setVisible(t.checked)}},{type:"button",title:locales.toolbar.pickup,text:locales.toolbar.pickup,iconCls:"fm-icon-toolbar-picker",onclick:function(t){this.mapWrapper.controls.coordPicker.setVisible(t.checked),t.checked&&this.mapWrapper.controls.coordPicker.once("hide",(function(){t.setChecked(!1)}))}},{type:"button",title:locales.toolbar.streetview,text:locales.toolbar.streetview,iconCls:"fm-icon-toolbar-streetview",onclick:function(t){var e=this.mapWrapper.controls.layers.activated.split(".")[0],n=this.mapWrapper,r=n._lastActivatedStreetView;if(r&&r.isEnabled()&&!1===t.checked)r.disable();else switch(e){case"baidu":this.mapWrapper._baiduStreetMap||(this.mapWrapper._baiduStreetMap=this.mapWrapper.createBaiduStreet(),this.mapWrapper._baiduStreetMap.on("hide",(function(){t.setChecked(!1)})),this.mapWrapper.on("baselayerchange",(function(e){e.layer.options.tile.startsWith("baidu")?n._lastActivatedStreetView===n._baiduStreetMap&&n._lastActivatedStreetView.isEnabled()&&n._lastActivatedStreetView.reloadTile():n._lastActivatedStreetView===n._baiduStreetMap&&n._lastActivatedStreetView.isEnabled()&&(n._lastActivatedStreetView.disable(),t.setChecked(!1))}))),this.mapWrapper._baiduStreetMap.enable(),this.mapWrapper._lastActivatedStreetView=this.mapWrapper._baiduStreetMap;break;case"google":this.mapWrapper._googleStreetMap||(this.mapWrapper._googleStreetMap=this.mapWrapper.createGoogleStreet(),this.mapWrapper._googleStreetMap.on("hide",(function(){t.setChecked(!1)})),this.mapWrapper.on("baselayerchange",(function(e){e.layer.options.tile.startsWith("google")?n._lastActivatedStreetView===n._googleStreetMap&&n._lastActivatedStreetView.isEnabled()&&n._lastActivatedStreetView.reloadTile():n._lastActivatedStreetView===n._googleStreetMap&&n._lastActivatedStreetView.isEnabled()&&(n._lastActivatedStreetView.disable(),t.setChecked(!1))}))),this.mapWrapper._googleStreetMap.enable(),this.mapWrapper._lastActivatedStreetView=this.mapWrapper._googleStreetMap;break;default:return console.warn("Street View only supported by Baidu and Google map!"),void t.setChecked(!1)}}}]}]},e={visible:!1,position:"topleft",bodyStyle:{minWidth:"300px",minHeight:"50px"},header:{iconCls:"fm-icon-layer",title:locales.toolbar.layers},nodeData:[]},n=this;"object"!==g(n.options.scalecontrol)&&!0!==n.options.scalecontrol||(!0===n.options.scalecontrol?n.createScale({position:"bottomright"}):n.createScale(n.options.scalecontrol)),"object"!==g(n.options.zoomcontrol)&&!0!==n.options.zoomcontrol||(!0===n.options.zoomcontrol?n.createZoom({position:"bottomleft"}):n.createZoom(n.options.zoomcontrol)),"object"!==g(n.options.contextmenu)&&!0!==n.options.contextmenu||(!0===n.options.contextmenu?n.createContextMenu({}):n.createContextMenu(n.options.contextmenu)),"object"!==g(n.options.tilelayer)&&!0!==n.options.tilelayer||(!0===n.options.tilelayer?n.createTileLayer():n.createTileLayer(n.options.tilelayer)),"object"!==g(n.options.toolbar)&&!0!==n.options.toolbar||(!0===n.options.toolbar?n.createToolbar(t):n.createToolbar(n.options.toolbar)),"object"!==g(n.options.baselayer)&&!0!==n.options.baselayer||(!0===n.options.baselayer?n.createBaseLayers():n.createBaseLayers(n.options.baselayer)),"object"!==g(n.options.legend)&&!0!==n.options.legend||(!0===n.options.legend?n.createLegend({bodyStyle:{maxHeight:"300px",minWidth:"200px",minHeight:"50px"}}):n.createLegend(n.options.legend)),"object"!==g(n.options.overlay)&&!0!==n.options.overlay||(!0===n.options.overlay?n.createOverlays(e):n.createOverlays(n.options.overlay)),"object"!==g(n.options.overlaysex)&&!0!==n.options.overlaysex||(!0===n.options.overlaysex?n.createOverlaysEx():n.createOverlaysEx(n.options.overlaysex)),"object"!==g(n.options.scrollmsg)&&!0!==n.options.scrollmsg||(!0===n.options.scrollmsg?n.createScrollMsg():n.createScrollMsg(n.options.scrollmsg)),"object"!==g(n.options.measure)&&!0!==n.options.measure||(!0===n.options.measure?n.createMeasure({position:"topright",visible:!1}):n.createMeasure(n.options.measure)),"object"!==g(n.options.draw)&&!0!==n.options.draw||(!0===n.options.draw?n.createDraw({position:"topright",visible:!1,drawPolyline:!0,drawRectangle:!0,drawPolygon:!0}):n.createDraw(n.options.draw)),"object"!==g(n.options.locate)&&!0!==n.options.locate||(!0===n.options.locate?n.createLocate({position:"topleft",visible:!1}):n.createLocate(n.options.locate)),"object"!==g(n.options.coordpicker)&&!0!==n.options.coordpicker||(!0===n.options.coordpicker?n.createCoordPicker({position:"topright",visible:!1}):n.createCoordPicker(n.options.coordpicker))}},{key:"createScale",value:function(t){}},{key:"createContextMenu",value:function(t){}},{key:"createZoom",value:function(t){}},{key:"createTileLayer",value:function(t){}},{key:"createToolbar",value:function(t){}},{key:"createBaseLayers",value:function(t){}},{key:"createDraw",value:function(t){}},{key:"createMeasure",value:function(t){}},{key:"createLocate",value:function(t){}},{key:"createCoordPicker",value:function(t){}},{key:"createPanel",value:function(t){}},{key:"createOverlays",value:function(t,e){}},{key:"createScrollMsg",value:function(t){}},{key:"createCanvas",value:function(t,e){e=e||"point";var n=this.getWebGlLayers().length;switch(e){case"point":if(this.useWebGl){if(n<this.webGlLimit)return this.createWebGlPointOverlay(t);console.warn("webgl context reach limited of browser, use Low Mode instead!")}return this.createPointOverlay(t);case"grid":if(this.useWebGl){if(n<this.webGlLimit)return this.createWebGlGridOverlay(t);console.warn("webgl context reach limited of browser, use Low Mode instead!")}return this.createGridOverlay(t);case"link":return this.createLinkOverlay(t);case"line":return this.createLineOverlay(t);case"cell":return this.createCellOverlay(t);case"icon":return this.createIconOverlay(t);default:throw new Error("Canvas type not supported!")}}},{key:"createWebGlPointOverlay",value:function(t){}},{key:"createPointOverlay",value:function(t){}},{key:"createWebGlGridOverlay",value:function(t){}},{key:"createGridOverlay",value:function(t){}},{key:"createCellOverlay",value:function(t){}},{key:"createLineOverlay",value:function(t){}},{key:"createLegend",value:function(t){}},{key:"createHeatmap",value:function(t){}},{key:"createLinkOverlay",value:function(t){}},{key:"createIconOverlay",value:function(t){}},{key:"createBaiduStreet",value:function(t){}},{key:"createGoogleStreet",value:function(t){}},{key:"createOverlaysEx",value:function(t){}},{key:"removeControl",value:function(t){}},{key:"getZoomDistanceToMax",value:function(){return this.getMaxZoom()-this.getZoom()}},{key:"getMaxZoom",value:function(){}},{key:"getMinZoom",value:function(){}},{key:"getZoom",value:function(){}},{key:"zoomIn",value:function(){}},{key:"zoomOut",value:function(){}},{key:"getCrsCode",value:function(){}},{key:"setView",value:function(t,e){}},{key:"fitBounds",value:function(t){}},{key:"invalidateSize",value:function(){}},{key:"addTileLayer",value:function(t){}},{key:"removeTileLayer",value:function(t){}},{key:"remove",value:function(){Object.values(this.layers).forEach((function(t){t.onRemove()}))}},{key:"beforeLayerAdd",value:function(t){return t.options.isLayer&&(this.layers[s.stamp(t)]=t),this}},{key:"beforeLayerRemove",value:function(t){t.options.isLayer&&delete this.layers[s.stamp(t)]}},{key:"getClickableLayers",value:function(){return Object.values(this.layers).filter((function(t){return t.options.clickable}))}},{key:"getWebGlLayers",value:function(){return Object.values(this.layers).filter((function(t){return t.useWebGL}))}},{key:"_onMapMoveStart",value:function(t){this.moving=!0}},{key:"_onMapMoveEnd",value:function(t){this.moving=!1}},{key:"_onBaselayerChange",value:function(t){}},{key:"_onCrschange",value:function(t){}},{key:"onMapMouseMove",value:function(t){this.grabing||this.moving||Date.now()-this.lastMoveTrigger<this.moveEventInterval||(this.lastMoveTrigger=Date.now(),Object.values(this.getClickableLayers()).some((function(e){if(e.isImpact(t.latlng,t.point))return!0}))?s.addClass(this.mapEl,"fm-clickable"):s.removeClass(this.mapEl,"fm-clickable"))}},{key:"onMapClick",value:function(t){this.grabing?this.grabingHandler.callback.call(this.grabingHandler.scope,t):Object.values(this.getClickableLayers()).some((function(e){return e._onMapClick(t.latlng,t.point)}))}},{key:"grabClickEvent",value:function(t,e){this.grabing=!0,this.grabingHandler={callback:t,scope:e||this}}},{key:"releaseGrabbed",value:function(){this.grabing=!1}},{key:"addMarker",value:function(t,e){}},{key:"notify",value:function(t){var e,n,r=this,i={hideDuration:300,extendedTimeOut:1,tapToDismiss:!1,target:this.mapEl},o="info",a="bottomright",s=0;"object"===g(t)?(t.type&&(o=t.type),e=t.title,n=t.content,t.position&&(a=t.position),t.timeOut&&(s=t.timeOut)):n=t;var l,u=Object.assign({},i,{timeOut:s,positionClass:{topleft:"toast-top-left",topright:"toast-top-right",bottomleft:"toast-bottom-left",bottomright:"toast-bottom-right"}[a]});return(l="success"===o?d.fn.toastr.success(n,e,u):"info"===o?d.fn.toastr.info(n,e,u):"warning"===o?d.fn.toastr.warning(n,e,u):"error"===o?d.fn.toastr.error(n,e,u):"loading"===o?d.fn.toastr.loading(n,e,u):d.fn.toastr.info(n,e,u)).destroy=function(){r._notifications.indexOf(l)>=0&&(r._notifications.splice(r._notifications.indexOf(l),1),l._ux_remove())},this._notifications.length===this.options.notifyLimit&&this._notifications[0].destroy(),this._notifications.push(l),l}}])&&y(n.prototype,r),i&&y(n,i),a}(h);function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S(t,e){return!e||"object"!==C(e)&&"function"!=typeof e?P(t):e}function P(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function I(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var N=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(l,t);var e,n,r,i,a=(e=l,function(){var t,n=T(e);if(M()){var r=T(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return S(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),I(P(e=a.call(this)),"events",["remove"]),I(P(e),"mapWrapper",void 0),e.options=t,e}return n=l,(r=[{key:"getContainerElement",value:function(){}},{key:"create",value:function(){throw new Error("create() must be implemented in sub class!")}},{key:"addTo",value:function(t){return this.mapWrapper=t,t.beforeLayerAdd(this),this}},{key:"onAdd",value:function(t){return this}},{key:"buildUI",value:function(){this._content=s.create("div","fm-cmp");var t=this.uiHook();return o.disableClickPropagation(this._content),t&&this._content.appendChild(t),this._content}},{key:"uiHook",value:function(){}},{key:"_getMapContainer",value:function(){return this.mapWrapper.mapCmp._container}},{key:"destroy",value:function(){this.onRemove()}},{key:"onRemove",value:function(){this.mapWrapper.beforeLayerRemove(this),this.fire("remove")}}])&&k(n.prototype,r),i&&k(n,i),l}(h);function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e){return!e||"object"!==D(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function B(t,e){return(B=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var z={tile:"baidu.sat"},F=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&B(t,e)}(r,t);var e,n=(e=r,function(){var t,n=j(e);if(A()){var r=j(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return R(this,t)});function r(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=n.call(this,t)).options=Object.assign({},z,t),e}return r}(N);function G(t){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function q(t,e,n){return(q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Y(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function H(t,e){return!e||"object"!==G(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function V(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Y(t){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function W(t,e){return(W=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var X=r.TileLayer.extend({initialize:function(t,e){r.TileLayer.prototype.initialize.call(this,t,r.extend({},{crs:r.CRS.EPSG3857},e))},onAdd:function(t){var e={oldCrs:this._map.options.crs,newCrs:this.options.crs};this._map.options.crs=this.options.crs,r.TileLayer.prototype.onAdd.call(this,t),e.oldCrs!==e.newCrs&&this._map.fire("crschange",e,this)},onRemove:function(t){r.TileLayer.prototype.onRemove.call(this,t)}}),Z=X.extend({getTileUrl:function(t){var e=Math.pow(2,t.z)-1-t.y,n=Math.floor(e/16),i={r:"",s:this._getSubdomain(t),x:t.x,y:e,x16:Math.floor(t.x/16),y16:n,z:this._getZoomForUrl()};return r.Util.template(this._url,r.Util.extend(i,this.options))}});r.CRS.GCJ02=r.extend({},r.CRS.EPSG3857,{code:"GCJ02"});var K=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&W(t,e)}(s,t);var e,n,i,o,a=(e=s,function(){var t,n=Y(e);if(V()){var r=Y(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return H(this,t)});function s(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=a.call(this,t)).TILE_CONFIG={gaode:{normal:new X("http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",{crs:r.CRS.GCJ02,maxZoom:18,minZoom:3,subdomains:["1","2","3","4"]}),sat:r.layerGroup([new X("http://webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",{crs:r.CRS.GCJ02,maxZoom:18,minZoom:3,subdomains:["1","2","3","4"]}),new X("http://webst0{s}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}",{crs:r.CRS.GCJ02,maxZoom:18,minZoom:3,subdomains:["1","2","3","4"]})],{crs:r.CRS.GCJ02})},OSM:{normal:new X("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png")},tencent:{normal:new Z("http://rt{s}.map.gtimg.com/realtimerender?z={z}&x={x}&y={y}&type=vector&style=0",{crs:r.CRS.GCJ02,maxZoom:18,subdomains:["0","1","2","3"]}),sat:new Z("http://p{s}.map.gtimg.com/sateTiles/{z}/{x16}/{y16}/{x}_{y}.jpg",{crs:r.CRS.GCJ02,maxZoom:18,subdomains:["0","1","2","3"]})},google:{normal:new X("http://mt{s}.google.com/vt/lyrs=m&hl=en&gl=en&src=app&x={x}&y={y}&z={z}&s=Ga",{maxZoom:18,subdomains:["0","1","2","3"]}),sat:new X("http://mt{s}.google.com/vt/lyrs=y&hl=en&gl=en&src=app&x={x}&y={y}&z={z}&s=Ga",{maxZoom:18,subdomains:["0","1","2","3"]}),street:r.layerGroup([new X("http://mt{s}.google.com/vt/lyrs=m&hl=en&gl=en&src=app&x={x}&y={y}&z={z}&s=Ga",{maxZoom:18,subdomains:["0","1","2","3"]}),new X("https://mts{s}.google.com/mapslt?lyrs=svv&scale=2&gl=en&x={x}&y={y}&z={z}&hl=en&style=40,18&w=256&h=256",{maxZoom:18,subdomains:["0","1","2","3"]})]),streetonly:new X("https://mts{s}.google.com/mapslt?lyrs=svv&scale=2&gl=en&x={x}&y={y}&z={z}&hl=en&style=40,18&w=256&h=256",{maxZoom:18,subdomains:["0","1","2","3"]})}};var n,i=window.BMap;if(i){var o={project:function(t){if(!t)return t;var e=(new i.MercatorProjection).lngLatToPoint(new i.Point(t.lng,t.lat));return new r.Point(e.x,e.y)},unproject:function(t){var e=(new i.MercatorProjection).pointToLngLat(new i.Pixel(t.x,t.y));return new r.LatLng(e.lat,e.lng)},bounds:function(){r.bounds([-20037726.37,-11708041.66],[20037726.37,12474104.17]);var t=33554432;return new r.Bounds([-t,-t],[t,t])}()};r.CRS.BD09=r.extend({},r.CRS.EPSG3857,{code:"BD09",projection:o,transformation:(n=Math.pow(2,-26),new r.Transformation(n,.5,-n,.5))});var l=X.extend({getTileUrl:function(t){var e=Math.pow(2,t.z-1),n=t.x-e,i=e-t.y-1,o=r.point(n,i);return o.z=t.z,r.TileLayer.prototype.getTileUrl.call(this,o)}});e.TILE_CONFIG.baidu={normal:new l("http://online{s}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles=pl",{minZoom:4,crs:r.CRS.BD09,attribution:"",subdomains:["0","1","2","3"]}),sat:r.layerGroup([new l("http://shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46&udt=20160506",{minZoom:4,crs:r.CRS.BD09,attribution:"",subdomains:["0","1","2","3"]}),new l("http://online{s}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles=sl&v=017&udt=20160506",{minZoom:4,crs:r.CRS.BD09,attribution:"",subdomains:["0","1","2","3"]})],{crs:r.CRS.BD09}),street:r.layerGroup([new l("http://online{s}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles=pl",{minZoom:4,crs:r.CRS.BD09,attribution:"",subdomains:["0","1","2","3"]}),new l("http://pcsv{s}.map.bdimg.com/tile/?udt=20150114&qt=tile&styles=pl&x={x}&y={y}&z={z}",{minZoom:4,crs:r.CRS.BD09,attribution:"",subdomains:["0","1","2"]})],{crs:r.CRS.BD09}),streetonly:new l("http://pcsv{s}.map.bdimg.com/tile/?udt=20150114&qt=tile&styles=pl&x={x}&y={y}&z={z}",{minZoom:4,crs:r.CRS.BD09,attribution:"",subdomains:["0","1","2"]})}}return e}return n=s,(i=[{key:"create",value:function(){var t=this.options,e=this.TILE_CONFIG;if(t.tile){var n=t.tile.split("."),r=n[0],i=n[1];if(!e[r]||!e[r][i])throw new Error("".concat(t.tile," is not supported!"));this._lcmp=e[r][i],this._lcmp.options.tile=t.tile}return this}},{key:"addTo",value:function(t){return q(Y(s.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}}])&&U(n.prototype,i),o&&U(n,o),s}(F);function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $(t,e,n){return($="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function tt(t,e){return!e||"object"!==J(e)&&"function"!=typeof e?et(t):e}function et(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function rt(t){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function it(t,e){return(it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ot(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var at={position:"topright",hideSingleBase:!0,visible:!1,baseLayers:{baidu:[{title:locales.layers.baidu,type:"normal"},{title:locales.layers.baidu_sat,type:"sat"}],gaode:[{title:locales.layers.gaode,type:"normal",activated:!0},{title:locales.layers.gaode_sat,type:"sat"}],OSM:[{title:locales.layers.osm,type:"normal"}],google:[{title:locales.layers.google,type:"normal"},{title:locales.layers.google_sat,type:"sat"}],tencent:[{title:locales.layers.tencent,type:"normal"},{title:locales.layers.tencent_sat,type:"sat"}]}},st=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&it(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=rt(e);if(nt()){var r=rt(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return tt(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),ot(et(e=o.call(this,t)),"CONTROL_KEY","layers"),ot(et(e),"activated",""),e.options=Object.assign({},at,t),e}return n=a,(r=[{key:"addTo",value:function(t){$(rt(a.prototype),"addTo",this).call(this,t),t.controls[this.CONTROL_KEY]=this}},{key:"onAdd",value:function(){$(rt(a.prototype),"onAdd",this).call(this),this.mapWrapper.mapCmp.on("baselayerchange",this._onBaselayerChange,this)}},{key:"_onBaselayerChange",value:function(t){var e=t.cfg.tileLayer.options.tile;"baidu.street"===e?(this.baiduStreetPanel||(this.baiduStreetPanel=this.mapWrapper.createBaiduStreet()),this.baiduStreetPanel.enable()):this.baiduStreetPanel&&this.baiduStreetPanel.disable(),"google.street"===e?(this.googleStreetPanel||(this.googleStreetPanel=this.mapWrapper.createGoogleStreet()),this.googleStreetPanel.enable()):this.googleStreetPanel&&this.googleStreetPanel.disable(),this.activated=e}},{key:"onRemove",value:function(){$(rt(a.prototype),"onRemove",this).call(this),this.mapWrapper.mapCmp.off("baselayerchange",this._onBaselayerChange)}},{key:"setVisible",value:function(){}}])&&Q(n.prototype,r),i&&Q(n,i),a}(N);function lt(t){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var ut=(Object.freeze||Object)({lastId:0,Coordinate:{GCJ02:"GCJ02",WGS84:"WGS84","EPSG:3857":"WGS84",BD09:"BD09"},PI:3.141592653589793,x_pi:52.35987755982988,delta:function(t,e){var n=6378245,r=.006693421622965943,i=this.transformLat(e-105,t-35),o=this.transformLon(e-105,t-35),a=t/180*this.PI,s=Math.sin(a);s=1-r*s*s;var l=Math.sqrt(s);return{lat:i=180*i/(n*(1-r)/(s*l)*this.PI),lng:o=180*o/(n/l*Math.cos(a)*this.PI)}},transformLat:function(t,e){var n=2*t-100+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*this.PI)+20*Math.sin(2*t*this.PI))/3,n+=2*(20*Math.sin(e*this.PI)+40*Math.sin(e/3*this.PI))/3,n+=2*(160*Math.sin(e/12*this.PI)+320*Math.sin(e*this.PI/30))/3},transformLon:function(t,e){var n=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*this.PI)+20*Math.sin(2*t*this.PI))/3,n+=2*(20*Math.sin(t*this.PI)+40*Math.sin(t/3*this.PI))/3,n+=2*(150*Math.sin(t/12*this.PI)+300*Math.sin(t/30*this.PI))/3},transform:function(t,e,n,r){var i=this.Coordinate[n],o=this.Coordinate[r];if(i===o)return{lat:t,lng:e};switch("".concat(i,"->").concat(o)){case"".concat(this.Coordinate.BD09,"->").concat(this.Coordinate.GCJ02):return this.bd2Gcj(t,e);case"".concat(this.Coordinate.GCJ02,"->").concat(this.Coordinate.BD09):return this.gcj2Bd(t,e);case"".concat(this.Coordinate.BD09,"->").concat(this.Coordinate.WGS84):return this.bd2Wgs(t,e);case"".concat(this.Coordinate.WGS84,"->").concat(this.Coordinate.BD09):return this.wgs2Bd(t,e);case"".concat(this.Coordinate.GCJ02,"->").concat(this.Coordinate.WGS84):return this.gcj2Wgs(t,e);case"".concat(this.Coordinate.WGS84,"->").concat(this.Coordinate.GCJ02):return this.wgs2Gcj(t,e);default:throw new Error("can not transform ".concat(n).concat(" to").concat(r))}},wgs2Gcj:function(t,e){var n=this.delta(t,e);return{lat:t+n.lat,lng:e+n.lng}},gcj2Wgs:function(t,e){var n=this.delta(t,e);return{lat:t-n.lat,lng:e-n.lng}},gcj2Bd:function(t,e){var n=e,r=t,i=Math.sqrt(n*n+r*r)+2e-5*Math.sin(r*this.x_pi),o=Math.atan2(r,n)+3e-6*Math.cos(n*this.x_pi),a=i*Math.cos(o)+.0065;return{lat:i*Math.sin(o)+.006,lng:a}},bd2Gcj:function(t,e){var n=e-.0065,r=t-.006,i=Math.sqrt(n*n+r*r)-2e-5*Math.sin(r*this.x_pi),o=Math.atan2(r,n)-3e-6*Math.cos(n*this.x_pi),a=i*Math.cos(o);return{lat:i*Math.sin(o),lng:a}},bd2Wgs:function(t,e){var n=this.bd2Gcj(t,e);return this.gcj2Wgs(n.lat,n.lng)},wgs2Bd:function(t,e){var n=this.wgs2Gcj(t,e);return this.gcj2Bd(n.lat,n.lng)},deepClone:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach((function(n){if(n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(Array.isArray(n[r])?t[r]=e.deepClone(t[r]||[],n[r]):"object"===lt(n[r])?t[r]=e.deepClone(t[r]||{},n[r]):t[r]=n[r])})),t},extendBounds:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];n.forEach((function(e){t.north=Math.max(e.north,t.north),t.south=Math.min(e.south,t.south),t.east=Math.max(e.east,t.east),t.west=Math.min(e.west,t.west)}))},simplify:function(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=this._reducePoints(t,n),t=this._simplifyDP(t,n)},_reducePoints:function(t,e){for(var n=[t[0]],r=1,i=0,o=t.length;r<o;r++)this._sqDist(t[r],t[i])>e&&(n.push(t[r]),i=r);return i<o-1&&n.push(t[o-1]),n},_simplifyDP:function(t,e){var n,r=t.length,i=new(("undefined"==typeof Uint8Array?"undefined":lt(Uint8Array))!==void 0+""?Uint8Array:Array)(r);i[0]=i[r-1]=1,this._simplifyDPStep(t,i,e,0,r-1);var o=[];for(n=0;n<r;n++)i[n]&&o.push(t[n]);return o},_simplifyDPStep:function(t,e,n,r,i){var o,a,s,l=0;for(a=r+1;a<=i-1;a++)(s=this._sqClosestPointOnSegment(t[a],t[r],t[i],!0))>l&&(o=a,l=s);l>n&&(e[o]=1,this._simplifyDPStep(t,e,n,r,o),this._simplifyDPStep(t,e,n,o,i))},_sqClosestPointOnSegment:function(t,e,n,r){var i,o=e[0],a=e[1],s=n[0]-o,l=n[1]-a,u=s*s+l*l;return u>0&&((i=((t[0]-o)*s+(t[1]-a)*l)/u)>1?(o=n[0],a=n[1]):i>0&&(o+=s*i,a+=l*i)),s=t[0]-o,l=t[1]-a,r?s*s+l*l:[o,a]},_sqDist:function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}});function ct(t){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pt(t,e,n){return(pt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function dt(t,e){return!e||"object"!==ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function yt(t){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mt(t,e){return(mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vt=r.Control.extend({options:{position:"topright",autoZIndex:!0,hideSingleBase:!1,collapsed:!1,visible:!0},initialize:function(t,e){for(var n in r.setOptions(this,e),this._layerControlInputs=[],this._layers=[],this._handlingClick=!1,t)this._addLayer(t[n].tileLayer._lcmp,n,t[n])},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this).on("crschange",this._transformMapCenter,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return!1===this.options.visible&&r.DomUtil.addClass(this._container,"control-display-none"),this._container},addTo:function(t){return r.Control.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this),this._map.off("crschange",this._transformMapCenter,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(r.stamp(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){r.DomUtil.addClass(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(r.DomUtil.addClass(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):r.DomUtil.removeClass(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return r.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=r.DomUtil.create("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),r.DomEvent.disableClickPropagation(e),r.DomEvent.disableScrollPropagation(e);var i=this._section=r.DomUtil.create("section",t+"-list");n&&this._map.on("click",this.collapse,this);var o=this._layersLink=r.DomUtil.create("a",t+"-toggle",e);o.href="#",o.title="Layers",n||this.expand(),this._baseLayersList=r.DomUtil.create("div",t+"-base",i),this._separator=r.DomUtil.create("div",t+"-separator",i),this._overlaysList=r.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&r.stamp(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,cfg:n}),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;var t,e,n,i;r.DomUtil.empty(this._baseLayersList),this._layerControlInputs=[];var o=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),e=e||i.overlay,t=t||!i.overlay,o+=i.overlay?0:1;return this.options.hideSingleBase&&(t=t&&o>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(r.stamp(t.target)),n="add"===t.type?"baselayerchange":null;n&&(this._map.fire(n,e),this._resetMapView())},_resetMapView:function(){this._lastMapCenter&&this._lastZoom&&this._map.setView(this._lastMapCenter,this._lastZoom)},_transformMapCenter:function(t){if(this._lastMapCenter){var e=t.oldCrs.code,n=t.newCrs.code;this._lastMapCenter=ut.transform(this._lastMapCenter.lat,this._lastMapCenter.lng,e,n)}},addDefaultLayer:function(t){var e=this;this._lastMapCenter=t.getCenter(),this._lastZoom=t.getZoom();for(var n=0;n<this._layers.length;n++)if(!0===this._layers[n].cfg.activated){this._layers[n].layer.addTo(t);break}setTimeout((function(){e._resetMapView()}),0)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",r=document.createElement("div");return r.innerHTML=n,r.firstChild},_addItem:function(t){var e,n=document.createElement("label"),i=this._map.hasLayer(t.layer);e=this._createRadioElement("leaflet-base-layers_"+r.stamp(this),i),this._layerControlInputs.push(e),e.layerId=r.stamp(t.layer),r.DomEvent.on(e,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name;var a=document.createElement("div");return n.appendChild(a),a.appendChild(e),a.appendChild(o),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,n=this._layerControlInputs,r=[],i=[];this._handlingClick=!0;for(var o=n.length-1;o>=0;o--)t=n[o],e=this._getLayer(t.layerId).layer,t.checked?r.push(e):t.checked||i.push(e);for(this._lastMapCenter=this._map.getCenter(),this._lastZoom=this._map.getZoom(),o=0;o<i.length;o++)this._map.hasLayer(i[o])&&this._map.removeLayer(i[o]);for(o=0;o<r.length;o++)this._map.hasLayer(r[o])||this._map.addLayer(r[o]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,r=this._map.getZoom(),i=n.length-1;i>=0;i--)t=n[i],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&r<e.options.minZoom||void 0!==e.options.maxZoom&&r>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),_t=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mt(t,e)}(s,t);var e,n,i,o,a=(e=s,function(){var t,n=yt(e);if(gt()){var r=yt(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return dt(this,t)});function s(){return ht(this,s),a.apply(this,arguments)}return n=s,(i=[{key:"create",value:function(){var t=this,e=t.options,n=e.baseLayers,r={};return Object.keys(n).forEach((function(e){n[e].forEach((function(n){r[n.title]={tileLayer:new K({tile:"".concat(e,".").concat(n.type)}).create(),activated:n.activated},n.activated&&(t.activated="".concat(e,".").concat(n.type))}))})),t._lcmp=new vt(r,e),t}},{key:"addTo",value:function(t){return pt(yt(s.prototype),"addTo",this).call(this,t),this._lcmp.addDefaultLayer(t.mapCmp),this._lcmp.addTo(t.mapCmp),t.mapCmp.on("baselayerchange",this.onBaseLayerChange,this),this}},{key:"setVisible",value:function(t){return t?r.DomUtil.removeClass(this._lcmp._container,"control-display-none"):r.DomUtil.addClass(this._lcmp._container,"control-display-none"),this.options.visible=!!t,this}},{key:"onBaseLayerChange",value:function(){this.mapWrapper.controls.layers.trigger&&this.mapWrapper.controls.layers.trigger.click()}}])&&ft(n.prototype,i),o&&ft(n,o),s}(st);function bt(t){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xt(t,e,n){return(xt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=kt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Lt(t,e){return!e||"object"!==bt(e)&&"function"!=typeof e?Et(t):e}function Et(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function kt(t){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function St(t,e){return(St=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Mt={visible:!0,position:"topright",items:void 0},Tt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&St(t,e)}(l,t);var e,n,r,i,a=(e=l,function(){var t,n=kt(e);if(Ct()){var r=kt(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Lt(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),Pt(Et(e=a.call(this,Object.assign({},Mt,t))),"CONTROL_KEY","toolbar"),Pt(Et(e),"subMenus",[]),e}return n=l,(r=[{key:"uiHook",value:function(){var t=this.options,e=s.create("div","fm-toolbar");return this._parseConfiguration(e,t.items,"fm-toolbar"),e}},{key:"_parseConfiguration",value:function(t,e,n){var r=this;e.forEach((function(e,i){if("string"==typeof e)switch(e){case"|":var a=s.create("div",n+"-splitter",t);s.create("div",n+"-splitter-inner",a);break;default:s.create("div",n+"-label",t).innerHTML=e}else if("object"===bt(e)){var l,u,c,h,f,p;switch(e.type){case"input":(c=s.create("input",n+"-input",t)).setAttribute("placeholder",e.placeholder),c.style.width=(e.width||120)+"px",c.cfg=e;break;case"button":default:(l=s.create("div",n+"-button-cell",t)).cfg=e,(u=s.create("a",n+"-button",l)).eventTarget=l,e.iconCls&&(h=s.create("div",n+"-button-icon",u),s.addClass(h,e.iconCls),h.eventTarget=l),u.title=e.title,e.text&&((f=s.create("span",n+"-button-text",u)).eventTarget=l,f.innerText=e.text),e.iconCls&&!e.text&&s.addClass(u,n+"-button-icon-no-text"),e.toggle=e.toggle||void 0!==e.menu,e.menu&&(p=s.create("div",n+"-button-menu-suffix",u),l.menu=e.menu,p.eventTarget=l,l.menu.el=r._configureMenu(l.menu,u),l.menu.el.trigger=l),o.on(l,"click",r._onButtonClick,r)}}}))}},{key:"_configureMenu",value:function(t,e){var n,r,i,a,l,u,c=this,h=s.create("div","fm-toolbar-vertical"),f=s.create("ul","fm-toolbar-vertical-list",h);return t.forEach((function(t,e){if("string"==typeof t)switch(t){case"|":s.create("li","fm-toolbar-vertical-splitter",f);break;default:s.create("li","fm-toolbar-vertical-label",f).innerHTML=t}else if("object"===bt(t))switch(t.type){case"button":default:(n=s.create("li","fm-toolbar-vertical-button-cell",f)).cfg=t,n._container=h,(r=s.create("div","fm-toolbar-vertical-button",n)).eventTarget=n,(i=s.create("div","fm-toolbar-vertical-button-checkpoint",r)).eventTarget=n,n.checkPoint=i,n.checked?s.removeClass(i,"check-point-transparent"):s.addClass(i,"check-point-transparent"),n.setChecked=s.bind((function(t){this.checked=t,t?s.removeClass(this.checkPoint,"check-point-transparent"):s.addClass(this.checkPoint,"check-point-transparent")}),n),a=s.create("div","fm-toolbar-vertical-button-icon",r),s.addClass(a,t.iconCls),a.eventTarget=n,r.title=t.title,t.text&&((l=s.create("div","fm-toolbar-vertical-button-text",r)).eventTarget=n,l.innerText=t.text),t.iconCls&&!t.text&&s.addClass(r,"fm-toolbar-vertical-button-icon-no-text"),t.toggle=t.toggle||void 0!==t.menu,t.menu&&(u=s.create("div","fm-toolbar-vertical-button-menu-suffix",r),n.menu=t.menu,n.menu.el=c._configureMenu(n.menu,r),u.eventTarget=n),o.on(n,"click",c._onMenuClick,c)}})),c.subMenus.push(h),h}},{key:"_onButtonClick",value:function(t){var e=t.target.eventTarget||t.target,n=this.mapWrapper.lastActiveMenuButton,r=e.cfg;n&&n!==e&&n.pressed&&n.click(),r.toggle?(e.pressed=!e.pressed,e.pressed?s.addClass(e,"fm-toolbar-button-pressed"):s.removeClass(e,"fm-toolbar-button-pressed"),e.menu&&(this.subMenuVisible(e.menu.el,e.pressed),this.mapWrapper.lastActiveMenuButton=e),"function"==typeof r.onclick&&r.onclick.apply(r.scope||this,[e,e.pressed])):(e.tb&&e.tb.setVisible(!this.options.visible),"function"==typeof r.onclick&&r.onclick.apply(r.scope||this,[e]))}},{key:"_onMenuClick",value:function(t){var e=t.target.eventTarget||t.target,n=e.cfg;e.checked=!e.checked,e.checked?s.removeClass(e.checkPoint,"check-point-transparent"):s.addClass(e.checkPoint,"check-point-transparent"),e._container.trigger.click(),"function"==typeof n.onclick&&n.onclick.apply(n.scope||this,[e])}},{key:"addTo",value:function(t){xt(kt(l.prototype),"addTo",this).call(this,t),t.controls[this.CONTROL_KEY]=this,xt(kt(l.prototype),"addTo",this).call(this,t)}},{key:"subMenuVisible",value:function(t,e){}}])&&wt(n.prototype,r),i&&wt(n,i),l}(N);function Ot(t){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function It(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Dt(t,e,n){return(Dt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Rt(t,e){return!e||"object"!==Ot(e)&&"function"!=typeof e?At(t):e}function At(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Bt(t){return(Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zt(t,e){return(zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ft(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Gt=r.Control.extend({initialize:function(t){return r.setOptions(this,t),r.stamp(this),this},onAdd:function(t){return this.el=this.options.el,this.el}}),Ut={position:"topright",top:"50px",right:"10px",visible:!1},qt=r.Control.extend({initialize:function(t){return r.setOptions(this,t),r.stamp(this),this},onAdd:function(t){var e=this;return e.el=e.options.el,e._initStyle(),e.setVisible(),e.el},_initStyle:function(){var t=this.el;t.style.position="absolute",t.style.marginTop="44px",t.style.right="150px",t.style.zIndex="850"},setVisible:function(t){this.el.style.display=t?"block":"none",this.options.visible=t}}),Ht=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zt(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Bt(e);if(jt()){var r=Bt(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function a(){var t;It(this,a);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Ft(At(t=o.call.apply(o,[this].concat(n))),"subMenusCmps",[]),t}return n=a,(r=[{key:"create",value:function(){var t=this;return Object.assign(this.options,{el:t.buildUI()}),t._lcmp=new Gt(t.options),t.subMenus.forEach((function(e){t.subMenusCmps.push(new qt(Object.assign({},{el:e},Ut)))})),t}},{key:"addTo",value:function(t){return Dt(Bt(a.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this.subMenusCmps.forEach((function(e){e.addTo(t.mapCmp)})),this}},{key:"subMenuVisible",value:function(t,e){Dt(Bt(a.prototype),"subMenuVisible",this).call(this,t,e),this.subMenusCmps.forEach((function(n){n.options.el===t?n.setVisible(e):n.setVisible(!1)}))}}])&&Nt(n.prototype,r),i&&Nt(n,i),a}(Tt);n(34),n(256);function Vt(t){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wt(t,e,n){return(Wt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Jt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Xt(t,e){return!e||"object"!==Vt(e)&&"function"!=typeof e?Zt(t):e}function Zt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Jt(t){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qt(t,e){return(Qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var te={visible:!0,position:"topright",drawPolyline:!0,drawRectangle:!0,drawPolygon:!0,color:"#1890ff",weight:2,opacity:1,fillColor:"#1890ff",fillOpacity:.3},ee=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qt(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Jt(e);if(Kt()){var r=Jt(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Xt(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),$t(Zt(e=o.call(this,t)),"events",["hide","show","startdraw","enddraw","startedit","endedit"]),$t(Zt(e),"CONTROL_KEY","draw"),e.options=Object.assign({},te,t),e}return n=a,(r=[{key:"addTo",value:function(t){Wt(Jt(a.prototype),"addTo",this).call(this,t),t.controls[this.CONTROL_KEY]=this,this.on("startdraw",(function(e){t.controls.measure&&t.controls.measure.disableMeasure()}),this)}},{key:"show",value:function(){this._show(),this.fire("show")}},{key:"hide",value:function(){this._hide(),this.fire("hide")}},{key:"setVisible",value:function(t){t?this.show():this.hide()}},{key:"onRemove",value:function(){delete this.mapWrapper.controls[this.CONTROL_KEY],Wt(Jt(a.prototype),"onRemove",this).call(this)}},{key:"disableDraw",value:function(){}},{key:"setGeoJSON",value:function(t){}},{key:"addGeoJSON",value:function(t){}},{key:"getGeoJSON",value:function(){}},{key:"clear",value:function(){}},{key:"removeGeoJSON",value:function(t){}},{key:"getBounds",value:function(){}}])&&Yt(n.prototype,r),i&&Yt(n,i),a}(N);function ne(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var re=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};ne(re,"CRS_CODE_BD09","BD09"),ne(re,"CRS_CODE_GCJ02","GCJ02"),ne(re,"CRS_CODE_WGS84","WGS84"),ne(re,"CRS_CODE","WGS84");var ie=re;function oe(t){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ae(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return se(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function se(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ue(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ce(t,e,n){return(ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=pe(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function he(t,e){return!e||"object"!==oe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function pe(t){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function de(t,e){return(de=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}L.PM.initialize({optIn:!0});var ge={drawMarker:!1,drawCircleMarker:!1,drawCircle:!1,editMode:!0,dragMode:!0,cutPolygon:!1,removalMode:!0},ye=["stroke","fill"],me=["stroke-opacity","fill-opacity"],ve=["stroke-width"],_e=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&de(t,e)}(l,t);var e,n,r,i,a=(e=l,function(){var t,n=pe(e);if(fe()){var r=pe(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return he(this,t)});function l(){return le(this,l),a.apply(this,arguments)}return n=l,(r=[{key:"create",value:function(){return this.on("hide",this._onHide,this),this}},{key:"addTo",value:function(t){ce(pe(l.prototype),"addTo",this).call(this,t);var e=this,n=e.mapWrapper.mapCmp;return e.drawControl=new L.PM.Map(n),n.pm=e.drawControl,n.pm.setGlobalOptions({snappable:!1,cursorMarker:!1,finishOn:"dblclick",templineStyle:{color:e.options.color,weight:e.options.weight,opacity:e.options.opacity},hintlineStyle:{color:e.options.color,weight:e.options.weight,opacity:e.options.opacity,dashArray:[3,15]}}),n.pm.setLang("fleetmap",locales.draw,"en"),n.pm.setPathOptions({color:e.options.color,weight:e.options.weight,opacity:e.options.opacity,fillColor:e.options.fillColor,fillOpacity:e.options.fillOpacity}),e.options.visible&&e._show(),e}},{key:"_show",value:function(){var t={};Object.assign(t,this.options,ge),this.drawControl.addControls(t),this._bindEvent(),this.options.visible=!0}},{key:"_hide",value:function(){this.options.visible&&(this._cleanControl(),this.options.visible=!1)}},{key:"remove",value:function(){var t=this.mapWrapper.mapCmp;this._cleanControl(),delete t.pm}},{key:"_cleanControl",value:function(){this.drawControl.removeControls();var t,e=ae(this._findLayers());try{for(e.s();!(t=e.n()).done;)t.value.remove()}catch(t){e.e(t)}finally{e.f()}this._unbindEvent()}},{key:"_bindEvent",value:function(){var t=this,e=t.drawControl.Toolbar.getButtons();for(var n in e)e[n].buttonsDomNode&&(n.startsWith("draw")?o.on(e[n].buttonsDomNode.childNodes[0],"click",(function(e){t.fire("startdraw")}),t):(o.on(e[n].buttonsDomNode.childNodes[0],"click",(function(e){t.fire("startedit")}),t),o.on(e[n].buttonsDomNode.childNodes[1],"click",(function(e){t.fire("endedit")}),t)));t.mapWrapper.mapCmp.on("pm:create",t._onCreate,t).on("crschange",t._transformCoords,t)}},{key:"_unbindEvent",value:function(){var t=this;t.mapWrapper.mapCmp.off("pm:create",t._onCreate,t).off("crschange",t._transformCoords,t)}},{key:"_onCreate",value:function(t){var e=this,n=t.layer;n.on("pm:edit",e._onEdit,e);var r=e._getFeatureProperties(n);n.feature={type:"Feature",properties:r},e._bindPropertiesPopup(n),e._bindPM(n),e.fire("enddraw")}},{key:"_onEdit",value:function(t){var e=t.target;Object.assign(e.feature.properties,this._getBoundsAndCenter(e))}},{key:"_onLayerCut",value:function(t){var e=t.layer,n=t.target;e.feature=n.feature,e.once("pm:cut",this._onLayerCut,this),this._bindPropertiesPopup(e),this.fire("enddraw")}},{key:"_onHide",value:function(t){this.disableDraw()}},{key:"_transformCoords",value:function(t){var e,n=ae(this._findLayers());try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r instanceof L.Circle){var i=r.getLatLng(),o=ut.transform(i.lat,i.lng,t.oldCrs.code,t.newCrs.code);r.setLatLng(o)}else{var a=r.getLatLngs(),s=void 0;r instanceof L.Polygon?s=a.map((function(e){return e.map((function(e){return ut.transform(e.lat,e.lng,t.oldCrs.code,t.newCrs.code)}))})):r instanceof L.Polyline&&(s=a.map((function(e){return ut.transform(e.lat,e.lng,t.oldCrs.code,t.newCrs.code)}))),r.setLatLngs(s)}if(r.redraw(),r.isPopupOpen()){var l=r.getPopup(),u=l.getLatLng(),c=ut.transform(u.lat,u.lng,t.oldCrs.code,t.newCrs.code);l.setLatLng(c),l.update()}}}catch(t){n.e(t)}finally{n.f()}}},{key:"disableDraw",value:function(){ce(pe(l.prototype),"disableDraw",this).call(this);var t=this;t.drawControl&&(t.drawControl.disableDraw(),t.drawControl.disableGlobalEditMode(),t.drawControl.disableGlobalDragMode(),t.drawControl.disableGlobalRemovalMode())}},{key:"setGeoJSON",value:function(t){this.clear(),this._addGeoJSONData(t)}},{key:"addGeoJSON",value:function(t){this._addGeoJSONData(t)}},{key:"_addGeoJSONData",value:function(t){var e=this,n=e.mapWrapper.mapCmp,r=e._standardInput(t);L.geoJSON(r,{style:function(t){var n={};if(t.properties.stroke&&(n.color=t.properties.stroke),t.properties["stroke-width"]&&(n.weight=t.properties["stroke-width"]),t.properties["stroke-opacity"]&&(n.opacity=t.properties["stroke-opacity"]),t.properties.fill&&(n.fillColor=t.properties.fill),t.properties["fill-opacity"]&&(n.fillOpacity=t.properties["fill-opacity"]),0===Object.getOwnPropertyNames(n).length){var r=t.geometry.type;n.color=e.options.color,n.weight=e.options.weight,n.opacity=e.options.opacity,"MultiPolygon"!==r&&"Polygon"!==r||(n.fillColor=e.options.fillColor,n.fillOpacity=e.options.fillOpacity)}return n}}).eachLayer((function(t){e._bindPropertiesPopup(t),e._bindPM(t),t.on("pm:edit",e._onEdit,e),t.addTo(n)}))}},{key:"getGeoJSON",value:function(){var t=this._findLayers(),e=L.layerGroup(t).toGeoJSON();return this._standardOutput(e)}},{key:"onRemove",value:function(){var t=this.mapWrapper.mapCmp;this.disableDraw(),this._cleanControl(),delete t.pm,ce(pe(l.prototype),"onRemove",this).call(this)}},{key:"_bindPropertiesPopup",value:function(t){var e=this;t._popupHandlersAdded=!0,t.on("click",(function(n){var r=e.mapWrapper.mapCmp;r.pm.globalDragModeEnabled()||r.pm.globalEditEnabled()||r.pm.globalRemovalEnabled()||t.openPopup(n.layer||n.target,n.latlng)})),t.bindPopup("",{closeButton:!1}),t.on("popupopen",e._updatePropertiesPopup,e)}},{key:"_getFeatureProperties",value:function(t){if(t.feature)return Object.assign(t.feature.properties||{},this._getBoundsAndCenter(t));var e=t.options,n={};return n.stroke=e.color,n["stroke-width"]=e.weight,n["stroke-opacity"]=e.opacity,t instanceof L.Polygon&&(n.fill=e.fillColor,n["fill-opacity"]=e.fillOpacity),Object.assign({},n,this._getBoundsAndCenter(t))}},{key:"_getBoundsAndCenter",value:function(t){var e=L.featureGroup([t]).getBounds(),n=e.getCenter();return{bounds:this._standardOutputBounds(e),center:this._standardOutputCenter(n)}}},{key:"_updatePropertiesPopup",value:function(t){var e=this,n=t.target,r=e._getFeatureProperties(n),i=s.create("div"),a=s.create("div","fm-draw-feature-popup-content",i),l=s.create("table","fm-draw-feature-popup-properties",a),u=s.create("tbody",void 0,l);for(var c in r){var h=s.create("tr",void 0,u),f=s.create("th",void 0,h),p=s.create("input",void 0,f);p.type="text",p.value=c;var d=s.create("td",void 0,h),g=s.create("input",void 0,d),y=e._getInputAttrs(c);Object.assign(g,y),"object"===oe(r[c])?(g.readOnly=!0,g.value=JSON.stringify(r[c])):g.value=r[c]}var m=s.create("div","fm-draw-feature-popup-btn",i),v=s.create("button","fm-common-button fm-common-button--primary fm-common-button--mini",m);s.create("span",void 0,v).innerHTML=locales.common.add,o.on(v,"click",(function(t){var e=s.create("tr",void 0,this),n=s.create("th",void 0,e);s.create("input",void 0,n).type="text";var r=s.create("td",void 0,e);s.create("input",void 0,r).type="text",l.scrollTo(0,this.scrollHeight)}),u);var _=s.create("button","fm-common-button fm-common-button--primary fm-common-button--mini",m);s.create("span",void 0,_).innerHTML=locales.common.save,o.on(_,"click",(function(t){for(var r=Array.prototype.slice.call(this.querySelectorAll("input")),i=r.map((function(t){return t.value})),o={},a=0;a<i.length/2;a++)i[2*a].trim()&&(o[i[2*a]]=i[2*a+1],r[2*a+1].readOnly&&(o[i[2*a]]=JSON.parse(i[2*a+1])));e._applyPropertiesToFeature(n,o),n.closePopup()}),u);var b=s.create("button","fm-common-button fm-common-button--danger fm-common-button--mini",m);s.create("span",void 0,b).innerHTML=locales.common.cancel,o.on(b,"click",(function(t){n.closePopup()}),u),n.setPopupContent(i)}},{key:"_getInputAttrs",value:function(t){var e={};return ye.includes(t)?e.type="color":me.includes(t)||ve.includes(t)?(e.type="number",e.min=0,e.step=.1,me.includes(t)&&(e.max=1)):e.type="text",e}},{key:"_applyPropertiesToFeature",value:function(t,e){var n=this;t.feature.properties=Object.assign({},e);var r={};r.color=e.stroke||n.options.color,r.weight=e["stroke-width"]||n.options.weight,r.opacity=e["stroke-opacity"]||n.options.opacity,t instanceof L.Polygon&&(r.fillColor=e.fill||n.options.fillColor,r.fillOpacity=e["fill-opacity"]||n.options.fillOpacity),t.setStyle(r)}},{key:"_bindPM",value:function(t){Object.assign(t.options,{pmIgnore:!1}),t instanceof L.Rectangle?(t.pm=new L.PM.Edit.Rectangle(t),t.once("pm:cut",this._onLayerCut,this)):t instanceof L.Polygon?(t.pm=new L.PM.Edit.Polygon(t),t.once("pm:cut",this._onLayerCut,this)):t instanceof L.Polyline?t.pm=new L.PM.Edit.Line(t):t instanceof L.Circle&&(t.pm=new L.PM.Edit.Circle(t))}},{key:"_standardOutput",value:function(t){var e=this.mapWrapper.mapCmp.options.crs.code,n=ie.CRS_CODE;return this._transformGeoCoords(t,e,n)}},{key:"_standardOutputBounds",value:function(t){var e=this.mapWrapper.mapCmp.options.crs.code,n=ie.CRS_CODE,r={};return r._northEast=ut.transform(t._northEast.lat,t._northEast.lng,e,n),r._southWest=ut.transform(t._southWest.lat,t._southWest.lng,e,n),{north:r._northEast.lat,south:r._southWest.lat,west:r._southWest.lng,east:r._northEast.lng}}},{key:"_standardOutputCenter",value:function(t){var e=this.mapWrapper.mapCmp.options.crs.code,n=ie.CRS_CODE;return ut.transform(t.lat,t.lng,e,n)}},{key:"_standardInput",value:function(t){var e=L.geoJSON(t).toGeoJSON(),n=this.mapWrapper.mapCmp,r=ie.CRS_CODE,i=n.options.crs.code;return this._transformGeoCoords(e,r,i)}},{key:"_transformGeoCoords",value:function(t,e,n){var r=ut.deepClone({},t);if(r&&e!==n){var i,o=ae(r.features);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=a.geometry.coordinates,l=this._transform(s,e,n);a.geometry.coordinates=l}}catch(t){o.e(t)}finally{o.f()}}return r}},{key:"_transform",value:function(t,e,n){if(!Array.isArray(t))throw new Error("coordinates should be an array");if(Array.isArray(t[0])){var r,i=[],o=ae(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;i.push(this._transform(a,e,n))}}catch(t){o.e(t)}finally{o.f()}return i}var s=ut.transform(t[1],t[0],e,n);return[s.lng,s.lat]}},{key:"clear",value:function(){this._findLayers().map((function(t){return t.remove()}))}},{key:"removeGeoJSON",value:function(t){var e,n=ae(this._findLayers());try{for(n.s();!(e=n.n()).done;){var r=e.value;!0===t(r.toGeoJSON())&&r.remove()}}catch(t){n.e(t)}finally{n.f()}}},{key:"getBounds",value:function(){var t=this._findLayers(),e=L.featureGroup(t).getBounds();if(e)return this._standardOutputBounds(e)}},{key:"_findLayers",value:function(){var t=this.mapWrapper.mapCmp,e=[];return t.eachLayer((function(t){(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.Circle||t instanceof L.CircleMarker)&&e.push(t)})),e=(e=e.filter((function(t){return!!t.pm}))).filter((function(t){return!t._pmTempLayer}))}}])&&ue(n.prototype,r),i&&ue(n,i),l}(ee);function be(t){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function we(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xe(t,e,n){return(xe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ke(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Le(t,e){return!e||"object"!==be(e)&&"function"!=typeof e?Ee(t):e}function Ee(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ce(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ke(t){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Se(t,e){return(Se=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Me={position:"topright",horizon:"10px",vertical:"50px",visible:!0,closeButton:!0,hideOnClose:!0,dragable:!0,resizable:!1,header:{iconCls:"",title:""},bodyId:void 0,bodyStyle:void 0,body:void 0},Te=document.createElement("img"),Oe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Se(t,e)}(l,t);var e,n,r,i,a=(e=l,function(){var t,n=ke(e);if(Ce()){var r=ke(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Le(this,t)});function l(t){var e;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),t=t||{},Pe(Ee(e=a.call(this,Object.assign({},Me,t,{header:!1!==t.header&&Object.assign({},Me.header,t.header),bodyStyle:Object.assign({},Me.bodyStyle,t.bodyStyle)}))),"events",["hide","show"]),Pe(Ee(e),"mousePressed",!1),Pe(Ee(e),"lastPressed",0),Pe(Ee(e),"startDrag",!1),Pe(Ee(e),"dockTop",!0),Pe(Ee(e),"dockLeft",!0),Pe(Ee(e),"dragCfg",{x:0,y:0,offsetTop:0,offsetRight:0}),"topright"!==e.options.position&&"topleft"!==e.options.position&&"bottomright"!==e.options.position&&"bottomleft"!==e.options.position)throw new Error("position[".concat(e.options.position,'] supports "topright|topleft|bottomright|bottomleft" only!'));return e.dockTop=-1!==e.options.position.indexOf("top"),e.dockLeft=-1!==e.options.position.indexOf("left"),e.dockedVertical=e.dockTop?"top":"bottom",e.dockedHorizon=e.dockLeft?"left":"right",e}return n=l,(r=[{key:"uiHook",value:function(){var t=this,e=t.options,n=s.create("div","fm-panel");if(o.disableScrollPropagation(n).disableClickPropagation(n).disableMousePropagation(n),!1!==e.header){var r=s.create("div","fm-panel-header",n);if(e.header.iconCls){var i=s.create("div","fm-panel-header-icon",r);s.addClass(i,e.header.iconCls)}if(e.dragable&&(s.addClass(r,"fm-panel-draggable"),r.draggable=!0,o.on(r,"dragstart",this._onDragStart,t),o.on(r,"dragend",this._onDragEnd,t),o.on(r,"drag",this._onDrag,t),o.on(r,"dragover",this._onDragOver,t)),s.create("div","fm-panel-header-title",r).innerHTML=e.header.title,e.closeButton){var a=s.create("div","fm-panel-header-close",r);s.addClass(a,"fm-icon-close"),a.preventDragEvent=!0,a.draggable=!0,o.on(a,"click",this._closeButtonEvent,t)}}var l=s.create("div","fm-panel-body",n);this.options.bodyId&&(l.id=this.options.bodyId),t._bodyEl=l,t.options.resizable&&s.addClass(l,"div-resizable"),Object.assign(l.style,this.options.bodyStyle);var u=t.bodyHook()||e.body;return u&&(u instanceof HTMLElement?l.appendChild(u):l.innerHTML=u),n}},{key:"_onDragOver",value:function(t){t.preventDefault()}},{key:"_onDragStart",value:function(t){if(!0!==t.target.preventDragEvent){this.mousePressed=!0,this.startDrag=!0,this.lastPressed=t.timeStamp;var e=this.getContainerElement(),n=this.mapWrapper.mapEl.getBoundingClientRect(),r=e.getBoundingClientRect();this.dragCfg.offsetTop=r.top-n.top,this.dragCfg.offsetRight=n.right-r.right,this.dragCfg.verticalOffset=this.dockTop?r.top-n.top:n.bottom-r.bottom,this.dragCfg.horizonOffset=this.dockLeft?r.left-n.left:n.right-r.right,this.dragCfg.top=r.top,this.dragCfg.right=r.right,this.dragCfg.mapRect=n,this.dragCfg.panelRect=r,this.dragCfg.clientX=t.clientX,this.dragCfg.clientY=t.clientY,this.dragCfg.layerX=t.layerX,this.dragCfg.layerY=t.layerY,this.dragCfg.x=t.x,this.dragCfg.y=t.y,t.dataTransfer.setDragImage(Te,5e3,5e3)}}},{key:"_onDragEnd",value:function(t){t.preventDefault(),this.mousePressed=!1,this.options.resizable&&this._calculateMaxSize()}},{key:"_onDrag",value:function(t){t.preventDefault(),this.mousePressed&&(t.clientX===this.lastX&&t.clientY===this.lastY||(!0===this.startDrag&&(this.startDrag=!1),this._updatePosition(t),this.lastX=t.clientX,this.lastY=t.clientY))}},{key:"_closeButtonEvent",value:function(t){o.stopPropagation(t),t.preventDefault(),this.options.hideOnClose?(this._beforeHide(),this.hide()):this.destroy()}},{key:"_updatePosition",value:function(t){if(0!==t.clientX&&0!==t.clientY){var e=this.getContainerElement(),n=t.clientX-this.dragCfg.clientX,r=t.clientY-this.dragCfg.clientY,i=this.dragCfg.horizonOffset+n*(this.dockLeft?1:-1),o=this.dragCfg.verticalOffset+r*(this.dockTop?1:-1),a=t.clientX-this.dragCfg.layerX,s=t.clientY-this.dragCfg.layerY,l=this.mapWrapper.mapEl.getBoundingClientRect(),u=e.getBoundingClientRect();a<l.x&&(i=this.dockLeft?0:l.width-u.width),a>l.x+l.width-u.width&&(i=this.dockLeft?l.width-u.width:0),s<l.y&&(o=this.dockTop?0:l.height-u.height),s>l.y+l.height-u.height&&(o=this.dockTop?l.height-u.height:0),e.style[this.dockedHorizon]=i+"px",e.style[this.dockedVertical]=o+"px",this.lastUpdate=t.timeStamp}}},{key:"bodyHook",value:function(){}},{key:"show",value:function(){this._content.style.display="block",this.options.resizable&&this._calculateMaxSize(),this.fire("show")}},{key:"_calculateMaxSize",value:function(){var t=this._bodyEl,e=this.mapWrapper.mapEl.getBoundingClientRect(),n=t.getBoundingClientRect();t.style.maxWidth=e.right-n.right+n.width+"px",t.style.maxHeight=e.bottom-n.bottom+n.height+"px"}},{key:"onAdd",value:function(t){return xe(ke(l.prototype),"onAdd",this).call(this,t),this.options.visible&&this.show(),this.options.resizable&&this.mapWrapper.mapCmp.on("delegateresize",this._calculateMaxSize,this),this}},{key:"hide",value:function(){this._content.style.display="none",this.fire("hide")}},{key:"_beforeHide",value:function(){}},{key:"setVisible",value:function(t){t?this.show():this.hide()}},{key:"onRemove",value:function(){this.options.resizable&&this.mapWrapper.mapCmp.off("delegateresize",this._calculateMaxSize,this),this.fire("remove"),xe(ke(l.prototype),"onRemove",this).call(this)}}])&&we(n.prototype,r),i&&we(n,i),l}(N);function Ie(t){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function De(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Re(t,e,n){return(Re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Be(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Ae(t,e){return!e||"object"!==Ie(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function je(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Be(t){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ze(t,e){return(ze=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fe=r.Control.extend({initialize:function(t){return r.setOptions(this,t),r.stamp(this),this},onAdd:function(t){var e=this;return e.el=e.options.el,e._initStyle(),e.setVisible(this.options.visible),this.options.resizable&&t.on("resize",this.tranferMapResize,this),e.el},onRemove:function(){return this._map.off("resize",this.tranferMapResize,this),this},_initStyle:function(){var t=this.el;t.style.position="absolute",t.style.margin="0",t.style.zIndex="840",this.dockTop=-1!==this.options.position.indexOf("top"),this.dockLeft=-1!==this.options.position.indexOf("left"),t.style[this.dockTop?"top":"bottom"]=this.options.vertical?this.options.vertical:"50px",t.style[this.dockLeft?"left":"right"]=this.options.horizon?this.options.horizon:"10px"},setVisible:function(t){this.el.style.display=t?"block":"none",this.options.visible=t},tranferMapResize:function(t){this._map.fire("delegateresize",{delegate:this})}}),Ge=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ze(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Be(e);if(je()){var r=Be(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Ae(this,t)});function a(){return Ne(this,a),o.apply(this,arguments)}return n=a,(r=[{key:"create",value:function(){return Object.assign(this.options,{el:this.buildUI()}),this._lcmp=new Fe(this.options),this}},{key:"addTo",value:function(t){return Re(Be(a.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}},{key:"getContainerElement",value:function(){return this._lcmp.el}},{key:"destroy",value:function(){this.mapWrapper.removeControl(this._lcmp),this.onRemove()}},{key:"onRemove",value:function(){Re(Be(a.prototype),"onRemove",this).call(this)}}])&&De(n.prototype,r),i&&De(n,i),a}(Oe);n(35),n(258);function Ue(t){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function He(t,e,n){return(He="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xe(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Ve(t,e){return!e||"object"!==Ue(e)&&"function"!=typeof e?Ye(t):e}function Ye(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function We(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Xe(t){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ze(t,e){return(Ze=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ke(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Je={visible:!1,position:"topleft",vertical:"65px",beforeRemoveHook:function(t,e){return!0}},Qe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ze(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Xe(e);if(We()){var r=Xe(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Ve(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Ke(Ye(e=o.call(this,Object.assign({},Je,t))),"treeId",""),Ke(Ye(e),"CONTROL_KEY","overlays"),Ke(Ye(e),"events",["layerchanged","rangechanged","itemremove","itemclick","itemdblclick","itemexpand","itemcollapse"]),Ke(Ye(e),"ztreeSetting",{}),Ke(Ye(e),"ztreeDiyDom",(function(t,e){var n=d("#"+e.tId+"_a");if(e.rangeEnable){var r=s.create("input");r.id=e.tId+"_range",r.type="range",r.className="fm-overlays-body-node-range",r.value=void 0===e.rangeValue?100:e.rangeValue,r.style.display=e.checked?"inline-block":"none",r.treeNode=e,n.after(r)}})),e.treeId="__map_overlays_"+s.stamp(Ye(e));var n=Ye(e);return e.ztreeSetting={view:{addDiyDom:e.ztreeDiyDom,txtSelectedEnable:!1},edit:{enable:!0,showRemoveBtn:n._showTreeRemoveBtn,showRenameBtn:!1},check:{enable:!0,autoCheckTrigger:!0},callback:{onCheck:function(t,e,r){d.fn.zTree.getZTreeObj(e).getChangeCheckedNodes().forEach((function(t){d("#"+t.tId+"_range").css("display",t.checked?"inline-block":"none"),n.fire("layerchanged",{node:t,oldValue:t.checkedOld,value:t.checked}),t.checkedOld=t.checked}))},beforeRemove:e.options.beforeRemoveHook,onRemove:function(t,e,r){n.fire("itemremove",{node:r})},onClick:function(t,e,r){n.fire("itemclick",{node:r})},onDblClick:function(t,e,r){n.fire("itemdblclick",{node:r})},onExpand:function(t,e,r){n.fire("itemexpand",{node:r})},onCollapse:function(t,e,r){n.fire("itemcollapse",{node:r})}}},e}return n=a,(r=[{key:"addTo",value:function(t){He(Xe(a.prototype),"addTo",this).call(this,t),t.controls[this.CONTROL_KEY]=this}},{key:"onAdd",value:function(t){var e=this;return setTimeout((function(){e._tree=d.fn.zTree.init(d("#"+e.treeId),e.ztreeSetting,e.options.nodeData),setTimeout((function(){d("input[type=range].fm-overlays-body-node-range").on("input",(function(){d(this).css("background","linear-gradient(to right, #059CFA, white "+this.value+"%, white)");var t=d(this).prop("treeNode");e.fire("rangechanged",{node:t,oldValue:t.rangeValueOld,value:this.value}),t.rangeValueOld=this.value}))}),100)}),100),e}},{key:"bodyHook",value:function(){var t=s.create("ul","fm-overlays-body ztree");return t.id=this.treeId,t}},{key:"onRemove",value:function(){delete this.mapWrapper.controls[this.CONTROL_KEY],d.fn.zTree.destroy(this.treeId)}},{key:"_showTreeRemoveBtn",value:function(t,e){return e.removeEnable}},{key:"checkNode",value:function(t,e){this._tree.checkNode(t,e,!0,!0)}},{key:"getTreeNodes",value:function(){return this._tree.getNodes()}},{key:"fetchNode",value:function(t,e){return this._tree.getNodeByParam(t,e)}},{key:"addNode",value:function(t,e,n){return this._tree.addNodes(t,e,n)}},{key:"removeNode",value:function(t,e){this._tree.removeNode(t,e)}}])&&qe(n.prototype,r),i&&qe(n,i),a}(Oe);function $e(t){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function en(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nn(t,e,n){return(nn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=an(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function rn(t,e){return!e||"object"!==$e(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function on(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sn(t,e){return(sn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ln=Fe.extend({}),un=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sn(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=an(e);if(on()){var r=an(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return rn(this,t)});function a(){return tn(this,a),o.apply(this,arguments)}return n=a,(r=[{key:"create",value:function(){return Object.assign(this.options,{el:this.buildUI()}),this._lcmp=new ln(this.options),this}},{key:"addTo",value:function(t){return nn(an(a.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}},{key:"getContainerElement",value:function(){return this._lcmp.el}},{key:"destroy",value:function(){this.mapWrapper.removeControl(this._lcmp),this.onRemove()}},{key:"onRemove",value:function(){nn(an(a.prototype),"onRemove",this).call(this)}}])&&en(n.prototype,r),i&&en(n,i),a}(Qe);function cn(t){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fn(t,e,n){return(fn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yn(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function pn(t,e){return!e||"object"!==cn(e)&&"function"!=typeof e?dn(t):e}function dn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function yn(t){return(yn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mn(t,e){return(mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _n(t){var e=[];this.push=function(n){return null!=n&&(null==t||isNaN(t)||e.length===t&&e.shift(),e.push(n),!0)},this.pop=function(){return e.shfit()},this.size=function(){return e.length},this.list=function(){return e},this.reset=function(){e.length=0}}var bn={position:"bottomright",visible:!0,closeButton:!1,hideOnClose:!0,dragable:!1,resizable:!1,header:!1,body:void 0,showTime:!0,queueSize:20,bodyStyle:{background:"transparent",padding:"5px",margin:"0",height:"150px",width:"600px",overflow:"auto",backgroundColor:"white",borderRadius:"4px"}},wn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mn(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=yn(e);if(gn()){var r=yn(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return pn(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),vn(dn(e=o.call(this,t)),"CONTROL_KEY","scrollmsg"),vn(dn(e),"events",[]),vn(dn(e),"queue",void 0),vn(dn(e),"bodyEl",void 0),e.options=Object.assign({},e.options,bn,t),e.queue=new _n(e.options.queueSize),e}return n=a,(r=[{key:"addTo",value:function(t){fn(yn(a.prototype),"addTo",this).call(this,t),t.controls[this.CONTROL_KEY]=this,this.onAdd(t)}},{key:"onAdd",value:function(t){this.update()}},{key:"bodyHook",value:function(){var t=s.create("ul","fm-scroll-msg");return this.bodyEl=t,t}},{key:"update",value:function(){var t=this;t.bodyEl.innerHTML="",t.queue.list().forEach((function(e){s.create("li","fm-scroll-msg-item",t.bodyEl).innerHTML=(t.options.showTime?"[".concat(e.time.getHours().toString().padStart(2,"0"),":").concat(e.time.getMinutes().toString().padStart(2,"0"),":").concat(e.time.getSeconds().toString().padStart(2,"0"),".").concat(e.time.getMilliseconds().toString().padStart(3,"0"),"]: "):"")+e.content})),this.bodyEl.scrollTo(0,500)}},{key:"addMsg",value:function(t){this.queue.push({time:new Date,content:t}),this.update()}}])&&hn(n.prototype,r),i&&hn(n,i),a}(Oe);function xn(t){return(xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ln(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function En(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cn(t,e,n){return(Cn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Pn(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function kn(t,e){return!e||"object"!==xn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Pn(t){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mn(t,e){return(Mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tn=r.Control.extend({initialize:function(t){return r.setOptions(this,t),r.stamp(this),this},onAdd:function(t){return this.el=this.options.el,this.setVisible(this.options.visible),this.el},setVisible:function(t){this.el.style.display=t?"block":"none",this.options.visible=t}}),On=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mn(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Pn(e);if(Sn()){var r=Pn(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return kn(this,t)});function a(){return Ln(this,a),o.apply(this,arguments)}return n=a,(r=[{key:"create",value:function(){return Object.assign(this.options,{el:this.buildUI()}),this._lcmp=new Tn(this.options),this}},{key:"addTo",value:function(t){return Cn(Pn(a.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}},{key:"getContainerElement",value:function(){return this._lcmp.el}},{key:"destroy",value:function(){this.mapWrapper.removeControl(this._lcmp),this.onRemove()}},{key:"onRemove",value:function(){Cn(Pn(a.prototype),"onRemove",this).call(this)}}])&&En(n.prototype,r),i&&En(n,i),a}(wn);function In(t){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Dn(t,e){return!e||"object"!==In(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function An(t){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jn(t,e){return(jn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bn={clickable:!1,visible:!0,isLayer:!0},zn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jn(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=An(e);if(Rn()){var r=An(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Dn(this,t)});function a(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,Object.assign({},Bn,t))}return n=a,(r=[{key:"setOpacity",value:function(t){}},{key:"setVisible",value:function(t){this.options.visible=t}},{key:"isVisible",value:function(){return this.options.visible}},{key:"setZIndex",value:function(t){}},{key:"getName",value:function(){return this.options.name}},{key:"isClickable",value:function(){return this.options.clickable}},{key:"setClickable",value:function(t){this.options.clickable=t}}])&&Nn(n.prototype,r),i&&Nn(n,i),a}(N);function Fn(t){return(Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gn(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return Un(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Un(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Un(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function qn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hn(t){return function(){var e,n=Wn(t);if(Yn()){var r=Wn(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Vn(this,e)}}function Vn(t,e){return!e||"object"!==Fn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Wn(t){return(Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xn(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zn(t,e)}function Zn(t,e){return(Zn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Kn(t,e){var n,r=Gn(Reflect.ownKeys(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;if("constructor"!==i&&"prototype"!==i){var o=Object.getOwnPropertyDescriptor(e,i);"function"==typeof o.value&&Object.defineProperty(t,i,o)}}}catch(t){r.e(t)}finally{r.f()}}var Jn=function(t){for(var e=function(t){Xn(n,t);var e=Hn(n);function n(){return qn(this,n),e.apply(this,arguments)}return n}(t),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0,a=r;o<a.length;o++){var s=a[o];Kn(e.prototype,s)}return e};function Qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $n(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var tr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),$n(this,"key",void 0),$n(this,"data",[]),$n(this,"realCount",-1),this.key=e}var e,n,r;return e=t,(n=[{key:"push",value:function(t){return this.data.push(t),this}},{key:"getData",value:function(){return this.data}},{key:"getCount",value:function(){return-1===this.realCount?this.data.length:this.realCount}}])&&Qn(e.prototype,n),r&&Qn(e,r),t}();function er(t){return(er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rr(t,e){return!e||"object"!==er(e)&&"function"!=typeof e?ir(t):e}function ir(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function or(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ar(t){return(ar=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sr(t,e){return(sr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ur={latKey:void 0,lngKey:void 0,groupKey:void 0,latIdx:1,lngIdx:0,groupIdx:2},cr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sr(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=ar(e);if(or()){var r=ar(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return rr(this,t)});function a(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),lr(ir(n=o.call(this)),"events",["refresh","filter","filtercancel"]),lr(ir(n),"filter",void 0),lr(ir(n),"filteredBounds",void 0),lr(ir(n),"crsCode",ie.CRS_CODE),lr(ir(n),"compiledCrsCode",void 0),lr(ir(n),"_matrix",{}),lr(ir(n),"matrixInterval",1e4),lr(ir(n),"gpsApproximation",1e5),lr(ir(n),"bounds",{north:-90,south:90,west:180,east:-180}),lr(ir(n),"boundsInSystemCrs",{north:-90,south:90,west:180,east:-180}),lr(ir(n),"center",{lat:0,lng:0}),n.options=Object.assign({},ur,e);var r=ir(n);return r.header=[],r.headerIdx={},r.rows=[],r.raw=[],r.sliced=1,r.groups={},r._initialData(t,e),n}return n=a,(r=[{key:"_initialData",value:function(t,e){var n,r=this;for(var i in r.raw=t,r.header=t[0],r.header)r.headerIdx[r.header[i]]=i,r.header[i]===r.options.latKey&&(r.options.latIdx=i),r.header[i]===r.options.lngKey&&(r.options.lngIdx=i),r.header[i]===r.options.groupKey&&(r.options.groupIdx=i);r.rows=t.slice(r.sliced),e&&e.crsCode&&(r.crsCode=e.crsCode),r.initialMatrix(),r.buildMatrix(r.rows),r.rows.forEach((function(t){n=r.fetchGroup(t),r.groups[n]?r.groups[n].push(t):r.groups[n]=new tr(n).push(t)}))}},{key:"toObject",value:function(t){var e={};return this.header.forEach((function(n,r){e[n]=t[r]})),e}},{key:"getHeader",value:function(){return this.header}},{key:"getRows",value:function(){return this.rows}},{key:"getSize",value:function(){return this.rows.length}},{key:"onBeforeBind",value:function(t){this._transformLatLng(this.crsCode,t.mapWrapper.mapCmp.options.crs.code);var e=ut.transform(this.bounds.south,this.bounds.west,t.mapWrapper.mapCmp.options.crs.code,ie.CRS_CODE),n=ut.transform(this.bounds.north,this.bounds.east,t.mapWrapper.mapCmp.options.crs.code,ie.CRS_CODE);this.boundsInSystemCrs={south:e.lat,west:e.lng,north:n.lat,east:n.lng}}},{key:"onBind",value:function(t){t&&t.mapWrapper.mapCmp.on("crschange",this._onCrsChanged,this)}},{key:"onUnbind",value:function(t){t.mapWrapper.mapCmp.off("crschange",this._onCrsChanged)}},{key:"_onCrsChanged",value:function(t){this._transformLatLng(this.crsCode,t.newCrs.code),this.fire("refresh")}},{key:"_transformLatLng",value:function(t,e){var n,r,i=this;if(this.rows.forEach((function(o){n=i.fetchLat(o),r=i.fetchLng(o),o.compiledLatLng=ut.transform(n,r,t,e)})),this.bounds){var o=ut.transform(this.bounds.south,this.bounds.west,t,e),a=ut.transform(this.bounds.north,this.bounds.east,t,e);this.bounds={north:a.lat,east:a.lng,south:o.lat,west:o.lng}}this.center&&(this.center=ut.transform(this.center.lat,this.center.lng,t,ie.CRS_CODE)),this.cendroid&&(this.cendroid=ut.transform(this.cendroid.lat,this.cendroid.lng,t,ie.CRS_CODE)),this.compiledCrsCode=e}},{key:"fetchLat",value:function(t){return t[this.options.latIdx]}},{key:"fetchLng",value:function(t){return t[this.options.lngIdx]}},{key:"fetchGroup",value:function(t){return t[this.options.groupIdx]}},{key:"fetch",value:function(t,e){return t[this.headerIdx[e]]}},{key:"getGroup",value:function(t){return this.groups[t]}},{key:"getGroups",value:function(){return this.groups}},{key:"getFilteredBounds",value:function(){return this.filteredBounds}},{key:"setFilter",value:function(t){if(t){var e=this;e.filter=t;var n,r,i={north:-90,south:90,west:180,east:-180};Object.values(e.getGroups()).forEach((function(t){t.realCount=0}));var o=!1;e.rows.forEach((function(t){t._filtered=e.filter(e,t),t._filtered&&(o=!0,n=e.fetchLat(t),r=e.fetchLng(t),e.getGroup(t[e.options.groupIdx]).realCount+=1,i.north=Math.max(n,i.north),i.south=Math.min(n,i.south),i.east=Math.max(r,i.east),i.west=Math.min(r,i.west))})),o&&(e.filteredBounds=i),e.fire("filter")}}},{key:"clearFilter",value:function(){this.filter=void 0,Object.values(this.getGroups()).forEach((function(t){t.realCount=-1})),this.rows.forEach((function(t){t._filtered=!0})),this.filteredBounds=void 0,this.fire("filtercancel")}},{key:"_setMatrixInterval",value:function(t){this.matrixInterval=t}},{key:"_getMatrixInterval",value:function(){return this.matrixInterval}}])&&nr(n.prototype,r),i&&nr(n,i),a}(Jn(h,{initialMatrix:function(){this._latSum=0,this._lngSum=0,this._latlngCnt=0,this.clearMatrix()},clearMatrix:function(){this._matrix={}},buildMatrix:function(t){var e=this;t.forEach((function(t){e.matrixing(t)})),e.center={lat:(e.bounds.north+e.bounds.south)/2,lng:(e.bounds.west+e.bounds.east)/2},e.cendroid={lat:this._latSum/this._latlngCnt,lng:this._lngSum/this._latlngCnt}},matrixing:function(t){var e=this,n=e._matrix,r=e.bounds,i=e.toMatrixIndex(e.fetchLat(t),e.fetchLng(t)),o=e.fetchLat(t),a=e.fetchLng(t),s=n[i];s?s.push(t):((s=[]).push(t),n[i]=s),r.north=Math.max(o,r.north),r.south=Math.min(o,r.south),r.east=Math.max(a,r.east),r.west=Math.min(a,r.west),this._latSum+=o,this._lngSum+=a,this._latlngCnt++},toMatrixIndex:function(t,e){var n=this.toTileLatLng(t,e);return n.ilat+","+n.ilng},toTileLatLng:function(t,e){var n=this.matrixInterval,r=this.gpsApproximation,i=Math.round(t*r),o=Math.round(e*r);return{ilat:(i-i%n)/n,ilng:(o-o%n)/n}},getCenter:function(){return this.center},getCendroid:function(){return this.cendroid},getBounds:function(){return this.boundsInSystemCrs},_getBoundsInMap:function(){return this.bounds},intersectionBounds:function(t,e){return t.north<e.south||t.south>e.north||t.west>e.east||t.east<e.west?null:{north:Math.min(t.north,e.north),south:Math.max(t.south,e.south),east:Math.min(t.east,e.east),west:Math.max(t.west,e.west)}},getAroundData:function(t){var e=this.intersectionBounds(this._getBoundsInMap(),t);return null===e?[]:this.getAroundMatrixTiles(e).reduce((function(t,e){return t.concat(e)}),[])},getAroundMatrixTiles:function(t){for(var e=parseInt(t.north*this.gpsApproximation/this.matrixInterval),n=parseInt(t.south*this.gpsApproximation/this.matrixInterval),r=parseInt(t.east*this.gpsApproximation/this.matrixInterval),i=[],o=parseInt(t.west*this.gpsApproximation/this.matrixInterval)-2;o<r+2;o++)for(var a=n-2;a<e+2;a++)this._matrix["".concat(a,",").concat(o)]&&i.push(this._matrix["".concat(a,",").concat(o)]);return i}}));function hr(t){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pr(t,e,n){return(pr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=mr(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function dr(t,e){return!e||"object"!==hr(e)&&"function"!=typeof e?gr(t):e}function gr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function mr(t){return(mr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vr(t,e){return(vr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var br={visible:!0,opacity:1},wr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vr(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=mr(e);if(yr()){var r=mr(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return dr(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),_r(gr(e=o.call(this,Object.assign({},br,t))),"events",["storechange","visiblechange"]),_r(gr(e),"COLOR_SETTING",{red:[255,0,0],green:[0,255,0],blue:[0,0,255],orange:[255,153,0],purple:[156,39,176],white:[255,255,255],black:[0,0,0],gray:[158,158,158],yellow:[255,255,0],brown:[165,42,42],indigo:[75,0,130],deeppink:[255,20,147],default:[158,158,158],transform:function(t){if("object"===hr(t)&&t.constructor===Array&&3===t.length)return t;if(this[t])return this[t];var e,n,r;if(0===t.indexOf("#"))e=parseInt("0x"+t.substring(1,3),16),n=parseInt("0x"+t.substring(3,5),16),r=parseInt("0x"+t.substring(5,7),16);else{if(6!==t.length)return this.default;e=parseInt("0x"+t.substring(0,2),16),n=parseInt("0x"+t.substring(2,4),16),r=parseInt("0x"+t.substring(4,6),16)}return[e,n,r]}}),e}return n=a,(r=[{key:"create",value:function(){this.buildUI()}},{key:"buildUI",value:function(){this._canvas=this.buildCanvas(),this._opCanvas=this.uiHook()}},{key:"buildCanvas",value:function(){return s.create("canvas","fm-canvas-overlay")}},{key:"uiHook",value:function(){return this.options.clickable?s.create("canvas","fm-canvas-overlay-op"):void 0}},{key:"onDraw",value:function(t){}},{key:"onOpDraw",value:function(t){}},{key:"unbindStore",value:function(){this.store.off("refresh",this.repaint,this),this.store.off("filter filtercancel",this._storeFiltered,this)}},{key:"bindStore",value:function(t){this.store&&(this.store.onUnbind(this),this.unbindStore()),t.onBeforeBind(this),this.store=t,t.on("refresh",this.repaint,this),t.on("filter filtercancel",this._storeFiltered,this),t.onBind(this)}},{key:"_storeFiltered",value:function(t){this.repaint(),this.fire("storechange",{store:this.store})}},{key:"_onStoreBind",value:function(t){this.repaint(),this.fire("storechange",{store:t})}},{key:"getStore",value:function(){return this.store}},{key:"getZoomDistance",value:function(){throw new Error("CanvasOverlay.getZoomDistance() must be implemented!")}},{key:"repaint",value:function(){throw new Error("CanvasOverlay.repaint() must be implemented!")}},{key:"opRepaint",value:function(){throw new Error("CanvasOverlay.opRepaint() must be implemented!")}},{key:"setData",value:function(t,e){this.bindStore(new cr(t,e))}},{key:"isInView",value:function(t){throw new Error("CanvasOverlay.isInView() must be implemented!")}},{key:"_getProjectionOffset",value:function(t){throw new Error("CanvasOverlay._getProjectionOffset() must be implemented!")}},{key:"latLngToPoint",value:function(t){throw new Error("CanvasOverlay.latLngToPoint() must be implemented!")}},{key:"pixelToDegrees",value:function(t){throw new Error("CanvasOverlay.pixelToDegrees() must be implemented!")}},{key:"onRemove",value:function(){pr(mr(a.prototype),"onRemove",this).call(this),this.store&&this.store.onUnbind(this)}},{key:"setOpacity",value:function(t){this._canvas.style.opacity=t,this._opCanvas&&(this._opCanvas.style.opacity=t)}},{key:"setVisible",value:function(t){this._canvas.style.display=t?"block":"none",this._opCanvas&&(this._opCanvas.style.opacity=t?"block":"none"),this.options.visible=t}},{key:"destroy",value:function(){pr(mr(a.prototype),"destroy",this).call(this)}}])&&fr(n.prototype,r),i&&fr(n,i),a}(zn);function xr(t){return(xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Er(t,e,n){return(Er="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sr(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Cr(t,e){return!e||"object"!==xr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Sr(t){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pr(t,e){return(Pr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mr={name:"",style:{color:"gray"},legends:{}},Tr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pr(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Sr(e);if(kr()){var r=Sr(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Cr(this,t)});function a(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,Object.assign({},Mr,t,{style:Object.assign({},Mr.style,t.style),legends:Object.assign({},Mr.legends,t.legends)}))}return n=a,(r=[{key:"getName",value:function(){return this.options.name}},{key:"getLegendStyle",value:function(t){return this.options.legends[t]||this.options.style}},{key:"getLegends",value:function(){return this.options.legends}},{key:"bindStore",value:function(t){Er(Sr(a.prototype),"bindStore",this).call(this,t),this._compileLegend(t)}},{key:"_compileLegend",value:function(t){var e,n=this.options,r=t.getGroups(),i=n.legends;Object.keys(r).forEach((function(t,r){(e=i[t])?(e.color=e.color||n.style.color,e.idx=r,e.opacity=void 0===e.opacity?n.opacity:e.opacity,e.visible=void 0===e.visible?n.visible:e.visible):(e={visible:n.visible,color:n.style.color,idx:r,opacity:n.opacity},i[t]=e)})),Object.keys(i).forEach((function(t){r[t]||((e=i[t]).color=e.color||n.style.color,e.idx=-1,e.opacity=void 0===e.opacity?n.opacity:e.opacity,e.visible=void 0===e.visible?n.visible:e.visible)}))}},{key:"setOpacity",value:function(t,e){void 0!==e?this.options.legends[e]?this.options.legends[e].opacity=t:console.error("legendKey[".concat(e,"] is not found")):(Object.values(this.options.legends).forEach((function(e){e.opacity=t})),this.options.opacity=t)}},{key:"setVisible",value:function(t,e){var n;if(void 0!==e)this.options.legends[e]?(n=this.options.legends[e].visible,this.options.legends[e].visible=t,t&&(this.options.visible=t,this._canvas.style.display=t?"block":"none",this._opCanvas&&(this._opCanvas.style.opacity=t?"block":"none")),n!==t&&this.fire("visiblechange",{oldValue:n,newValue:t})):console.error("legendKey[".concat(e,"] is not found"));else{var r=!1;Object.values(this.options.legends).forEach((function(e){e.visible!==t&&(r=!0),e.visible=t})),n=this.options.visible,this._canvas.style.display=t?"block":"none",this._opCanvas&&(this._opCanvas.style.opacity=t?"block":"none"),this.options.visible=t,(n!==t||r)&&this.fire("visiblechange",{oldValue:!!t,newValue:t})}}}])&&Lr(n.prototype,r),i&&Lr(n,i),a}(wr);function Or(t){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nr(t,e,n){return(Nr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jr(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Dr(t,e){return!e||"object"!==Or(e)&&"function"!=typeof e?Rr(t):e}function Rr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ar(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function jr(t){return(jr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Br(t,e){return(Br=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Fr={realResponse:!0,offsetX:0,offsetY:0,clickable:!0,clickType:1,getDrawSize:void 0},Gr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Br(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=jr(e);if(Ar()){var r=jr(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Dr(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),zr(Rr(e=o.call(this,Object.assign({},Fr,t))),"events",["itemclick","itemcancel"]),zr(Rr(e),"lastClickedData",void 0),e}return n=a,(r=[{key:"bindStore",value:function(t){Nr(jr(a.prototype),"bindStore",this).call(this,t),this._onStoreBind(t)}},{key:"onDraw",value:function(t){var e=this,n=e._canvas,r=n.getContext("2d");if(r.clearRect(0,0,n.width,n.height),e.store&&0!==e.store.getSize()&&e.options.visible){var i,o,a,s,l=t.zoom,u=e.store,c=e.options,h=e.getDrawSize(l)/2,f=c.legends;Object.keys(f).forEach((function(t){(a=f[t]).visible&&(o=e.COLOR_SETTING.transform(a.color),((s=u.getGroup(t))?s.getData():[]).forEach((function(t){!1!==t._filtered&&e.isInView(t.compiledLatLng)&&(i=e.latLngToPoint(t.compiledLatLng),e.drawCircle(r,i,h,o,a.opacity))})))}))}}},{key:"onOpDraw",value:function(t){var e=this,n=e.options,r=e.lastClickedData;if(n.visible&&!1!==n.clickable&&e._opCanvas&&r){var i,o,a,s=e._opCanvas,l=s.getContext("2d"),u=e.store,c=t.zoom,h=.75*e.getDrawSize(c),f=n.legends;l.clearRect(0,0,s.width,s.height),r.forEach((function(t){!1!==t._filtered&&(i=e.latLngToPoint(t.compiledLatLng),(o=f[u.fetchGroup(t)]).visible&&(a=e.COLOR_SETTING.transform(o.color),l.beginPath(),l.arc(i.x,i.y,h,0,2*Math.PI,!1),l.fillStyle="rgba(".concat(a[0],", ").concat(a[1],", ").concat(a[2],", 1)"),l.fill(),l.lineWidth=1,l.strokeStyle="#003300",l.stroke(),l.closePath()))}))}}},{key:"drawCircle",value:function(t,e,n,r,i,o){t.beginPath(),t.arc(e.x,e.y,n,0,2*Math.PI,!1),t.fillStyle="rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", ").concat(i,")"),t.fill(),t.closePath(),o&&t.stroke()}},{key:"getDrawSize",value:function(t){if(this.options.getDrawSize)return this.options.getDrawSize.call(this,t);var e=1;switch(t){case 14:e=t-3;break;case 15:e=t-2;break;case 16:e=t-1;break;case 17:e=t+1;break;case 18:e=t+2;break;default:e=t-4}return e=Math.max(e,1)}},{key:"setVisible",value:function(t,e){Nr(jr(a.prototype),"setVisible",this).call(this,t,e),this.repaint()}},{key:"setOpacity",value:function(t,e){Nr(jr(a.prototype),"setOpacity",this).call(this,t,e),this.repaint()}},{key:"_onItemClick",value:function(t){var e;switch(this.options.clickType){case 1:e=t;break;case 2:e=[t[0]];break;case 3:e=[t[t.length-1]]}this.lastClickedData=e,this.fire("itemclick",{data:e}),this.opRepaint()}},{key:"_onItemCancel",value:function(){var t=this.lastClickedData;this.lastClickedData=void 0,this.fire("itemcancel",{data:t}),this.clearOpCanvas()}},{key:"clearOpCanvas",value:function(){var t=this._opCanvas;t.getContext("2d").clearRect(0,0,t.width,t.height)}},{key:"selectItems",value:function(t){this._onItemClick(t)}},{key:"select",value:function(t){t<0||t>=this.store.getRows().length?console.error("index[".concat(t,"] out of bounds")):this._onItemClick([this.store.getRows()[t]])}},{key:"clearSelection",value:function(){this.lastClickedData&&this._onItemCancel()}},{key:"setOffset",value:function(t,e){this.options.offsetX=t,this.options.offsetY=e,this._updateOffset(),this.repaint()}},{key:"_updateOffset",value:function(){}},{key:"setClickable",value:function(t){Nr(jr(a.prototype),"setClickable",this).call(this,t),!1===t&&this.clearOpCanvas()}},{key:"_onMapClick",value:function(t,e){if(this.options.realResponse&&(this.options.offsetX||this.options.offsetY)){var n={x:e.x-this.options.offsetX,y:e.y-this.options.offsetY};t=this.mapWrapper.mapCmp.containerPointToLatLng(n)}var r=this.impact(t,!0);r.length>0?this._onItemClick(r):this.lastClickedData&&this._onItemCancel()}}])&&Ir(n.prototype,r),i&&Ir(n,i),a}(Jn(Tr,{isImpact:function(t,e){if(this.options.realResponse&&(this.options.offsetX||this.options.offsetY)){var n={x:e.x-this.options.offsetX,y:e.y-this.options.offsetY};t=this.mapWrapper.mapCmp.containerPointToLatLng(n)}return this.impact(t,!1).length>0},impact:function(t,e){var n=this,r=n.store,i=n.options.legends,o=[];if(!n.options.clickable||!r)return o;var a=n.getDrawSize(n.mapWrapper.getZoom())||0,s=n.pixelToDegrees(a)/2,l={north:t.lat+s,south:t.lat-s,east:t.lng+s,west:t.lng-s};return r.getAroundData(l).every((function(a){return!1===a._filtered||!(i[r.fetchGroup(a)].visible&&n.getDistance(a.compiledLatLng,t)<=s&&(o.push(a),!e))})),o},getDistance:function(t,e){return Math.sqrt(Math.pow(t.lat-e.lat,2)+Math.pow(t.lng-e.lng,2))}}));function Ur(t){return(Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hr(t,e,n){return(Hr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xr(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Vr(t,e){return!e||"object"!==Ur(e)&&"function"!=typeof e?Yr(t):e}function Yr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Xr(t){return(Xr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zr(t,e){return(Zr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Kr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Jr={realResponse:!0,offsetX:0,offsetY:0,clickable:!0,gridSize:.001,opacity:.7},Qr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zr(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Xr(e);if(Wr()){var r=Xr(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Vr(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Kr(Yr(e=o.call(this,Object.assign({},Jr,t))),"events",["itemclick","itemcancel"]),Kr(Yr(e),"lastClickedData",void 0),Kr(Yr(e),"lastClickedData",void 0),e}return n=a,(r=[{key:"bindStore",value:function(t){Hr(Xr(a.prototype),"bindStore",this).call(this,t),this._onStoreBind(t)}},{key:"onDraw",value:function(t){var e=this,n=e._canvas,r=n.getContext("2d");if(r.clearRect(0,0,n.width,n.height),e.store&&0!==e.store.getSize()&&e.options.visible){var i,o,a,s,l,u=e.store,c=e.options,h=e.options.gridSize,f=c.legends;Object.keys(f).forEach((function(t){(s=f[t]).visible&&(a=e.COLOR_SETTING.transform(s.color),((l=u.getGroup(t))?l.getData():[]).forEach((function(t){!1!==t._filtered&&e.isInView(t.compiledLatLng,h)&&(i=e.latLngToPoint(t.compiledLatLng),o=e.latLngToPoint({lat:t.compiledLatLng.lat+h,lng:t.compiledLatLng.lng+h}),e.drawRect(r,i,o,a,s.opacity))})))}))}}},{key:"onOpDraw",value:function(t){var e=this,n=e.options,r=e.lastClickedData,i=e._opCanvas,o=i.getContext("2d");if(o.clearRect(0,0,i.width,i.height),n.visible&&n.clickable&&e._opCanvas&&r){var a,s,l,u,c,h=e.store,f=e.options.gridSize,p=n.legends;r.forEach((function(t){!1!==t._filtered&&(s=t.compiledLatLng,a=e.latLngToPoint(s),l=e.latLngToPoint({lat:s.lat+f,lng:s.lng+f}),(u=p[h.fetchGroup(t)]).visible&&(c=e.COLOR_SETTING.transform(u.color),o.beginPath(),o.rect(a.x,a.y,l.x-a.x,l.y-a.y),o.fillStyle="rgba(".concat(c[0],", ").concat(c[1],", ").concat(c[2],", 1)"),o.fill(),o.lineWidth=1,o.strokeStyle="#003300",o.stroke(),o.closePath()))}))}}},{key:"drawRect",value:function(t,e,n,r,i,o){t.beginPath(),t.rect(e.x,e.y,n.x-e.x,n.y-e.y),t.fillStyle="rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", ").concat(i,")"),t.fill(),o&&t.stroke(),t.closePath()}},{key:"setVisible",value:function(t,e){Hr(Xr(a.prototype),"setVisible",this).call(this,t,e),this.repaint()}},{key:"setOpacity",value:function(t,e){Hr(Xr(a.prototype),"setOpacity",this).call(this,t,e),this.repaint()}},{key:"setOffset",value:function(t,e){this.options.offsetX=t,this.options.offsetY=e,this._updateOffset(),this.repaint()}},{key:"_updateOffset",value:function(){}},{key:"_onItemClick",value:function(t){this.lastClickedData=t,this.fire("itemclick",{data:t}),this.opRepaint()}},{key:"_onItemCancel",value:function(){var t=this.lastClickedData;this.lastClickedData=void 0,this.fire("itemcancel",{data:t}),this.clearOpCanvas()}},{key:"clearOpCanvas",value:function(){var t=this._opCanvas;t.getContext("2d").clearRect(0,0,t.width,t.height)}},{key:"selectItems",value:function(t){this._onItemClick(t)}},{key:"select",value:function(t){t<0||t>=this.store.getRows().length?console.error("index[".concat(t,"] out of bounds")):this._onItemClick([this.store.getRows()[t]])}},{key:"clearSelection",value:function(){this.lastClickedData&&this._onItemCancel()}},{key:"setClickable",value:function(t){Hr(Xr(a.prototype),"setClickable",this).call(this,t),!1===t&&this.clearOpCanvas()}},{key:"_onMapClick",value:function(t,e){if(this.options.realResponse&&(this.options.offsetX||this.options.offsetY)){var n={x:e.x-this.options.offsetX,y:e.y-this.options.offsetY};t=this.mapWrapper.mapCmp.containerPointToLatLng(n)}var r=this.impact(t,!0);r.length>0?this._onItemClick(r):this.lastClickedData&&this._onItemCancel()}}])&&qr(n.prototype,r),i&&qr(n,i),a}(Jn(Tr,{isImpact:function(t,e){if(this.options.realResponse&&(this.options.offsetX||this.options.offsetY)){var n={x:e.x-this.options.offsetX,y:e.y-this.options.offsetY};t=this.mapWrapper.mapCmp.containerPointToLatLng(n)}return this.impact(t,!1).length>0},impact:function(t,e){var n=this,r=n.store,i=n.options.gridSize,o=n.options.legends,a=[];if(!n.options.clickable||!r)return a;var s={north:t.lat,south:t.lat,east:t.lng,west:t.lng};return r.getAroundData(s).every((function(s){return!1===s._filtered||!(o[r.fetchGroup(s)].visible&&n.inGrid(s.compiledLatLng,t,i)&&(a.push(s),!e))})),a},inGrid:function(t,e,n){return t.lat<e.lat&&t.lng<e.lng&&t.lat+n>e.lat&&t.lng+n>e.lng}}));function $r(t){return($r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ti(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ei(t,e,n){return(ei="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=oi(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function ni(t,e){return!e||"object"!==$r(e)&&"function"!=typeof e?ri(t):e}function ri(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ii(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function oi(t){return(oi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ai(t,e){return(ai=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function si(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var li={debug:!1},ui=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ai(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=oi(e);if(ii()){var r=oi(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return ni(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),si(ri(e=o.call(this,Object.assign({},li,t))),"useWebGL",!0),si(ri(e),"glAttrs",{u_matLoc:void 0,colorLoc:void 0,vertLoc:void 0,aPointSize:void 0,legendIdx1Pos:void 0,legendIdx2Pos:void 0}),si(ri(e),"pixelsToWebGLMatrix",new Float32Array(16)),si(ri(e),"mapMatrix",new Float32Array(16)),si(ri(e),"vshaderPoint","\n    precision mediump float;\n    uniform mat4 u_matrix;\n    attribute vec4 a_vertex;\n    attribute float a_pointSize;\n    attribute vec4 a_color;\n    attribute float a_legendIdx;\n    attribute float a_filtered;\n    varying float v_legendIdx;\n    varying float v_filtered;\n    varying vec4 v_color;\n    void main() {\n    // Set the size of the point\n      gl_PointSize =  a_pointSize;\n    // multiply each vertex by a matrix.\n      gl_Position = u_matrix * a_vertex;\n    // pass the color to the fragment shader\n      v_color = a_color;\n      v_legendIdx = a_legendIdx;\n      v_filtered = a_filtered;\n    }"),si(ri(e),"fshaderPoint","\n    precision mediump float;\n    varying vec4 v_color;\n    varying float v_filtered;\n    \n    uniform float legendIdx0;\n    uniform float legendIdx1;\n    uniform float legendIdx2;\n    uniform float legendIdx3;\n    uniform float legendIdx4;\n    uniform float legendIdx5;\n    uniform float legendIdx6;\n    uniform float legendIdx7;\n    uniform float legendIdx8;\n    uniform float legendIdx9;\n    uniform float legendIdx10;\n    uniform float legendIdx11;\n    uniform float legendIdx12;\n    uniform float legendIdx13;\n    uniform float legendIdx14;\n    uniform float legendIdx15;\n    uniform float legendIdx16;\n    uniform float legendIdx17;\n    uniform float legendIdx18;\n    uniform float legendIdx19;\n    varying float v_legendIdx;\n\n    void main() {\n      float border = 0.05;\n      float radius = 0.5;\n      vec4 color0 = vec4(0.0, 0.0, 0.0, 0.0);\n      vec4 color1; \n      int idx = int(v_legendIdx);\n      if (idx == 0) { color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx0 * v_filtered); }\n      else if (idx == 1) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx1 * v_filtered); }\n      else if (idx == 2) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx2 * v_filtered); }\n      else if (idx == 3) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx3 * v_filtered); }\n      else if (idx == 4) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx4 * v_filtered); }\n      else if (idx == 5) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx5 * v_filtered); }\n      else if (idx == 6) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx6 * v_filtered); }\n      else if (idx == 7) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx7 * v_filtered); }\n      else if (idx == 8) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx8 * v_filtered); }\n      else if (idx == 9) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx9 * v_filtered); }\n      else if (idx == 10) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx10 * v_filtered); }\n      else if (idx == 11) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx11 * v_filtered); }\n      else if (idx == 12) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx12 * v_filtered); }\n      else if (idx == 13) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx13 * v_filtered); }\n      else if (idx == 14) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx14 * v_filtered); }\n      else if (idx == 15) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx15 * v_filtered); }\n      else if (idx == 16) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx16 * v_filtered); }\n      else if (idx == 17) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx17 * v_filtered); }\n      else if (idx == 18) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx18 * v_filtered); }\n      else if (idx == 19) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx19 * v_filtered); }\n      else { color1 = vec4(v_color[0], v_color[1], v_color[2], 1.0 * v_filtered);}\n      \n      vec2 m = gl_PointCoord.xy - vec2(0.5, 0.5);\n      float dist = radius - sqrt(m.x * m.x + m.y * m.y);\n      float t = 0.0;\n      if (dist > border)\n        t = 1.0;\n      else if (dist > 0.0)\n        t = dist / border;\n      gl_FragColor = mix(color0, color1, t);\n    }"),e}return n=a,(r=[{key:"onAdd",value:function(){return ei(oi(a.prototype),"onAdd",this).call(this),this._glCtx=this._canvas.getContext("webgl",{antialias:!0})||this._canvas.getContext("experimental-webgl",{antialias:!0}),this}},{key:"onRemove",value:function(){this.store&&this.store.off("refresh",this._compileData),this._glCtx&&this._glCtx.getExtension("WEBGL_lose_context")&&this._glCtx.getExtension("WEBGL_lose_context").loseContext(),ei(oi(a.prototype),"onRemove",this).call(this)}},{key:"bindStore",value:function(t){ei(oi(a.prototype),"bindStore",this).call(this,t),this._compileData(),t.on("refresh",this._compileData,this),this._onStoreBind(t)}},{key:"_compileData",value:function(){var t,e=this,n=e.store,r=e.options,i=[],o=e._glCtx,a=e.glAttrs,s=e._createProgram(e.vshaderPoint,e.fshaderPoint);o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.enable(o.BLEND),a.u_matLoc=o.getUniformLocation(s,"u_matrix"),a.colorLoc=o.getAttribLocation(s,"a_color"),a.vertLoc=o.getAttribLocation(s,"a_vertex"),o.aPointSize=a.aPointSize=o.getAttribLocation(s,"a_pointSize");for(var l=0;l<20;l++)a["legendIdx".concat(l)]=o.getUniformLocation(s,"legendIdx".concat(l));a.legendLoc=o.getAttribLocation(s,"a_legendIdx"),a.filterLoc=o.getAttribLocation(s,"a_filtered");var u,c,h=n.getGroups(),f=r.legends;Object.keys(h).forEach((function(n){u=f[n],c=e.COLOR_SETTING.transform(u.color),h[n].getData().forEach((function(n){t=e._getProjectionOffset({lat:n.compiledLatLng.lat,lng:n.compiledLatLng.lng}),i.push(t.x,t.y,c[0]/255,c[1]/255,c[2]/255,u.idx,!1===n._filtered?0:1)}))})),e.lastVerts=i;var p=new Float32Array(i),d=p.BYTES_PER_ELEMENT,g=7*d;o.bindBuffer(o.ARRAY_BUFFER,o.createBuffer()),o.bufferData(o.ARRAY_BUFFER,p,o.DYNAMIC_DRAW),o.vertexAttribPointer(a.vertLoc,2,o.FLOAT,!1,g,0),o.enableVertexAttribArray(a.vertLoc),o.vertexAttribPointer(a.colorLoc,3,o.FLOAT,!1,g,2*d),o.enableVertexAttribArray(a.colorLoc),o.vertexAttribPointer(a.legendLoc,1,o.FLOAT,!1,g,5*d),o.enableVertexAttribArray(a.legendLoc),o.vertexAttribPointer(a.filterLoc,1,o.FLOAT,!1,g,6*d),o.enableVertexAttribArray(a.filterLoc)}},{key:"_storeFiltered",value:function(t){var e=this,n=e.lastVerts;if(n&&n.length>0){var r=e.store.getGroups(),i=0;Object.keys(r).forEach((function(t){r[t].getData().forEach((function(t){n[7*i+6]=!1===t._filtered?0:1,i++}))}))}var o=e._glCtx,a=e.glAttrs,s=new Float32Array(n),l=s.BYTES_PER_ELEMENT,u=7*l;o.bindBuffer(o.ARRAY_BUFFER,o.createBuffer()),o.bufferData(o.ARRAY_BUFFER,s,o.DYNAMIC_DRAW),o.vertexAttribPointer(a.vertLoc,2,o.FLOAT,!1,u,0),o.enableVertexAttribArray(a.vertLoc),o.vertexAttribPointer(a.colorLoc,3,o.FLOAT,!1,u,2*l),o.enableVertexAttribArray(a.colorLoc),o.vertexAttribPointer(a.legendLoc,1,o.FLOAT,!1,u,5*l),o.enableVertexAttribArray(a.legendLoc),o.vertexAttribPointer(a.filterLoc,1,o.FLOAT,!1,u,6*l),o.enableVertexAttribArray(a.filterLoc),e.repaint(),e.fire("storechange",{store:this.store})}},{key:"onDraw",value:function(t){var e=this;if(e.store&&0!==e.store.getSize()&&e.options.visible){var n=e._glCtx,r=t.bounds,i=t.zoom,o=e._canvas,a=e.glAttrs,s=e.store,l=e.pixelsToWebGLMatrix,u=e.mapMatrix;if(null!=n){n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),l.set([2/o.width,0,0,0,0,-2/o.height,0,0,0,0,0,0,-1,1,0,1]),n.viewport(0,0,o.width,o.height),e.lastDrawSize=e.getDrawSize(i),n.vertexAttrib1f(n.aPointSize,e.lastDrawSize),u.set(l);var c={lat:r.north,lng:r.west},h=this._getProjectionOffset(c),f=Math.pow(2,i);e.scaleMatrix(u,f,f),e.translateMatrix(u,-h.x,-h.y),n.uniformMatrix4fv(a.u_matLoc,!1,u),e._deliverOpacity(),n.drawArrays(n.POINTS,0,s.getSize())}}}},{key:"translateMatrix",value:function(t,e,n){t[12]+=t[0]*e+t[4]*n,t[13]+=t[1]*e+t[5]*n,t[14]+=t[2]*e+t[6]*n,t[15]+=t[3]*e+t[7]*n}},{key:"scaleMatrix",value:function(t,e,n){t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=n,t[5]*=n,t[6]*=n,t[7]*=n}},{key:"_createProgram",value:function(t,e){var n=this._glCtx,r=n.createProgram(),i=this._createShader(n,n.VERTEX_SHADER,t),o=this._createShader(n,n.FRAGMENT_SHADER,e);if(n.attachShader(r,i),n.attachShader(r,o),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS))return n.useProgram(r),r;console.error("create WebGL program failed: ",n.getProgramInfoLog(r))}},{key:"_createShader",value:function(t,e,n){var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))return r;console.error("create WebGL shader failed: ",e,n,t.getShaderInfoLog(r))}},{key:"_deliverOpacity",value:function(){var t=this.options.legends,e=this.glAttrs,n=this._glCtx;Object.values(t).forEach((function(t){n.uniform1f(e["legendIdx".concat(t.idx)],!1===t.visible?0:t.opacity)}))}}])&&ti(n.prototype,r),i&&ti(n,i),a}(Gr);function ci(t){return(ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fi(t,e,n){return(fi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yi(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function pi(t,e){return!e||"object"!==ci(e)&&"function"!=typeof e?di(t):e}function di(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function yi(t){return(yi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mi(t,e){return(mi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vi(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _i={},bi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mi(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=yi(e);if(gi()){var r=yi(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return pi(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),vi(di(e=o.call(this,Object.assign({},_i,t))),"useWebGL",!0),vi(di(e),"glAttrs",{u_matLoc:void 0,colorLoc:void 0,vertLoc:void 0,aPointSize:void 0,legendIdx1Pos:void 0,legendIdx2Pos:void 0}),vi(di(e),"pixelsToWebGLMatrix",new Float32Array(16)),vi(di(e),"mapMatrix",new Float32Array(16)),vi(di(e),"vshaderGrid","\n    precision highp float;\n    uniform mat4 u_matrix;\n    attribute vec4 a_vertex;\n    attribute float a_pointSize;\n    attribute vec4 a_color;\n    attribute float a_filtered;\n    varying vec4 v_color;\n    attribute float a_legendIdx;\n    varying float v_legendIdx;\n    varying float v_filtered;\n    void main() {\n    // Set the size of the point\n      gl_PointSize = a_pointSize;\n    // multiply each vertex by a matrix.\n      gl_Position = u_matrix * a_vertex;\n    // pass the color to the fragment shader\n      v_color = a_color;\n      v_legendIdx = a_legendIdx;\n      v_filtered = a_filtered;\n    }"),vi(di(e),"fshaderGrid","\n    precision highp float;\n    varying vec4 v_color;\n    varying float v_filtered;\n    \n    uniform float legendIdx0;\n    uniform float legendIdx1;\n    uniform float legendIdx2;\n    uniform float legendIdx3;\n    uniform float legendIdx4;\n    uniform float legendIdx5;\n    uniform float legendIdx6;\n    uniform float legendIdx7;\n    uniform float legendIdx8;\n    uniform float legendIdx9;\n    uniform float legendIdx10;\n    uniform float legendIdx11;\n    uniform float legendIdx12;\n    uniform float legendIdx13;\n    uniform float legendIdx14;\n    uniform float legendIdx15;\n    uniform float legendIdx16;\n    uniform float legendIdx17;\n    uniform float legendIdx18;\n    uniform float legendIdx19;\n    varying float v_legendIdx;\n    void main() {\n      float border = 0.05;\n      float radius = 0.9;\n      vec4 color0 = vec4(0.0, 0.0, 0.0, 0.0);\n      vec4 color1;\n      int idx = int(v_legendIdx);\n      if (idx == 0) { color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx0 * v_filtered); }\n      else if (idx == 1) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx1 * v_filtered); }\n      else if (idx == 2) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx2 * v_filtered); }\n      else if (idx == 3) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx3 * v_filtered); }\n      else if (idx == 4) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx4 * v_filtered); }\n      else if (idx == 5) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx5 * v_filtered); }\n      else if (idx == 6) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx6 * v_filtered); }\n      else if (idx == 7) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx7 * v_filtered); }\n      else if (idx == 8) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx8 * v_filtered); }\n      else if (idx == 9) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx9 * v_filtered); }\n      else if (idx == 10) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx10 * v_filtered); }\n      else if (idx == 11) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx11 * v_filtered); }\n      else if (idx == 12) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx12 * v_filtered); }\n      else if (idx == 13) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx13 * v_filtered); }\n      else if (idx == 14) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx14 * v_filtered); }\n      else if (idx == 15) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx15 * v_filtered); }\n      else if (idx == 16) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx16 * v_filtered); }\n      else if (idx == 17) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx17 * v_filtered); }\n      else if (idx == 18) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx18 * v_filtered); }\n      else if (idx == 19) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx19 * v_filtered); }\n      else { color1 = vec4(v_color[0], v_color[1], v_color[2], 1.0 * v_filtered);}\n      vec2 m = gl_PointCoord.xy - vec2(0.5, 0.5);\n      float dist = radius - sqrt(m.x * m.x + m.y * m.y);\n      float t = 0.0;\n      if (dist > border)\n        t = 1.0;\n      else if (dist > 0.0)\n        t = dist / border;\n      gl_FragColor = mix(color0, color1, t);\n    }"),e}return n=a,(r=[{key:"onAdd",value:function(){fi(yi(a.prototype),"onAdd",this).call(this);var t=this;return t._glCtx=t._canvas.getContext("experimental-webgl",{antialias:!0})||t._canvas.getContext("webgl",{antialias:!0}),t.setOpacity(t.options.opacity),this}},{key:"onRemove",value:function(){this.store&&this.store.off("refresh",this._compileData),this._glCtx&&this._glCtx.getExtension("WEBGL_lose_context")&&this._glCtx.getExtension("WEBGL_lose_context").loseContext(),fi(yi(a.prototype),"onRemove",this).call(this)}},{key:"bindStore",value:function(t){fi(yi(a.prototype),"bindStore",this).call(this,t),this._compileData(),t.on("refresh",this._compileData,this),this._onStoreBind(t)}},{key:"_compileData",value:function(){var t,e=this,n=e.store,r=e.options,i=[],o=e._glCtx,a=e.glAttrs,s=e._canvas,l=e._createProgram(e.vshaderGrid,e.fshaderGrid);o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.enable(o.BLEND),a.u_matLoc=o.getUniformLocation(l,"u_matrix"),a.colorLoc=o.getAttribLocation(l,"a_color"),a.vertLoc=o.getAttribLocation(l,"a_vertex"),o.aPointSize=a.aPointSize=o.getAttribLocation(l,"a_pointSize");for(var u=0;u<20;u++)a["legendIdx".concat(u)]=o.getUniformLocation(l,"legendIdx".concat(u));a.legendLoc=o.getAttribLocation(l,"a_legendIdx"),a.filterLoc=o.getAttribLocation(l,"a_filtered"),e.pixelsToWebGLMatrix.set([2/s.width,0,0,0,0,-2/s.height,0,0,0,0,0,0,-1,1,0,1]),o.viewport(0,0,s.width,s.height),o.uniformMatrix4fv(a.u_matLoc,!1,e.pixelsToWebGLMatrix);var c,h,f=e.options.gridSize,p=n.getGroups(),d=r.legends;Object.keys(p).forEach((function(n){c=d[n],h=e.COLOR_SETTING.transform(c.color),p[n].getData().forEach((function(n){t=e._getProjectionOffset({lat:n.compiledLatLng.lat/f*f+f/2,lng:n.compiledLatLng.lng/f*f+f/2}),i.push(t.x,t.y,h[0]/255,h[1]/255,h[2]/255,c.idx,!1===n._filtered?0:1)}))})),e.lastVerts=i;var g=new Float32Array(i),y=g.BYTES_PER_ELEMENT,m=7*y;o.bindBuffer(o.ARRAY_BUFFER,o.createBuffer()),o.bufferData(o.ARRAY_BUFFER,g,o.DYNAMIC_DRAW),o.vertexAttribPointer(a.vertLoc,2,o.FLOAT,!1,m,0),o.enableVertexAttribArray(a.vertLoc),o.vertexAttribPointer(a.colorLoc,3,o.FLOAT,!1,m,2*y),o.enableVertexAttribArray(a.colorLoc),o.vertexAttribPointer(a.legendLoc,1,o.FLOAT,!1,m,5*y),o.enableVertexAttribArray(a.legendLoc),o.vertexAttribPointer(a.filterLoc,1,o.FLOAT,!1,m,6*y),o.enableVertexAttribArray(a.filterLoc)}},{key:"_storeFiltered",value:function(t){var e=this,n=e.lastVerts;if(n&&n.length>0){var r=e.store.getGroups(),i=0;Object.keys(r).forEach((function(t){r[t].getData().forEach((function(t){n[7*i+6]=!1===t._filtered?0:1,i++}))}))}var o=e._glCtx,a=e.glAttrs,s=new Float32Array(n),l=s.BYTES_PER_ELEMENT,u=7*l;o.bindBuffer(o.ARRAY_BUFFER,o.createBuffer()),o.bufferData(o.ARRAY_BUFFER,s,o.DYNAMIC_DRAW),o.vertexAttribPointer(a.vertLoc,2,o.FLOAT,!1,u,0),o.enableVertexAttribArray(a.vertLoc),o.vertexAttribPointer(a.colorLoc,3,o.FLOAT,!1,u,2*l),o.enableVertexAttribArray(a.colorLoc),o.vertexAttribPointer(a.legendLoc,1,o.FLOAT,!1,u,5*l),o.enableVertexAttribArray(a.legendLoc),o.vertexAttribPointer(a.filterLoc,1,o.FLOAT,!1,u,6*l),o.enableVertexAttribArray(a.filterLoc),e.repaint(),e.fire("storechange",{store:this.store})}},{key:"_getDrawSize",value:function(t){var e=this.store.getCenter(),n=Math.pow(2,t);return Math.max(1,Math.ceil((this._getProjectionOffset({lat:e.lat,lng:e.lng+this.options.gridSize}).x-this._getProjectionOffset(e).x)*n-(t>16?3:t>10?2:1)))}},{key:"onDraw",value:function(t){var e=this;if(e.store&&0!==e.store.getSize()){var n=e._glCtx,r=t.bounds,i=t.zoom,o=e._canvas,a=e.glAttrs,s=e.store,l=e.pixelsToWebGLMatrix,u=e.mapMatrix;if(null!=n){n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),l.set([2/o.width,0,0,0,0,-2/o.height,0,0,0,0,0,0,-1,1,0,1]),n.viewport(0,0,o.width,o.height),n.vertexAttrib1f(n.aPointSize,e._getDrawSize(i)),u.set(l);var c={lat:r.north,lng:r.west},h=this._getProjectionOffset(c),f=Math.pow(2,i);e.scaleMatrix(u,f,f),e.translateMatrix(u,-h.x,-h.y),n.uniformMatrix4fv(a.u_matLoc,!1,u),e._deliverOpacity(),n.drawArrays(n.POINTS,0,s.getSize())}}}},{key:"translateMatrix",value:function(t,e,n){t[12]+=t[0]*e+t[4]*n,t[13]+=t[1]*e+t[5]*n,t[14]+=t[2]*e+t[6]*n,t[15]+=t[3]*e+t[7]*n}},{key:"scaleMatrix",value:function(t,e,n){t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=n,t[5]*=n,t[6]*=n,t[7]*=n}},{key:"_createProgram",value:function(t,e){var n=this._glCtx,r=n.createProgram(),i=this._createShader(n,n.VERTEX_SHADER,t),o=this._createShader(n,n.FRAGMENT_SHADER,e);if(n.attachShader(r,i),n.attachShader(r,o),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS))return n.useProgram(r),r;console.error("create WebGL program failed: ",n.getProgramInfoLog(r))}},{key:"_createShader",value:function(t,e,n){var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))return r;console.error("create WebGL shader failed: ",e,n,t.getShaderInfoLog(r))}},{key:"_deliverOpacity",value:function(){var t=this.options.legends,e=this.glAttrs,n=this._glCtx;Object.values(t).forEach((function(t){n.uniform1f(e["legendIdx".concat(t.idx)],!1===t.visible?0:t.opacity)}))}}])&&hi(n.prototype,r),i&&hi(n,i),a}(Qr),wi=n(1);function xi(t){return(xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Li(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ei(t,e){return!e||"object"!==xi(e)&&"function"!=typeof e?Ci(t):e}function Ci(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ki(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Si(t){return(Si=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pi(t,e){return(Pi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mi(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ti={geojsonKey:"linestring",geojsonIdx:5},Oi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pi(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Si(e);if(ki()){var r=Si(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Ei(this,t)});function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Mi(Ci(n=o.call(this,t,Object.assign({},Ti,e))),"events",["refresh"]),Mi(Ci(n),"matrixInterval",1e3),n._setMatrixInterval(1e3),n}return n=a,(r=[{key:"_initialData",value:function(t,e){this.fixedLatIdx=1,this.fixedLngIdx=0,this.fixedGroupIdx=2,this.fixedRawIdx=3;var n=this;for(var r in n.raw=t,n.header=t[0],n.header)n.headerIdx[n.header[r]]=r,n.header[r]===n.options.geojsonKey&&(n.options.geojsonIdx=r),n.header[r]===n.options.groupKey&&(n.options.groupIdx=r);var i,o,a,s,l=t.slice(n.sliced);n.rows=[];var u,c={};l.forEach((function(t,e){for(i=t[n.options.geojsonIdx],o=i.coordinates,s=t[n.options.groupIdx],a=0;a<o.length-1;a++)n.rows.push([o[a][0],o[a][1],s,e]),n.rows.push([o[a+1][0],o[a+1][1],s,e]);c[s]?c[s]++:c[s]=1,t._turfData=wi.lineString(o)})),n.rawRows=l,e&&e.crsCode&&(n.crsCode=e.crsCode),n.matrixInterval=1e3,n.initialMatrix(),n.buildMatrix(n.rows),n.rows.forEach((function(t){u=n.fetchGroup(t),n.groups[u]?n.groups[u].push(t):(n.groups[u]=new tr(u).push(t),n.groups[u].realCount=c[u])}))}},{key:"fetchLat",value:function(t){return t[this.fixedLatIdx]}},{key:"fetchLng",value:function(t){return t[this.fixedLngIdx]}},{key:"fetchRaw",value:function(t){return this.rawRows[t[this.fixedRawIdx]]}},{key:"fetchGroup",value:function(t){return t[this.fixedGroupIdx]}},{key:"fetchRawGroup",value:function(t){return t[this.options.groupIdx]}},{key:"getFilteredBounds",value:function(){return this.filteredBounds}},{key:"setFilter",value:function(t){if(t){var e=this;e.filter=t;var n,r={north:-90,south:90,west:180,east:-180};Object.values(e.getGroups()).forEach((function(t){t.realCount=0}));var i=!1;e.rawRows.forEach((function(t){t._filtered=e.filter(e,t),t._filtered&&(i=!0,e.getGroup(t[e.options.groupIdx]).realCount+=1,n=wi.bbox(t._turfData),r.north=Math.max(n[3],r.north),r.south=Math.min(n[1],r.south),r.east=Math.max(n[2],r.east),r.west=Math.min(n[0],r.west))})),i&&(e.filteredBounds=r),e.fire("filter")}}},{key:"clearFilter",value:function(){var t=this;t.filter=void 0,Object.values(t.getGroups()).forEach((function(t){t.realCount=0})),t.rawRows.forEach((function(e){e._filtered=!0,t.getGroup(e[t.options.groupIdx]).realCount+=1})),this.filteredBounds=void 0,t.fire("filtercancel")}}])&&Li(n.prototype,r),i&&Li(n,i),a}(cr),Ii=[0,10,8,6,4,2,.8,.4,.2,.1,.085,.07,.06,.05,.035,.02,.01,.006,.004,.004,.004];function Ni(t){return(Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Di(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ri(t,e,n){return(Ri="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zi(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Ai(t,e){return!e||"object"!==Ni(e)&&"function"!=typeof e?ji(t):e}function ji(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function zi(t){return(zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fi(t,e){return(Fi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gi(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ui={clickable:!0,clickType:1,highlightWidth:5},qi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fi(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=zi(e);if(Bi()){var r=zi(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Ai(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Gi(ji(e=o.call(this,Object.assign({},Ui,t))),"events",["itemclick","itemcancel"]),Gi(ji(e),"useWebGL",!0),Gi(ji(e),"glAttrs",{u_matLoc:void 0,colorLoc:void 0,vertLoc:void 0,aPointSize:void 0,legendIdx1Pos:void 0,legendIdx2Pos:void 0}),Gi(ji(e),"pixelsToWebGLMatrix",new Float32Array(16)),Gi(ji(e),"mapMatrix",new Float32Array(16)),Gi(ji(e),"vshaderPoint","\n    precision mediump float;\n    uniform mat4 u_matrix;\n    attribute vec4 a_vertex;\n    attribute float a_pointSize;\n    attribute vec4 a_color;\n    attribute float a_filtered;\n    attribute float a_legendIdx;\n    varying float v_legendIdx;\n    varying float v_filtered;\n    varying vec4 v_color;\n    void main() {\n    // Set the size of the point\n      gl_PointSize =  a_pointSize;\n    // multiply each vertex by a matrix.\n      gl_Position = u_matrix * a_vertex;\n    // pass the color to the fragment shader\n      v_color = a_color;\n      v_legendIdx = a_legendIdx;\n      v_filtered = a_filtered;\n    }"),Gi(ji(e),"fshaderPoint","\n    precision mediump float;\n    varying vec4 v_color;\n    varying float v_filtered;\n    \n    uniform float legendIdx0;\n    uniform float legendIdx1;\n    uniform float legendIdx2;\n    uniform float legendIdx3;\n    uniform float legendIdx4;\n    uniform float legendIdx5;\n    uniform float legendIdx6;\n    uniform float legendIdx7;\n    uniform float legendIdx8;\n    uniform float legendIdx9;\n    uniform float legendIdx10;\n    uniform float legendIdx11;\n    uniform float legendIdx12;\n    uniform float legendIdx13;\n    uniform float legendIdx14;\n    uniform float legendIdx15;\n    uniform float legendIdx16;\n    uniform float legendIdx17;\n    uniform float legendIdx18;\n    uniform float legendIdx19;\n    varying float v_legendIdx;\n\n    void main() {\n      float border = 0.05;\n      float radius = 0.5;\n      vec4 color0 = vec4(0.0, 0.0, 0.0, 0.0);\n      vec4 color1; \n      int idx = int(v_legendIdx);\n      if (idx == 0) { color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx0 * v_filtered); }\n      else if (idx == 1) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx1 * v_filtered); }\n      else if (idx == 2) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx2 * v_filtered); }\n      else if (idx == 3) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx3 * v_filtered); }\n      else if (idx == 4) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx4 * v_filtered); }\n      else if (idx == 5) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx5 * v_filtered); }\n      else if (idx == 6) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx6 * v_filtered); }\n      else if (idx == 7) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx7 * v_filtered); }\n      else if (idx == 8) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx8 * v_filtered); }\n      else if (idx == 9) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx9 * v_filtered); }\n      else if (idx == 10) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx10 * v_filtered); }\n      else if (idx == 11) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx11 * v_filtered); }\n      else if (idx == 12) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx12 * v_filtered); }\n      else if (idx == 13) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx13 * v_filtered); }\n      else if (idx == 14) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx14 * v_filtered); }\n      else if (idx == 15) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx15 * v_filtered); }\n      else if (idx == 16) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx16 * v_filtered); }\n      else if (idx == 17) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx17 * v_filtered); }\n      else if (idx == 18) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx18 * v_filtered); }\n      else if (idx == 19) {  color1 = vec4(v_color[0], v_color[1], v_color[2], legendIdx19 * v_filtered); }\n      else { color1 = vec4(v_color[0], v_color[1], v_color[2], 1.0 * v_filtered);}\n      \n      vec2 m = gl_PointCoord.xy - vec2(0.5, 0.5);\n      float dist = radius - sqrt(m.x * m.x + m.y * m.y);\n      float t = 0.0;\n      if (dist > border)\n        t = 1.0;\n      else if (dist > 0.0)\n        t = dist / border;\n      gl_FragColor = mix(color0, color1, t);\n    }"),e}return n=a,(r=[{key:"onAdd",value:function(){return Ri(zi(a.prototype),"onAdd",this).call(this),this._glCtx=this._canvas.getContext("experimental-webgl",{antialias:!0})||this._canvas.getContext("webgl",{antialias:!0}),this}},{key:"onRemove",value:function(){this.store&&this.store.off("refresh",this._compileData),this._glCtx&&this._glCtx.getExtension("WEBGL_lose_context")&&this._glCtx.getExtension("WEBGL_lose_context").loseContext(),Ri(zi(a.prototype),"onRemove",this).call(this)}},{key:"bindStore",value:function(t){if(t.constructor!==Oi)return console.error("LineStringStore support only!");Ri(zi(a.prototype),"bindStore",this).call(this,t),this._compileData(),t.on("refresh",this._compileData,this),this._onStoreBind(t)}},{key:"_compileData",value:function(){var t,e=this,n=e.store,r=e.options,i=[],o=e._glCtx,a=e.glAttrs,s=e._canvas,l=e._createProgram(e.vshaderPoint,e.fshaderPoint);o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.enable(o.BLEND),a.u_matLoc=o.getUniformLocation(l,"u_matrix"),a.colorLoc=o.getAttribLocation(l,"a_color"),a.vertLoc=o.getAttribLocation(l,"a_vertex"),o.aPointSize=a.aPointSize=o.getAttribLocation(l,"a_pointSize");for(var u=0;u<20;u++)a["legendIdx".concat(u)]=o.getUniformLocation(l,"legendIdx".concat(u));a.legendLoc=o.getAttribLocation(l,"a_legendIdx"),a.filterLoc=o.getAttribLocation(l,"a_filtered"),e.pixelsToWebGLMatrix.set([2/s.width,0,0,0,0,-2/s.height,0,0,0,0,0,0,-1,1,0,1]),o.viewport(0,0,s.width,s.height),o.uniformMatrix4fv(a.u_matLoc,!1,e.pixelsToWebGLMatrix);var c,h,f,p=n.getGroups(),d=r.legends;Object.keys(p).forEach((function(r,o){c=d[r],h=e.COLOR_SETTING.transform(c.color),p[r].getData().forEach((function(r){t=e._getProjectionOffset({lat:r.compiledLatLng.lat,lng:r.compiledLatLng.lng}),f=n.fetchRaw(r),i.push(t.x,t.y,h[0]/255,h[1]/255,h[2]/255,c.idx,!1===f._filtered?0:1)}))})),e.lastVerts=i;var g=new Float32Array(i),y=g.BYTES_PER_ELEMENT,m=7*y;o.bindBuffer(o.ARRAY_BUFFER,o.createBuffer()),o.bufferData(o.ARRAY_BUFFER,g,o.DYNAMIC_DRAW),o.vertexAttribPointer(a.vertLoc,2,o.FLOAT,!1,m,0),o.enableVertexAttribArray(a.vertLoc),o.vertexAttribPointer(a.colorLoc,3,o.FLOAT,!1,m,2*y),o.enableVertexAttribArray(a.colorLoc),o.vertexAttribPointer(a.legendLoc,1,o.FLOAT,!1,m,5*y),o.enableVertexAttribArray(a.legendLoc),o.vertexAttribPointer(a.filterLoc,1,o.FLOAT,!1,m,6*y),o.enableVertexAttribArray(a.filterLoc)}},{key:"_storeFiltered",value:function(t){var e=this,n=e.lastVerts;if(n&&n.length>0){var r,i=e.store,o=i.getGroups(),a=0;Object.keys(o).forEach((function(t){o[t].getData().forEach((function(t){r=i.fetchRaw(t),n[7*a+6]=!1===r._filtered?0:1,a++}))}))}var s=e._glCtx,l=e.glAttrs,u=new Float32Array(n),c=u.BYTES_PER_ELEMENT,h=7*c;s.bindBuffer(s.ARRAY_BUFFER,s.createBuffer()),s.bufferData(s.ARRAY_BUFFER,u,s.DYNAMIC_DRAW),s.vertexAttribPointer(l.vertLoc,2,s.FLOAT,!1,h,0),s.enableVertexAttribArray(l.vertLoc),s.vertexAttribPointer(l.colorLoc,3,s.FLOAT,!1,h,2*c),s.enableVertexAttribArray(l.colorLoc),s.vertexAttribPointer(l.legendLoc,1,s.FLOAT,!1,h,5*c),s.enableVertexAttribArray(l.legendLoc),s.vertexAttribPointer(l.filterLoc,1,s.FLOAT,!1,h,6*c),s.enableVertexAttribArray(l.filterLoc),e.repaint(),e.fire("storechange",{store:this.store})}},{key:"onOpDraw",value:function(t){var e=this,n=e.options,r=e.lastClickedData;if(n.visible&&n.clickable&&e._opCanvas&&r){var i,o,a,s,l=e._opCanvas,u=l.getContext("2d"),c=e.store,h=n.legends;u.clearRect(0,0,l.width,l.height),u.lineWidth=e.options.highlightWidth,e.lastClickedData.forEach((function(t){!1!==t._filtered&&(a=h[c.fetchRawGroup(t)]).visible&&(s=e.COLOR_SETTING.transform(a.color),i=wi.getCoords(t._turfData),u.beginPath(),i.forEach((function(t,n){o=e.latLngToPoint(ut.transform(t[1],t[0],c.crsCode,e.mapWrapper.getCrsCode())),0===n?u.moveTo(o.x,o.y):u.lineTo(o.x,o.y)})),u.strokeStyle="rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 1)"),u.stroke(),u.closePath())}))}}},{key:"setClickable",value:function(t){Ri(zi(a.prototype),"setClickable",this).call(this,t),!1===t&&this.clearOpCanvas()}},{key:"setVisible",value:function(t,e){Ri(zi(a.prototype),"setVisible",this).call(this,t,e),this.repaint()}},{key:"setOpacity",value:function(t,e){Ri(zi(a.prototype),"setOpacity",this).call(this,t,e),this.repaint()}},{key:"onDraw",value:function(t){var e=this;if(e.store&&0!==e.store.getSize()&&e.options.visible){var n=e._glCtx,r=t.bounds,i=t.zoom,o=e._canvas,a=e.glAttrs,s=e.store,l=e.pixelsToWebGLMatrix,u=e.mapMatrix;if(null!=n){n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),l.set([2/o.width,0,0,0,0,-2/o.height,0,0,0,0,0,0,-1,1,0,1]),n.viewport(0,0,o.width,o.height),u.set(l);var c={lat:r.north,lng:r.west},h=this._getProjectionOffset(c),f=Math.pow(2,i);e.scaleMatrix(u,f,f),e.translateMatrix(u,-h.x,-h.y),n.uniformMatrix4fv(a.u_matLoc,!1,u),e._deliverOpacity(),n.drawArrays(n.LINES,0,s.getSize())}}}},{key:"translateMatrix",value:function(t,e,n){t[12]+=t[0]*e+t[4]*n,t[13]+=t[1]*e+t[5]*n,t[14]+=t[2]*e+t[6]*n,t[15]+=t[3]*e+t[7]*n}},{key:"scaleMatrix",value:function(t,e,n){t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=n,t[5]*=n,t[6]*=n,t[7]*=n}},{key:"_createProgram",value:function(t,e){var n=this._glCtx,r=n.createProgram(),i=this._createShader(n,n.VERTEX_SHADER,t),o=this._createShader(n,n.FRAGMENT_SHADER,e);if(n.attachShader(r,i),n.attachShader(r,o),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS))return n.useProgram(r),r;console.error("create WebGL program failed: ",n.getProgramInfoLog(r))}},{key:"_createShader",value:function(t,e,n){var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))return r;console.error("create WebGL shader failed: ",e,n,t.getShaderInfoLog(r))}},{key:"_deliverOpacity",value:function(){var t=this.options.legends,e=this.glAttrs,n=this._glCtx;Object.values(t).forEach((function(t){n.uniform1f(e["legendIdx".concat(t.idx)],!1===t.visible?0:t.opacity)}))}},{key:"setData",value:function(t,e){var n=new Oi(t,e);this.bindStore(n)}},{key:"_onItemClick",value:function(t){var e;switch(this.options.clickType){case 1:e=t;break;case 2:e=[t[0]];break;case 3:e=[t[t.length-1]]}this.lastClickedData=e,this.fire("itemclick",{data:e}),this.opRepaint()}},{key:"_onItemCancel",value:function(){var t=this.lastClickedData;this.lastClickedData=void 0,this.fire("itemcancel",{data:t}),this.clearOpCanvas()}},{key:"clearOpCanvas",value:function(){var t=this._opCanvas;t.getContext("2d").clearRect(0,0,t.width,t.height)}},{key:"_onMapClick",value:function(t){var e=this.impact(t,!0);e.length>0?this._onItemClick(e):this.lastClickedData&&this._onItemCancel()}},{key:"renderGeoJSON",value:function(t){}}])&&Di(n.prototype,r),i&&Di(n,i),a}(Jn(Tr,{isImpact:function(t){return this.impact(t,!1).length>0},impact:function(t,e){var n=this,r=n.store,i=n.options.legends,o=[];if(!n.options.clickable||!r)return o;var a,s=Date.now(),l={north:t.lat,south:t.lat,east:t.lng,west:t.lng},u=r.getAroundData(l),c=ut.transform(t.lat,t.lng,n.mapWrapper.getCrsCode(),r.crsCode),h=wi.point([c.lng,c.lat]),f=n.mapWrapper.getZoom(),p=Ii[f],d=new Set;u.forEach((function(t){i[r.fetchGroup(t)].visible&&(a=r.fetchRaw(t),d.add(a))}));var g=d.values();for(a=g.next().value;a&&(!1===a._filtered||!n._isValidPointToLine(a,h,p,s)||(o.push(a),e));)a=g.next().value;return o},_isValidPointToLine:function(t,e,n,r){return t._lastStamp!==r&&(t._lastStamp=r,wi.pointToLineDistance(e,t._turfData)<=n)}}));function Hi(t){return(Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yi(t,e,n){return(Yi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ki(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Wi(t,e){return!e||"object"!==Hi(e)&&"function"!=typeof e?Xi(t):e}function Xi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ki(t){return(Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ji(t,e){return(Ji=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qi(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var $i=[1,.75,.5,.25,.1,.05,.025,.01,.01,.01,.01,.01,.01,.01,.01,.001,.001,.001,.001,.001],to=[100,100,80,60,40,20,12,8,4,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],eo={name:"",clickable:!0,clickType:1,opacity:.7,drawLabel:!0,labelOffset:0,labelFontSize:12,labelFields:[],labelSeparator:",",labelLevelToMax:1,directionKey:"direction",radius:50,fill:"red",sectorDegrees:45,circleRadius:30,circleFill:"indigo",opScale:1.25,skippedThreshold:5e3},no=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ji(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Ki(e);if(Zi()){var r=Ki(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Wi(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Qi(Xi(e=o.call(this,Object.assign({},eo,t))),"drawStamp",0),Qi(Xi(e),"drawStart",0),Qi(Xi(e),"drawStep",2e3),Qi(Xi(e),"partialDrawing",!1),Qi(Xi(e),"lastClickedData",void 0),Qi(Xi(e),"lastDrawSkipped",!1),Qi(Xi(e),"events",["itemclick","itemcancel"]),e}return n=a,(r=[{key:"shouldSkipDraw",value:function(){return!(this.options.visible&&this.mapWrapper&&this.store)}},{key:"onOpDraw",value:function(t){var e=this,n=e.options,r=e.lastClickedData;if(n.visible&&e._opCanvas&&r){var i=e.mapWrapper.mapEl.getBoundingClientRect(),o=e._opCanvas.getContext("2d");o.clearRect(0,0,i.width,i.height);var a,s,l,u,c=$i[e.getZoomDistance()],h=n.radius*c*n.opScale,f=n.circleRadius*c*n.opScale,p=e.store;o.font="bold ".concat(this.options.labelFontSize*this.options.opScale,"px Arial");for(var d=0;d<r.length;d++)!1!==(a=r[d])._filtered&&e.isInView(a.compiledLatLng)&&(s=e.latLngToPoint(a.compiledLatLng),0===(u=p.fetch(a,n.directionKey))?(e.drawCircle(o,s,f,e.COLOR_SETTING.transform(n.circleFill),1,!0),l=f):(e.drawSector(o,s,h,u,n.sectorDegrees,e.COLOR_SETTING.transform(n.fill),1,!0),l=h),e.shouldDrawLabel()&&e.drawLabel(o,s,l,u,a))}}},{key:"onDraw",value:function(t){var e=this,n=e._canvas,r=t.bounds,i=e.mapWrapper.mapEl.getBoundingClientRect(),o=n.getContext("2d");if(o.clearRect(0,0,i.width,i.height),e.shouldSkipDraw())this.lastDrawSkipped=!0;else{var a,s,l,u,c=e.store,h=e.options,f=$i[e.getZoomDistance()],p=h.radius*f,d=h.circleRadius*f;e.drawStamp=Date.now();for(var g=e.drawStamp,y=c.getAroundData(r),m=[],v=0;v<y.length;v++)!1!==y[v]._filtered&&e.isInView(y[v].compiledLatLng)&&m.push(y[v]);var _=e.shouldDrawLabel();o.font="".concat(this.options.labelFontSize,"px Arial");var b=m.length>this.options.skippedThreshold?to[t.zoom]:1;if(m.length<2e3){for(var w=0;w<m.length;w++)a=m[w],s=e.latLngToPoint(a.compiledLatLng),0===(u=c.fetch(a,h.directionKey))?(e.drawCircle(o,s,d,e.COLOR_SETTING.transform(h.circleFill),e.options.opacity),l=d):(e.drawSector(o,s,p,u,h.sectorDegrees,e.COLOR_SETTING.transform(h.fill),e.options.opacity),l=p),_&&(!e.lastClickedData||e.lastClickedData.indexOf(a)<0)&&e.drawLabel(o,s,l,u,a);e.lastDrawSkipped=!1}else e.partialDrawing=!0,setTimeout((function t(){if(e.drawStamp===g){for(var n=Math.min(m.length,e.drawStart+e.drawStep),r=e.drawStart;r<n;r+=b)a=m[r],s=e.latLngToPoint(a.compiledLatLng),0===(u=c.fetch(a,h.directionKey))?(e.drawCircle(o,s,d,e.COLOR_SETTING.transform(h.circleFill),1),l=d):(e.drawSector(o,s,p,c.fetch(a,h.directionKey),h.sectorDegrees,e.COLOR_SETTING.transform(h.fill),1),l=p),_&&(!e.lastClickedData||e.lastClickedData.indexOf(a)<0)&&e.drawLabel(o,s,l,u,a);e.drawStart=n,e.drawStamp===g&&e.drawStart<m.length?setTimeout(t,0):(e.drawStart=0,e.partialDrawing=!1,e.lastDrawSkipped=!1)}else o.clearRect(0,0,i.width,i.height)}),0)}}},{key:"getDrawText",value:function(t){var e=this.store;return this.options.labelFields.map((function(n){return e.fetch(t,n)})).join(this.options.labelSeparator)}},{key:"shouldDrawLabel",value:function(){return this.options.drawLabel&&this.mapWrapper.getZoomDistanceToMax()<=this.options.labelLevelToMax&&this.options.labelFields&&this.options.labelFields.length>0}},{key:"drawLabel",value:function(t,e,n,r,i){var o=this.options,a=this.getDrawText(i),s=r<340&&r>200,l=n+o.labelOffset+o.labelFontSize/2;e.y=e.y-Math.cos(r*Math.PI/180)*l,e.x=e.x+Math.sin(r*Math.PI/180)*l,s&&(e.x=e.x-t.measureText(a).width),t.fillText(a,e.x,e.y)}},{key:"drawSector",value:function(t,e,n,r,i,o,a,s){t.beginPath(),t.translate(e.x,e.y),t.moveTo(0,0),t.arc(0,0,n,Math.PI*(r-i/2-90)/180,Math.PI*(r+i/2-90)/180,!1),t.fillStyle="rgba(".concat(o[0],", ").concat(o[1],", ").concat(o[2],", ").concat(a,")"),t.fill(),t.translate(-e.x,-e.y),t.closePath(),s&&t.stroke()}},{key:"drawCircle",value:function(t,e,n,r,i,o){t.beginPath(),t.arc(e.x,e.y,n,0,2*Math.PI,!1),t.fillStyle="rgba(".concat(r[0],", ").concat(r[1],", ").concat(r[2],", ").concat(i,")"),t.fill(),t.closePath(),o&&t.stroke()}},{key:"bindStore",value:function(t){Yi(Ki(a.prototype),"bindStore",this).call(this,t),this._onStoreBind(t)}},{key:"isImpact",value:function(t,e){return!!this.options.visible&&this.impact(t,e,!1).length>0}},{key:"impact",value:function(t,e,n){var r=this,i=r.store,o=r.options,a=[];if(!r.options.clickable||!i||!r.options.visible)return a;var s=$i[r.getZoomDistance()],l=r.options.radius*s,u=r.options.circleRadius*s,c=r.pixelToDegrees(l),h={north:t.lat+c,south:t.lat-c,east:t.lng+c,west:t.lng-c},f=i.getAroundData(h);if(l<2)f.every((function(e){return!1===e._filtered||!(r.getDistance(e.compiledLatLng,t)<=c&&(a.push(e),!n))}));else{var p,d=r._opCanvas.getContext("2d");f.every((function(t){return!1===t._filtered||(p=r.latLngToPoint(t.compiledLatLng),0===i.fetch(t,o.directionKey)?r.drawCircle(d,p,u,[0,0,0],0):r.drawSector(d,p,l,i.fetch(t,o.directionKey),o.sectorDegrees,[0,0,0],0),!(d.isPointInPath(e.x,e.y)&&(a.push(t),!n)))}))}return a}},{key:"getDistance",value:function(t,e){return Math.sqrt(Math.pow(t.lat-e.lat,2)+Math.pow(t.lng-e.lng,2))}},{key:"_onItemClick",value:function(t){var e,n=this;switch(n.options.clickType){case 1:e=t;break;case 2:e=[t[0]];break;case 3:e=[t[t.length-1]]}n.lastClickedData=e,n.fire("itemclick",{data:e}),n.shouldDrawLabel()?n.repaint():n.opRepaint()}},{key:"_onItemCancel",value:function(){var t=this,e=t.lastClickedData;t.lastClickedData=void 0,t.fire("itemcancel",{data:e}),t.shouldDrawLabel()?(t.repaint(),t.clearOpCanvas()):t.clearOpCanvas()}},{key:"clearOpCanvas",value:function(){var t=this._opCanvas;t.getContext("2d").clearRect(0,0,t.width,t.height)}},{key:"selectItems",value:function(t){this._onItemClick(t)}},{key:"select",value:function(t){t<0||t>=this.store.getRows().length?console.error("index[".concat(t,"] out of bounds")):this._onItemClick([this.store.getRows()[t]])}},{key:"clearSelection",value:function(){this.lastClickedData&&this._onItemCancel()}},{key:"_onMapClick",value:function(t,e){var n=this.impact(t,e,!0);n.length>0?this._onItemClick(n):this.lastClickedData&&this._onItemCancel()}},{key:"setVisible",value:function(t){Yi(Ki(a.prototype),"setVisible",this).call(this,t),t&&this.lastDrawSkipped&&this.repaint()}}])&&Vi(n.prototype,r),i&&Vi(n,i),a}(wr);function ro(t){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function io(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oo(t,e,n){return(oo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=uo(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function ao(t,e){return!e||"object"!==ro(e)&&"function"!=typeof e?so(t):e}function so(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function uo(t){return(uo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function co(t,e){return(co=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ho={width:2,color:"red",dashed:!1,dashStyle:[15,5]},fo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&co(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=uo(e);if(lo()){var r=uo(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return ao(this,t)});function a(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this,Object.assign({},ho,t)),n=so(e),i=!1,(r="_clickSupport")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e}return n=a,(r=[{key:"uiHook",value:function(){}},{key:"bindStore",value:function(t){oo(uo(a.prototype),"bindStore",this).call(this,t),this._onStoreBind(t)}},{key:"onDraw",value:function(){var t=this,e=t._canvas,n=e.getContext("2d");if(n.clearRect(0,0,e.width,e.height),t.store&&0!==t.store.getSize()&&t.options.visible){var r,i,o,a,s=t.store,l=t.options,u=s.getRows(),c=t.COLOR_SETTING.transform(l.color);n.beginPath(),n.lineWidth=l.lineWidth,n.strokeStyle="rgb(".concat(c[0],", ").concat(c[1],", ").concat(c[2],")"),l.dashed&&n.setLineDash(l.dashStyle);for(var h=0;h<u.length;h+=2)r=u[h],i=u[h+1],(t.isInView(r.compiledLatLng)||t.isInView(i.compiledLatLng))&&(o=t.latLngToPoint(r.compiledLatLng),a=t.latLngToPoint(i.compiledLatLng),n.moveTo(o.x,o.y),n.lineTo(a.x,a.y));n.stroke(),n.closePath()}}},{key:"setClickable",value:function(t){console.error("[clickable] not supported by link overlay!")}}])&&io(n.prototype,r),i&&io(n,i),a}(wr);function po(t){return(po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function go(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yo(t,e,n){return(yo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=bo(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function mo(t,e){return!e||"object"!==po(e)&&"function"!=typeof e?vo(t):e}function vo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function bo(t){return(bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wo(t,e){return(wo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xo(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Lo={iconWidth:16,iconHeight:16,highlightScale:1.5,defaultIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAG1SURBVHjapFO9SwNxDP39HfYoiGjx6xCKUOjS5UCKInSwIDi41KWLLlZFW0QHqYN2sd5ycFAEEQrFpeDsIhx0KUJBBRFEcBFc3nH3HFL7E+rgxxASXsIjeUkURo0bDBs+YkaIESP4kX3WTkQeFGIGEI3yTzZiBMqfjAR/JhiLdAnKZcLziGaTsCxJzs8T9TrhOEQiIZhlEbYt2Nxcl2B7LQTAnj0+Eskk8famsdtbwjSJ52eNvb8Ts6lAwbWFYGeHeHqS5NaW+PNzot2WeGVFvOcRFxcSl9ZDTXB2RlQqhOsSu7tS4DjE9bXExaL4TofI5aRuKRMov5DXIzQaxNAQsbHRT5DLSduAYFNTX0R0XT3b1RWxudlPkMkQ+byua7eJ5GSgfGs6QDpNVKs6eXz8PUE0Sqyu6k4O90IF5yTsCddqScK2+wkKBd3+0ZHENSdU/kFRCJpNvYX9/W5BTW9hcVH83Z0IDhCnlVD5M4kAr6+6fc/rv4NOhxgclHv4egcL6a6I8biovLxMjI/LrNkscXkpO0+lBDNNolQSvbJZ2QLG/vELMSNUMAfuey/6S/PNgZePAQAoNvQp5xrHJQAAAABJRU5ErkJggg=="},Eo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wo(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=bo(e);if(_o()){var r=bo(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return mo(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),xo(vo(e=o.call(this,Object.assign({},Lo,t))),"lastClickedData",void 0),xo(vo(e),"imageCheckFlag",{}),xo(vo(e),"ready",!1),e}return n=a,(r=[{key:"_checkReady",value:function(){this.ready=!Object.values(this.imageCheckFlag).some((function(t){return!1===t})),this.ready&&this.repaint()}},{key:"bindStore",value:function(t){yo(bo(a.prototype),"bindStore",this).call(this,t);var e=this;e._onStoreBind(t);var n,r=e.options.legends,i=e.imageCheckFlag,o=e.options;Object.keys(r).forEach((function(t){n=r[t],i[t]=!1,n.icon=n.icon||o.defaultIcon,n.iconImg=s.create("img"),n.iconImg.src=n.icon,n.iconImg.legendKey=t,n.iconImg.onload=function(){e._onImageLoad(this)},n.iconImg.onerror=function(){e._onImageError(this)}}))}},{key:"_onImageLoad",value:function(t){this.imageCheckFlag[t.legendKey]=!0,this._checkReady()}},{key:"_onImageError",value:function(t){console.error("".concat(t.src," not found!")),t.src=this.options.defaultIcon}},{key:"onDraw",value:function(t){var e=this,n=e._canvas,r=n.getContext("2d");if(r.clearRect(0,0,n.width,n.height),this.ready&&e.store&&0!==e.store.getSize()&&e.options.visible){var i,o,a,s=e.store,l=e.options,u=l.legends;Object.keys(u).forEach((function(t){(o=u[t]).visible&&((a=s.getGroup(t))?a.getData():[]).forEach((function(t){e.isInView(t.compiledLatLng)&&!1!==t._filtered&&(i=e.latLngToPoint(t.compiledLatLng),e.drawImage(r,o.iconImg,i,l.iconWidth,l.iconHeight,o.opacity))}))}))}}},{key:"onOpDraw",value:function(t){var e=this,n=e.options,r=e.lastClickedData,i=e._opCanvas,o=i.getContext("2d");if(o.clearRect(0,0,i.width,i.height),n.visible&&e._opCanvas&&r){var a,s,l=e.store,u=n.legends;r.forEach((function(t){!1!==t._filtered&&(a=e.latLngToPoint(t.compiledLatLng),(s=u[l.fetchGroup(t)]).visible&&e.drawImage(o,s.iconImg,a,n.iconWidth*n.highlightScale,n.iconHeight*n.highlightScale,s.opacity))}))}}},{key:"getDrawSize",value:function(){return this.options.iconWidth}},{key:"drawImage",value:function(t,e,n,r,i,o){t.globalAlpha=o,t.drawImage(e,n.x-r/2,n.y-i/2,r,i)}},{key:"setVisible",value:function(t,e){yo(bo(a.prototype),"setVisible",this).call(this,t,e),this.repaint()}},{key:"setOpacity",value:function(t,e){yo(bo(a.prototype),"setOpacity",this).call(this,t,e),this.repaint()}},{key:"_onItemClick",value:function(t){var e;switch(this.options.clickType){case 1:e=t;break;case 2:e=[t[0]];break;case 3:e=[t[t.length-1]]}this.lastClickedData=e,this.fire("itemclick",{data:e}),this.opRepaint()}},{key:"_onItemCancel",value:function(){var t=this.lastClickedData;this.lastClickedData=void 0,this.fire("itemcancel",{data:t}),this.clearOpCanvas()}},{key:"clearOpCanvas",value:function(){var t=this._opCanvas;t.getContext("2d").clearRect(0,0,t.width,t.height)}},{key:"_onMapClick",value:function(t){var e=this.impact(t,!0);e.length>0?this._onItemClick(e):this.lastClickedData&&this._onItemCancel()}}])&&go(n.prototype,r),i&&go(n,i),a}(Gr);function Co(t){return(Co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ko(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function So(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Po(t,e,n){return e&&So(t.prototype,e),n&&So(t,n),t}function Mo(t,e,n){return(Mo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=No(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function To(t){return function(){var e,n=No(t);if(Io()){var r=No(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Oo(this,e)}}function Oo(t,e){return!e||"object"!==Co(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Io(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function No(t){return(No=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Do(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ro(t,e)}function Ro(t,e){return(Ro=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ao=r.Class.extend({initialize:function(t){return r.setOptions(this,t),this._canvas=t._canvas,this._opCanvas=t._opCanvas,r.stamp(this),t.callback&&(this._scope=t.callback.scope||this,this.onDraw=t.callback.onDraw,this.onOpDraw=t.callback.onOpDraw),this},addTo:function(t){this._map=t;var e=t.getSize();return this._canvas.width=e.x,this._canvas.height=e.y,this.options.offsetX&&(this._canvas.style.left=this.options.offsetX+"px"),this.options.offsetY&&(this._canvas.style.top=this.options.offsetY+"px"),t._panes.overlayPane.appendChild(this._canvas),this._opCanvas&&(this._opCanvas.width=e.x,this._opCanvas.height=e.y,this.options.offsetX&&(this._opCanvas.style.left=this.options.offsetX+"px"),this.options.offsetY&&(this._opCanvas.style.top=this.options.offsetY+"px"),t._panes.overlayPane.appendChild(this._opCanvas)),this.onAdd(t),this._map.on("unload",this.remove,this),this},setZIndex:function(t){this._canvas.style.zIndex=t,this._opCanvas&&(this._opCanvas.style.zIndex=t)},setOffset:function(t,e){void 0!==t&&(this._canvas.style.left=t+"px"),void 0!==e&&(this._canvas.style.top=e+"px"),this._opCanvas&&(void 0!==t&&(this._opCanvas.style.left=t+"px"),void 0!==e&&(this._opCanvas.style.top=e+"px"))},remove:function(){var t=this._map;t._panes.overlayPane.removeChild(this._canvas),this._opCanvas&&t._panes.overlayPane.removeChild(this._opCanvas),t.off("moveend",this._reset,this),t.off("resize",this._resize,this),t.off("unload",this.remove,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},onAdd:function(t){this._initStyle(),this.setVisible(this.options.visible),t.on("moveend",this._reset,this),t.on("resize",this._resize,this),t.options.zoomAnimation&&r.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},_initStyle:function(){},setVisible:function(t){this._canvas.style.display=t?"block":"none",this._opCanvas&&(this._opCanvas.style.display=t?"block":"none"),this.options.visible=t},_resize:function(t){this._canvas.width=t.newSize.x,this._canvas.height=t.newSize.y,this._opCanvas&&(this._opCanvas.width=t.newSize.x,this._opCanvas.height=t.newSize.y)},_reset:function(){this.mapBounds=this._map.getBounds();var t=this._map.containerPointToLayerPoint([0,0]);r.DomUtil.setPosition(this._canvas,t),this._opCanvas&&r.DomUtil.setPosition(this._opCanvas,t),this._redraw()},isLatLngInView:function(t,e){if(!this.mapBounds)return!1;var n=this.mapBounds;return e&&(n=r.latLngBounds(n.getSouthWest(),n.getNorthEast())).extend({lat:n.getSouthWest().lat-e,lng:n.getSouthWest().lng-e}).extend({lat:n.getNorthEast().lat+e,lng:n.getNorthEast().lng+e}),n.contains(t)},_redraw:function(){var t=this._map.getSize(),e=this._map.getBounds(),n=180*t.x/(20037508.34*(e.getEast()-e.getWest())),r=this._map.getZoom(),i={north:e.getNorth(),south:e.getSouth(),west:e.getWest(),east:e.getEast()};this.onDraw&&this.onDraw.call(this._scope,{canvas:this._canvas,bounds:i,size:t,zoomScale:n,zoom:r}),this.onOpDraw&&this.onOpDraw.call(this._scope,{canvas:this._opCanvas,bounds:i,size:t,zoomScale:n,zoom:r}),this._frame=null},_rawRepaint:function(){var t=this._map.getSize(),e=this._map.getBounds(),n=180*t.x/(20037508.34*(e.getEast()-e.getWest())),r=this._map.getZoom(),i={north:e.getNorth(),south:e.getSouth(),west:e.getWest(),east:e.getEast()};this.onDraw&&this.onDraw.call(this._scope,{canvas:this._canvas,bounds:i,size:t,zoomScale:n,zoom:r})},_opRedraw:function(){var t=this._map.getSize(),e=this._map.getBounds(),n=180*t.x/(20037508.34*(e.getEast()-e.getWest())),r=this._map.getZoom(),i={north:e.getNorth(),south:e.getSouth(),west:e.getWest(),east:e.getEast()};this.onOpDraw&&this.onOpDraw.call(this._scope,{canvas:this._opCanvas,bounds:i,size:t,zoomScale:n,zoom:r}),this._frame=null},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._getCenterOffset(t.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());r.DomUtil.setTransform(this._canvas,n,e),this._opCanvas&&r.DomUtil.setTransform(this._opCanvas,n,e)},_latLngToPixelXY:function(t,e){var n=Math.PI/180,r=4*Math.PI,i=Math.sin(t*n);return{x:(e+180)/360*256,y:256*(.5-Math.log((1+i)/(1-i))/r)}},_getProjectionOffset:function(t){return"BD09"===this._map.options.crs.code?this._map.project(t,0):this._latLngToPixelXY(t.lat,t.lng)},getZoomDistance:function(){return this._map.getMaxZoom()-this._map.getZoom()}}),jo={setZIndex:function(t){this._lcmp.setZIndex(t)},_updateOffset:function(){this._lcmp.setOffset(this.options.offsetX,this.options.offsetY)},_create:function(){var t=this;return Object.assign(this.options,{_canvas:t._canvas,_opCanvas:t._opCanvas,callback:{onDraw:t.onDraw,onOpDraw:t.onOpDraw,scope:t}}),t._lcmp=new Ao(t.options),t},repaint:function(){this._lcmp._redraw()},rawRepaint:function(){this._lcmp._redraw()},opRepaint:function(){this._lcmp._opRedraw()},isInView:function(t,e){return this._lcmp.isLatLngInView(t,e)},getZoomDistance:function(){return this._lcmp.getZoomDistance()},latLngToPoint:function(t){return this.mapWrapper.mapCmp.latLngToContainerPoint(t)},pixelToDegrees:function(t){if(!t)return 0;var e=this.mapWrapper.mapCmp,n=e.getSize(),r={x:n.x/2,y:n.y/2},i=e.containerPointToLatLng(r);return e.containerPointToLatLng({x:r.x+t,y:r.y}).lng-i.lng},_addTo:function(t){return this._lcmp.addTo(t.mapCmp),this},getContainerElement:function(){return this._lcmp.el},_getProjectionOffset:function(t){return this._lcmp._getProjectionOffset(t)}},Bo=(Jn(wr,jo),function(t){Do(n,t);var e=To(n);function n(){return ko(this,n),e.apply(this,arguments)}return Po(n,[{key:"create",value:function(){return Mo(No(n.prototype),"create",this).call(this),this._create()}},{key:"destroy",value:function(){Mo(No(n.prototype),"destroy",this).call(this),this._lcmp.remove(),this.mapWrapper.mapCmp.removeLayer(this._lcmp)}},{key:"addTo",value:function(t){return Mo(No(n.prototype),"addTo",this).call(this,t),this._addTo(t)}}]),n}(Jn(Gr,jo))),zo=function(t){Do(n,t);var e=To(n);function n(){return ko(this,n),e.apply(this,arguments)}return Po(n,[{key:"create",value:function(){return Mo(No(n.prototype),"create",this).call(this),this._create()}},{key:"destroy",value:function(){Mo(No(n.prototype),"destroy",this).call(this),this._lcmp.remove(),this.mapWrapper.mapCmp.removeLayer(this._lcmp)}},{key:"addTo",value:function(t){return Mo(No(n.prototype),"addTo",this).call(this,t),this._addTo(t)}}]),n}(Jn(ui,jo)),Fo=function(t){Do(n,t);var e=To(n);function n(){return ko(this,n),e.apply(this,arguments)}return Po(n,[{key:"create",value:function(){return Mo(No(n.prototype),"create",this).call(this),this._create()}},{key:"destroy",value:function(){Mo(No(n.prototype),"destroy",this).call(this),this._lcmp.remove(),this.mapWrapper.mapCmp.removeLayer(this._lcmp)}},{key:"addTo",value:function(t){return Mo(No(n.prototype),"addTo",this).call(this,t),this._addTo(t)}}]),n}(Jn(Qr,jo)),Go=function(t){Do(n,t);var e=To(n);function n(){return ko(this,n),e.apply(this,arguments)}return Po(n,[{key:"create",value:function(){return Mo(No(n.prototype),"create",this).call(this),this._create()}},{key:"destroy",value:function(){Mo(No(n.prototype),"destroy",this).call(this),this._lcmp.remove(),this.mapWrapper.mapCmp.removeLayer(this._lcmp)}},{key:"addTo",value:function(t){return Mo(No(n.prototype),"addTo",this).call(this,t),this._addTo(t)}}]),n}(Jn(bi,jo)),Uo=function(t){Do(n,t);var e=To(n);function n(){return ko(this,n),e.apply(this,arguments)}return Po(n,[{key:"create",value:function(){return Mo(No(n.prototype),"create",this).call(this),this._create()}},{key:"destroy",value:function(){Mo(No(n.prototype),"destroy",this).call(this),this._lcmp.remove(),this.mapWrapper.mapCmp.removeLayer(this._lcmp)}},{key:"addTo",value:function(t){return Mo(No(n.prototype),"addTo",this).call(this,t),this._addTo(t)}}]),n}(Jn(no,jo)),qo=function(t){Do(n,t);var e=To(n);function n(){return ko(this,n),e.apply(this,arguments)}return Po(n,[{key:"create",value:function(){return Mo(No(n.prototype),"create",this).call(this),this._create()}},{key:"destroy",value:function(){Mo(No(n.prototype),"destroy",this).call(this),this._lcmp.remove(),this.mapWrapper.mapCmp.removeLayer(this._lcmp)}},{key:"addTo",value:function(t){return Mo(No(n.prototype),"addTo",this).call(this,t),this._addTo(t)}}]),n}(Jn(fo,jo)),Ho=function(t){Do(n,t);var e=To(n);function n(){return ko(this,n),e.apply(this,arguments)}return Po(n,[{key:"create",value:function(){return Mo(No(n.prototype),"create",this).call(this),this._create()}},{key:"destroy",value:function(){Mo(No(n.prototype),"destroy",this).call(this),this._lcmp.remove(),this.mapWrapper.mapCmp.removeLayer(this._lcmp)}},{key:"addTo",value:function(t){return Mo(No(n.prototype),"addTo",this).call(this,t),this._addTo(t)}}]),n}(Jn(Eo,jo)),Vo=(Jn(qi,jo),function(t){Do(n,t);var e=To(n);function n(){return ko(this,n),e.apply(this,arguments)}return Po(n,[{key:"create",value:function(){return Mo(No(n.prototype),"create",this).call(this),this._create()}},{key:"renderGeoJSON",value:function(t){r.geoJSON(t).addTo(this.mapWrapper.mapCmp)}},{key:"destroy",value:function(){Mo(No(n.prototype),"destroy",this).call(this),this._lcmp.remove(),this.mapWrapper.mapCmp.removeLayer(this._lcmp)}},{key:"addTo",value:function(t){return Mo(No(n.prototype),"addTo",this).call(this,t),this._addTo(t)}}]),n}(Jn(qi,jo)));n(36),n(264);function Yo(t){return(Yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xo(t,e,n){return(Xo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qo(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Zo(t,e){return!e||"object"!==Yo(e)&&"function"!=typeof e?Ko(t):e}function Ko(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Qo(t){return(Qo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $o(t,e){return($o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ta(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ea={header:{iconCls:"fm-icon-measure",title:locales.toolbar.measure},position:"topright"},na=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$o(t,e)}(l,t);var e,n,r,i,a=(e=l,function(){var t,n=Qo(e);if(Jo()){var r=Qo(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Zo(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),ta(Ko(e=a.call(this,Object.assign({},ea,t))),"events",["startmeasure","endmeasure"]),ta(Ko(e),"CONTROL_KEY","measure"),e}return n=l,(r=[{key:"addTo",value:function(t){Xo(Qo(l.prototype),"addTo",this).call(this,t),t.controls[this.CONTROL_KEY]=this,this.onAdd(t),this.on("startmeasure",(function(e){t.controls.draw&&t.controls.draw.disableDraw()}),this)}},{key:"bodyHook",value:function(){var t=this,e=t.bodyEl=s.create("div","fm-measure"),n=s.create("button","fm-common-button fm-common-button--primary fm-common-button--mini",e);s.create("span",void 0,n).innerHTML=locales.measure.length,o.on(n,"click",t._onLengthBtnClick,t);var r=s.create("button","fm-common-button fm-common-button--primary fm-common-button--mini",e);s.create("span",void 0,r).innerHTML=locales.measure.area,o.on(r,"click",t._onAreaBtnClick,t);var i=s.create("button","fm-common-button fm-common-button--danger fm-common-button--mini",e);return s.create("span",void 0,i).innerHTML=locales.measure.clear,o.on(i,"click",t._onCleanBtnClick,t),e}},{key:"onRemove",value:function(){delete this.mapWrapper.controls[this.CONTROL_KEY],Xo(Qo(l.prototype),"onRemove",this).call(this)}},{key:"disableMeasure",value:function(){}}])&&Wo(n.prototype,r),i&&Wo(n,i),l}(Oe);function ra(t){return(ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ia(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function aa(t,e,n){return(aa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ua(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function sa(t,e){return!e||"object"!==ra(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function la(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ua(t){return(ua=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ca(t,e){return(ca=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.assign(L.drawLocal,{draw:{handlers:{polygon:{tooltip:{start:locales.measure.polygon.tooltip.start,cont:locales.measure.polygon.tooltip.cont,end:locales.measure.polygon.tooltip.end}},polyline:{error:locales.measure.polyline.error,tooltip:{start:locales.measure.polyline.tooltip.start,cont:locales.measure.polyline.tooltip.cont,end:locales.measure.polyline.tooltip.end}}}}});var ha=Fe.extend({onAdd:function(t){var e=this;return Fe.prototype.onAdd.call(e,t),e.measureItems=new L.FeatureGroup,e._tempTips=[],e._tipsLayerGroup=new L.FeatureGroup,t.addLayer(e.measureItems),t.addLayer(e._tipsLayerGroup),e._polylineDrawer=new L.Draw.Polyline(t,{shapeOptions:{color:"#1890ff",weight:2,opacity:1}}),e._polygonDrawer=new L.Draw.Polygon(t,{allowIntersection:!1,showArea:!0,metric:["km","m"],shapeOptions:{color:"#1890ff",weight:2,opacity:1,fillColor:"#1890ff",fillOpacity:.3}}),e._bindEvent(),e.el},onRemove:function(t){Fe.prototype.onRemove.call(this,t),this.measureItems.remove(),this._tipsLayerGroup.remove(),this._unbindEvent()},_bindEvent:function(){var t=this;t._map.on(L.Draw.Event.DRAWVERTEX,t._onDrawVertex,t).on(L.Draw.Event.CREATED,t._onDrawCreated,t).on("crschange",t._transformCoords,t)},_unbindEvent:function(){var t=this;t._map.off(L.Draw.Event.DRAWVERTEX,t._onDrawVertex,t).off(L.Draw.Event.CREATED,t._onDrawCreated,t).off("crschange",t._transformCoords,t)},_onDrawVertex:function(t){var e=this;if("measure"===e._map._ld_apply_to&&e.currentDrawer&&"polyline"===e.currentDrawer.type){var n=t.layers.getLayers();if(n.length>0){var r=n[n.length-1],i=r.getLatLng(),o=e._createTooltip(i);if(1===n.length)o._icon.innerHTML='<div class="fm-measure-tooltip-total">'+locales.measure.start+"</div>";else if(2===n.length)o._icon.innerHTML='<div class="fm-measure-tooltip-total">'+e._getTotoalDistanceText(n.map((function(t){return t.getLatLng()})))+"</div>";else{var a=n[n.length-2],s='<div class="fm-measure-tooltip-total">'+e._getTotoalDistanceText(n.map((function(t){return t.getLatLng()})))+"</div>";s+='<div class="fm-measure-tooltip-difference">'+e._getDistanceDiffText(a.getLatLng(),r.getLatLng())+"</div>",o._icon.innerHTML=s}e._tempTips.push(o)}}},_onDrawCreated:function(t){var e=this;if("measure"===e._map._ld_apply_to){var n=t.layer;if(e.measureItems.addLayer(n),n.layerType=t.layerType,"polyline"!==n.layerType){var r=n.getCenter(),i=e._createTooltip(r),o=n._defaultShape?n._defaultShape():n.getLatLngs(),a=L.GeometryUtil.geodesicArea(o);i._icon.innerHTML='<div class="fm-measure-tooltip-total">'+e._getReadableArea(a)+"</div>",e._tempTips.push(i)}else{var s=e._tempTips[e._tempTips.length-1],l=n.getLatLngs();if(l.length<2)return;var u=l[l.length-2],c=l[l.length-1],h='<div class="fm-measure-tooltip-total">'+locales.measure.total+": "+e._getTotoalDistanceText(n.getLatLngs())+"</div>";l.length>2&&(h+='<div class="fm-measure-tooltip-difference">'+e._getDistanceDiffText(u,c)+"</div>"),s._icon.innerHTML=h}n._tips=e._tempTips,e._tempTips=[],e._wrapper.fire("endmeasure")}},_getTotoalDistanceText:function(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].distanceTo(t[n+1]);return this._getReadableLength(e)},_onZoomEnd:function(t){this.measureItems.eachLayer((function(t){(t._tips||[]).forEach((function(t){t.updatePosition(t._latLng)}))})),this._tempTips.forEach((function(t){t.updatePosition(t._latLng)}))},_getDistanceDiffText:function(t,e){var n=t.distanceTo(e);return"(+".concat(this._getReadableLength(n),")")},_getReadableLength:function(t){return t<1e3?Math.round(t)+" "+locales.measure.meter:(t/1e3).toFixed(2)+" "+locales.measure.kilometer},_getReadableArea:function(t){return t<1e5?Math.round(t)+" "+locales.measure.sqmeter:(t/1e6).toFixed(2)+" "+locales.measure.sqkilometer},_transformCoords:function(t){this.measureItems.eachLayer((function(e){var n,r=e.layerType,i=e.getLatLngs();(e._tips||[]).forEach((function(e){var n=e.getLatLng(),r=ut.transform(n.lat,n.lng,t.oldCrs.code,t.newCrs.code);e.setLatLng(r)})),n="polyline"===r?i.map((function(e){return ut.transform(e.lat,e.lng,t.oldCrs.code,t.newCrs.code)})):i.map((function(e){return e.map((function(e){return ut.transform(e.lat,e.lng,t.oldCrs.code,t.newCrs.code)}))})),e.setLatLngs(n),e.redraw()}))},_createTooltip:function(t){var e=L.divIcon({className:"fm-measure-tooltip",iconAnchor:[-5,-5]});return L.marker(t,{icon:e,clickable:!1}).addTo(this._tipsLayerGroup)}}),fa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ca(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=ua(e);if(la()){var r=ua(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return sa(this,t)});function a(){return ia(this,a),o.apply(this,arguments)}return n=a,(r=[{key:"create",value:function(){var t=this;return Object.assign(this.options,{el:t.buildUI()}),t._lcmp=new ha(t.options),t._lcmp._wrapper=t,t.on("hide",t._onHide,t).on("startmeasure",t._onStartMeasure,t).on("endmeasure",t._onEndMeasure,t),t}},{key:"addTo",value:function(t){return aa(ua(a.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}},{key:"getContainerElement",value:function(){return this._lcmp.el}},{key:"onRemove",value:function(){this.disableMeasure(),this.mapWrapper.removeControl(this._lcmp),aa(ua(a.prototype),"onRemove",this).call(this)}},{key:"_onLengthBtnClick",value:function(){var t=this._lcmp;t.currentDrawer=t._polylineDrawer,t._polylineDrawer.enable(),t._polygonDrawer.disable(),this.fire("startmeasure")}},{key:"_onAreaBtnClick",value:function(){var t=this._lcmp;t.currentDrawer=t._polygonDrawer,t._polylineDrawer.disable(),t._polygonDrawer.enable(),this.fire("startmeasure")}},{key:"_onCleanBtnClick",value:function(){var t=this._lcmp;t.currentDrawer&&t.currentDrawer.disable(),t.measureItems.eachLayer((function(t){(t._tips||[]).forEach((function(t){t.remove()})),t.remove()})),t._tempTips.forEach((function(t){t.remove()}))}},{key:"_onStartMeasure",value:function(t){this.mapWrapper.mapCmp._ld_apply_to="measure"}},{key:"_onEndMeasure",value:function(t){delete this.mapWrapper.mapCmp._ld_apply_to}},{key:"_onHide",value:function(t){this.disableMeasure(),this._lcmp.measureItems.clearLayers(),this._lcmp._tipsLayerGroup.clearLayers()}},{key:"disableMeasure",value:function(){aa(ua(a.prototype),"disableMeasure",this).call(this);var t=this._lcmp,e=this.mapWrapper.mapCmp;"measure"===e._ld_apply_to&&delete e._ld_apply_to,t.currentDrawer&&(t.currentDrawer.disable(),t._tempTips.forEach((function(t){t.remove()})))}}])&&oa(n.prototype,r),i&&oa(n,i),a}(na);function pa(t){return(pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ga(t,e,n){return(ga="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_a(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function ya(t,e){return!e||"object"!==pa(e)&&"function"!=typeof e?ma(t):e}function ma(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function va(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _a(t){return(_a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ba(t,e){return(ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wa={position:"topleft",visible:!0,prompt:locales.locate.prompt,closeButton:!1,hideOnClose:!0,dragable:!1,header:!1,body:void 0,vertical:"10px",bodyStyle:{background:"transparent",padding:"0"}},xa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ba(t,e)}(l,t);var e,n,r,i,a=(e=l,function(){var t,n=_a(e);if(va()){var r=_a(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return ya(this,t)});function l(t){var e,n,r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),e=a.call(this,Object.assign({},wa,t)),n=ma(e),i="locate",(r="CONTROL_KEY")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i;var o=ma(e);return o.on("hide",(function(t){o._cleanSearchBox()}),o),e}return n=l,(r=[{key:"addTo",value:function(t){ga(_a(l.prototype),"addTo",this).call(this,t),t.controls[this.CONTROL_KEY]=this,this.onAdd(t)}},{key:"bodyHook",value:function(){var t=this,e=t.bodyEl=s.create("div","fm-locate"),n=s.create("div",void 0,e),r=s.create("input","fm-locate-input",n);r.placeholder=t.options.prompt,o.on(r,"keypress",t._onSearchInputKeyPress,t),o.on(r,"keyup",t._onSearchInputKeyUp,t);var i=s.create("button","fm-locate-delete-btn",n);i.title=locales.locate.clear,o.on(i,"click",t._onDeleteBtnClick,t);var a=s.create("div","fm-locate-search",e),l=s.create("button","fm-locate-search-btn",a);return l.title=locales.locate.search,o.on(l,"click",t._onSearchBtnClick,t),e}},{key:"_onSearchBtnClick",value:function(t){var e=this._getInputEl();e&&this.search(e.value.trim())}},{key:"_onDeleteBtnClick",value:function(t){this.clear(),this._getDeleteButtonEl().style.display="none"}},{key:"_onSearchInputKeyPress",value:function(t){this._getInputEl().value.trim()&&13===t.keyCode&&this._getSearchButtonEl().click()}},{key:"_onSearchInputKeyUp",value:function(t){var e=this._getInputEl().value.trim(),n=this._getDeleteButtonEl();n.style.display=e?"block":"none"}},{key:"_getInputEl",value:function(){return this.bodyEl.getElementsByClassName("fm-locate-input")[0]}},{key:"_getSearchButtonEl",value:function(){return this.bodyEl.getElementsByClassName("fm-locate-search-btn")[0]}},{key:"_getDeleteButtonEl",value:function(){return this.bodyEl.getElementsByClassName("fm-locate-delete-btn")[0]}},{key:"_isCoordinate",value:function(t){if(t&&t.match(/^[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?),\s*[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?)$/)){var e=t.split(",");return{lat:parseFloat(e[1].trim()),lng:parseFloat(e[0].trim())}}}},{key:"_cleanSearchBox",value:function(){this._getInputEl().value=""}},{key:"_cleanLocatedItem",value:function(){}},{key:"search",value:function(t){}},{key:"clear",value:function(){this._getDeleteButtonEl().style.display="none",this._cleanSearchBox(),this._cleanLocatedItem()}},{key:"onRemove",value:function(){delete this.mapWrapper.controls[this.CONTROL_KEY],ga(_a(l.prototype),"onRemove",this).call(this)}}])&&da(n.prototype,r),i&&da(n,i),l}(Oe),La=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Ea=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return La(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}};var Ca=Ea(La);Ca.right,Ca.left;var ka=Array.prototype;ka.slice,ka.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);Array.prototype.slice;var Sa={value:function(){}};function Pa(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Ma(r)}function Ma(t){this._=t}function Ta(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Oa(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Ia(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Sa,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Ma.prototype=Pa.prototype={constructor:Ma,on:function(t,e){var n,r=this._,i=Ta(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=Ia(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Ia(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=Oa(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ma(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var Na=Pa;function Da(){}var Ra=function(t){return null==t?Da:function(){return this.querySelector(t)}};function Aa(){return[]}var ja=function(t){return null==t?Aa:function(){return this.querySelectorAll(t)}},Ba=function(t){return function(){return this.matches(t)}},za=function(t){return new Array(t.length)};function Fa(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Fa.prototype={constructor:Fa,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Ga(t,e,n,r,i,o){for(var a,s=0,l=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new Fa(t,o[s]);for(;s<l;++s)(a=e[s])&&(i[s]=a)}function Ua(t,e,n,r,i,o,a){var s,l,u,c={},h=e.length,f=o.length,p=new Array(h);for(s=0;s<h;++s)(l=e[s])&&(p[s]=u="$"+a.call(l,l.__data__,s,e),u in c?i[s]=l:c[u]=l);for(s=0;s<f;++s)(l=c[u="$"+a.call(t,o[s],s,o)])?(r[s]=l,l.__data__=o[s],c[u]=null):n[s]=new Fa(t,o[s]);for(s=0;s<h;++s)(l=e[s])&&c[p[s]]===l&&(i[s]=l)}function qa(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var Ha="http://www.w3.org/1999/xhtml",Va={svg:"http://www.w3.org/2000/svg",xhtml:Ha,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Ya=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Va.hasOwnProperty(e)?{space:Va[e],local:t}:t};function Wa(t){return function(){this.removeAttribute(t)}}function Xa(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Za(t,e){return function(){this.setAttribute(t,e)}}function Ka(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ja(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Qa(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var $a=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function ts(t){return function(){this.style.removeProperty(t)}}function es(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ns(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function rs(t,e){return t.style.getPropertyValue(e)||$a(t).getComputedStyle(t,null).getPropertyValue(e)}function is(t){return function(){delete this[t]}}function os(t,e){return function(){this[t]=e}}function as(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function ss(t){return t.trim().split(/^|\s+/)}function ls(t){return t.classList||new us(t)}function us(t){this._node=t,this._names=ss(t.getAttribute("class")||"")}function cs(t,e){for(var n=ls(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function hs(t,e){for(var n=ls(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function fs(t){return function(){cs(this,t)}}function ps(t){return function(){hs(this,t)}}function ds(t,e){return function(){(e.apply(this,arguments)?cs:hs)(this,t)}}us.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function gs(){this.textContent=""}function ys(t){return function(){this.textContent=t}}function ms(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function vs(){this.innerHTML=""}function _s(t){return function(){this.innerHTML=t}}function bs(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ws(){this.nextSibling&&this.parentNode.appendChild(this)}function xs(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ls(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Ha&&e.documentElement.namespaceURI===Ha?e.createElement(t):e.createElementNS(n,t)}}function Es(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var Cs=function(t){var e=Ya(t);return(e.local?Es:Ls)(e)};function ks(){return null}function Ss(){var t=this.parentNode;t&&t.removeChild(this)}function Ps(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ms(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var Ts={},Os=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Ts={mouseenter:"mouseover",mouseleave:"mouseout"}));function Is(t,e,n){return t=Ns(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Ns(t,e,n){return function(r){var i=Os;Os=r;try{t.call(this,this.__data__,e,n)}finally{Os=i}}}function Ds(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Rs(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function As(t,e,n){var r=Ts.hasOwnProperty(t.type)?Is:Ns;return function(i,o,a){var s,l=this.__on,u=r(e,o,a);if(l)for(var c=0,h=l.length;c<h;++c)if((s=l[c]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=e);this.addEventListener(t.type,u,n),s={type:t.type,name:t.name,value:e,listener:u,capture:n},l?l.push(s):this.__on=[s]}}function js(t,e,n){var r=$a(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Bs(t,e){return function(){return js(this,t,e)}}function zs(t,e){return function(){return js(this,t,e.apply(this,arguments))}}var Fs=[null];function Gs(t,e){this._groups=t,this._parents=e}function Us(){return new Gs([[document.documentElement]],Fs)}Gs.prototype=Us.prototype={constructor:Gs,select:function(t){"function"!=typeof t&&(t=Ra(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(o=s[c])&&(a=t.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new Gs(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=ja(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],l=s.length,u=0;u<l;++u)(a=s[u])&&(r.push(t.call(a,a.__data__,u,s)),i.push(a));return new Gs(r,i)},filter:function(t){"function"!=typeof t&&(t=Ba(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new Gs(r,this._parents)},data:function(t,e){if(!t)return d=new Array(this.size()),c=-1,this.each((function(t){d[++c]=t})),d;var n,r=e?Ua:Ga,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var a=o.length,s=new Array(a),l=new Array(a),u=new Array(a),c=0;c<a;++c){var h=i[c],f=o[c],p=f.length,d=t.call(h,h&&h.__data__,c,i),g=d.length,y=l[c]=new Array(g),m=s[c]=new Array(g);r(h,f,y,m,u[c]=new Array(p),d,e);for(var v,_,b=0,w=0;b<g;++b)if(v=y[b]){for(b>=w&&(w=b+1);!(_=m[w])&&++w<g;);v._next=_||null}}return(s=new Gs(s,i))._enter=l,s._exit=u,s},enter:function(){return new Gs(this._enter||this._groups.map(za),this._parents)},exit:function(){return new Gs(this._exit||this._groups.map(za),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,u=e[s],c=n[s],h=u.length,f=a[s]=new Array(h),p=0;p<h;++p)(l=u[p]||c[p])&&(f[p]=l);for(;s<r;++s)a[s]=e[s];return new Gs(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=qa);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,u=i[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(u[c]=a);u.sort(e)}return new Gs(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=Ya(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Xa:Wa:"function"==typeof e?n.local?Qa:Ja:n.local?Ka:Za)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?ts:"function"==typeof e?ns:es)(t,e,null==n?"":n)):rs(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?is:"function"==typeof e?as:os)(t,e)):this.node()[t]},classed:function(t,e){var n=ss(t+"");if(arguments.length<2){for(var r=ls(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?ds:e?fs:ps)(n,e))},text:function(t){return arguments.length?this.each(null==t?gs:("function"==typeof t?ms:ys)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?vs:("function"==typeof t?bs:_s)(t)):this.node().innerHTML},raise:function(){return this.each(ws)},lower:function(){return this.each(xs)},append:function(t){var e="function"==typeof t?t:Cs(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Cs(t),r=null==e?ks:"function"==typeof e?e:Ra(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Ss)},clone:function(t){return this.select(t?Ms:Ps)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=Ds(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?As:Rs,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?zs:Bs)(t,e))}};var qs=Us,Hs=function(t){return"string"==typeof t?new Gs([[document.querySelector(t)]],[document.documentElement]):new Gs([[t]],Fs)};var Vs=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Ys(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ws(){}var Xs="\\s*([+-]?\\d+)\\s*",Zs="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ks="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Js=/^#([0-9a-f]{3,8})$/,Qs=new RegExp("^rgb\\("+[Xs,Xs,Xs]+"\\)$"),$s=new RegExp("^rgb\\("+[Ks,Ks,Ks]+"\\)$"),tl=new RegExp("^rgba\\("+[Xs,Xs,Xs,Zs]+"\\)$"),el=new RegExp("^rgba\\("+[Ks,Ks,Ks,Zs]+"\\)$"),nl=new RegExp("^hsl\\("+[Zs,Ks,Ks]+"\\)$"),rl=new RegExp("^hsla\\("+[Zs,Ks,Ks,Zs]+"\\)$"),il={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ol(){return this.rgb().formatHex()}function al(){return this.rgb().formatRgb()}function sl(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Js.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ll(e):3===n?new fl(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new fl(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new fl(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Qs.exec(t))?new fl(e[1],e[2],e[3],1):(e=$s.exec(t))?new fl(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=tl.exec(t))?ul(e[1],e[2],e[3],e[4]):(e=el.exec(t))?ul(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=nl.exec(t))?yl(e[1],e[2]/100,e[3]/100,1):(e=rl.exec(t))?yl(e[1],e[2]/100,e[3]/100,e[4]):il.hasOwnProperty(t)?ll(il[t]):"transparent"===t?new fl(NaN,NaN,NaN,0):null}function ll(t){return new fl(t>>16&255,t>>8&255,255&t,1)}function ul(t,e,n,r){return r<=0&&(t=e=n=NaN),new fl(t,e,n,r)}function cl(t){return t instanceof Ws||(t=sl(t)),t?new fl((t=t.rgb()).r,t.g,t.b,t.opacity):new fl}function hl(t,e,n,r){return 1===arguments.length?cl(t):new fl(t,e,n,null==r?1:r)}function fl(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function pl(){return"#"+gl(this.r)+gl(this.g)+gl(this.b)}function dl(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function gl(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function yl(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new vl(t,e,n,r)}function ml(t){if(t instanceof vl)return new vl(t.h,t.s,t.l,t.opacity);if(t instanceof Ws||(t=sl(t)),!t)return new vl;if(t instanceof vl)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new vl(a,s,l,t.opacity)}function vl(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function _l(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function bl(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}Vs(Ws,sl,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:ol,formatHex:ol,formatHsl:function(){return ml(this).formatHsl()},formatRgb:al,toString:al}),Vs(fl,hl,Ys(Ws,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new fl(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new fl(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:pl,formatHex:pl,formatRgb:dl,toString:dl})),Vs(vl,(function(t,e,n,r){return 1===arguments.length?ml(t):new vl(t,e,n,null==r?1:r)}),Ys(Ws,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new vl(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new vl(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new fl(_l(t>=240?t-240:t+120,i,r),_l(t,i,r),_l(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var wl=function(t){return function(){return t}};function xl(t,e){return function(n){return t+n*e}}function Ll(t){return 1==(t=+t)?El:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):wl(isNaN(e)?n:e)}}function El(t,e){var n=e-t;return n?xl(t,n):wl(isNaN(t)?e:t)}var Cl=function t(e){var n=Ll(e);function r(t,e){var r=n((t=hl(t)).r,(e=hl(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=El(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function kl(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=hl(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}kl((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return bl((n-r/e)*e,a,i,o,s)}})),kl((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return bl((n-r/e)*e,i,o,a,s)}}));var Sl=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},Pl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ml=new RegExp(Pl.source,"g");var Tl,Ol,Il=function(t,e){var n,r,i,o=Pl.lastIndex=Ml.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=Pl.exec(t))&&(r=Ml.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:Sl(n,r)})),o=Ml.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})},Nl=0,Dl=0,Rl=0,Al=0,jl=0,Bl=0,zl="object"==typeof performance&&performance.now?performance:Date,Fl="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Gl(){return jl||(Fl(Ul),jl=zl.now()+Bl)}function Ul(){jl=0}function ql(){this._call=this._time=this._next=null}function Hl(t,e,n){var r=new ql;return r.restart(t,e,n),r}function Vl(){jl=(Al=zl.now())+Bl,Nl=Dl=0;try{!function(){Gl(),++Nl;for(var t,e=Tl;e;)(t=jl-e._time)>=0&&e._call.call(null,t),e=e._next;--Nl}()}finally{Nl=0,function(){var t,e,n=Tl,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Tl=e);Ol=t,Wl(r)}(),jl=0}}function Yl(){var t=zl.now(),e=t-Al;e>1e3&&(Bl-=e,Al=t)}function Wl(t){Nl||(Dl&&(Dl=clearTimeout(Dl)),t-jl>24?(t<1/0&&(Dl=setTimeout(Vl,t-zl.now()-Bl)),Rl&&(Rl=clearInterval(Rl))):(Rl||(Al=zl.now(),Rl=setInterval(Yl,1e3)),Nl=1,Fl(Vl)))}ql.prototype=Hl.prototype={constructor:ql,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Gl():+n)+(null==e?0:+e),this._next||Ol===this||(Ol?Ol._next=this:Tl=this,Ol=this),this._call=t,this._time=n,Wl()},stop:function(){this._call&&(this._call=null,this._time=1/0,Wl())}};var Xl=function(t,e,n){var r=new ql;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r},Zl=Na("start","end","cancel","interrupt"),Kl=[],Jl=function(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(l){var u,c,h,f;if(1!==n.state)return s();for(u in i)if((f=i[u]).name===n.name){if(3===f.state)return Xl(o);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[u]):+u<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[u])}if(Xl((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),u=0,c=-1;u<h;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=f);r.length=c+1}}function a(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Hl((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:Zl,tween:Kl,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function Ql(t,e){var n=tu(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function $l(t,e){var n=tu(t,e);if(n.state>3)throw new Error("too late; already running");return n}function tu(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var eu,nu,ru,iu,ou=function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}},au=180/Math.PI,su={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},lu=function(t,e,n,r,i,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*au,skewX:Math.atan(l)*au,scaleX:a,scaleY:s}};function uu(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],l=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:Sl(t,i)},{i:l-2,x:Sl(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Sl(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Sl(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,l),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Sl(t,n)},{i:s-2,x:Sl(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var cu=uu((function(t){return"none"===t?su:(eu||(eu=document.createElement("DIV"),nu=document.documentElement,ru=document.defaultView),eu.style.transform=t,t=ru.getComputedStyle(nu.appendChild(eu),null).getPropertyValue("transform"),nu.removeChild(eu),t=t.slice(7,-1).split(","),lu(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),hu=uu((function(t){return null==t?su:(iu||(iu=document.createElementNS("http://www.w3.org/2000/svg","g")),iu.setAttribute("transform",t),(t=iu.transform.baseVal.consolidate())?(t=t.matrix,lu(t.a,t.b,t.c,t.d,t.e,t.f)):su)}),", ",")",")");function fu(t,e){var n,r;return function(){var i=$l(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function pu(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=$l(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function du(t,e,n){var r=t._id;return t.each((function(){var t=$l(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return tu(t,r).value[e]}}var gu=function(t,e){var n;return("number"==typeof e?Sl:e instanceof sl?Cl:(n=sl(e))?(e=n,Cl):Il)(t,e)};function yu(t){return function(){this.removeAttribute(t)}}function mu(t){return function(){this.removeAttributeNS(t.space,t.local)}}function vu(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function _u(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function bu(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttribute(t)}}function wu(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function xu(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Lu(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Eu(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Lu(t,i)),n}return i._value=e,i}function Cu(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&xu(t,i)),n}return i._value=e,i}function ku(t,e){return function(){Ql(this,t).delay=+e.apply(this,arguments)}}function Su(t,e){return e=+e,function(){Ql(this,t).delay=e}}function Pu(t,e){return function(){$l(this,t).duration=+e.apply(this,arguments)}}function Mu(t,e){return e=+e,function(){$l(this,t).duration=e}}function Tu(t,e){if("function"!=typeof e)throw new Error;return function(){$l(this,t).ease=e}}function Ou(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Ql:$l;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}var Iu=qs.prototype.constructor;function Nu(t){return function(){this.style.removeProperty(t)}}function Du(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Ru(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&Du(t,o,n)),r}return o._value=e,o}function Au(t){return function(e){this.textContent=t.call(this,e)}}function ju(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Au(r)),e}return r._value=t,r}var Bu=0;function zu(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Fu(){return++Bu}var Gu=qs.prototype;zu.prototype=function(t){return qs().transition(t)}.prototype={constructor:zu,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Ra(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,l,u=r[a],c=u.length,h=o[a]=new Array(c),f=0;f<c;++f)(s=u[f])&&(l=t.call(s,s.__data__,f,u))&&("__data__"in s&&(l.__data__=s.__data__),h[f]=l,Jl(h[f],e,n,f,h,tu(s,n)));return new zu(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ja(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l,u=r[s],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var f,p=t.call(l,l.__data__,h,u),d=tu(l,n),g=0,y=p.length;g<y;++g)(f=p[g])&&Jl(f,e,n,g,p,d);o.push(p),a.push(l)}return new zu(o,a,e,n)},filter:function(t){"function"!=typeof t&&(t=Ba(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new zu(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,u=e[s],c=n[s],h=u.length,f=a[s]=new Array(h),p=0;p<h;++p)(l=u[p]||c[p])&&(f[p]=l);for(;s<r;++s)a[s]=e[s];return new zu(a,this._parents,this._name,this._id)},selection:function(){return new Iu(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Fu(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var c=tu(a,e);Jl(a,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new zu(r,this._parents,t,n)},call:Gu.call,nodes:Gu.nodes,node:Gu.node,size:Gu.size,empty:Gu.empty,each:Gu.each,on:function(t,e){var n=this._id;return arguments.length<2?tu(this.node(),n).on.on(t):this.each(Ou(n,t,e))},attr:function(t,e){var n=Ya(t),r="transform"===n?hu:gu;return this.attrTween(t,"function"==typeof e?(n.local?wu:bu)(n,r,du(this,"attr."+t,e)):null==e?(n.local?mu:yu)(n):(n.local?_u:vu)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Ya(t);return this.tween(n,(r.local?Eu:Cu)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?cu:gu;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=rs(this,t),a=(this.style.removeProperty(t),rs(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,Nu(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=rs(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=rs(this,t)),a===l?null:a===r&&l===i?o:(i=l,o=e(r=a,s))}}(t,r,du(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var l=$l(this,t),u=l.on,c=null==l.value[a]?o||(o=Nu(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=rs(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,Ru(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(du(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,ju(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=tu(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?fu:pu)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ku:Su)(e,t)):tu(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Pu:Mu)(e,t)):tu(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(Tu(e,t)):tu(this.node(),e).ease},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0==--i&&o()}};n.each((function(){var n=$l(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e}))}))}};var Uu={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function qu(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return Uu.time=Gl(),Uu;return n}qs.prototype.interrupt=function(t){return this.each((function(){ou(this,t)}))},qs.prototype.transition=function(t){var e,n;t instanceof zu?(e=t._id,t=t._name):(e=Fu(),(n=Uu).time=Gl(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)(a=s[u])&&Jl(a,t,e,u,s,n||qu(a,e));return new zu(r,this._parents,t,e)};function Hu(t){return[+t[0],+t[1]]}function Vu(t){return[Hu(t[0]),Hu(t[1])]}["w","e"].map(Yu),["n","s"].map(Yu),["n","w","e","s","nw","ne","sw","se"].map(Yu);function Yu(t){return{type:t}}Math.cos,Math.sin,Math.PI,Math.max;Array.prototype.slice;var Wu=Math.PI,Xu=2*Wu,Zu=Xu-1e-6;function Ku(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ju(){return new Ku}Ku.prototype=Ju.prototype={constructor:Ku,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-t,l=r-e,u=o-t,c=a-e,h=u*u+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(c*s-l*u)>1e-6&&i){var f=n-o,p=r-a,d=s*s+l*l,g=f*f+p*p,y=Math.sqrt(d),m=Math.sqrt(h),v=i*Math.tan((Wu-Math.acos((d+h-g)/(2*y*m)))/2),_=v/m,b=v/y;Math.abs(_-1)>1e-6&&(this._+="L"+(t+_*u)+","+(e+_*c)),this._+="A"+i+","+i+",0,0,"+ +(c*f>u*p)+","+(this._x1=t+b*s)+","+(this._y1=e+b*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,o){t=+t,e=+e,o=!!o;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),l=t+a,u=e+s,c=1^o,h=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+u:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-u)>1e-6)&&(this._+="L"+l+","+u),n&&(h<0&&(h=h%Xu+Xu),h>Zu?this._+="A"+n+","+n+",0,1,"+c+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Wu)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function Qu(){}function $u(t,e){var n=new Qu;if(t instanceof Qu)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}Qu.prototype=$u.prototype={constructor:Qu,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var tc=$u;function ec(){}var nc=tc.prototype;function rc(t,e){var n=new ec;if(t instanceof ec)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}ec.prototype=rc.prototype={constructor:ec,has:nc.has,add:function(t){return this["$"+(t+="")]=t,this},remove:nc.remove,clear:nc.clear,values:nc.keys,size:nc.size,empty:nc.empty,each:nc.each};Array.prototype.slice;function ic(t){return+t}var oc={},ac={};function sc(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function lc(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function uc(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function cc(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+uc(-e,6):e>9999?"+"+uc(e,6):uc(e,4))+"-"+uc(t.getUTCMonth()+1,2)+"-"+uc(t.getUTCDate(),2)+(o?"T"+uc(n,2)+":"+uc(r,2)+":"+uc(i,2)+"."+uc(o,3)+"Z":i?"T"+uc(n,2)+":"+uc(r,2)+":"+uc(i,2)+"Z":r||n?"T"+uc(n,2)+":"+uc(r,2)+"Z":"")}var hc=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,l=o<=0,u=!1;function c(){if(l)return ac;if(u)return u=!1,oc;var e,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=o?l=!0:10===(r=t.charCodeAt(a++))?u=!0:13===r&&(u=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(e=a++)))u=!0;else if(13===r)u=!0,10===t.charCodeAt(a)&&++a;else if(r!==n)continue;return t.slice(i,e)}return l=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=c())!==ac;){for(var h=[];r!==oc&&r!==ac;)h.push(r),r=c();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?cc(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=sc(t);return function(r,i){return e(n(r),i,t)}}(t,e):sc(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=lc(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=lc(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}},fc=hc(","),pc=fc.parse,dc=(fc.parseRows,fc.format,fc.formatBody,fc.formatRows,fc.formatRow,fc.formatValue,hc("\t")),gc=dc.parse;dc.parseRows,dc.format,dc.formatBody,dc.formatRows,dc.formatRow,dc.formatValue;function yc(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}var mc=function(t,e){return fetch(t,e).then(yc)};function vc(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=void 0),mc(e,n).then((function(e){return t(e,r)}))}}vc(pc),vc(gc);function _c(t){return function(e,n){return mc(e,n).then((function(e){return(new DOMParser).parseFromString(e,t)}))}}_c("application/xml"),_c("text/html"),_c("image/svg+xml");function bc(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,l,u,c,h,f,p=t._root,d={data:r},g=t._x0,y=t._y0,m=t._x1,v=t._y1;if(!p)return t._root=d,t;for(;p.length;)if((u=e>=(o=(g+m)/2))?g=o:m=o,(c=n>=(a=(y+v)/2))?y=a:v=a,i=p,!(p=p[h=c<<1|u]))return i[h]=d,t;if(s=+t._x.call(null,p.data),l=+t._y.call(null,p.data),e===s&&n===l)return d.next=p,i?i[h]=d:t._root=d,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(u=e>=(o=(g+m)/2))?g=o:m=o,(c=n>=(a=(y+v)/2))?y=a:v=a}while((h=c<<1|u)==(f=(l>=a)<<1|s>=o));return i[f]=p,i[h]=d,t}var wc=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function xc(t){return t[0]}function Lc(t){return t[1]}function Ec(t,e,n){var r=new Cc(null==e?xc:e,null==n?Lc:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Cc(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function kc(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Sc=Ec.prototype=Cc.prototype;Sc.copy=function(){var t,e,n=new Cc(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=kc(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=kc(e));return n},Sc.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return bc(this.cover(e,n),e,n,t)},Sc.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),l=1/0,u=1/0,c=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<l&&(l=r),r>c&&(c=r),i<u&&(u=i),i>h&&(h=i));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),n=0;n<o;++n)bc(this,a[n],s[n],t[n]);return this},Sc.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,s,l=i-n,u=this._root;n>t||t>=i||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(a=new Array(4))[s]=u,u=a,l*=2,s){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},Sc.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Sc.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Sc.find=function(t,e,n){var r,i,o,a,s,l,u,c=this._x0,h=this._y0,f=this._x1,p=this._y1,d=[],g=this._root;for(g&&d.push(new wc(g,c,h,f,p)),null==n?n=1/0:(c=t-n,h=e-n,f=t+n,p=e+n,n*=n);l=d.pop();)if(!(!(g=l.node)||(i=l.x0)>f||(o=l.y0)>p||(a=l.x1)<c||(s=l.y1)<h))if(g.length){var y=(i+a)/2,m=(o+s)/2;d.push(new wc(g[3],y,m,a,s),new wc(g[2],i,m,y,s),new wc(g[1],y,o,a,m),new wc(g[0],i,o,y,m)),(u=(e>=m)<<1|t>=y)&&(l=d[d.length-1],d[d.length-1]=d[d.length-1-u],d[d.length-1-u]=l)}else{var v=t-+this._x.call(null,g.data),_=e-+this._y.call(null,g.data),b=v*v+_*_;if(b<n){var w=Math.sqrt(n=b);c=t-w,h=e-w,f=t+w,p=e+w,r=g.data}}return r},Sc.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,l,u,c,h,f,p=this._root,d=this._x0,g=this._y0,y=this._x1,m=this._y1;if(!p)return this;if(p.length)for(;;){if((u=o>=(s=(d+y)/2))?d=s:y=s,(c=a>=(l=(g+m)/2))?g=l:m=l,e=p,!(p=p[h=c<<1|u]))return this;if(!p.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}for(;p.data!==t;)if(r=p,!(p=p.next))return this;return(i=p.next)&&delete p.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(p=e[0]||e[1]||e[2]||e[3])&&p===(e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[f]=p:this._root=p),this):(this._root=i,this)},Sc.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Sc.root=function(){return this._root},Sc.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Sc.visit=function(t){var e,n,r,i,o,a,s=[],l=this._root;for(l&&s.push(new wc(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&l.length){var u=(r+o)/2,c=(i+a)/2;(n=l[3])&&s.push(new wc(n,u,c,o,a)),(n=l[2])&&s.push(new wc(n,r,c,u,a)),(n=l[1])&&s.push(new wc(n,u,i,o,c)),(n=l[0])&&s.push(new wc(n,r,i,u,c))}return this},Sc.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new wc(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,l=e.x1,u=e.y1,c=(a+l)/2,h=(s+u)/2;(o=i[0])&&n.push(new wc(o,a,s,c,h)),(o=i[1])&&n.push(new wc(o,c,s,l,h)),(o=i[2])&&n.push(new wc(o,a,h,c,u)),(o=i[3])&&n.push(new wc(o,c,h,l,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Sc.x=function(t){return arguments.length?(this._x=t,this):this._x},Sc.y=function(t){return arguments.length?(this._y=t,this):this._y};Math.PI,Math.sqrt(5);var Pc=function(){return Math.random()},Mc=(function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(Pc),function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*e()-1,o=2*e()-1,i=r*r+o*o}while(!i||i>1);return t+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(Pc)),Tc=(function t(e){function n(){var t=Mc.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(Pc),function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(Pc));(function t(e){function n(t){var n=Tc.source(e)(t);return function(){return n()/t}}return n.source=t,n})(Pc),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(Pc);var Oc=Array.prototype;Oc.map,Oc.slice;var Ic=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Nc(t){if(!(e=Ic.exec(t)))throw new Error("invalid format: "+t);var e;return new Dc({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Dc(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}Nc.prototype=Dc.prototype,Dc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Rc,Ac,jc=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},Bc=function(t){return(t=jc(Math.abs(t)))?t[1]:NaN},zc=function(t,e){var n=jc(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Fc={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return zc(100*t,e)},r:zc,s:function(t,e){var n=jc(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Rc=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+jc(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Gc=function(t){return t},Uc=Array.prototype.map,qc=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];Ac=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Gc:(e=Uc.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(t.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Gc:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Uc.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"-":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Nc(t)).fill,n=t.align,h=t.sign,f=t.symbol,p=t.zero,d=t.width,g=t.comma,y=t.precision,m=t.trim,v=t.type;"n"===v?(g=!0,v="g"):Fc[v]||(void 0===y&&(y=12),m=!0,v="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var _="$"===f?i:"#"===f&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",b="$"===f?o:/[%p]/.test(v)?l:"",w=Fc[v],x=/[defgprs%]/.test(v);function L(t){var i,o,l,f=_,L=b;if("c"===v)L=w(t)+L,t="";else{var E=(t=+t)<0;if(t=isNaN(t)?c:w(Math.abs(t),y),m&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),E&&0==+t&&(E=!1),f=(E?"("===h?h:u:"-"===h||"("===h?"":h)+f,L=("s"===v?qc[8+Rc/3]:"")+L+(E&&"("===h?")":""),x)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){L=(46===l?a+t.slice(i+1):t.slice(i))+L,t=t.slice(0,i);break}}g&&!p&&(t=r(t,1/0));var C=f.length+t.length+L.length,k=C<d?new Array(d-C+1).join(e):"";switch(g&&p&&(t=r(k+t,k.length?d-L.length:1/0),k=""),n){case"<":t=f+t+L+k;break;case"=":t=f+k+t+L;break;case"^":t=k.slice(0,C=k.length>>1)+f+t+L+k.slice(C);break;default:t=k+f+t+L}return s(t)}return y=void 0===y?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),L.toString=function(){return t+""},L}return{format:h,formatPrefix:function(t,e){var n=h(((t=Nc(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Bc(e)/3))),i=Math.pow(10,-r),o=qc[8+r/3];return function(t){return n(i*t)+o}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Ac.format,Ac.formatPrefix;var Hc=new Date,Vc=new Date;function Yc(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return Yc((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return Hc.setTime(+e),Vc.setTime(+r),t(Hc),t(Vc),Math.floor(n(Hc,Vc))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Wc=Yc((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Wc.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Yc((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Xc=Wc,Zc=(Wc.range,Yc((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})));Zc.range;function Kc(t){return Yc((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var Jc=Kc(0),Qc=Kc(1),$c=Kc(2),th=Kc(3),eh=Kc(4),nh=Kc(5),rh=Kc(6),ih=(Jc.range,Qc.range,$c.range,th.range,eh.range,nh.range,rh.range,Yc((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1}))),oh=ih,ah=(ih.range,Yc((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()}))),sh=(ah.range,Yc((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()}))),lh=(sh.range,Yc((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()}))),uh=(lh.range,Yc((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t})));uh.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Yc((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):uh:null};uh.range;function ch(t){return Yc((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var hh=ch(0),fh=ch(1),ph=ch(2),dh=ch(3),gh=ch(4),yh=ch(5),mh=ch(6),vh=(hh.range,fh.range,ph.range,dh.range,gh.range,yh.range,mh.range,Yc((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1}))),_h=vh,bh=(vh.range,Yc((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));bh.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Yc((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var wh=bh;bh.range;function xh(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Lh(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Eh(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var Ch,kh={"-":"",_:" ",0:"0"},Sh=/^\s*\d+/,Ph=/^%/,Mh=/[\\^$*+?|[\]().{}]/g;function Th(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Oh(t){return t.replace(Mh,"\\$&")}function Ih(t){return new RegExp("^(?:"+t.map(Oh).join("|")+")","i")}function Nh(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Dh(t,e,n){var r=Sh.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Rh(t,e,n){var r=Sh.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Ah(t,e,n){var r=Sh.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function jh(t,e,n){var r=Sh.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Bh(t,e,n){var r=Sh.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function zh(t,e,n){var r=Sh.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Fh(t,e,n){var r=Sh.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Gh(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Uh(t,e,n){var r=Sh.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function qh(t,e,n){var r=Sh.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Hh(t,e,n){var r=Sh.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Vh(t,e,n){var r=Sh.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Yh(t,e,n){var r=Sh.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Wh(t,e,n){var r=Sh.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Xh(t,e,n){var r=Sh.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Zh(t,e,n){var r=Sh.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Kh(t,e,n){var r=Sh.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Jh(t,e,n){var r=Ph.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Qh(t,e,n){var r=Sh.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function $h(t,e,n){var r=Sh.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function tf(t,e){return Th(t.getDate(),e,2)}function ef(t,e){return Th(t.getHours(),e,2)}function nf(t,e){return Th(t.getHours()%12||12,e,2)}function rf(t,e){return Th(1+oh.count(Xc(t),t),e,3)}function of(t,e){return Th(t.getMilliseconds(),e,3)}function af(t,e){return of(t,e)+"000"}function sf(t,e){return Th(t.getMonth()+1,e,2)}function lf(t,e){return Th(t.getMinutes(),e,2)}function uf(t,e){return Th(t.getSeconds(),e,2)}function cf(t){var e=t.getDay();return 0===e?7:e}function hf(t,e){return Th(Jc.count(Xc(t)-1,t),e,2)}function ff(t,e){var n=t.getDay();return t=n>=4||0===n?eh(t):eh.ceil(t),Th(eh.count(Xc(t),t)+(4===Xc(t).getDay()),e,2)}function pf(t){return t.getDay()}function df(t,e){return Th(Qc.count(Xc(t)-1,t),e,2)}function gf(t,e){return Th(t.getFullYear()%100,e,2)}function yf(t,e){return Th(t.getFullYear()%1e4,e,4)}function mf(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Th(e/60|0,"0",2)+Th(e%60,"0",2)}function vf(t,e){return Th(t.getUTCDate(),e,2)}function _f(t,e){return Th(t.getUTCHours(),e,2)}function bf(t,e){return Th(t.getUTCHours()%12||12,e,2)}function wf(t,e){return Th(1+_h.count(wh(t),t),e,3)}function xf(t,e){return Th(t.getUTCMilliseconds(),e,3)}function Lf(t,e){return xf(t,e)+"000"}function Ef(t,e){return Th(t.getUTCMonth()+1,e,2)}function Cf(t,e){return Th(t.getUTCMinutes(),e,2)}function kf(t,e){return Th(t.getUTCSeconds(),e,2)}function Sf(t){var e=t.getUTCDay();return 0===e?7:e}function Pf(t,e){return Th(hh.count(wh(t)-1,t),e,2)}function Mf(t,e){var n=t.getUTCDay();return t=n>=4||0===n?gh(t):gh.ceil(t),Th(gh.count(wh(t),t)+(4===wh(t).getUTCDay()),e,2)}function Tf(t){return t.getUTCDay()}function Of(t,e){return Th(fh.count(wh(t)-1,t),e,2)}function If(t,e){return Th(t.getUTCFullYear()%100,e,2)}function Nf(t,e){return Th(t.getUTCFullYear()%1e4,e,4)}function Df(){return"+0000"}function Rf(){return"%"}function Af(t){return+t}function jf(t){return Math.floor(+t/1e3)}!function(t){Ch=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,l=t.shortMonths,u=Ih(i),c=Nh(i),h=Ih(o),f=Nh(o),p=Ih(a),d=Nh(a),g=Ih(s),y=Nh(s),m=Ih(l),v=Nh(l),_={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:tf,e:tf,f:af,H:ef,I:nf,j:rf,L:of,m:sf,M:lf,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Af,s:jf,S:uf,u:cf,U:hf,V:ff,w:pf,W:df,x:null,X:null,y:gf,Y:yf,Z:mf,"%":Rf},b={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:vf,e:vf,f:Lf,H:_f,I:bf,j:wf,L:xf,m:Ef,M:Cf,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Af,s:jf,S:kf,u:Sf,U:Pf,V:Mf,w:Tf,W:Of,x:null,X:null,y:If,Y:Nf,Z:Df,"%":Rf},w={a:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return E(t,e,n,r)},d:Hh,e:Hh,f:Kh,H:Yh,I:Yh,j:Vh,L:Zh,m:qh,M:Wh,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=c[r[0].toLowerCase()],n+r[0].length):-1},q:Uh,Q:Qh,s:$h,S:Xh,u:Rh,U:Ah,V:jh,w:Dh,W:Bh,x:function(t,e,r){return E(t,n,e,r)},X:function(t,e,n){return E(t,r,e,n)},y:Fh,Y:zh,Z:Gh,"%":Jh};function x(t,e){return function(n){var r,i,o,a=[],s=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(i=kh[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),l=s+1);return a.push(t.slice(l,s)),a.join("")}}function L(t,e){return function(n){var r,i,o=Eh(1900,void 0,1);if(E(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Lh(Eh(o.y,0,1))).getUTCDay(),r=i>4||0===i?fh.ceil(r):fh(r),r=_h.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=xh(Eh(o.y,0,1))).getDay(),r=i>4||0===i?Qc.ceil(r):Qc(r),r=oh.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Lh(Eh(o.y,0,1)).getUTCDay():xh(Eh(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Lh(o)):xh(o)}}function E(t,e,n,r){for(var i,o,a=0,s=e.length,l=n.length;a<s;){if(r>=l)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=w[i in kh?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return _.x=x(n,_),_.X=x(r,_),_.c=x(e,_),b.x=x(n,b),b.X=x(r,b),b.c=x(e,b),{format:function(t){var e=x(t+="",_);return e.toString=function(){return t},e},parse:function(t){var e=L(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=x(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=L(t+="",!0);return e.toString=function(){return t},e}}}(t),Ch.format,Ch.parse,Ch.utcFormat,Ch.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Bf=Yc((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),zf=(Bf.range,Yc((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getUTCHours()}))),Ff=(zf.range,Yc((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getUTCMinutes()})));Ff.range;function Gf(){this._=null}function Uf(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function qf(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Hf(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Vf(t){for(;t.L;)t=t.L;return t}Gf.prototype={constructor:Gf,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Vf(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(qf(this,n),n=(t=n).U),n.C=!1,r.C=!0,Hf(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Hf(this,n),n=(t=n).U),n.C=!1,r.C=!0,qf(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,a=t.R;if(n=o?a?Vf(a):o:a,i?i.L===t?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=a,a.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,qf(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Hf(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,qf(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,Hf(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,qf(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,Hf(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var Yf=Gf;function Wf(t,e,n,r){var i=[null,null],o=mp.push(i)-1;return i.left=t,i.right=e,n&&Zf(i,t,e,n),r&&Zf(i,e,t,r),gp[t.index].halfedges.push(o),gp[e.index].halfedges.push(o),i}function Xf(t,e,n){var r=[e,n];return r.left=t,r}function Zf(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Kf(t,e,n,r,i){var o,a=t[0],s=t[1],l=a[0],u=a[1],c=0,h=1,f=s[0]-l,p=s[1]-u;if(o=e-l,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>c&&(c=o)}if(o=r-l,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<h&&(h=o)}if(o=n-u,p||!(o>0)){if(o/=p,p<0){if(o<c)return;o<h&&(h=o)}else if(p>0){if(o>h)return;o>c&&(c=o)}if(o=i-u,p||!(o<0)){if(o/=p,p<0){if(o>h)return;o>c&&(c=o)}else if(p>0){if(o<c)return;o<h&&(h=o)}return!(c>0||h<1)||(c>0&&(t[0]=[l+c*f,u+c*p]),h<1&&(t[1]=[l+h*f,u+h*p]),!0)}}}}}function Jf(t,e,n,r,i){var o=t[1];if(o)return!0;var a,s,l=t[0],u=t.left,c=t.right,h=u[0],f=u[1],p=c[0],d=c[1],g=(h+p)/2,y=(f+d)/2;if(d===f){if(g<e||g>=r)return;if(h>p){if(l){if(l[1]>=i)return}else l=[g,n];o=[g,i]}else{if(l){if(l[1]<n)return}else l=[g,i];o=[g,n]}}else if(s=y-(a=(h-p)/(d-f))*g,a<-1||a>1)if(h>p){if(l){if(l[1]>=i)return}else l=[(n-s)/a,n];o=[(i-s)/a,i]}else{if(l){if(l[1]<n)return}else l=[(i-s)/a,i];o=[(n-s)/a,n]}else if(f<d){if(l){if(l[0]>=r)return}else l=[e,a*e+s];o=[r,a*r+s]}else{if(l){if(l[0]<e)return}else l=[r,a*r+s];o=[e,a*e+s]}return t[0]=l,t[1]=o,!0}function Qf(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function $f(t,e){return e[+(e.left!==t.site)]}function tp(t,e){return e[+(e.left===t.site)]}var ep,np=[];function rp(){Uf(this),this.x=this.y=this.arc=this.site=this.cy=null}function ip(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var a=i[0],s=i[1],l=r[0]-a,u=r[1]-s,c=o[0]-a,h=o[1]-s,f=2*(l*h-u*c);if(!(f>=-_p)){var p=l*l+u*u,d=c*c+h*h,g=(h*p-u*d)/f,y=(l*d-c*p)/f,m=np.pop()||new rp;m.arc=t,m.site=i,m.x=g+a,m.y=(m.cy=y+s)+Math.sqrt(g*g+y*y),t.circle=m;for(var v=null,_=yp._;_;)if(m.y<_.y||m.y===_.y&&m.x<=_.x){if(!_.L){v=_.P;break}_=_.L}else{if(!_.R){v=_;break}_=_.R}yp.insert(v,m),v||(ep=m)}}}}function op(t){var e=t.circle;e&&(e.P||(ep=e.N),yp.remove(e),np.push(e),Uf(e),t.circle=null)}var ap=[];function sp(){Uf(this),this.edge=this.site=this.circle=null}function lp(t){var e=ap.pop()||new sp;return e.site=t,e}function up(t){op(t),dp.remove(t),ap.push(t),Uf(t)}function cp(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,a=t.N,s=[t];up(t);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<vp&&Math.abs(r-l.circle.cy)<vp;)o=l.P,s.unshift(l),up(l),l=o;s.unshift(l),op(l);for(var u=a;u.circle&&Math.abs(n-u.circle.x)<vp&&Math.abs(r-u.circle.cy)<vp;)a=u.N,s.push(u),up(u),u=a;s.push(u),op(u);var c,h=s.length;for(c=1;c<h;++c)u=s[c],l=s[c-1],Zf(u.edge,l.site,u.site,i);l=s[0],(u=s[h-1]).edge=Wf(l.site,u.site,null,i),ip(l),ip(u)}function hp(t){for(var e,n,r,i,o=t[0],a=t[1],s=dp._;s;)if((r=fp(s,a)-o)>vp)s=s.L;else{if(!((i=o-pp(s,a))>vp)){r>-vp?(e=s.P,n=s):i>-vp?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){gp[t.index]={site:t,halfedges:[]}}(t);var l=lp(t);if(dp.insert(e,l),e||n){if(e===n)return op(e),n=lp(e.site),dp.insert(l,n),l.edge=n.edge=Wf(e.site,l.site),ip(e),void ip(n);if(n){op(e),op(n);var u=e.site,c=u[0],h=u[1],f=t[0]-c,p=t[1]-h,d=n.site,g=d[0]-c,y=d[1]-h,m=2*(f*y-p*g),v=f*f+p*p,_=g*g+y*y,b=[(y*v-p*_)/m+c,(f*_-g*v)/m+h];Zf(n.edge,u,d,b),l.edge=Wf(u,t,null,b),n.edge=Wf(t,d,null,b),ip(e),ip(n)}else l.edge=Wf(e.site,l.site)}}function fp(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var a=t.P;if(!a)return-1/0;var s=(n=a.site)[0],l=n[1],u=l-e;if(!u)return s;var c=s-r,h=1/o-1/u,f=c/u;return h?(-f+Math.sqrt(f*f-2*h*(c*c/(-2*u)-l+u/2+i-o/2)))/h+r:(r+s)/2}function pp(t,e){var n=t.N;if(n)return fp(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var dp,gp,yp,mp,vp=1e-6,_p=1e-12;function bp(t,e){return e[1]-t[1]||e[0]-t[0]}function wp(t,e){var n,r,i,o=t.sort(bp).pop();for(mp=[],gp=new Array(t.length),dp=new Yf,yp=new Yf;;)if(i=ep,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(hp(o),n=o[0],r=o[1]),o=t.pop();else{if(!i)break;cp(i.arc)}if(function(){for(var t,e,n,r,i=0,o=gp.length;i<o;++i)if((t=gp[i])&&(r=(e=t.halfedges).length)){var a=new Array(r),s=new Array(r);for(n=0;n<r;++n)a[n]=n,s[n]=Qf(t,mp[e[n]]);for(a.sort((function(t,e){return s[e]-s[t]})),n=0;n<r;++n)s[n]=e[a[n]];for(n=0;n<r;++n)e[n]=s[n]}}(),e){var a=+e[0][0],s=+e[0][1],l=+e[1][0],u=+e[1][1];!function(t,e,n,r){for(var i,o=mp.length;o--;)Jf(i=mp[o],t,e,n,r)&&Kf(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>vp||Math.abs(i[0][1]-i[1][1])>vp)||delete mp[o]}(a,s,l,u),function(t,e,n,r){var i,o,a,s,l,u,c,h,f,p,d,g,y=gp.length,m=!0;for(i=0;i<y;++i)if(o=gp[i]){for(a=o.site,s=(l=o.halfedges).length;s--;)mp[l[s]]||l.splice(s,1);for(s=0,u=l.length;s<u;)d=(p=tp(o,mp[l[s]]))[0],g=p[1],h=(c=$f(o,mp[l[++s%u]]))[0],f=c[1],(Math.abs(d-h)>vp||Math.abs(g-f)>vp)&&(l.splice(s,0,mp.push(Xf(a,p,Math.abs(d-t)<vp&&r-g>vp?[t,Math.abs(h-t)<vp?f:r]:Math.abs(g-r)<vp&&n-d>vp?[Math.abs(f-r)<vp?h:n,r]:Math.abs(d-n)<vp&&g-e>vp?[n,Math.abs(h-n)<vp?f:e]:Math.abs(g-e)<vp&&d-t>vp?[Math.abs(f-e)<vp?h:t,e]:null))-1),++u);u&&(m=!1)}if(m){var v,_,b,w=1/0;for(i=0,m=null;i<y;++i)(o=gp[i])&&(b=(v=(a=o.site)[0]-t)*v+(_=a[1]-e)*_)<w&&(w=b,m=o);if(m){var x=[t,e],L=[t,r],E=[n,r],C=[n,e];m.halfedges.push(mp.push(Xf(a=m.site,x,L))-1,mp.push(Xf(a,L,E))-1,mp.push(Xf(a,E,C))-1,mp.push(Xf(a,C,x))-1)}}for(i=0;i<y;++i)(o=gp[i])&&(o.halfedges.length||delete gp[i])}(a,s,l,u)}this.edges=mp,this.cells=gp,dp=yp=mp=gp=null}wp.prototype={constructor:wp,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return $f(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(o=(i=n.halfedges).length)for(var i,o,a,s,l,u,c=n.site,h=-1,f=e[i[o-1]],p=f.left===c?f.right:f.left;++h<o;)a=p,p=(f=e[i[h]]).left===c?f.right:f.left,a&&p&&r<a.index&&r<p.index&&(l=a,u=p,((s=c)[0]-u[0])*(l[1]-s[1])-(s[0]-l[0])*(u[1]-s[1])<0)&&t.push([c.data,a.data,p.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var l=t-i.site[0],u=e-i.site[1],c=l*l+u*u;do{i=o.cells[r=a],a=null,i.halfedges.forEach((function(n){var r=o.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var l=t-s[0],u=e-s[1],h=l*l+u*u;h<c&&(c=h,a=s.index)}}))}while(null!==a);return o._found=r,null==n||c<=n*n?i.site:null}};Math.SQRT2;function xp(t,e,n){this.k=t,this.x=e,this.y=n}xp.prototype={constructor:xp,scale:function(t){return 1===t?this:new xp(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new xp(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new xp(1,0,0);xp.prototype;var Lp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",Ep="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";function Cp(t){return(Cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pp(t,e,n){return(Pp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Op(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Mp(t,e){return!e||"object"!==Cp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Op(t){return(Op=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ip(t,e){return(Ip=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Np={"":8,"":12,"":14,"":16,"":17},Dp=r.icon({iconUrl:Lp,shadowUrl:Ep,iconSize:[25,41],shadowSize:[41,41],iconAnchor:[13,41],shadowAnchor:[13,41],popupAnchor:[-1,-27]}),Rp=Fe.extend({}),Ap=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ip(t,e)}(s,t);var e,n,i,o,a=(e=s,function(){var t,n=Op(e);if(Tp()){var r=Op(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Mp(this,t)});function s(){return kp(this,s),a.apply(this,arguments)}return n=s,(i=[{key:"create",value:function(){var t=this;return Object.assign(this.options,{el:t.buildUI()}),t._lcmp=new Rp(t.options),t.on("hide",(function(e){t._cleanLocatedItem()}),t),t}},{key:"addTo",value:function(t){return Pp(Op(s.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this._bindEvent(),this}},{key:"getContainerElement",value:function(){return this._lcmp.el}},{key:"onRemove",value:function(){this.mapWrapper.removeControl(this._lcmp),this._cleanLocatedItem(),this._unbindEvent(),Pp(Op(s.prototype),"onRemove",this).call(this)}},{key:"search",value:function(t){var e,n,r=this,i=new BMap.Geocoder,o=r._isCoordinate(t),a=r.mapWrapper.mapCmp;if(o){var s=ie.CRS_CODE,l=ut.Coordinate.BD09,u=a.options.crs.code,c=ut.transform(o.lat,o.lng,s,l);i.getLocation(new BMap.Point(c.lng,c.lat),(function(t){t&&t.address?(r._location=t.address,r._locationLevel=r._getSuitableMapLevel(t.addressComponents)):(r._location=locales.locate.unknownPlace,r._locationLevel=17),e=ut.transform(o.lat,o.lng,s,u),r._updateMarker({latLng:e,displayLatLng:o},!0)}))}else i.getPoint(t,(function(i,o){if(i){r._location=t,r._locationLevel=o.level;var s=ut.Coordinate.BD09,l=a.options.crs.code,u=ie.CRS_CODE;e=ut.transform(i.lat,i.lng,s,l),n=ut.transform(i.lat,i.lng,s,u)}else r._invalidSearch();r._updateMarker({latLng:e,displayLatLng:n},!0)}),t)}},{key:"_bindEvent",value:function(){this.mapWrapper.mapCmp.on("crschange",this._transformCoords,this)}},{key:"_unbindEvent",value:function(){this.mapWrapper.mapCmp.off("crschange",this._transformCoords,this)}},{key:"_transformCoords",value:function(t){if(this.locatedItem){var e=this.locatedItem.getLatLng(),n=ut.transform(e.lat,e.lng,t.oldCrs.code,t.newCrs.code);this._updateMarker({latLng:n,displayLatLng:this.locatedItem._displayLatLng},!1)}}},{key:"_updateMarker",value:function(t,e){var n=this;if(n.locatedItem&&n.locatedItem.remove(),t){var i=n.mapWrapper.mapCmp,o=r.popup({closeOnClick:!1}).setContent("<div>\n        <div><span>".concat(locales.locate.place,": </span><span>").concat(n._location,"</span></div>\n        <div><span>").concat(locales.locate.longitude,": </span><span>").concat(t.displayLatLng.lng,"</span></div>\n        <div><span>").concat(locales.locate.latitude,": </span><span>").concat(t.displayLatLng.lat,"</span></div>\n      </div>"));n.locatedItem=r.marker(t.latLng,{icon:Dp}).bindPopup(o).addTo(i).openPopup(),n.locatedItem._displayLatLng=t.displayLatLng,e&&i.setView(t.latLng,Np[n._locationLevel]||17)}}},{key:"_getSuitableMapLevel",value:function(t){return t.streetNumber?t.street?t.district?t.city?t.province?void 0:Np[""]:Np[""]:Np[""]:Np[""]:Np[""]}},{key:"_invalidSearch",value:function(){delete this._location,delete this._locationLevel;var t=this._getInputEl();t&&Hs(t).style("background","#ff0000").transition().ease(ic).duration(1500).style("background","#ffffff")}},{key:"_cleanLocatedItem",value:function(){this.locatedItem&&(this.locatedItem.remove(),delete this.locatedItem)}}])&&Sp(n.prototype,i),o&&Sp(n,o),s}(xa);function jp(t){return(jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zp(t,e,n){return(zp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qp(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Fp(t,e){return!e||"object"!==jp(e)&&"function"!=typeof e?Gp(t):e}function Gp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Up(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function qp(t){return(qp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hp(t,e){return(Hp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vp(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Yp={position:"topright",header:{iconCls:"fm-icon-legend",title:locales.legend.title},visible:!1,closeButton:!0,hideOnClose:!0,dragable:!0,resizable:!1,body:"",bodyStyle:{maxWidth:"300px",maxHeight:"450px",overflowY:"auto",overflowX:"hidden"}},Wp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hp(t,e)}(l,t);var e,n,r,i,a=(e=l,function(){var t,n=qp(e);if(Up()){var r=qp(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Fp(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),t=t||{},Vp(Gp(e=a.call(this,Object.assign({},Yp,t,{header:Object.assign({},Yp.header,t.header),bodyStyle:Object.assign({},Yp.bodyStyle,t.bodyStyle)}))),"CONTROL_KEY","legend"),Vp(Gp(e),"events",[]),Vp(Gp(e),"layers",{}),e}return n=l,(r=[{key:"addTo",value:function(t){zp(qp(l.prototype),"addTo",this).call(this,t),t.controls[this.CONTROL_KEY]=this,this.onAdd(t)}},{key:"onAdd",value:function(t){}},{key:"bodyHook",value:function(){var t=s.create("table","fm-legend-body");return this.bodyEl=t,t}},{key:"register",value:function(t){if(!t.getStore||!t.getLegends)throw new Error("layer.getStore() and layer.getLegends() are required!");var e=this;e.layers[s.stamp(t)]=t,t.on("storechange",e._update,e),t.on("visiblechange",e._update,e),t.on("remove",e._onLayerRemove,e),this._update()}},{key:"unregister",value:function(t){var e=this,n=e.layers[s.stamp(t)];n&&(n.off("storechange",e._update,e),n.off("visiblechange",e._update,e),n.off("remove",e._onLayerRemove,e),delete e.layers[s.stamp(t)]),this._update()}},{key:"_onLayerRemove",value:function(t){this.unregister(t.target)}},{key:"onRemove",value:function(){delete this.mapWrapper.controls[this.CONTROL_KEY]}},{key:"_update",value:function(){var t,e,n,r,i,a,l,u,c,h,f,p,d,g,y,m,v,_=this,b=_.layers,w=_.bodyEl,x=!0;w.innerHTML="",Object.values(b).forEach((function(b){b.getStore()&&(t=b.getLegends(),e=b.getName(),v=_._calculateCount(b),r=s.create("tr","fm-legend-body-item-row",w),l=s.create("td","fm-legend-body-item-group",r),(c=s.create("input","fm-legend-body-item-group-check",l)).setAttribute("type","checkbox"),(d=s.create("span","fm-legend-body-item-group-label",l)).innerHTML=e,d.title=e,u=s.create("div","fm-legend-body-item-group-collapse-icon",l),b.legendCollapse&&(u.style.transform="rotate(180deg)"),(i=s.create("td","fm-legend-body-item-group-count",r)).innerHTML=v.num.total,a=s.create("td","fm-legend-body-item-group-perc",r),o.on(u,"click",_._onGroupCollExpClick,_),g={delegateEl:l,checkEl:c,countEl:i,percentEl:a,layer:b},Object.assign(l,g,{_children:[]}),Object.assign(c,g),Object.assign(d,g),Object.assign(u,g),o.on(c,"click",_._onGroupClick,_),o.on(d,"click",_._onGroupClick,_),x=!0,Object.keys(t).forEach((function(e){n=t[e],r=s.create("tr","fm-legend-body-item-row",w),b.legendCollapse&&(r.style.display="none"),h=s.create("td","fm-legend-body-item",r),s.create("div","fm-legend-body-list-offset",h),l._children.push(h),(p=s.create("input","fm-legend-body-item-check",h)).setAttribute("type","checkbox"),n.visible?p.setAttribute("checked","checked"):x=!1,f=s.create("div","fm-legend-body-item-color",h),n.icon?(f.style.backgroundImage="url(".concat(n.iconImg?n.iconImg.src:n.icon,")"),f.style.backgroundSize="100%"):f.style.backgroundColor=n.color,(d=s.create("span","fm-legend-body-item-label",h)).innerHTML=e,(y=s.create("td","fm-legend-body-item-group-count",r)).innerHTML=void 0!==v.num[e]?v.num[e]:"-",(m=s.create("td","fm-legend-body-item-group-perc",r)).innerHTML=v.perc[e]?v.perc[e]:"N/A",g={delegateEl:h,checkEl:p,deviceEl:void 0,countEl:y,percentEl:m,rowEl:r,legendKey:e,layer:b},Object.assign(h,g,{_parent:l}),Object.assign(p,g),Object.assign(f,g),Object.assign(d,g),o.on(p,"click",_._onItemClick,_),o.on(f,"click",_._onItemClick,_),o.on(d,"click",_._onItemClick,_)})),c.checked=x)}))}},{key:"_calculateCount",value:function(t){var e=t.getStore(),n=t.getLegends(),r={num:{total:0},perc:{total:""}};for(var i in n)n[i].visible&&(r.num[i]=e.getGroup(i)?e.getGroup(i).getCount():0,r.num.total+=e.getGroup(i)?e.getGroup(i).getCount():0);for(var o in n)n[o],r.num[o]>=0&&(r.perc[o]=(r.num[o]/r.num.total*100).toFixed(2),"NaN"!==r.perc[o]?r.perc[o]+="%":r.perc[o]="N/A");return r}},{key:"_onGroupCollExpClick",value:function(t){var e=t.target,n=e.delegateEl._children;if(e.layer.legendCollapse){for(var r in n)n[r].rowEl.style.display="";e.layer.legendCollapse=!1,Hs(e).transition().duration(300).styleTween("transform",(function(){return function(t){return"rotate("+(180*t+180)+"deg)"}}))}else{for(var i in n)n[i].rowEl.style.display="none";e.layer.legendCollapse=!0,Hs(e).style("transform","rotate(0deg)").transition().duration(300).style("transform","rotate(180deg)")}}},{key:"_onGroupClick",value:function(t){var e=t.target,n=e.delegateEl,r=e.checkEl;r!==e&&(r.checked=!r.checked),n.layer.setVisible(r.checked)}},{key:"_onItemClick",value:function(t){var e=t.target,n=e.delegateEl,r=e.checkEl;r!==e&&(r.checked=!r.checked),n.layer.setVisible(r.checked,n.legendKey)}}])&&Bp(n.prototype,r),i&&Bp(n,i),l}(Oe);function Xp(t){return(Xp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jp(t,e,n){return(Jp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=td(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Qp(t,e){return!e||"object"!==Xp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function td(t){return(td=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ed(t,e){return(ed=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nd,rd,id,od,ad,sd,ld,ud=Fe.extend({}),cd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ed(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=td(e);if($p()){var r=td(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Qp(this,t)});function a(){return Zp(this,a),o.apply(this,arguments)}return n=a,(r=[{key:"create",value:function(){return Object.assign(this.options,{el:this.buildUI()}),this._lcmp=new ud(this.options),this}},{key:"addTo",value:function(t){return Jp(td(a.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}},{key:"getContainerElement",value:function(){return this._lcmp.el}},{key:"destroy",value:function(){this.mapWrapper.removeControl(this._lcmp),this.onRemove()}},{key:"onRemove",value:function(){Jp(td(a.prototype),"onRemove",this).call(this)}}])&&Kp(n.prototype,r),i&&Kp(n,i),a}(Wp),hd={};hd.h337=(nd={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},rd=function(){var t=function(t){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=t.xField||t.defaultXField,this._yField=t.yField||t.defaultYField,this._valueField=t.valueField||t.defaultValueField,t.radius&&(this._cfgRadius=t.radius)},e=nd.defaultRadius;return t.prototype={_organiseData:function(t,n){var r=t[this._xField],i=t[this._yField],o=this._radi,a=this._data,s=this._max,l=this._min,u=t[this._valueField]||1,c=t.radius||this._cfgRadius||e;a[r]||(a[r]=[],o[r]=[]),a[r][i]?a[r][i]+=u:(a[r][i]=u,o[r][i]=c);var h=a[r][i];return h>s?(n?this.setDataMax(h):this._max=h,!1):h<l?(n?this.setDataMin(h):this._min=h,!1):{x:r,y:i,value:u,radius:c,min:l,max:s}},_unOrganizeData:function(){var t=[],e=this._data,n=this._radi;for(var r in e)for(var i in e[r])t.push({x:r,y:i,radius:n[r][i],value:e[r][i]});return{min:this._min,max:this._max,data:t}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0)for(var t=arguments[0],e=t.length;e--;)this.addData(t[e]);else{var n=this._organiseData(arguments[0],!0);n&&(0===this._data.length&&(this._min=this._max=n.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[n]}))}return this},setData:function(t){var e=t.data,n=e.length;this._data=[],this._radi=[];for(var r=0;r<n;r++)this._organiseData(e[r],!1);return this._max=t.max,this._min=t.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(t){return this._max=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(t){return this._min=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(t){this._coordinator=t},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),id=function(){var t=function(t){var e=t.gradient||t.defaultGradient,n=document.createElement("canvas"),r=n.getContext("2d");n.width=256,n.height=1;var i=r.createLinearGradient(0,0,256,1);for(var o in e)i.addColorStop(o,e[o]);return r.fillStyle=i,r.fillRect(0,0,256,1),r.getImageData(0,0,256,1).data},e=function(t,e){var n=document.createElement("canvas"),r=n.getContext("2d"),i=t,o=t;if(n.width=n.height=2*t,1===e)r.beginPath(),r.arc(i,o,t,0,2*Math.PI,!1),r.fillStyle="rgba(0,0,0,1)",r.fill();else{var a=r.createRadialGradient(i,o,t*e,i,o,t);a.addColorStop(0,"rgba(0,0,0,1)"),a.addColorStop(1,"rgba(0,0,0,0)"),r.fillStyle=a,r.fillRect(0,0,2*t,2*t)}return n};function n(e){var n=e.container,r=this.shadowCanvas=document.createElement("canvas"),i=this.canvas=e.canvas||document.createElement("canvas");this._renderBoundaries=[1e4,1e4,0,0];var o=getComputedStyle(e.container)||{};i.className="heatmap-canvas",this._width=i.width=r.width=e.width||+o.width.replace(/px/,""),this._height=i.height=r.height=e.height||+o.height.replace(/px/,""),this.shadowCtx=r.getContext("2d"),this.ctx=i.getContext("2d"),i.style.cssText=r.style.cssText="position:absolute;left:0;top:0;",n.style.position="relative",n.appendChild(i),this._palette=t(e),this._templates={},this._setStyles(e)}return n.prototype={renderPartial:function(t){t.data.length>0&&(this._drawAlpha(t),this._colorize())},renderAll:function(t){this._clear(),t.data.length>0&&(this._drawAlpha(function(t){for(var e=[],n=t.min,r=t.max,i=t.radi,o=t.data,a=Object.keys(o),s=a.length;s--;)for(var l=a[s],u=Object.keys(o[l]),c=u.length;c--;){var h=u[c],f=o[l][h],p=i[l][h];e.push({x:l,y:h,value:f,radius:p})}return{min:n,max:r,data:e}}(t)),this._colorize())},_updateGradient:function(e){this._palette=t(e)},updateConfig:function(t){t.gradient&&this._updateGradient(t),this._setStyles(t)},setDimensions:function(t,e){this._width=t,this._height=e,this.canvas.width=this.shadowCanvas.width=t,this.canvas.height=this.shadowCanvas.height=e},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(t){this._blur=0===t.blur?0:t.blur||t.defaultBlur,t.backgroundColor&&(this.canvas.style.backgroundColor=t.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=t.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=t.height||this._height,this._opacity=255*(t.opacity||0),this._maxOpacity=255*(t.maxOpacity||t.defaultMaxOpacity),this._minOpacity=255*(t.minOpacity||t.defaultMinOpacity),this._useGradientOpacity=!!t.useGradientOpacity},_drawAlpha:function(t){for(var n=this._min=t.min,r=this._max=t.max,i=t.data||[],o=i.length,a=1-this._blur;o--;){var s,l=i[o],u=l.x,c=l.y,h=l.radius,f=Math.min(l.value,r),p=u-h,d=c-h,g=this.shadowCtx;this._templates[h]?s=this._templates[h]:this._templates[h]=s=e(h,a);var y=(f-n)/(r-n);g.globalAlpha=y<.01?.01:y,g.drawImage(s,p,d),p<this._renderBoundaries[0]&&(this._renderBoundaries[0]=p),d<this._renderBoundaries[1]&&(this._renderBoundaries[1]=d),p+2*h>this._renderBoundaries[2]&&(this._renderBoundaries[2]=p+2*h),d+2*h>this._renderBoundaries[3]&&(this._renderBoundaries[3]=d+2*h)}},_colorize:function(){var t=this._renderBoundaries[0],e=this._renderBoundaries[1],n=this._renderBoundaries[2]-t,r=this._renderBoundaries[3]-e,i=this._width,o=this._height,a=this._opacity,s=this._maxOpacity,l=this._minOpacity,u=this._useGradientOpacity;t<0&&(t=0),e<0&&(e=0),t+n>i&&(n=i-t),e+r>o&&(r=o-e);for(var c=this.shadowCtx.getImageData(t,e,n,r),h=c.data,f=h.length,p=this._palette,d=3;d<f;d+=4){var g,y=h[d],m=4*y;m&&(g=a>0?a:y<s?y<l?l:y:s,h[d-3]=p[m],h[d-2]=p[m+1],h[d-1]=p[m+2],h[d]=u?p[m+3]:g)}this.ctx.putImageData(c,t,e),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(t){var e=this.shadowCtx.getImageData(t.x,t.y,1,1).data[3],n=this._max,r=this._min;return Math.abs(n-r)*(e/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},n}(),ld=!1,"canvas2d"===nd.defaultRenderer&&(ld=id),od=ld,ad=function(){for(var t={},e=arguments.length,n=0;n<e;n++){var r=arguments[n];for(var i in r)t[i]=r[i]}return t},sd=function(){var t=function(){function t(){this.cStore={}}return t.prototype={on:function(t,e,n){var r=this.cStore;r[t]||(r[t]=[]),r[t].push((function(t){return e.call(n,t)}))},emit:function(t,e){var n=this.cStore;if(n[t])for(var r=n[t].length,i=0;i<r;i++)(0,n[t][i])(e)}},t}(),e=function(t){var e=t._renderer,n=t._coordinator,r=t._store;n.on("renderpartial",e.renderPartial,e),n.on("renderall",e.renderAll,e),n.on("extremachange",(function(e){t._config.onExtremaChange&&t._config.onExtremaChange({min:e.min,max:e.max,gradient:t._config.gradient||t._config.defaultGradient})})),r.setCoordinator(n)};function n(){var n=this._config=ad(nd,arguments[0]||{});if(this._coordinator=new t,n.plugin){var r=n.plugin;if(!nd.plugins[r])throw new Error("Plugin '"+r+"' not found. Maybe it was not registered.");var i=nd.plugins[r];this._renderer=new i.renderer(n),this._store=new i.store(n)}else this._renderer=new od(n),this._store=new rd(n);e(this)}return n.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(t){return this._config=ad(this._config,t),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(t){return this._store.getValueAt?this._store.getValueAt(t):this._renderer.getValueAt?this._renderer.getValueAt(t):null}},n}(),{create:function(t){return new sd(t)},register:function(t,e){nd.plugins[t]=e}});var fd=hd;function pd(t){return(pd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gd(t,e,n){return(gd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function yd(t,e){return!e||"object"!==pd(e)&&"function"!=typeof e?md(t):e}function md(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _d(t){return(_d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bd(t,e){return(bd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wd={gradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},visible:!0,radius:20,opacity:.7,scaleRadius:!1,useLocalExtrema:!1,maxCount:10,latField:"lat",lngField:"lng",valueField:"count"},xd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bd(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=_d(e);if(vd()){var r=_d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return yd(this,t)});function a(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this,Object.assign({},wd,t)),n=md(e),i=!1,(r="_clickSupport")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e}return n=a,(r=[{key:"uiHook",value:function(){}},{key:"buildCanvas",value:function(){}},{key:"bindStore",value:function(t){gd(_d(a.prototype),"bindStore",this).call(this,t),this._compileData(),this._onStoreBind(t)}},{key:"_compileData",value:function(){var t=this.store,e=[];t.getRows().forEach((function(n){!1!==n._filtered&&e.push({lat:n.compiledLatLng.lat,lng:n.compiledLatLng.lng,count:t.fetch(n,"count")||1})})),this._setDrawData({max:this.options.maxCount,data:e})}},{key:"_storeFiltered",value:function(t){this._compileData(),gd(_d(a.prototype),"_storeFiltered",this).call(this,t)}},{key:"setOpacity",value:function(t){this.getContainerElement().style.opacity=t}},{key:"setVisible",value:function(t){this.getContainerElement().style.display=t?"block":"none",this.options.visible=t}},{key:"setClickable",value:function(t){console.error("[clickable] not supported by heatmap overlay!")}},{key:"_setDrawData",value:function(t){}}])&&dd(n.prototype,r),i&&dd(n,i),a}(wr);function Ld(t){return(Ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ed(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kd(t,e,n){return(kd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Md(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Sd(t,e){return!e||"object"!==Ld(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Md(t){return(Md=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Td(t,e){return(Td=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Od={};!function(t,e,n){if(void 0===fd.h337)throw new Error("heatmap.js must be loaded before the leaflet heatmap plugin");if(void 0===r)throw new Error("Leaflet must be loaded before the leaflet heatmap plugin");e.HeatmapOverlay=function(t,e){void 0===e.Layer&&(e.Layer=e.Class);var n=e.Layer.extend({initialize:function(t){this.cfg=t,this._el=e.DomUtil.create("div","leaflet-zoom-hide"),this._data=[],this._max=1,this._min=0,this.cfg.container=this._el},onAdd:function(n){var r=n.getSize();this._map=n,this._width=r.x,this._height=r.y,this._el.style.width=r.x+"px",this._el.style.height=r.y+"px",this._el.style.position="absolute",this._origin=this._map.layerPointToLatLng(new e.Point(0,0)),n.getPanes().overlayPane.appendChild(this._el),this._heatmap||(this._heatmap=t.create(this.cfg)),n.on("moveend",this._reset,this),this._draw()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._el),t.off("moveend",this._reset,this)},_draw:function(){if(this._map){var t=this._map.getPanes().mapPane._leaflet_pos;this._el.style[n.CSS_TRANSFORM]="translate("+-Math.round(t.x)+"px,"+-Math.round(t.y)+"px)",this._update()}},_update:function(){var t,e,n,r={max:this._max,min:this._min,data:[]};if(t=this._map.getBounds(),e=this._map.getZoom(),n=Math.pow(2,e),0!==this._data.length){for(var i=[],o=this.cfg.scaleRadius?n:1,a=0,s=0,l=this.cfg.valueField,u=this._data.length;u--;){var c=this._data[u],h=c[l],f=c.latlng;if(t.contains(f)){a=Math.max(h,a),s=Math.min(h,s);var p,d=this._map.latLngToContainerPoint(f),g={x:Math.round(d.x),y:Math.round(d.y)};g[l]=h,p=c.radius?c.radius*o:(this.cfg.radius||2)*o,g.radius=p,i.push(g)}}this.cfg.useLocalExtrema&&(r.max=a,r.min=s),r.data=i,this._heatmap.setData(r)}else this._heatmap&&this._heatmap.setData(r)},setData:function(t){this._max=t.max||this._max,this._min=t.min||this._min;for(var n=this.cfg.latField||"lat",r=this.cfg.lngField||"lng",i=this.cfg.valueField||"value",o=t.data,a=o.length,s=[];a--;){var l=o[a],u={latlng:new e.LatLng(l[n],l[r])};u[i]=l[i],l.radius&&(u.radius=l.radius),s.push(u)}this._data=s,this._draw()},addData:function(t){if(t.length>0)for(var n=t.length;n--;)this.addData(t[n]);else{var r=this.cfg.latField||"lat",i=this.cfg.lngField||"lng",o=this.cfg.valueField||"value",a=t,s={latlng:new e.LatLng(a[r],a[i])};s[o]=a[o],this._max=Math.max(this._max,s[o]),this._min=Math.min(this._min,s[o]),a.radius&&(s.radius=a.radius),this._data.push(s),this._draw()}},_reset:function(){this._origin=this._map.layerPointToLatLng(new e.Point(0,0));var t=this._map.getSize();this._width===t.x&&this._height===t.y||(this._width=t.x,this._height=t.y,this._el.style.width=this._width+"px",this._el.style.height=this._height+"px",this._heatmap._renderer.setDimensions(this._width,this._height)),this._draw()}});return n.CSS_TRANSFORM=function(){for(var t=document.createElement("div"),e=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],n=0;n<e.length;n++){var r=e[n];if(void 0!==t.style[r])return r}return e[0]}(),n}(fd.h337,r)}(0,Od);var Id=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Td(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Md(e);if(Pd()){var r=Md(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Sd(this,t)});function a(){return Ed(this,a),o.apply(this,arguments)}return n=a,(r=[{key:"create",value:function(){return kd(Md(a.prototype),"create",this).call(this),this._lcmp=new Od.HeatmapOverlay(this.options),this}},{key:"addTo",value:function(t){return kd(Md(a.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}},{key:"_setDrawData",value:function(t){this._lcmp.setData(t)}},{key:"getContainerElement",value:function(){return this._lcmp._el}},{key:"repaint",value:function(){this._lcmp._draw()}}])&&Cd(n.prototype,r),i&&Cd(n,i),a}(xd);function Nd(t){return(Nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rd(t,e,n){return(Rd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zd(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Ad(t,e){return!e||"object"!==Nd(e)&&"function"!=typeof e?jd(t):e}function jd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function zd(t){return(zd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fd(t,e){return(Fd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gd={isLayer:!0,visible:!0,opacity:.6,simplify:!0,tolerance:1e-5,stroke:"blue",strokeWidth:3,markerStrokeWidth:3,markerStroke:"red"},Ud=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fd(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=zd(e);if(Bd()){var r=zd(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Ad(this,t)});function a(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this,Object.assign({},Gd,t)),n=jd(e),i=!1,(r="_clickSupport")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e}return n=a,(r=[{key:"buildUI",value:function(){this._svg=s.create("svg","fm-drive-container-svg",void 0,"http://www.w3.org/2000/svg"),this._svg.setAttribute("version","1.1"),this._svg.setAttribute("pointer-events","none"),this._svg.style.opacity=this.options.opacity,this._svg.style.display=this.options.visible?"block":"none",this._path=s.create("path","fm-drive-container-path",this._svg,"http://www.w3.org/2000/svg"),this._path.setAttribute("stroke",this.options.stroke),this._path.setAttribute("stroke-width",this.options.strokeWidth),this._path.setAttribute("fill","none"),this._path.style.strokeDasharray="40 20";for(var t,e=[],n=0;n<5;n++)(t=s.create("path","",this._svg,"http://www.w3.org/2000/svg")).setAttribute("d","M -20 -10 L 0 0  L -20 10"),t.setAttribute("stroke-width",this.options.markerStrokeWidth),t.setAttribute("stroke",this.options.markerStroke),t.setAttribute("fill","none"),e.push(t);return this._markers=e,this._svg}},{key:"unbindStore",value:function(){this.store.off("refresh",this.repaint,this),this.store.off("filter filtercancel",this._storeFiltered,this)}},{key:"bindStore",value:function(t){this.store&&(this.store.onUnbind(this),this.unbindStore()),t.onBeforeBind(this),this.store=t,t.on("refresh",this._storeRefresh,this),t.on("filter filtercancel",this._storeFiltered,this),t.onBind(this),this._onStoreBind(t)}},{key:"_onStoreBind",value:function(t){this._storeRefresh(),this.fire("storechange",{store:t})}},{key:"_storeRefresh",value:function(){this.options.simplify&&this._simplify(),this.repaint()}},{key:"_simplify",value:function(){var t=this.store,e=[];t.getRows().forEach((function(t){e.push([t.compiledLatLng.lng,t.compiledLatLng.lat])})),this.simplified=ut.simplify(e,this.options.tolerance)}},{key:"getStore",value:function(){return this.store}},{key:"onDraw",value:function(t){var e=this,n=this.store;if(this.options.visible&&this.store){var r,i="";e.options.simplify?e.simplified.forEach((function(t,n){r=e.latLngToPoint({lat:t[1],lng:t[0]}),0===n?i="M".concat(r.x," ").concat(r.y," L"):i+=" ".concat(r.x," ").concat(r.y)})):n.getRows().forEach((function(t,n){r=e.latLngToPoint(t.compiledLatLng),0===n?i="M".concat(r.x," ").concat(r.y," L"):i+=" ".concat(r.x," ").concat(r.y)})),e._path.setAttribute("d",i);var o=this._path.getTotalLength()/200;e._markers.forEach((function(t,e){t.style.offsetPath="path('".concat(i,"')"),t.style.animation="drive-marker".concat(e," ").concat(Math.max(o,2),"s linear normal infinite")}))}}},{key:"setData",value:function(t,e){this.bindStore(new cr(t,e))}},{key:"setVisible",value:function(t){Rd(zd(a.prototype),"setVisible",this).call(this,t),this.repaint()}},{key:"setClickable",value:function(t){console.error("[clickable] not supported by drive overlay!")}},{key:"_compressData",value:function(t){return t}},{key:"latLngToPoint",value:function(t){}}])&&Dd(n.prototype,r),i&&Dd(n,i),a}(zn);function qd(t){return(qd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yd(t,e,n){return(Yd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zd(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Wd(t,e){return!e||"object"!==qd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xd(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Zd(t){return(Zd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kd(t,e){return(Kd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jd=r.Class.extend({initialize:function(t){return r.setOptions(this,t),this._container=t._container,r.stamp(this),t.callback&&(this._scope=t.callback.scope||this,this.onDraw=t.callback.onDraw,this.onOpDraw=t.callback.onOpDraw),this},addTo:function(t){this._map=t;var e=t.getSize();return this._container.style.width=e.x,this._container.style.height=e.y,t._panes.markerPane.appendChild(this._container),this.onAdd(t),this._map.on("unload",this.remove,this),this},remove:function(){var t=this._map;t._panes.markerPane.removeChild(this._container),t.off("moveend",this._reset,this),t.off("resize",this._resize,this),t.off("unload",this.remove,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},onAdd:function(t){this._initStyle(),this.setVisible(this.options.visible),t.on("moveend",this._reset,this),t.on("resize",this._resize,this),t.options.zoomAnimation&&r.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},_initStyle:function(){},setVisible:function(t){this._container.style.display=t?"block":"none",this.options.visible=t},_resize:function(t){this._container.style.width=t.newSize.x,this._container.style.height=t.newSize.y},_reset:function(){this.mapBounds=this._map.getBounds();var t=this._map.containerPointToLayerPoint([0,0]);r.DomUtil.setPosition(this._container,t),this._redraw()},isLatLngInView:function(t,e){if(!this.mapBounds)return!1;var n=this.mapBounds;return e&&(n=r.latLngBounds(n.getSouthWest(),n.getNorthEast())).extend({lat:n.getSouthWest().lat-e,lng:n.getSouthWest().lng-e}).extend({lat:n.getNorthEast().lat+e,lng:n.getNorthEast().lng+e}),n.contains(t)},_redraw:function(){var t=this._map.getSize(),e=this._map.getBounds(),n=180*t.x/(20037508.34*(e.getEast()-e.getWest())),r=this._map.getZoom(),i={north:e.getNorth(),south:e.getSouth(),west:e.getWest(),east:e.getEast()};this.onDraw&&this.onDraw.call(this._scope,{el:this._container,bounds:i,size:t,zoomScale:n,zoom:r}),this._frame=null},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._getCenterOffset(t.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());r.DomUtil.setTransform(this._container,n,e)},_latLngToPixelXY:function(t,e){var n=Math.PI/180,r=4*Math.PI,i=Math.sin(t*n);return{x:(e+180)/360*256,y:256*(.5-Math.log((1+i)/(1-i))/r)}},_getProjectionOffset:function(t){return"BD09"===this._map.options.crs.code?this._map.project(t,0):this._latLngToPixelXY(t.lat,t.lng)},getZoomDistance:function(){return this._map.getMaxZoom()-this._map.getZoom()}}),Qd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kd(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Zd(e);if(Xd()){var r=Zd(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Wd(this,t)});function a(){return Hd(this,a),o.apply(this,arguments)}return n=a,(r=[{key:"create",value:function(){return Object.assign(this.options,{_container:this.buildUI(),callback:{onDraw:this.onDraw,scope:this}}),this._lcmp=new Jd(this.options),this}},{key:"addTo",value:function(t){return Yd(Zd(a.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}},{key:"_setDrawData",value:function(t){this._lcmp.setData(t)}},{key:"getContainerElement",value:function(){return this._lcmp._container}},{key:"repaint",value:function(){this._lcmp._redraw()}},{key:"latLngToPoint",value:function(t){return this.mapWrapper.mapCmp.latLngToContainerPoint(t)}},{key:"setOpacity",value:function(t){Yd(Zd(a.prototype),"setOpacity",this).call(this,t),this._svg.style.opacity=t}},{key:"setVisible",value:function(t){Yd(Zd(a.prototype),"setVisible",this).call(this,t),this._svg.style.display=t?"block":"none"}}])&&Vd(n.prototype,r),i&&Vd(n,i),a}(Ud),$d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsSAAALEgHS3X78AAAQUUlEQVR4Ae1dW5Ac11n+z6V7emZnV7srrbS6oLuDrdhGjhPia2Jjl1MYC6cqyBCKwoGQ2oRKHlx5JlU8AE8UL9yGlIsKPECASgriVCVUkRAqiFQgRjaOI4RkSbYirS6rvc3OznSfC/Wfc3p2LMXWZbt7ekbnqzrbM7PdZ6bP/53v/8/pcwEPDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PD4/hQKPRqDcaDX47m5OU4DfkgkajEQFAvSehocdv8LsWAEAAQDNNMzMz7QErghvC0BDAGRwNvMkds67ZwhHjMh6HhRADTQAn39Mu1Qv+elSGWUwzMzOi4O/ODANJgEajMd5j+DIgJcJCSX7PDWOgCOAMv/smfHnRQAKcHiQiDAQBMFoHgP0lNvzVQAKcmJmZaZbrZ12LUhPA+Xis8TtK8HNuBWedIpQ2RigtARqNBkbzd+YQzRcNNP6xmZmZy2X8caUjwBDU+ndCKdWgVARwbfm7+9CkKwoYE7xWpj6E0hDABXoHh0DyrwdUgKNlCRBLQYBGozHt/H3u0C6BJqT7GgAo/iFak+IKBeOC2WK+6p3RdwLkaXw0rtKECJtoognF1/az9N5JlwaUgGagNSNaB0SrgGrNiVbMESMH9J0EfSVAXsZHI3cUpR1FWUcRFmtKhaJofCo1oUgAhfX9bbevUQU0JZYADAlgSKBUSJSMqJIVat9nXGh9JUHfCJC18bEOo9FXJeWrirG2ojxWlCWKYs1nUtO09lNlLE9QHWh6PQGtCQFNnAJQohXWfo5GJ0qFhgBIBClqTImIKqMMGf38vpGgLwRwAd/7s8jLGZ41JeMtyfiqZBzfx4ryRFEmrOGRAM74hGpta7+2Xp8QK/HaqIAjAbXSrzhRitmaL1EJKlSJiElRZVLU8UiVzIgI/9WPwLBwArim3vuziPZjTeiy4HxFsqAlWdC2xuexYswZn0lX+6UiVAEa36oA9ASAKUwAaMhgjU+7SqAkp0riEZUgNApgSTDCZDLKRFJlSq6zMIUjQaFNxEIJ4Dp5Dq63nY/+e0UytiR42BQ8wFrfVjSIJUPj80RTJhTlzvCGAEoTpkzkb0lgWwCke//2hfmPpvaoUhVgRElGtbREkJYEVCaoBlUmkxEuDAnGuEz4+tSg6ZqIhXUWFd3m3r1e4yeaEDT8kuDBiuBhS7GggzVfsgBlX2hmpF9aAjAb9FEn/YRqW8dplwDOXMQZLlUAunZEAihmpV5wymRCpYgpYzEeXawRcww4BRsPRIxu4RZvr+7K6MR6yuhmUJgCuL79u9eTR1tRupDwcEnyEI2/amSfhx2s9YoFCRLAJIa1ninnAqzxuyQwSp/Wfjyiz3dfoYlTAacESABJiVLUqACSwLgDEVAlUAVCKkWFyaTKRFJjMh7lSYwkwPhgHYX7WlHPDgohgJP+B9ajOC1J2bwIsOZXTM2XPGybWs+DRBq/HwjFDAGs4a0LwNe6G/w5BQBCXc2/+v61CwiVI4GiYI1vlIAqYdwBUQJdQUBlEjCFJEgiJkwaWSNBZ4wLQa8NNW4E6AK+V4QrKMoF7F6f8Rm7kvDKkggqza7xOfr8MDY13yQujQugXHUVgLCUAM74zv8b6e+qgIXrBbSuwBAAjU5M7TcqICVywCoAKoswMYaWTDGrMlf3MWCn0iiXt2JEXpQryF0BsmjyxYrQk6u1saUkiFoiCNuKhR1HgNT4QrHA+n1mFMAktUYA1wKgzss7NwDG5E76wTYMXH9ANwZQ0gaEypCAWjcgnApgSgIqRchkHKIKUBlXuYg3hnHrjtrK4jqbiLk3DYtQgP3rzSCkWu2odJovt6v1VfT5koUdxcNEGtlPE0o+Gt8ogNKEqx4X0KsAhgRgOwJ6u4JtSKhT46NGKEooqoGkYI1PtZKKKqaIMvmlxFJWO4hmBCIm43211lIG/QNYdkfXW37vhlwVwI3hO5hVfpfjSuXI3KY9LRFEseKhcPIv09qvmCWAVQBDAK2JIwDtIQA4AvS4ALKmAljzoRsDGDewpgIuDqBU4jFhayqQBFQk42Fn8YnNF96oUKkyuu2jeY4xzFsBdmeZ2aaw0/nAxJUz37q49UAiWWhrPg+kpoExvm36cVvrKUuP1yqA6Qp2TX+XefedUwBtCaANAahEEmji8iBE4B9Npe1XcH1INSZaj01dPJWh8cGVYW4qwPLKuGcEb6YY5UJsCJKlk8vj2xIVREKxEBVAaaMEodKcaxMHsEBrip8bVdBAudYmMf12guD/UCEYWMXAOMERxqmGaTW4oyGOiyXMG8unGhPNX9x+5tURLm61D+CdEB06dGjhpZdeyqWHME8FyG3M/q5ac+XxLeeOfuPHux8y8q9N7Q+s76ddN2Dln3ZrvzOiaQG4eL/bBUDskyAr/dp4czwqQoiJAbD2UySDolQTic+VXCtCQo0lSx/dcerlOk/yarZNu5HGmYPmkWnPjJ3csK++uPzk1re+h+5cKusCpGah1AyJEGhlgkEkglEHrcznXDu1UIqFv/JQfdvvf3ziTpXQSEoaKoXJXm+vdUdLLm6UxuYb2O+hQUTVynO7jh8ZC+Ikx9udzmsSay4EKGrGzk+PXVn8yLZT3yGaatU1DhqcWuNZw3NtO4dQ6gPXSuBKUv7JnxvZ9fEPjfyUbOuqSqCiJDNuAt2G1j0k0I5I7r1VHMYjqpZ+de8Pv70h7ORp/BS5lOlAEwDx3vHL8z+/48Q/EyDKGS6t+V3Dq/QzZT/D9NTPVDYd3BtsqEeEfeqp+lYVk1BJCHVKAtWNGYxqGCL1fB4xufjrd7zyjYmwHRd0q4NBgJ5p2YXh3skLc0/vPP41dMhdw6HBAOMAtmZIjTECKgIJPv1UbXv6+1742OhWFUNFCxIqRYJusGgVpadZafOKqJz/zff84J8mK6tFGR9Rd2WbKfJQgL5M37pv47nLz+w89hUKRKz1BJravhb1u/f7NvPaY/eE3d+5bSMLDj9anVCCBEoSdA9p6yC9ttt6iJic++Rd3/+HjVGr04fbzLxs8yDAphzyvCHcP3X24i/s/uHfUgLCtQDWiIDNPDSoIvx3nqtdM+nk08/UNulYB1pAAJpwRxjW02zkEROXP3XgP/5mKlrph/Ehj7IdGgVI8bOb37zwzK7X/poCSVwnEBqeWkknbN8WWvvoA+HkNdfdFVbv38/rSAAlwSgFdBWAsCoTF2fe+92/2lxt9nNSR7kVwPmovk/seGD69OyhPa/+JQWIrRGRBIRpBewTj4emFmmdDhu3CV9/9tnahE5QBXSA56bXVZm4MHPPv724pbbc7xk9POs4IGsFKM2Urge3vnH+0N5XvkhBd0xHkCR0YoSGv/FkZSMaPFEArRig2bEJXz/7aDS6dwuLtCAcFKoAoRETs5+591//Yrq2VJbpXJmW8dASAPHwthPnDu195c8ZQRIAe+FQZSqqELrcAbjSAji3BHBmHuDkHMDxSwCzywC//FhlA6qAEsCrNL7wmXu+9WfTI4urJbidFJ4AN4NHth//8dN7XvlT0IQ996FgcjUBiDjA9CjAHZsA7tkKcN92gH0brRI8/MHq2GgAlVB15j6298iL41Ffff5PQqZlnLW/Lt3ETqUIuXfq9OzjDx04Nlmv31UNAM7OA/z9ywCvn7fnHNgKcPh9AAe2AGwaIeTphxl59fVj31kRUFmJeYDP9zGM7Pe9OGRaxlkbrHRLuEggsNCpRL/94fEPo/H/6F9s6sU3X7efvfCETV94vjb5+OcrO99qjc1NJ52lsUqSVKgsCwEyLeO8uoJLAaz9qypgzx9+8vmxGp/83a9fa/xe4P/wnD2bg+gLn9jz4LwemboU10Y6wHFG4FAuqjnUBMDaP59Elf07Jp5GuX/x369/DZ6DLuK5R8Z3LUJ16nw8OoF5yCFdVHVoCWBqvwzYB++/7wMBp1X0+TeKF48A1CuUP3Hf5J1zSXXzxfbICOY1jCqQGQFKt+gyA1iVnEe1+i58mwZ8N4L03C1jlan5pLrlUlzbgHnlN36qf8hSAUpFAKkItCVnnAdjt5rHSESjjmKjLRFGmJfMemWAEiAzApRx8WQcsvWjs81z+HrHTcTO6bn//VbcVmaGkRtKNoQY6iAQB/x9//jcW/j68P03fl167g9OdZrUTALRqmf+4FBhaAnAqIaICbm4vDR/5P+a//vAHoAH917/OjwHz/3KyysLCy2xUqFyucbjNubF6PBxYHgVQAJUmRBTYWvxD776xldbsUq++GvvTgL8H56z3Fbq8383dyak4spE2J7FPDAvyHrAdwmQNQFKs0o2dt1WWSI3RysrqjV/5rNfevMfcT7fl38L4A9/CeAjB2wX8I4J+xo/w/8RUOrZP7l4cqmVXKnz+PzmcOUC5oF5laQ7ONMyzmNXjdKAgYYJ3u7srC1e/p8zs/95+I+V/txTWx49/L6Raez7vxoo+7/39YWzpy+1L40GndPTUfMUXot5sFua5Z0LMi3jrAnQ7OeQsKthVIAkcnu0vNxR/M3j8wCf+1JrbsfU6L6H76jv2jbB6zgB7MwVEX/7R63FNy7Fi1b24/No/PfUr7yJ11Z5gusDlIUBmc4WzoMApUJAlJ4IV+O9APMVitPKOksXF9uzXz6yfLIj2KgiNMDfS7VKJkO5jD5/c2Xlws7q4mU0Pl6LeZTonjwBbhYBVXqishpHTCxMVlZXL7ZHrlyKa+ewg0e6FcOwqYfRPgZ86PNR9rHml8z4kHUZZ9650Wg0Hinrgs/Yl48PdbBff1Vz3k44Szt4sJ0fBUJWiRAY8KHPL9EYgBRiZmbmu1lmmIehFsoUB/TCjA0GDQxiWWexlMHb+W/a+RLKaPgUmbey8iDA5bISIIUxsMbFoa+ysy59z0jmK4flcbsDt3XaACHzss2cAO6hUOl3yxpA5LJ9bV6C1/eNEIYQuZSpJ8DgYHAI4Fa49CTIDrntT5xnzOsJkB1yK8vcCODWtvMtgvVjIc91AvNu9Z7OOf/bAbmWYa4E8CqwbuRa+6Ggfq/CNj8YQuRedrkTwK12fTbv7xlCnC1iE6mier5Pl220UMkhioqfCiGAa8MeK+K7hgTHito4qrBnX24PHO8Kro+zRe0XBH14+HnaPyh6VzSLbjoXSgAna6/5eOAnQrjdwgotm8KHP7hHmrlugzKgONqP+ZV9Gf/imjc+KFzDsX7sGwzDun38gOH23D4+xW1Ogr4aH8pAALh9SdB340NZCABrG0weLOucggwhXMBXiuZwqVa9cAsh313GFUczQtM19Uqzmkrplj1xi03hdnPXrOk/4MBe0NNFt/Ovh9Kue+O2m79zCFyCcP6+sO7dm0GpFz4aAjUoZa3vxUCsfOUCxP1lXIv4HYCjeE6UJdB7NwzU0mc929GWlQgLrsYPzDC4gVz7zhFhusj9Ca+DWTd2f+DGPw704oc9W9RO96Hp2Owx/MA+3Rya1S9dH8K4m5o+ntMCWAtuivZCGVdGvRUM5xrob9/BNE38JmKHBWfwZpqGxeAeHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4ewwkA+H/OSyKd82sYfAAAAABJRU5ErkJggg==";function tg(t){return(tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ng(t,e,n){return(ng="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ag(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function rg(t,e){return!e||"object"!==tg(e)&&"function"!=typeof e?ig(t):e}function ig(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function og(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ag(t){return(ag=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sg(t,e){return(sg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lg(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ug={position:"topleft",visible:!0,closeButton:!0,hideOnClose:!0,dragable:!0,resizable:!0,header:{iconCls:"fm-icon-streetview",title:locales.streetview.baidu_title},bodyId:void 0,bodyStyle:{padding:"0 0 4px 0",backgroundColor:"rgb(48,65,86)",width:"450px",height:"600px"},markerIcon:$d,body:void 0},cg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sg(t,e)}(l,t);var e,n,r,i,a=(e=l,function(){var t,n=ag(e);if(og()){var r=ag(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return rg(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),t=t||{},lg(ig(e=a.call(this,Object.assign({},ug,t,{header:!1!==t.header&&Object.assign({},ug.header,t.header),bodyStyle:Object.assign({},ug.bodyStyle,t.bodyStyle)}))),"initialized",!1),lg(ig(e),"panoValid",!1),lg(ig(e),"pickerEnabled",!1),lg(ig(e),"enabled",!1),lg(ig(e),"firstPositionEvent",!1),e}return n=l,(r=[{key:"bodyHook",value:function(){var t=s.create("div","fm-baidu-street-pano-container");return t.id="baiduPanorama",this.infoEl=s.create("aside","fm-baidu-street-pano-info",t),this.infoEl.innerHTML=locales.streetview.default_msg,this.switchButton=s.create("div","fm-baidu-street-switch",t),this.switchButton.title=locales.streetview.picker,o.on(this.switchButton,"click",this.switchPicker,this),this.tileSwitchButton=s.create("div","fm-baidu-street-switch-tile",t),this.tileSwitchButton.title=locales.streetview.tile_switch,o.on(this.tileSwitchButton,"click",this.switchTile,this),t}},{key:"onAdd",value:function(t){if(ng(ag(l.prototype),"onAdd",this).call(this,t),!window.BMap)throw new Error("BMap.Panorama not found!");return this.panorama=new window.BMap.Panorama("baiduPanorama"),this.panorama.parentCmp=this,this.panorama.addEventListener("position_changed",this._panoChange,this),this.panorama.addEventListener("pov_changed",this._panoChange,this),this.panoService=new window.BMap.PanoramaService,this}},{key:"getStreetTile",value:function(){}},{key:"_panoChange",value:function(t){var e=t.target,n=e.parentCmp;n.firstPositionEvent&&"onposition_changed"===t.type&&setTimeout((function(){e.setPov({heading:0,pitch:0}),n.firstPositionEvent=!1}),0),n._updateMarker({lng:t.target.getPosition().lng,lat:t.target.getPosition().lat,heading:t.target.getPov().heading})}},{key:"_onBaseMapChange",value:function(t){}},{key:"onMapClick",value:function(t){var e=this,n=e.panorama,r=e.infoEl;n.hide();var i=new window.BMap.Point(t.latlng.lng,t.latlng.lat);e.disablePicker(),e.setVisible(!0),r.innerHTML=locales.streetview.requesting,e.panoService.getPanoramaByLocation(i,(function(t){null===t?(r.innerHTML=locales.streetview.not_found,e.hideTracker(),e.panoValid=!1):(e.panoValid=!0,r.innerHTML=locales.streetview.initializing,n.show(),e.firstPositionEvent=!0,n.setPosition(i),e.showTracker(),e.initialized=!0)}))}},{key:"isEnabled",value:function(){return this.enabled}},{key:"enable",value:function(){this.showTracker(),this.enableTile(),this.setVisible(!0),this.enabled=!0}},{key:"reloadTile",value:function(){this.disableTile(),this.enableTile()}},{key:"enablePicker",value:function(){this.mapWrapper.grabClickEvent(this.onMapClick,this),s.addClass(this.mapWrapper.mapEl,"street-picker"),s.addClass(this.switchButton,"fm-baidu-street-switch-selected"),this.pickerEnabled=!0}},{key:"switchPicker",value:function(){this.pickerEnabled?this.disablePicker():this.enablePicker()}},{key:"disable",value:function(){this.disablePicker(),this.setVisible(!1),this.hideTracker(),this.disableTile(),this.enabled=!1}},{key:"disablePicker",value:function(){this.mapWrapper.releaseGrabbed(),s.removeClass(this.mapWrapper.mapEl,"street-picker"),s.removeClass(this.switchButton,"fm-baidu-street-switch-selected"),this.pickerEnabled=!1}},{key:"showTrakcer",value:function(){}},{key:"hideTracker",value:function(){}},{key:"_beforeHide",value:function(){this.disable()}},{key:"switchTile",value:function(){this.tileEnabled?this.disableTile():this.enableTile()}},{key:"enableTile",value:function(){s.addClass(this.tileSwitchButton,"fm-baidu-street-switch-tile-selected"),this.mapWrapper.addTileLayer(this.getStreetTile()),this.tileEnabled=!0}},{key:"disableTile",value:function(){s.removeClass(this.tileSwitchButton,"fm-baidu-street-switch-tile-selected"),this.mapWrapper.removeTileLayer(this.getStreetTile()),this.tileEnabled=!1}}])&&eg(n.prototype,r),i&&eg(n,i),l}(Oe);function hg(t){return(hg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function dg(t,e,n){return(dg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vg(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function gg(t,e){return!e||"object"!==hg(e)&&"function"!=typeof e?yg(t):e}function yg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function vg(t){return(vg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _g(t,e){return(_g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bg(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var wg=r.Marker.extend({setScale:function(t){this.options.scale=t},setRotate:function(t){this.options.rotate=t},_setPos:function(t){this.setScale(1),this._icon&&s.setPosition(this._icon,t,this.options.scale,this.options.rotate),this._shadow&&s.setPosition(this._shadow,t,this.options.scale,this.options.rotate),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()}}),xg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_g(t,e)}(s,t);var e,n,i,o,a=(e=s,function(){var t,n=vg(e);if(mg()){var r=vg(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return gg(this,t)});function s(){var t;fg(this,s);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return bg(yg(t=a.call.apply(a,[this].concat(n))),"markerAppended",!1),bg(yg(t),"trakcerVisible",!0),bg(yg(t),"tileLayer",void 0),t}return n=s,(i=[{key:"create",value:function(){return Object.assign(this.options,{el:this.buildUI()}),this._lcmp=new Fe(this.options),this}},{key:"_updateMarker",value:function(t){this.markerAppended?(this._lmarker.setRotate(t.heading),this._lmarker.setLatLng([t.lat,t.lng])):(this._lmarker=new wg([t.lat,t.lng],{opacity:1,rotate:t.heading,interactive:!1,bubblingMouseEvents:!0,icon:r.icon({iconUrl:this.options.markerIcon,iconSize:[128,128],iconAnchor:[64,64]})}).addTo(this.mapWrapper.mapCmp),this._lmarker._icon.style.transformOrigin="center center",this.markerAppended=!0)}},{key:"addTo",value:function(t){return dg(vg(s.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}},{key:"getContainerElement",value:function(){return this._lcmp.el}},{key:"showTracker",value:function(){this.panoValid&&this._lmarker&&(this._lmarker._icon.style.display=""),this.trackerVisible=!0}},{key:"hideTracker",value:function(){this.panoValid&&this._lmarker&&(this._lmarker._icon.style.display="none"),this.trackerVisible=!1}},{key:"destroy",value:function(){this.mapWrapper.removeControl(this._lcmp),this.markerAppended&&this.mapWrapper.mapCmp.remove(this._lmarker),this.onRemove()}},{key:"getStreetTile",value:function(){return this.tileLayer||(this.tileLayer=new K({tile:"baidu.streetonly"}).create()),this.tileLayer}},{key:"onRemove",value:function(){dg(vg(s.prototype),"onRemove",this).call(this)}}])&&pg(n.prototype,i),o&&pg(n,o),s}(cg);function Lg(t){return(Lg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Eg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cg(t,e,n){return(Cg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mg(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function kg(t,e){return!e||"object"!==Lg(e)&&"function"!=typeof e?Sg(t):e}function Sg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Mg(t){return(Mg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tg(t,e){return(Tg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Og(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ig={position:"topleft",visible:!0,closeButton:!0,hideOnClose:!0,dragable:!0,resizable:!0,header:{iconCls:"fm-icon-streetview",title:locales.streetview.google_title},bodyId:void 0,bodyStyle:{padding:"0 0 4px 0",backgroundColor:"rgb(48,65,86)",width:"450px",height:"600px"},markerIcon:$d,body:void 0};function Ng(t){return(Ng="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ag(t,e,n){return(Ag="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Fg(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function jg(t,e){return!e||"object"!==Ng(e)&&"function"!=typeof e?Bg(t):e}function Bg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Fg(t){return(Fg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gg(t,e){return(Gg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ug(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var qg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gg(t,e)}(s,t);var e,n,i,o,a=(e=s,function(){var t,n=Fg(e);if(zg()){var r=Fg(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return jg(this,t)});function s(){var t;Dg(this,s);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Ug(Bg(t=a.call.apply(a,[this].concat(n))),"markerAppended",!1),Ug(Bg(t),"trakcerVisible",!0),Ug(Bg(t),"tileLayer",void 0),t}return n=s,(i=[{key:"create",value:function(){return Object.assign(this.options,{el:this.buildUI()}),this._lcmp=new Fe(this.options),this}},{key:"_updateMarker",value:function(t){this.markerAppended?(this._lmarker.setRotate(t.heading),this._lmarker.setLatLng([t.lat,t.lng])):(this._lmarker=new wg([t.lat,t.lng],{opacity:1,rotate:t.heading,interactive:!1,bubblingMouseEvents:!0,icon:r.icon({iconUrl:this.options.markerIcon,iconSize:[128,128],iconAnchor:[64,64]})}).addTo(this.mapWrapper.mapCmp),this._lmarker._icon.style.transformOrigin="center center",this.markerAppended=!0)}},{key:"addTo",value:function(t){return Ag(Fg(s.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}},{key:"getContainerElement",value:function(){return this._lcmp.el}},{key:"showTracker",value:function(){this.panoValid&&this._lmarker&&(this._lmarker._icon.style.display=""),this.trackerVisible=!0}},{key:"hideTracker",value:function(){this.panoValid&&this._lmarker&&(this._lmarker._icon.style.display="none"),this.trackerVisible=!1}},{key:"destroy",value:function(){this.mapWrapper.removeControl(this._lcmp),this.markerAppended&&this.mapWrapper.mapCmp.remove(this._lmarker),this.onRemove()}},{key:"onRemove",value:function(){Ag(Fg(s.prototype),"onRemove",this).call(this)}},{key:"getStreetTile",value:function(){return this.tileLayer||(this.tileLayer=new K({tile:"google.streetonly"}).create()),this.tileLayer}}])&&Rg(n.prototype,i),o&&Rg(n,o),s}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tg(t,e)}(l,t);var e,n,r,i,a=(e=l,function(){var t,n=Mg(e);if(Pg()){var r=Mg(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return kg(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),t=t||{},Og(Sg(e=a.call(this,Object.assign({},Ig,t,{header:!1!==t.header&&Object.assign({},Ig.header,t.header),bodyStyle:Object.assign({},Ig.bodyStyle,t.bodyStyle)}))),"initialized",!1),Og(Sg(e),"panoValid",!1),Og(Sg(e),"pickerEnabled",!1),Og(Sg(e),"enabled",!1),Og(Sg(e),"firstPositionEvent",!1),e}return n=l,(r=[{key:"bodyHook",value:function(){var t=s.create("div","fm-google-street-pano-container");return t.id="panorama",this.infoEl=s.create("aside","fm-google-street-pano-info",t),this.infoEl.innerHTML=locales.streetview.default_msg,this.switchButton=s.create("div","fm-google-street-switch",t),this.switchButton.title=locales.streetview.picker,o.on(this.switchButton,"click",this.switchPicker,this),this.tileSwitchButton=s.create("div","fm-google-street-switch-tile",t),this.tileSwitchButton.title=locales.streetview.tile_switch,o.on(this.tileSwitchButton,"click",this.switchTile,this),t}},{key:"onAdd",value:function(){if(Cg(Mg(l.prototype),"onAdd",this).call(this),!window.google)throw new Error("Google Street View not found!");return this.panorama=new window.google.maps.StreetViewPanorama(document.getElementById("panorama"),{visible:!1}),this.panorama.parentCmp=this,this.panorama.addListener("position_changed",this._panoChange,this),this.panorama.addListener("pov_changed",this._panoChange,this),this.panoService=new window.google.maps.StreetViewService,this}},{key:"getStreetTile",value:function(){}},{key:"_panoChange",value:function(){var t=this.parentCmp,e=this.position,n=this.pov;t._updateMarker({lng:e.lng(),lat:e.lat(),heading:n.heading})}},{key:"onMapClick",value:function(t){var e=this,n=e.panorama,r=e.infoEl;r.innerHTML=locales.streetview.requesting,n.setVisible(!1);var i=t.latlng;e.disablePicker(),e.setVisible(!0),e.panoService.getPanorama({location:i},(function(t,o){console.log(t,o),null===t?(r.innerHTML=locales.streetview.not_found,e.hideTracker(),e.panoValid=!1):(e.panoValid=!0,r.innerHTML=locales.streetview.initializing,n.setVisible(!0),e.firstPositionEvent=!0,n.setPosition(i),e.showTracker(),e.initialized=!0)}))}},{key:"isEnabled",value:function(){return this.enabled}},{key:"enable",value:function(){this.showTracker(),this.enableTile(),this.setVisible(!0),this.enabled=!0}},{key:"reloadTile",value:function(){this.disableTile(),this.enableTile()}},{key:"enablePicker",value:function(){this.mapWrapper.grabClickEvent(this.onMapClick,this),s.addClass(this.mapWrapper.mapEl,"street-picker"),s.addClass(this.switchButton,"fm-google-street-switch-selected"),this.pickerEnabled=!0}},{key:"switchPicker",value:function(){this.pickerEnabled?this.disablePicker():this.enablePicker()}},{key:"disable",value:function(){this.disablePicker(),this.setVisible(!1),this.mapWrapper.removeTileLayer(this.getStreetTile()),this.hideTracker(),this.enabled=!1}},{key:"disablePicker",value:function(){this.mapWrapper.releaseGrabbed(),s.removeClass(this.mapWrapper.mapEl,"street-picker"),s.removeClass(this.switchButton,"fm-google-street-switch-selected"),this.pickerEnabled=!1}},{key:"showTrakcer",value:function(){}},{key:"hideTracker",value:function(){}},{key:"_beforeHide",value:function(){this.disable()}},{key:"switchTile",value:function(){this.tileEnabled?this.disableTile():this.enableTile()}},{key:"enableTile",value:function(){s.addClass(this.tileSwitchButton,"fm-google-street-switch-tile-selected"),this.mapWrapper.addTileLayer(this.getStreetTile()),this.tileEnabled=!0}},{key:"disableTile",value:function(){s.removeClass(this.tileSwitchButton,"fm-google-street-switch-tile-selected"),this.mapWrapper.removeTileLayer(this.getStreetTile()),this.tileEnabled=!1}}])&&Eg(n.prototype,r),i&&Eg(n,i),l}(Oe)),Hg=n(22),Vg=n.n(Hg);function Yg(t){return(Yg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xg(t,e,n){return(Xg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qg(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Zg(t,e){return!e||"object"!==Yg(e)&&"function"!=typeof e?Kg(t):e}function Kg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jg(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Qg(t){return(Qg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $g(t,e){return($g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ty={header:{iconCls:"fm-icon-picker",title:locales.toolbar.pickup},position:"topright",visible:!0,closeButton:!0,hideOnClose:!0,dragable:!0,resizable:!1},ey=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$g(t,e)}(l,t);var e,n,r,i,a=(e=l,function(){var t,n=Qg(e);if(Jg()){var r=Qg(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Zg(this,t)});function l(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),e=a.call(this,Object.assign({},ty,t)),n=Kg(e),i="coordPicker",(r="CONTROL_KEY")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e}return n=l,(r=[{key:"addTo",value:function(t){Xg(Qg(l.prototype),"addTo",this).call(this,t),t.controls[this.CONTROL_KEY]=this,this.onAdd(t)}},{key:"bodyHook",value:function(){var t=this,e=t.bodyEl=s.create("div","fm-coord-picker");(t._coordEl=s.create("input","fm-coord-picker-coord",e)).readOnly=!0;var n=s.create("div","fm-coord-picker-toolbar",e),r=s.create("button","fm-common-button fm-common-button--primary fm-common-button--mini",n);s.create("span",void 0,r).innerHTML=locales.coordPicker.pickup,o.on(r,"click",t._onPickBtnClick,t);var i=s.create("button","fm-common-button fm-common-button--primary fm-common-button--mini",n);return s.create("span",void 0,i).innerHTML=locales.coordPicker.copy,o.on(i,"click",t._onCopyBtnClick,t),e}},{key:"_onPickBtnClick",value:function(t){}},{key:"_onCopyBtnClick",value:function(t){var e=this,n=new Vg.a(t.target,{text:function(){return e._coordEl.value}});n.on("success",(function(){e.fire("copysuccess"),n.destroy()})),n.on("error",(function(){e.fire("copyerror"),n.destroy()})),n.onClick(t)}},{key:"updateCoord",value:function(t){var e=t.lng.toFixed(6).concat(", ").concat(t.lat.toFixed(6));this._coordEl.value=e}},{key:"onRemove",value:function(){delete this.mapWrapper.controls[this.CONTROL_KEY],Xg(Qg(l.prototype),"onRemove",this).call(this)}}])&&Wg(n.prototype,r),i&&Wg(n,i),l}(Oe);function ny(t){return(ny="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ry(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oy(t,e,n){return(oy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ly(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function ay(t,e){return!e||"object"!==ny(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ly(t){return(ly=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function uy(t,e){return(uy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cy=window.L,hy=cy.icon({iconUrl:Lp,shadowUrl:Ep,iconSize:[25,41],shadowSize:[41,41],iconAnchor:[13,41],shadowAnchor:[13,41],popupAnchor:[-1,-27]}),fy=Fe.extend({onAdd:function(t){Fe.prototype.onAdd.call(this,t);return t.on("crschange",this._transformCoords,this),this.el},onRemove:function(t){var e=this;Fe.prototype.onRemove.call(e,t),e._pickedCoord&&e._pickedCoord.remove(),e.disable(),t.off("crschange",e._transformCoords,e)},enable:function(){var t=this._map;s.addClass(t._container,"fm-coord-picker-active"),t.on("click",this._onMapClick,this)},disable:function(){var t=this._map;s.removeClass(t._container,"fm-coord-picker-active"),t.off("click",this._onMapClick,this)},_onMapClick:function(t){var e=this,n=e._map,r=e._wrapper;e._pickedCoord&&e._pickedCoord.remove(),e._pickedCoord=cy.marker(t.latlng,{icon:hy}).addTo(n);var i=n.options.crs.code,o=ie.CRS_CODE,a=ut.transform(t.latlng.lat,t.latlng.lng,i,o);r.updateCoord({lat:a.lat,lng:a.lng}),e.disable()},_transformCoords:function(t){if(this._pickedCoord){var e=this._pickedCoord.getLatLng(),n=ut.transform(e.lat,e.lng,t.oldCrs.code,t.newCrs.code);this._pickedCoord.setLatLng(n)}}}),py=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uy(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=ly(e);if(sy()){var r=ly(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return ay(this,t)});function a(){return ry(this,a),o.apply(this,arguments)}return n=a,(r=[{key:"create",value:function(){var t=this;return Object.assign(this.options,{el:t.buildUI()}),t._lcmp=new fy(t.options),t._lcmp._wrapper=t,t.on("hide",(function(e){t._lcmp.disable(),t._lcmp._pickedCoord&&t._lcmp._pickedCoord.remove(),t._coordEl.value=""}),t),t}},{key:"addTo",value:function(t){return oy(ly(a.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}},{key:"getContainerElement",value:function(){return this._lcmp.el}},{key:"onRemove",value:function(){this.mapWrapper.removeControl(this._lcmp),oy(ly(a.prototype),"onRemove",this).call(this)}},{key:"_onPickBtnClick",value:function(t){oy(ly(a.prototype),"_onPickBtnClick",this).call(this,t),this._lcmp.enable()}}])&&iy(n.prototype,r),i&&iy(n,i),a}(ey);function dy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gy(t,e,n){return(gy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ly(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function yy(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function my(t){return(my="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _y(t){return function(){var e,n=Ly(t);if(xy()){var r=Ly(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return by(this,e)}}function by(t,e){return!e||"object"!==my(e)&&"function"!=typeof e?wy(t):e}function wy(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ly(t){return(Ly=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ey(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cy(t,e)}function Cy(t,e){return(Cy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ky={type:"single"},Sy={visible:!1,position:"topleft",resizable:!0,header:{iconCls:"fm-icon-overlays-ex",title:locales.overlays.title},bodyStyle:{minWidth:"450px",width:"600px",height:"450px"}},Py=function(t){Ey(n,t);var e=_y(n);function n(t){var r;return vy(this,n),(r=e.call(this)).options=Object.assign({},ky,t),r}return n}(h),My=function(t){Ey(a,t);var e,n,r,i=_y(a);function a(t){var e;return vy(this,a),yy(wy(e=i.call(this,Object.assign({},Sy,t,{header:(!t||!1!==t.header)&&Object.assign({},Sy.header,t?t.header:{}),bodyStyle:Object.assign({},Sy.bodyStyle,t?t.bodyStyle:{})}))),"selModel",void 0),yy(wy(e),"layers",{}),yy(wy(e),"rowsOverlay",[]),yy(wy(e),"selectedRowIdx",-1),yy(wy(e),"CONTROL_KEY","overlaysex"),yy(wy(e),"events",["btnaddclick","overlayadd","overlayremove"]),e.selModel=new Py,e}return e=a,(n=[{key:"addTo",value:function(t){gy(Ly(a.prototype),"addTo",this).call(this,t),t.controls[this.CONTROL_KEY]=this}},{key:"bodyHook",value:function(){return this._containerEl=s.create("div","fm-overlays-ex-body-container"),this._toolbarEl=s.create("div","fm-overlays-ex-body-toolbar",this._containerEl),this._buildToolbar(this._toolbarEl),this._mainEl=s.create("div","fm-overlays-ex-body-main",this._containerEl),this._buildMain(this._mainEl),this._bottomEl=s.create("div","fm-overlays-ex-body-buttons",this._containerEl),this._buildBottom(this._bottomEl),this._containerEl}},{key:"_buildToolbar",value:function(t){var e=this,n=s.create("button","fm-overlays-ex-body-toolbar-icon overlay-button-add",t);n.title=locales.common.add,o.on(n,"click",e._onAddClick,e);var r=s.create("button","fm-overlays-ex-body-toolbar-icon overlay-button-del",t);r.title=locales.common.delete,o.on(r,"click",e._onRemoveClick,e),s.create("div","fm-overlays-ex-body-toolbar-splitter",t);var i=s.create("button","fm-overlays-ex-body-toolbar-icon overlay-button-top",t);i.title=locales.common.top,o.on(i,"click",e._moveToTop,e);var a=s.create("button","fm-overlays-ex-body-toolbar-icon overlay-button-up",t);a.title=locales.common.up,o.on(a,"click",e._moveUp,e);var l=s.create("button","fm-overlays-ex-body-toolbar-icon overlay-button-down",t);l.title=locales.common.down,o.on(l,"click",e._moveDown,e);var u=s.create("button","fm-overlays-ex-body-toolbar-icon overlay-button-bottom",t);u.title=locales.common.bottom,o.on(u,"click",e._moveToBottom,e),s.create("div","fm-overlays-ex-body-toolbar-splitter",t);var c=s.create("div","fm-overlays-ex-body-toolbar-opacity",t);c._labelEl=s.create("div","fm-overlays-ex-body-toolbar-opacity-label",c),c._labelEl.innerHTML="".concat(locales.overlays.header.opacity,": "),c._rangeEl=s.create("input","fm-overlays-ex-body-toolbar-opacity-range",c),c._rangeEl.setAttribute("type","range"),o.on(c._rangeEl,"input",e._updateOpacity,e),e._opacityEl=c}},{key:"_buildMain",value:function(t){var e=s.create("table","fm-overlays-ex-body-main-table",t);e.setAttribute("cellspacing","0"),e.setAttribute("cellpadding","0"),e.setAttribute("border","0"),e.innerHTML='<thead><tr>\n        <th class="'.concat("fm-overlays-ex-body",'-th-name">').concat(locales.overlays.header.name,'</th>\n        <th class="').concat("fm-overlays-ex-body",'-th-offset-x">').concat(locales.overlays.header.offsetX,'</th>\n        <th class="').concat("fm-overlays-ex-body",'-th-offset-y">').concat(locales.overlays.header.offsetY,'</th>\n        <th class="').concat("fm-overlays-ex-body",'-th-visible">').concat(locales.overlays.header.visible,'</th>\n        <th class="').concat("fm-overlays-ex-body",'-th-clickable">').concat(locales.overlays.header.clickable,"</th>\n        </tr></thead>"),this._tableBodyEl=s.create("tbody","fm-overlays-ex-body-main-table-body",e)}},{key:"_onAddClick",value:function(t){this.fire("btnaddclick",{srcElement:t.target})}},{key:"_onRemoveClick",value:function(t){var e=this.getSelectedEl();e&&(this.unregister(e._overlay),this._opacityEl.style.display="none")}},{key:"register",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){t.layers[s.stamp(e)]||(t.layers[s.stamp(e)]=e,e.on("visiblechange",t._onVisibleChange,t),e.on("remove",t._onLayerRemove,t),e._weight=t.rowsOverlay.length,t.rowsOverlay.push(e))})),this._updateTableBody(),t.fire("overlayadd",{data:n})}},{key:"unregister",value:function(){for(var t=this,e=[],n=t.getSelectedEl(),r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];if(i.forEach((function(n){var r=t.layers[s.stamp(n)];r&&(r.off("visiblechange",t._updateTableBody,t),r.off("remove",t._onLayerRemove,t),delete t.layers[s.stamp(n)],t.rowsOverlay.splice(t.rowsOverlay.indexOf(n),1),e.push(n))})),this._updateTableBody(),n)for(var a=0;a<t._tableBodyEl.childNodes.length;a++)if(n===t._tableBodyEl.childNodes[a]){t.selectedRowIdx=a,t.select(a);break}this.fire("overlayremove",{data:e})}},{key:"select",value:function(t){s.addClass(this._tableBodyEl.childNodes[t],"selected-row")}},{key:"_onVisibleChange",value:function(){for(var t,e=this._tableBodyEl.childNodes,n=0;n<e.length;n++)(t=e[n])._overlay.options.visible?s.addClass(t._visibleImg,"overlay-visible"):s.removeClass(t._visibleImg,"overlay-visible")}},{key:"_updateZIndex",value:function(){this.rowsOverlay.forEach((function(t,e){t.setZIndex(100+t._weight)}))}},{key:"clearOverlays",value:function(){this.unregister(this.rowsOverlay)}},{key:"_onLayerRemove",value:function(t){this.unregister(t.target)}},{key:"_updateTableBody",value:function(){var t,e=this,n=e._tableBodyEl;n.innerHTML="",e.rowsOverlay.sort((function(t,e){return e._weight-t._weight})).forEach((function(r,i){t=s.create("tr","",n),o.on(t,"click",e._onRowClick,e),t._overlay=r,e._renderRow(t,r)})),e._updateWeight()}},{key:"_renderRow",value:function(t,e){s.create("td","fm-overlays-ex-body-td-name",t).innerText=e.getName();var n,r,i=s.create("td","",t),a=s.create("td","",t);Object.prototype.hasOwnProperty.call(e.options,"offsetX")?((r=s.create("div","fm-overlays-ex-body-offset-label",i)).innerHTML=e.options.offsetX,(n=s.create("input","fm-overlays-ex-body-offset-input",i)).setAttribute("type","range"),n.setAttribute("value",e.options.offsetX+50),n.style.background="linear-gradient(to right, #059CFA, white "+(e.options.offsetX+50)+"%, white)",n._tr=t,n._labelEl=r,o.on(n,"input",this._updateOffset,n),t._rangeX=n,(r=s.create("div","fm-overlays-ex-body-offset-label",a)).innerHTML=e.options.offsetY,(n=s.create("input","fm-overlays-ex-body-offset-input",a)).setAttribute("type","range"),n.value=e.options.offsetX+50,n.style.background="linear-gradient(to right, #059CFA, white "+(e.options.offsetY+50)+"%, white)",n._tr=t,n._labelEl=r,o.on(n,"input",this._updateOffset,n),t._rangeY=n):(i.innerHTML='<span style="color: gray;">-</span>',a.innerHTML='<span style="color: gray;">-</span>');var l=s.create("td","",t),u=s.create("div","fm-overlays-ex-body-visible",l);t._visibleImg=u,e.options.visible&&s.addClass(u,"overlay-visible"),o.on(u,"click",(function(t){e.isVisible()?(e.setVisible(!1),s.removeClass(u,"overlay-visible")):(e.setVisible(!0),s.addClass(u,"overlay-visible")),o.stopPropagation(t)}),u);var c=s.create("td","",t);if(!1!==e._clickSupport){var h=s.create("div","fm-overlays-ex-body-clickable",c);e.options.clickable&&s.addClass(h,"overlay-clickable"),o.on(h,"click",(function(t){e.options.clickable?(e.setClickable(!1),s.removeClass(h,"overlay-clickable")):(e.setClickable(!0),s.addClass(h,"overlay-clickable")),o.stopPropagation(t)}),u)}else c.innerHTML='<span style="color: gray;">-</span>'}},{key:"_updateOffset",value:function(){var t=this._tr,e=this._labelEl,n=t._overlay,r=t._rangeX,i=t._rangeY;this.style.background="linear-gradient(to right, #059CFA, white "+this.value+"%, white)",e.innerHTML="".concat(parseInt(this.value)-50),n.setOffset(r.value-50,i.value-50)}},{key:"_updateOpacity",value:function(){var t=this.getSelectedEl();t&&(t._overlay.setOpacity(this._opacityEl._rangeEl.value/100),this._opacityEl._rangeEl.style.background="linear-gradient(to right, #059CFA, white "+this._opacityEl._rangeEl.value+"%, white)")}},{key:"_onRowClick",value:function(t){var e=this,n=e._searchTrNode(t.target);e._tableBodyEl.childNodes.forEach((function(t,r){t===n?(e.selectedRowIdx=r,s.addClass(t,"selected-row")):s.removeClass(t,"selected-row")})),e._testOpacity()}},{key:"_testOpacity",value:function(){var t=this.getSelectedEl();if(t){var e=this._opacityEl._rangeEl,n=t._overlay;e.value=100*n.options.opacity,e.style.background="linear-gradient(to right, #059CFA, white "+100*n.options.opacity+"%, white)",this._opacityEl.style.display="block"}else this._opacityEl.style.display="none"}},{key:"getSelectedEl",value:function(){if(-1!==this.selectedRowIdx)return this._tableBodyEl.childNodes[this.selectedRowIdx]}},{key:"getSelecttion",value:function(){if(-1!==this.selectedRowIdx)return this._tableBodyEl.childNodes[this.selectedRowIdx]._overlay}},{key:"_updateWeight",value:function(){var t=this._tableBodyEl.childNodes.length-1;this._tableBodyEl.childNodes.forEach((function(e,n){e._overlay._weight=t-n})),this._updateZIndex()}},{key:"_moveUp",value:function(){var t=this._tableBodyEl,e=this.getSelectedEl();if(t.childNodes[0]!==e){var n=e.previousSibling;t.insertBefore(e,n),this.selectedRowIdx--}this._updateWeight()}},{key:"_moveDown",value:function(){var t=this._tableBodyEl,e=this.getSelectedEl(),n=t.lastChild;if(n!==e){var r=e.nextSibling;r===n?t.appendChild(e):t.insertBefore(e,r.nextSibling),this.selectedRowIdx++,this._updateWeight()}}},{key:"_moveToTop",value:function(){var t=this._tableBodyEl,e=this.getSelectedEl(),n=t.firstChild;n!==e&&(t.insertBefore(e,n),this.selectedRowIdx=0,this._updateWeight())}},{key:"_moveToBottom",value:function(){var t=this._tableBodyEl,e=this.getSelectedEl();t.lastChild!==e&&(t.appendChild(e),this.selectedRowIdx=t.childNodes.length-1,this._updateWeight())}},{key:"_searchTrNode",value:function(t){for(var e=t.parentNode;e&&"TR"!==e.tagName;)e=e.parentNode;return e}},{key:"_buildBottom",value:function(t){}},{key:"onRemove",value:function(){delete this.mapWrapper.controls[this.CONTROL_KEY]}}])&&dy(e.prototype,n),r&&dy(e,r),a}(Oe);function Ty(t){return(Ty="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Iy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ny(t,e,n){return(Ny="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ay(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Dy(t,e){return!e||"object"!==Ty(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ry(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ay(t){return(Ay=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jy(t,e){return(jy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var By=Fe.extend({}),zy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jy(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Ay(e);if(Ry()){var r=Ay(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Dy(this,t)});function a(){return Oy(this,a),o.apply(this,arguments)}return n=a,(r=[{key:"create",value:function(){return Object.assign(this.options,{el:this.buildUI()}),this._lcmp=new By(this.options),this}},{key:"addTo",value:function(t){return Ny(Ay(a.prototype),"addTo",this).call(this,t),this._lcmp.addTo(t.mapCmp),this}},{key:"getContainerElement",value:function(){return this._lcmp.el}},{key:"destroy",value:function(){this.mapWrapper.removeControl(this._lcmp),this.onRemove()}},{key:"onRemove",value:function(){Ny(Ay(a.prototype),"onRemove",this).call(this)}}])&&Iy(n.prototype,r),i&&Iy(n,i),a}(My);function Fy(t){return(Fy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Uy(t,e,n){return(Uy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Vy(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function qy(t,e){return!e||"object"!==Fy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Vy(t){return(Vy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yy(t,e){return(Yy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wy={crsCode:ie.CRS_CODE},Xy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yy(t,e)}(a,t);var e,n,r,i,o=(e=a,function(){var t,n=Vy(e);if(Hy()){var r=Vy(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return qy(this,t)});function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,Object.assign({},Wy,e))).latLng=t,n}return n=a,(r=[{key:"addTo",value:function(t){Uy(Vy(a.prototype),"addTo",this).call(this,t);var e=this.latLng;return this._compiledLatLng=ut.transform(e.lat,e.lng,this.options.crsCode,t.getCrsCode()),t.on("crschange",this._crsChange,this),this}},{key:"_crsChange",value:function(t){var e=this.latLng;this._compiledLatLng=ut.transform(e.lat,e.lng,this.options.crsCode,this.mapWrapper.getCrsCode()),this._updatePosition()}},{key:"update",value:function(t){this.latLng=t,this._compiledLatLng=ut.transform(t.lat,t.lng,this.options.crsCode,this.mapWrapper.getCrsCode()),this._updatePosition()}},{key:"_getCompiledLatLng",value:function(){return this._compiledLatLng}},{key:"_updatePosition",value:function(){}}])&&Gy(n.prototype,r),i&&Gy(n,i),a}(N);function Zy(t){return(Zy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ky(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qy(t,e,n){return(Qy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=em(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function $y(t,e){return!e||"object"!==Zy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function em(t){return(em=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nm(t,e){return(nm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rm=r.icon({iconUrl:Lp,shadowUrl:Ep,iconSize:[25,41],shadowSize:[41,41],iconAnchor:[13,41],shadowAnchor:[13,41],popupAnchor:[-1,-27]}),im=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nm(t,e)}(s,t);var e,n,i,o,a=(e=s,function(){var t,n=em(e);if(tm()){var r=em(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return $y(this,t)});function s(){return Ky(this,s),a.apply(this,arguments)}return n=s,(i=[{key:"create",value:function(){return this}},{key:"addTo",value:function(t){return Qy(em(s.prototype),"addTo",this).call(this,t),this._lcmp=r.marker(this._getCompiledLatLng(),{icon:rm}),this._lcmp.addTo(t.mapCmp),this}},{key:"_updatePosition",value:function(){this._lcmp.setLatLng(this._getCompiledLatLng())}},{key:"destroy",value:function(){this._lcmp.remove(),Qy(em(s.prototype),"destroy",this).call(this)}}])&&Jy(n.prototype,i),o&&Jy(n,o),s}(Xy);function om(t){return(om="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function am(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sm(t,e,n){return(sm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cm(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function lm(t,e){return!e||"object"!==om(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function um(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function cm(t){return(cm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hm(t,e){return(hm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hm(t,e)}(s,t);var e,n,i,o,a=(e=s,function(){var t,n=cm(e);if(um()){var r=cm(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return lm(this,t)});function s(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,t,e)).mapCmp=r.map(t,n.options),n}return n=s,(i=[{key:"create",value:function(){sm(cm(s.prototype),"create",this).call(this),this.mapCmp.on("mousemove click",this._onMapMouseMoveClick,this),this.mapCmp.on("movestart",this._onMapMoveStart,this),this.mapCmp.on("moveend",this._onMapMoveEnd,this),this.mapCmp.on("baselayerchange",this.__baseLayerChange,this),this.mapCmp.on("crschange",this.__crsChange,this)}},{key:"createScale",value:function(t){return r.control.scale(t).addTo(this.mapCmp)}},{key:"createContextMenu",value:function(t){var e=this;window.oncontextmenu=function(t){var n=e;console.log(t.target===n.mapCmp._container)}}},{key:"createZoom",value:function(t){return r.control.zoom(t).addTo(this.mapCmp)}},{key:"createTileLayer",value:function(t){return new K(t).create().addTo(this).onAdd(this)}},{key:"createToolbar",value:function(t){return new Ht(t).create().addTo(this).onAdd(this)}},{key:"createBaseLayers",value:function(t){return new _t(t).create().addTo(this).onAdd(this)}},{key:"createDraw",value:function(t){return new _e(t).create().addTo(this).onAdd(this)}},{key:"createMeasure",value:function(t){return new fa(t).create().addTo(this).onAdd(this)}},{key:"createLocate",value:function(t){return new Ap(t).create().addTo(this).onAdd(this)}},{key:"createCoordPicker",value:function(t){return new py(t).create().addTo(this).onAdd(this)}},{key:"createPanel",value:function(t){return new Ge(t).create().addTo(this).onAdd(this)}},{key:"createOverlays",value:function(t){return new un(t).create().addTo(this).onAdd(this)}},{key:"createScrollMsg",value:function(t){return new On(t).create().addTo(this).onAdd(this)}},{key:"createHeatmap",value:function(t){return new Id(t).create().addTo(this).onAdd(this)}},{key:"createBaiduStreet",value:function(t){return new xg(t).create().addTo(this).onAdd(this)}},{key:"createGoogleStreet",value:function(t){return new qg(t).create().addTo(this).onAdd(this)}},{key:"createWebGlPointOverlay",value:function(t){return new zo(t).create().addTo(this).onAdd(this)}},{key:"createPointOverlay",value:function(t){return new Bo(t).create().addTo(this).onAdd(this)}},{key:"createWebGlGridOverlay",value:function(t){return new Go(t).create().addTo(this).onAdd(this)}},{key:"createGridOverlay",value:function(t){return new Fo(t).create().addTo(this).onAdd(this)}},{key:"createCellOverlay",value:function(t){return new Uo(t).create().addTo(this).onAdd(this)}},{key:"createLegend",value:function(t){return new cd(t).create().addTo(this).onAdd(this)}},{key:"createLinkOverlay",value:function(t){return new qo(t).create().addTo(this).onAdd(this)}},{key:"createIconOverlay",value:function(t){return new Ho(t).create().addTo(this).onAdd(this)}},{key:"createLineOverlay",value:function(t){return new Vo(t).create().addTo(this).onAdd(this)}},{key:"createDriveRoad",value:function(t){return new Qd(t).create().addTo(this).onAdd(this)}},{key:"createOverlaysEx",value:function(t){return new zy(t).create().addTo(this).onAdd(this)}},{key:"removeControl",value:function(t){this.mapCmp.removeControl(t)}},{key:"getMaxZoom",value:function(){return this.mapCmp.getMaxZoom()}},{key:"getMinZoom",value:function(){return this.mapCmp.getMinZoom()}},{key:"getZoom",value:function(){return this.mapCmp.getZoom()}},{key:"zoomIn",value:function(){this.mapCmp.zoomIn()}},{key:"zoomOut",value:function(){this.mapCmp.zoomOut()}},{key:"setView",value:function(t,e){this.mapCmp.setView(ut.transform(t.lat,t.lng,ie.CRS_CODE,this.mapCmp.options.crs.code),e)}},{key:"fitBounds",value:function(t){var e=this.mapCmp,n=ie.CRS_CODE,i=e.options.crs.code,o=ut.transform(t.north,t.east,n,i),a=ut.transform(t.south,t.west,n,i),s=r.latLng(o.lat,o.lng),l=r.latLng(a.lat,a.lng),u=r.latLngBounds(s,l);this.mapCmp.fitBounds(u)}},{key:"remove",value:function(){this.mapCmp.off("mousemove click",this._onMapMouseMoveClick),this.mapCmp.off("movestart",this._onMapMoveStart),this.mapCmp.off("movesend",this._onMapMoveEnd),this.mapCmp.off("baselayerchange",this.__baseLayerChange,this),this.mapCmp.off("crschange",this.__crsChange,this),this.mapCmp.remove(),sm(cm(s.prototype),"remove",this).call(this)}},{key:"addMarker",value:function(t,e){return new im(t,e).create().addTo(this).onAdd()}},{key:"invalidateSize",value:function(){this.mapCmp.invalidateSize()}},{key:"__baseLayerChange",value:function(t){this.fire("baselayerchange",{layer:t.layer,originalEvent:t.originalEvent})}},{key:"getCrsCode",value:function(){return this.mapCmp.options.crs.code}},{key:"__crsChange",value:function(t){this.fire("crschange",{layer:t.layer,originalEvent:t.originalEvent})}},{key:"addTileLayer",value:function(t){this.mapCmp.addLayer(t._lcmp)}},{key:"removeTileLayer",value:function(t){this.mapCmp.removeLayer(t._lcmp)}},{key:"_onMap",value:function(t){this.onMapMouseMove({originalEvent:t.originalEvent,latLng:{lat:t.latLng.lat,lng:t.latLng.lng},point:{x:t.containerPoint.x,y:t.containerPoint.y},type:t.type,target:t.target})}},{key:"_onMapMouseMoveClick",value:function(t){var e={originalEvent:t.originalEvent,latlng:{lat:t.latlng.lat,lng:t.latlng.lng},point:{x:t.containerPoint.x,y:t.containerPoint.y},type:t.type,target:t.target};"click"===t.type?this.onMapClick(e):this.onMapMouseMove(e)}}])&&am(n.prototype,i),o&&am(n,o),s}(E);n(269);function pm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var dm,gm,ym,mm=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=this.options=Object.assign({},{engine:"leaflet"},n);this._getMapWrapper(e,r).create()}var e,n,r;return e=t,(n=[{key:"remove",value:function(){this.mapWrapper.remove()}},{key:"_getMapWrapper",value:function(e,n){switch(n.engine){case t.FLEET_MAP_ENGINE_LEAFLET:this.mapWrapper=new fm(e,n);break;default:throw new Error("Map engine is required!")}return this.mapWrapper}}])&&pm(e.prototype,n),r&&pm(e,r),t}();ym="leaflet",(gm="FLEET_MAP_ENGINE_LEAFLET")in(dm=mm)?Object.defineProperty(dm,gm,{value:ym,enumerable:!0,configurable:!0,writable:!0}):dm[gm]=ym;e.default={SystemConfig:ie,FleetMap:mm,DomUtil:s,DomEvent:o,DataUtil:ut,BaseStore:cr}}}).default}));